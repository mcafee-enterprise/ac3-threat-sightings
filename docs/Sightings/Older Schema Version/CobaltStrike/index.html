<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">CobaltStrike | AC3 - Threat Sightings</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Older Schema Version/CobaltStrike"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="CobaltStrike | AC3 - Threat Sightings"><meta data-react-helmet="true" name="description" content="Summary"><meta data-react-helmet="true" property="og:description" content="Summary"><link data-react-helmet="true" rel="shortcut icon" href="/ac3-threat-sightings/img/ma-favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Older Schema Version/CobaltStrike"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Older Schema Version/CobaltStrike" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Older Schema Version/CobaltStrike" hreflang="x-default"><link rel="stylesheet" href="/ac3-threat-sightings/assets/css/styles.9f78bae8.css">
<link rel="preload" href="/ac3-threat-sightings/assets/js/runtime~main.c07ad03c.js" as="script">
<link rel="preload" href="/ac3-threat-sightings/assets/js/main.a21a4089.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ac3-threat-sightings/"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">AC3 Threat Sightings</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ac3-threat-sightings/docs/Welcome">Home</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Welcome">AC3 Threat Sightings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Sightings</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Darkside_Ransomware">Darkside_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Diavol_Ransomware">Diavol_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Conti_Ransomware">Conti_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/BlackCat_Ransomware">BlackCat_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer">Jupyter_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer">Raccoon_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Guildma_RAT">Guildma_RAT</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/LemonDuck_Malware">LemonDuck_Malware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/UNK-Credential_Access">UNK-Credential_Access</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/TA551-Phishing">TA551-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/UNK-Phishing">UNK-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/HermeticWiper">HermeticWiper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/WhisperGate">WhisperGate</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Hafnium">Hafnium</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Tortillas_Babuk">Tortillas_Babuk</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021">Emotet_Dec2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Older Schema Version</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Older Schema Version/CVE-2021-40444">CVE-2021-40444</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Older Schema Version/CobaltStrike">CobaltStrike</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Weapons</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Techniques</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Stats">Stats</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CobaltStrike</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="summary"></a>Summary<a class="hash-link" href="#summary" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="description"></a>Description<a class="hash-link" href="#description" title="Direct link to heading">#</a></h3><p> This Threat Sighting represent different behaviors observed during investigations that involved Cobalt Strike activity.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="ttps"></a>TTPs<a class="hash-link" href="#ttps" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="execution---highly-obfuscated-powershell-command-with-default-cobalt-strike-arguments-service-execution"></a>Execution - Highly Obfuscated PowerShell command with default Cobalt Strike arguments. Service Execution.<a class="hash-link" href="#execution---highly-obfuscated-powershell-command-with-default-cobalt-strike-arguments-service-execution" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th>Technique</th><th>Behavior</th></tr></thead><tbody><tr><td>Execution</td><td>T1569.002 - System Services: Service Execution</td><td>Highly Obfuscated PowerShell command executed as Windows service.</td></tr><tr><td>Execution</td><td>T1059.001 - Command and Scripting Interpreter: PowerShell</td><td>Highly Obfuscated PowerShell command executed as Windows service.</td></tr><tr><td>Defense Evasion</td><td>T1140 - Deobfuscate/Decode Files or Information</td><td>Highly Obfuscated PowerShell command executed as Windows service.</td></tr></tbody></table><div class="mermaid">
graph LR;
sigh_e26ab4efb8e84e2f85b32431669f69a5[&quot;Execution - Highly Obfuscated PowerShell command with default Cobalt Strike arguments. Service Execution.&quot;];
typ_0[&quot;Process Created&quot;];
sigh_e26ab4efb8e84e2f85b32431669f69a5 --&gt; typ_0;
tech_0[&quot;T1569.002 - System Services: Service Execution&quot;];
typ_0 --&gt; tech_0;
tech_1[&quot;T1059.001 - Command and Scripting Interpreter: PowerShell&quot;];
typ_0 --&gt; tech_1;
tech_2[&quot;T1140 - Deobfuscate/Decode Files or Information&quot;];
typ_0 --&gt; tech_2;
</div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="execution---cobalt-strike-beacon-started-by-windows-service-injects-into-rundll32-and-dllhost"></a>Execution - Cobalt Strike beacon started by Windows Service. Injects into RUNDLL32 and DLLHOST.<a class="hash-link" href="#execution---cobalt-strike-beacon-started-by-windows-service-injects-into-rundll32-and-dllhost" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th>Technique</th><th>Behavior</th></tr></thead><tbody><tr><td>Execution</td><td>T1569.002 - System Services: Service Execution</td><td>PE file executed from ADMIN$ folder by services.exe.</td></tr><tr><td>Command and Control</td><td>T1071 - Application Layer Protocol</td><td>Connected to default Cobalt Strike named pipe (MSSE-*).</td></tr><tr><td>Execution</td><td>T1218.011 - Signed Binary Proxy Execution: Rundll32</td><td>Spawned RUNDLL32 without command-line arguments.</td></tr><tr><td>Execution</td><td>T1055.012 - Process Injection: Process Hollowing</td><td>Injected RUNDLL32.</td></tr><tr><td>Command and Control</td><td>T1071 - Application Layer Protocol</td><td>DLLHOST connected to default Cobalt Strike named pipe (postex_*).</td></tr></tbody></table><div class="mermaid">
graph LR;
sigh_b9b5b55fdcd24d97b6cb6cdcce8fd576[&quot;Execution - Cobalt Strike beacon started by Windows Service. Injects into RUNDLL32 and DLLHOST.&quot;];
typ_0[&quot;Process Created&quot;];
sigh_b9b5b55fdcd24d97b6cb6cdcce8fd576 --&gt; typ_0;
tech_0[&quot;T1569.002 - System Services: Service Execution&quot;];
typ_0 --&gt; tech_0;
typ_1[&quot;NamedPipe Connected&quot;];
sigh_b9b5b55fdcd24d97b6cb6cdcce8fd576 --&gt; typ_1;
tech_1[&quot;T1071 - Application Layer Protocol&quot;];
typ_1 --&gt; tech_1;
typ_2[&quot;Process Created&quot;];
sigh_b9b5b55fdcd24d97b6cb6cdcce8fd576 --&gt; typ_2;
tech_2[&quot;T1218.011 - Signed Binary Proxy Execution: Rundll32&quot;];
typ_2 --&gt; tech_2;
typ_3[&quot;Process Hollowed&quot;];
sigh_b9b5b55fdcd24d97b6cb6cdcce8fd576 --&gt; typ_3;
tech_3[&quot;T1055.012 - Process Injection: Process Hollowing&quot;];
typ_3 --&gt; tech_3;
typ_4[&quot;Process Created&quot;];
sigh_b9b5b55fdcd24d97b6cb6cdcce8fd576 --&gt; typ_4;
typ_5[&quot;NamedPipe Connected&quot;];
sigh_b9b5b55fdcd24d97b6cb6cdcce8fd576 --&gt; typ_5;
tech_4[&quot;T1071 - Application Layer Protocol&quot;];
typ_5 --&gt; tech_4;
</div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="discovery---automatic-discovery-with-bloodhound-process-injection-into-dllhost"></a>Discovery - Automatic Discovery with BloodHound. Process Injection into DLLHOST.<a class="hash-link" href="#discovery---automatic-discovery-with-bloodhound-process-injection-into-dllhost" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th>Technique</th><th>Behavior</th></tr></thead><tbody><tr><td>Discovery</td><td>T1018 - Remote System Discovery</td><td>DLLHOST performed multiple DNS Query events.</td></tr><tr><td>Discovery</td><td>T1046 - Network Service Scanning</td><td>DLLHOST performed hundreds of network connections to local network</td></tr><tr><td>Discovery</td><td>T1560 - Archive Collected Data</td><td>DLLHOST created json files and a zip file</td></tr></tbody></table><div class="mermaid">
graph LR;
sigh_f33125a7e43d4547a636089c40c72466[&quot;Discovery - Automatic Discovery with BloodHound. Process Injection into DLLHOST.&quot;];
typ_0[&quot;DNS Query&quot;];
sigh_f33125a7e43d4547a636089c40c72466 --&gt; typ_0;
tech_0[&quot;T1018 - Remote System Discovery&quot;];
typ_0 --&gt; tech_0;
typ_1[&quot;Network Accessed&quot;];
sigh_f33125a7e43d4547a636089c40c72466 --&gt; typ_1;
tech_1[&quot;T1046 - Network Service Scanning&quot;];
typ_1 --&gt; tech_1;
typ_2[&quot;File Created&quot;];
sigh_f33125a7e43d4547a636089c40c72466 --&gt; typ_2;
tech_2[&quot;T1560 - Archive Collected Data&quot;];
typ_2 --&gt; tech_2;
</div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="discovery---hands-on-keyboard-discovery-obfuscated-powershell-ipconfig"></a>Discovery - Hands-on-keyboard Discovery. Obfuscated PowerShell. ipconfig<a class="hash-link" href="#discovery---hands-on-keyboard-discovery-obfuscated-powershell-ipconfig" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th>Technique</th><th>Behavior</th></tr></thead><tbody><tr><td>Discovery</td><td>T1016 - System Network Configuration Discovery</td><td>System Network Configuration Discovery with ipconfig.exe.</td></tr><tr><td>Discovery</td><td>T1087 - Account Discovery</td><td>Account Discovery with Net.exe.</td></tr><tr><td>Discovery</td><td>T1016 - System Network Configuration Discovery</td><td>System Network Configuration Discovery with nslookup.</td></tr><tr><td>Discovery</td><td>T1016 - System Network Configuration Discovery</td><td>Discovery via Highly Obfuscated PowerShell</td></tr><tr><td>Execution</td><td>T1059.001 - Command and Scripting Interpreter: PowerShell</td><td>Discovery via Highly Obfuscated PowerShell</td></tr></tbody></table><div class="mermaid">
graph LR;
sigh_2f74b8a27ec5438c8df5d421ac337e39[&quot;Discovery - Hands-on-keyboard Discovery. Obfuscated PowerShell. ipconfig&quot;];
typ_0[&quot;Process Created&quot;];
sigh_2f74b8a27ec5438c8df5d421ac337e39 --&gt; typ_0;
tech_0[&quot;T1016 - System Network Configuration Discovery&quot;];
typ_0 --&gt; tech_0;
typ_1[&quot;Process Created&quot;];
sigh_2f74b8a27ec5438c8df5d421ac337e39 --&gt; typ_1;
tech_1[&quot;T1087 - Account Discovery&quot;];
typ_1 --&gt; tech_1;
typ_2[&quot;Process Created&quot;];
sigh_2f74b8a27ec5438c8df5d421ac337e39 --&gt; typ_2;
tech_2[&quot;T1016 - System Network Configuration Discovery&quot;];
typ_2 --&gt; tech_2;
typ_3[&quot;Process Created&quot;];
sigh_2f74b8a27ec5438c8df5d421ac337e39 --&gt; typ_3;
tech_3[&quot;T1016 - System Network Configuration Discovery&quot;];
typ_3 --&gt; tech_3;
tech_4[&quot;T1059.001 - Command and Scripting Interpreter: PowerShell&quot;];
typ_3 --&gt; tech_4;
</div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="priviledge-escalation---named-pipes-impersonation-cobalt-getsystem"></a>Priviledge Escalation - Named Pipes Impersonation (Cobalt getSystem)<a class="hash-link" href="#priviledge-escalation---named-pipes-impersonation-cobalt-getsystem" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th>Technique</th><th>Behavior</th></tr></thead><tbody><tr><td>Privilege Escalation</td><td>T1134 - Access Token Manipulation</td><td>Priviledge Escalation via Named Pipes Impersonation (Cobalt getSystem)</td></tr></tbody></table><div class="mermaid">
graph LR;
sigh_c57f5c01112148fab934105cf2df8082[&quot;Priviledge Escalation - Named Pipes Impersonation (Cobalt getSystem)&quot;];
typ_0[&quot;Process Created&quot;];
sigh_c57f5c01112148fab934105cf2df8082 --&gt; typ_0;
tech_0[&quot;T1134 - Access Token Manipulation&quot;];
typ_0 --&gt; tech_0;
</div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="threat-sighting-yaml-file"></a>Threat Sighting YAML File<a class="hash-link" href="#threat-sighting-yaml-file" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">sightingReportId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 8ad76b99</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b579</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">458c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">8810</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">786d3e86bd79</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> wip</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> This Threat Sighting represent different behaviors observed during investigations that involved Cobalt Strike activity.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">author</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Alejandro Houspanossian (@lekz86)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">acknowledgement</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> thedfirreport</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">tlp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> white</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">threatInformation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">adversary</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> multiple</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">malware</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> n/d</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">lolbas</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> rundll32.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">tools</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> net.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> powershell.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ipconfig.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> CobaltStrike</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> BloodHound</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> nslookup.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">country</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> many</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">region</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> many</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">industry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> many</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">threatSightings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">sighting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Execution </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Highly Obfuscated PowerShell command with default Cobalt Strike arguments. Service Execution.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> e26ab4ef</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b8e8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4e2f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">85b3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">2431669f69a5</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">observables</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Highly Obfuscated PowerShell command executed as Windows service.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 8eb7afc6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">510f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">48f3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">9fd1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">bcc976f4ebbe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\SysWOW64\\cmd.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">cmdLine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> /b /c start /b /min powershell </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">nop </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">w hidden </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">encodedcommand JABzAD0ATgBlAHcAL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">line pattern &#x27;/b /c start /b /min powershell&#x27; used by Cobalt Strike to execute its code a service.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Cobalt Strike executes PowerShell command as Windows Services.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">line patter &#x27;powershell </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">nop </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">w hidden </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">encodedcommand&#x27; used by Cobalt Strike to execute PowerShell encoded commands.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Cobalt Strike executes encoded PowerShell commands to load beacons shellcode into memory.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">execution</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;T1569.002 - System Services: Service Execution&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;T1059.001 - Command and Scripting Interpreter: PowerShell&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">defenseEvasion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1140 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Deobfuscate/Decode Files or Information</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">sighting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Execution </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Cobalt Strike beacon started by Windows Service. Injects into RUNDLL32 and DLLHOST.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> b9b5b55f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dcd2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4d97</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b6cb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">6cdcce8fd576</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">observables</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> PE file executed from ADMIN$ folder by services.exe.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> b868bc41</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">362a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4596</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">9ee8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">9897557e947b</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> \\\\</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#{IP}\\ADMIN$\\e10a2f3.exe</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">embedFilename</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> undefined</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">cmdLine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\\\</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#{IP}\\ADMIN$\\e10a2f3.exe</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">sha256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> 11D4978BF49A98F169FD82425B7CBC5DEDCD33881AE6D4CB0C5530ECC631F640</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\services.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ADMIN$ is one of the default administrative network shares in Windows.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ADMIN$ is hidden</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> and links to C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ADMIN$ is typically used to deploy software remotely.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\\\</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#{IP}\\ADMIN$\\ is a probable indicator of remote execution.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> The filename pattern </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">z0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">.exe is known for Cobalt Strike PE beacons.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">execution</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;T1569.002 - System Services: Service Execution&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Connected to default Cobalt Strike named pipe (MSSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token important">*).</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 621ca01e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">7e2c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">47e6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">80a3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">2a23d58a2c92</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> NamedPipe Connected</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">pipeName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> \\\\.\\pipe\\MSSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">5861</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">server</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> \\\\</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#{IP}\\ADMIN$\\e10a2f3.exe</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> NamedPipes are an inter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">process communication mechanism on Windows.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> NamedPipe traffic that goes host</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">host is encapsulated within the SMB protocol.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> NamedPipe name pattern &#x27;MSSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">server&#x27; is one of the default NamedPipes used by Cobalt Strike.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">commandAndControl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1071 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Application Layer Protocol</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Spawned RUNDLL32 without command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">line arguments.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> f383e553</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ff06</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4b0b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">bbd9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b2682bbc73d4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\rundll32.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">cmdLine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\rundll32.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> \\\\</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#{IP}\\ADMIN$\\e10a2f3.exe</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> RUNDLL32 is part of Windows.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> RUNDLL32 is used to launch functionality stored in a DLL file.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> RUNDLL32 without commmand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">line arguments is suspicious.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> RUNDLL32 is default Spawn_to process for Cobalt Strike.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Cobalt Strike is a post</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">explotaition tool widely used in attacks.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">execution</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;T1218.011 - Signed Binary Proxy Execution: Rundll32&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Injected RUNDLL32.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> f609d11c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b1aa</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4dc3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b75b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">56b175661716</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Hollowed</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\rundll32.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\\\</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#{IP}\\ADMIN$\\e10a2f3.exe</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Process hollowing is a method of executing arbitrary code in the address space of a separate live process.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Cobalt Strike injects into temporary processes for execution.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">execution</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;T1055.012 - Process Injection: Process Hollowing&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> RUNDLL32 created ~20 instances of DLLHOST without command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">line arguments.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 1669ecb0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">3a8a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4858</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">9efd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">23e5c01ad643</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">cmdLine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\rundll32.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> DLLHOST (a.k.a. COM Surrogate) is intented to execute DLLs.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> DLLHOST without commmand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">line arguments is suspicious.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> DLLHOST connected to default Cobalt Strike named pipe (postex_</span><span class="token important">*).</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 1dfd3613</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">6b33</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">486b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">99bb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">e87a98346887</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> NamedPipe Connected</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">pipeName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> \\\\.\\pipe\\postex_d0e7</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> NamedPipe name pattern &#x27;postex_</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">z0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">&#x27; is one of the default NamedPipes used by Cobalt Strike.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">commandAndControl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1071 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Application Layer Protocol</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">sighting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Discovery </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Automatic Discovery with BloodHound. Process Injection into DLLHOST.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> f33125a7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">e43d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4547</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">a636</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">089c40c72466</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">observables</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> DLLHOST performed multiple DNS Query events.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 762daeff</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">39c9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4741</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">a255</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">f8dfca2ba18a</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> DNS Query</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tcp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> SQL03.COMPANY.COM</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> SQL02.COMPANY.COM</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> DEV01.COMPANY.COM</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">discovery</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1018 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Remote System Discovery</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> DLLHOST performed hundreds of network connections to local network</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ced277c3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">f68a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">42b5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b153</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">55e1983d17ec</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Network Accessed</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">connections</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tcp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">dstIp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;#{PRIVATEIP}&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">dstPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">445</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> The srcPort is high port number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> eg. 63794.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">discovery</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1046 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Network Service Scanning</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> DLLHOST created json files and a zip file</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 00e87649</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">62aa</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">41c0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">92d3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">93bccf268b8f</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> File Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">files</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\20210101190124_users.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 20210101190124_users.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\20210101190124_computers.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 20210101190124_computers.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\20210101190124_groups.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 20210101190124_groups.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\20210101190124_ous.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 20210101190124_ous.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\20210101190124_gpos.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 20210101190124_gpos.json</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\20210101190124_BloodHound.zip</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 20210101190124_BloodHound.zip</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> BloodHound is an Active Directory (AD) reconnaissance tool.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> BloodHound outputs results as JSON files</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> BloodHound can collect information about the following objects (users</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> computers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> groups</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gpos)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> BloodHound can archive collected a ZIP file</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">discovery</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1560 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Archive Collected Data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">sighting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Discovery </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Hands</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">on</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">keyboard Discovery. Obfuscated PowerShell. ipconfig</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 2f74b8a2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">7ec5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">438c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">8df5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">d421ac337e39</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">observables</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> System Network Configuration Discovery with ipconfig.exe.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cabd27ff</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">28f6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">41bd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">85cc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">8860ab136782</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">cmdLine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ipconfig /all</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\ipconfig.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ipconfig displays all current TCP/IP network configuration values and refreshes Dynamic Host Configuration Protocol (DHCP) and Domain Name System (DNS) settings</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Cobalt Strike typically injects into legit system processes</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">discovery</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1016 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> System Network Configuration Discovery</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Account Discovery with Net.exe.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 8f233e51</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">284c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4423</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">823f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ce3aedf5e03a</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">cmdLine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> net users</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> net users /domain</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\net.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> The Net utility is a component of the Windows operating system. It is used in command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">line operations for control of users</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> groups</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> services</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> and network connections.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Cobalt Strike typically injects into legit system processes</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">discovery</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1087 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Account Discovery</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> System Network Configuration Discovery with nslookup.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 5ac96747</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ca6c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4ee2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">bc55</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">0048a82c6afc</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">cmdLine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> nslookup</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\nslookup.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">notes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Nslookup is a network administration command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">line tool for querying the Domain Name System to obtain the mapping between domain name and IP address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> or other DNS records.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Cobalt Strike typically injects into legit system processes</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">discovery</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1016 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> System Network Configuration Discovery</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Discovery via Highly Obfuscated PowerShell</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 4a17d5ad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">cbad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4363</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b6ed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">85644a92069e</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">cmdLine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ipconfig /all</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\ipconfig.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parentProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">discovery</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1016 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> System Network Configuration Discovery</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">execution</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;T1059.001 - Command and Scripting Interpreter: PowerShell&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">sighting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Priviledge Escalation </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Named Pipes Impersonation (Cobalt getSystem)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> c57f5c01</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">1121</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">48fa</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b934</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">105cf2df8082</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">observables</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">behavior</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Priviledge Escalation via Named Pipes Impersonation (Cobalt getSystem)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 310f5757</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">59b0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4cff</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">994a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">2921d2d52cfc</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Process Created</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\system32\\cmd.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">cmdLine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> C</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">\\Windows\\system32\\cmd.exe /c echo 675f2d61c15 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"> \\\\.\\pipe\\526c8c</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">att&amp;ck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">privilegeEscalation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> T1134 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> Access Token Manipulation</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">threatHunting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Hunt for Suspicious Process execution via Services.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">queryId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 65e91ae8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">2140</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4465</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">8329</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">693fb1dcb638</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sigma</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">behaviorIds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> b868bc41</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">362a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4596</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">9ee8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">9897557e947b</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> 8eb7afc6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">510f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">48f3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">9fd1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">bcc976f4ebbe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">logsource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">category</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> process_creation</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">product</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> windows</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">detection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">ParentImage|endswith</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\services.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">selection1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">Image|re</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;*ADMIN$\\[a-z0-9]{7}.exe&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">selection2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">CommandLine|contains</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> /b /c start /b /min powershell</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">nop </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">w hidden </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">encodedcommand</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">condition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> parent AND (selection1 OR selection2)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Hunt for Automated discovery</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">queryId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 7bec5230</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">5e8d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4ba0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">99b0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">92d9a86b00a7</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sigma</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">behaviorIds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> 00e87649</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">62aa</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">41c0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">92d3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">93bccf268b8f</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">logsource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">category</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> file_creation</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">product</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> windows</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">detection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">selection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">FileName|re</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;[0-9]{14}_BloodHound.zip&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">condition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> selection</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Hunt for Suspicious Process Injection</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">queryId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> f3f5821f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4d8b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4c6f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ab60</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">c8d6200561c4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sigma</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">behaviorIds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> f383e553</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ff06</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4b0b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">bbd9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b2682bbc73d4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">logsource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">category</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> process_creation</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">product</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> windows</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">detection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parent1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">ParentImage|endswith</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\powershell.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">parent2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">ParentImage|contains</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ADMIN$</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">selection3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">CommandLine|endswith</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\rundll32.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\sysnative\\mstsc.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\sysnative\\net.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\sysnative\\svchost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\sysnative\\lsass.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\sysnative\\dllhost.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\sysnative\\lsass.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\sysnative\\gpupdate.exe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\sysnative\\svchost.exe </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">k netsvcs</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">condition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> (parent1 OR parent2) AND selection3</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Hunt for Suspicious Process Execution from ADMIN$</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">queryId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> be6f5897</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">db49</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">456a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">bea7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">74cca07bb2c3</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sigma</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">behaviorIds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> f383e553</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ff06</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">4b0b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">bbd9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b2682bbc73d4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">logsource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">category</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> process_creation</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">product</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> windows</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">detection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">geno</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">ParentImage|re</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;*ADMIN$\\[a-z0-9]{7}.exe&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token key atrule">CommandLine|contains</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\Windows\\System32\\</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\Windows\\SysWow64\\</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> \\Windows\\Sysnative\\</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">condition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> geno</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">footer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">changeTracking</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">created</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2021-09-01</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">lastModified</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2021-11-18</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">sightingVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1.7</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token key atrule">schemaVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1.6</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token key atrule">references</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">//nasbench.medium.com/what</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">is</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">the</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dllhost</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">exe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">actually</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">running</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ef9fe4c19c08</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">//attack.mitre.org/techniques/T1055/012/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">//blog.cobaltstrike.com/2019/08/21/cobalt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">strikes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">injection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">the</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">details</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">cobalt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">strike/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">//thedfirreport.com/2021/08/29/cobalt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">strike</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">defenders</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">guide/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/Older Schema Version/CVE-2021-40444"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« CVE-2021-40444</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Weapons/7zip"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">7zip Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#summary" class="table-of-contents__link">Summary</a><ul><li><a href="#description" class="table-of-contents__link">Description</a></li></ul></li><li><a href="#ttps" class="table-of-contents__link">TTPs</a><ul><li><a href="#execution---highly-obfuscated-powershell-command-with-default-cobalt-strike-arguments-service-execution" class="table-of-contents__link">Execution - Highly Obfuscated PowerShell command with default Cobalt Strike arguments. Service Execution.</a></li><li><a href="#execution---cobalt-strike-beacon-started-by-windows-service-injects-into-rundll32-and-dllhost" class="table-of-contents__link">Execution - Cobalt Strike beacon started by Windows Service. Injects into RUNDLL32 and DLLHOST.</a></li><li><a href="#discovery---automatic-discovery-with-bloodhound-process-injection-into-dllhost" class="table-of-contents__link">Discovery - Automatic Discovery with BloodHound. Process Injection into DLLHOST.</a></li><li><a href="#discovery---hands-on-keyboard-discovery-obfuscated-powershell-ipconfig" class="table-of-contents__link">Discovery - Hands-on-keyboard Discovery. Obfuscated PowerShell. ipconfig</a></li><li><a href="#priviledge-escalation---named-pipes-impersonation-cobalt-getsystem" class="table-of-contents__link">Priviledge Escalation - Named Pipes Impersonation (Cobalt getSystem)</a></li></ul></li><li><a href="#threat-sighting-yaml-file" class="table-of-contents__link">Threat Sighting YAML File</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/ac3-threat-sightings/assets/js/runtime~main.c07ad03c.js"></script>
<script src="/ac3-threat-sightings/assets/js/main.a21a4089.js"></script>
</body>
</html>