<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">WhisperGate | AC3 - Threat Sightings</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/WhisperGate"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="WhisperGate | AC3 - Threat Sightings"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/ac3-threat-sightings/img/ma-favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/WhisperGate"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/WhisperGate" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/WhisperGate" hreflang="x-default"><link rel="stylesheet" href="/ac3-threat-sightings/assets/css/styles.9f78bae8.css">
<link rel="preload" href="/ac3-threat-sightings/assets/js/runtime~main.c07ad03c.js" as="script">
<link rel="preload" href="/ac3-threat-sightings/assets/js/main.a21a4089.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ac3-threat-sightings/"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">AC3 Threat Sightings</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ac3-threat-sightings/docs/Welcome">Home</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Welcome">AC3 Threat Sightings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Sightings</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Darkside_Ransomware">Darkside_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Diavol_Ransomware">Diavol_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Conti_Ransomware">Conti_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/BlackCat_Ransomware">BlackCat_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer">Jupyter_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer">Raccoon_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Guildma_RAT">Guildma_RAT</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/LemonDuck_Malware">LemonDuck_Malware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/UNK-Credential_Access">UNK-Credential_Access</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/TA551-Phishing">TA551-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/UNK-Phishing">UNK-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/HermeticWiper">HermeticWiper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/WhisperGate">WhisperGate</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Hafnium">Hafnium</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Tortillas_Babuk">Tortillas_Babuk</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021">Emotet_Dec2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Older Schema Version</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Weapons</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Techniques</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Stats">Stats</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>WhisperGate</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>This Threat Sighting documents observed TTPs for a data destructive malware tracked as WhisperGate. This Threat Sighting is based on information made public by different research teams. At this point, there are no deteails about the TTPs for Initial Access. Other pieces of the attack chain are unclear or partially documented.</p><p>This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: <a href="https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_WhisperGate.yml" target="_blank" rel="noopener noreferrer">https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_WhisperGate.yml</a></p><p>Author: Alejandro Houspanossian (@lekz86)</p><p>Acknowledgements: @MSFTSecurity, @S2W_Official, @elastic, @TrellixLabs</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="references"></a>References:<a class="hash-link" href="#references" title="Direct link to heading">#</a></h3><ul><li><a href="https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/" target="_blank" rel="noopener noreferrer">https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/</a></li><li><a href="https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3" target="_blank" rel="noopener noreferrer">https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3</a></li><li><a href="https://securityboulevard.com/2022/01/ttps-used-by-dev-0586-apt-group-in-whispergate-attack-targeting-ukraine/" target="_blank" rel="noopener noreferrer">https://securityboulevard.com/2022/01/ttps-used-by-dev-0586-apt-group-in-whispergate-attack-targeting-ukraine/</a></li><li><a href="https://elastic.github.io/security-research/malware/2022/01/01.operation-bleeding-bear/article/" target="_blank" rel="noopener noreferrer">https://elastic.github.io/security-research/malware/2022/01/01.operation-bleeding-bear/article/</a></li><li><a href="https://limbenjamin.com/articles/overwriting-mbr.html" target="_blank" rel="noopener noreferrer">https://limbenjamin.com/articles/overwriting-mbr.html</a></li><li><a href="https://www.zscaler.com/blogs/security-research/discord-cdn-popular-choice-hosting-malicious-payloads" target="_blank" rel="noopener noreferrer">https://www.zscaler.com/blogs/security-research/discord-cdn-popular-choice-hosting-malicious-payloads</a></li><li><a href="https://www.trellix.com/en-us/about/newsroom/stories/threat-labs/return-of-pseudo-ransomware.html" target="_blank" rel="noopener noreferrer">https://www.trellix.com/en-us/about/newsroom/stories/threat-labs/return-of-pseudo-ransomware.html</a></li><li><a href="https://attack.mitre.org/techniques/T1542/003/" target="_blank" rel="noopener noreferrer">https://attack.mitre.org/techniques/T1542/003/</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-activity"></a>Threat Actor Activity<a class="hash-link" href="#threat-actor-activity" title="Direct link to heading">#</a></h3><ul><li>Threat Actor used <em>Impacket</em> to execute <em>Stage1</em> <em>.EXE</em> file via WMI and CMD for Execution.</li><li>Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence.</li><li>Threat Actor used <em>MBR bootkit</em> to destroy disk data and display ransom note for Impact.</li><li>Threat Actor used malware <em>.EXE</em> file to download additional artifacts from <em>Discord CDN</em> for Command And Control.</li><li>Threat Actor used obfuscated <em>.EXE</em> files for Defense Evasion.</li><li>Stage3 malware used <em>AdvancedRun.exe</em> via VBScript and PowerShell do disable Windows Defender for Defense Evasion.</li><li>Threat Actor used <em>process injection on _InstallUtil</em> to launch the destructive routines for Impact.</li><li>Malware used <em>CMD del</em> command to delete itself for Defense Evasion.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="count-of-documented-ttps-by-tactic"></a>Count of documented TTPs by Tactic<a class="hash-link" href="#count-of-documented-ttps-by-tactic" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th># Documented TTPs</th></tr></thead><tbody><tr><td>Execution</td><td>+ (1)</td></tr><tr><td>Persistence</td><td>+ (1)</td></tr><tr><td>Command And Control</td><td>+ (1)</td></tr><tr><td>Impact</td><td>++ (2)</td></tr><tr><td>Defense Evasion</td><td>+++ (3)</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="attack-flow"></a>Attack Flow<a class="hash-link" href="#attack-flow" title="Direct link to heading">#</a></h3><p>The chart below shows a graphical representation of the attack flow.</p><div class="mermaid">
graph LR
EXE[Execution] --&gt; | _Impacket_ to execute _Stage1_ _.EXE_ file via WMI and CMD| EXE[Execution]
EXE[Execution] --&gt; | direct volume access to install a malicious MBR bootkit| PER[Persistence]
PER[Persistence] --&gt; | _MBR bootkit_ to destroy disk data and display ransom note| IMP[Impact]
EXE[Execution] --&gt; | malware _.EXE_ file to download additional artifacts from _Discord CDN_| C2[Command And Control]
EXE[Execution] --&gt; | obfuscated _.EXE_ files| DE[Defense Evasion]
EXE[Execution] --&gt; | _AdvancedRun.exe_ via VBScript and PowerShell do disable Windows Defender| DE[Defense Evasion]
EXE[Execution] --&gt; | _process injection on _InstallUtil_ to launch the destructive routines| IMP[Impact]
EXE[Execution] --&gt; | _CMD del_ command to delete itself| DE[Defense Evasion]
</div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-and-procedures"></a>Tactics, Techniques and Procedures<a class="hash-link" href="#tactics-techniques-and-procedures" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th></tr></thead><tbody><tr><td>Execution</td><td>T1047 - Windows Management Instrumentation<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat Actor used <em>Impacket</em> to execute <em>Stage1</em> <em>.EXE</em> file via WMI and CMD for Execution.</td></tr><tr><td>Persistence</td><td>T1006 - Direct Volume Access<br>T1542.003 - Pre-OS Boot: Bootkit</td><td>Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence.</td></tr><tr><td>Impact</td><td>T1491.001 - Defacement: Internal Defacement<br>T1561 - Disk Wipe</td><td>Threat Actor used <em>MBR bootkit</em> to destroy disk data and display ransom note for Impact.</td></tr><tr><td>Command And Control</td><td>T1553.002 - Subvert Trust Controls: Code Signing<br>T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion<br>T1059.001 - Command and Scripting Interpreter: PowerShell<br>T1105 - Ingress Tool Transfer<br>T1102 - Web Service<br>T1036 - Masquerading</td><td>Threat Actor used malware <em>.EXE</em> file to download additional artifacts from <em>Discord CDN</em> for Command And Control.</td></tr><tr><td>Defense Evasion</td><td>T1105 - Ingress Tool Transfer<br>T1027 - Obfuscated Files or Information</td><td>Threat Actor used obfuscated <em>.EXE</em> files for Defense Evasion.</td></tr><tr><td>Defense Evasion</td><td>T1059.005 - Command and Scripting Interpreter: Visual Basic<br>T1059.001 - Command and Scripting Interpreter: PowerShell<br>T1562.001 - Impair Defenses: Disable or Modify Tools</td><td>Stage3 malware used <em>AdvancedRun.exe</em> via VBScript and PowerShell do disable Windows Defender for Defense Evasion.</td></tr><tr><td>Impact</td><td>T1055 - Process Injection<br>T1561 - Disk Wipe</td><td>Threat Actor used <em>process injection on _InstallUtil</em> to launch the destructive routines for Impact.</td></tr><tr><td>Defense Evasion</td><td>T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion<br>T1070.004 - Indicator Removal on Host: File Deletion</td><td>Malware used <em>CMD del</em> command to delete itself for Defense Evasion.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-procedures-observables-and-notes"></a>Tactics, Techniques, Procedures, Observables and Notes<a class="hash-link" href="#tactics-techniques-procedures-observables-and-notes" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th><th>Observables</th><th>Notes</th></tr></thead><tbody><tr><td>Execution</td><td>T1047<br>T1059.003</td><td>Threat Actor used <em>Impacket</em> to execute <em>Stage1</em> <em>.EXE</em> file via WMI and CMD for Execution.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /Q /c start c:\\stage1.exe 1&gt; \\\\127.0.0.1\\ADMIN$\__[TIMESTAMP] 2&gt;&amp;1</code><br><em>Process Created</em>: <br>- <code>cmd.exe /Q /c start c:\\stage1.exe 1&gt; \\\\127.0.0.1\\ADMIN$\__[TIMESTAMP] 2&gt;&amp;1</code><br><em>Process Created</em>: <br>- <code>stage1.exe</code></td><td>- Wmiprvse.exe is the executable file for the Windows Management Instrumentation Provider Service.<br>- This might indicate remote code execution<br>- Patterns in the command-line arguments and process geno resemble to Impacket .<br>- Impacket is an open source collection of modules written in Python for programmatically constructing and manipulating network protocols.<br>- Impacket contains several tools for remote service execution, Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks.</td></tr><tr><td>Persistence</td><td>T1006<br>T1542.003</td><td>Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence.</td><td><em>API Invoked</em>: <br><em>API Invoked</em>: n/d</td><td>- CreateFileW(L&quot;\\.\PhysicalDrive0&quot;...<br>- WriteFile is executed with offset 0, to overwrite the 1st sector of the drive (the MBR).<br>- This will divert the execution during startup from the normal boot loader to adversary code.</td></tr><tr><td>Impact</td><td>T1491.001<br>T1561</td><td>Threat Actor used <em>MBR bootkit</em> to destroy disk data and display ransom note for Impact.</td><td><em>File Created</em>: <br>- <code>n/d</code></td><td>- The MBR bootkit (OS Pre-boot), written in assembler, will traverse all drives corrupting disks data and will show ransom note.</td></tr><tr><td>Command And Control</td><td>T1553.002<br>T1497.003<br>T1059.001<br>T1105<br>T1102<br>T1036</td><td>Threat Actor used malware <em>.EXE</em> file to download additional artifacts from <em>Discord CDN</em> for Command And Control.</td><td><em>Process Created</em>: <br>- <code>n/d</code><br><em>Process Created</em>: <br>- <code>powershell -enc UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA==</code><br><em>DNS Queried</em>: <code>cdn.discordapp[.]com</code><br><em>File Created</em>: <br>- <code>*\\Tbopbh.jpg</code></td><td>- details about mechanism used to execute this process is unknown for us at this time.<br>- the fake signature refers to a Microsoft Windows component.<br>- base64 encoded command decodes to &#x27;Start-Sleep -s 10&#x27;<br>- command is executed twice<br>- Multiple threat actors are using Discord CDN to host malware</td></tr><tr><td>Defense Evasion</td><td>T1105<br>T1027</td><td>Threat Actor used obfuscated <em>.EXE</em> files for Defense Evasion.</td><td><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Waqybg</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Nmddfrqqrbyjeygggda.vbs</code></td><td></td></tr><tr><td>Defense Evasion</td><td>T1059.005<br>T1059.001<br>T1562.001</td><td>Stage3 malware used <em>AdvancedRun.exe</em> via VBScript and PowerShell do disable Windows Defender for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\System32\\WScript.exe\&quot; \&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\Nmddfrqqrbyjeygggda.vbs\&quot;</code><br><em>Process Created</em>: <br>- <code>powershell.exe Set-MpPreference -ExclusionPath \&#x27;C:\\\&#x27;</code><br><em>Process Created</em>: <br>- <code>powershell.exe Set-MpPreference -ExclusionPath \&#x27;C:\\\&#x27;</code><br><em>Process Created</em>: <br>- <code>\&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe\&quot; /EXEFilename \&quot;C:\\Windows\\System32\\sc.exe\&quot; /WindowState 0 /CommandLine \&quot;stop WinDefend\&quot; /StartDirectory \&quot;\&quot; /RunAs 8 /Run</code><br><em>Process Created</em>: <br>- <code>\&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe\&quot; /EXEFilename \&quot;C:\\Windows\\System32\\sc.exe\&quot; /WindowState 0 /CommandLine \&quot;stop WinDefend\&quot; /StartDirectory \&quot;\&quot; /RunAs 8 /Run</code><br><em>Process Created</em>: <br>- <code>\&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe\&quot; /EXEFilename \&quot;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\&quot; /WindowState 0 /CommandLine \&quot;rmdir \&quot;C:\\ProgramData\\Microsoft\\Windows Defender\&quot; -Recurse\&quot; /StartDirectory \&quot;\&quot; /RunAs 8 /Run</code><br><em>Process Created</em>: <br>- <code>\&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe\&quot; /EXEFilename \&quot;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\&quot; /WindowState 0 /CommandLine \&quot;rmdir \&quot;C:\\ProgramData\\Microsoft\\Windows Defender\&quot; -Recurse\&quot; /StartDirectory \&quot;\&quot; /RunAs 8 /Run</code></td><td>- Nirsofts <em>AdvancedRun.exe</em> allows to run a Windows program with different settings.<br>- Nirsofts <em>AdvancedRun.exe</em> allows to run a Windows program with different settings.</td></tr><tr><td>Impact</td><td>T1055<br>T1561</td><td>Threat Actor used <em>process injection on _InstallUtil</em> to launch the destructive routines for Impact.</td><td><em>Process Created</em>: <br>- <code>InstallUtil.exe</code></td><td>- At this time, only Elastic reports on this TTP and no further details are available.<br>- InstallUtil.exe is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries.</td></tr><tr><td>Defense Evasion</td><td>T1497.003<br>T1070.004</td><td>Malware used <em>CMD del</em> command to delete itself for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 &gt; Nul &amp; Del /f /q #{process}</code><br><em>Process Created</em>: <br>- <code>cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 &gt; Nul &amp; Del /f /q #{process}</code></td><td></td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="ttp-profiles-with-observables"></a>TTP Profiles with Observables<a class="hash-link" href="#ttp-profiles-with-observables" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-impacket-to-execute-stage1-exe-file-via-wmi-and-cmd-for-execution"></a>Threat Actor used <em>Impacket</em> to execute <em>Stage1</em> <em>.EXE</em> file via WMI and CMD for Execution.<a class="hash-link" href="#threat-actor-used-impacket-to-execute-stage1-exe-file-via-wmi-and-cmd-for-execution" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic"></a>Tactic<a class="hash-link" href="#tactic" title="Direct link to heading">#</a></h4><ul><li>Execution</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques"></a>Techniques<a class="hash-link" href="#techniques" title="Direct link to heading">#</a></h4><ul><li>T1047 - Windows Management Instrumentation</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1047</td><td>Windows Command Shell spawned by Windows Management Instrumentation Provider Service (WMIPRVSE).</td><td><em>Process Created</em>: <br>- <code>cmd.exe /Q /c start c:\\stage1.exe 1&gt; \\\\127.0.0.1\\ADMIN$\__[TIMESTAMP] 2&gt;&amp;1</code></td></tr><tr><td>T1059.003</td><td>Suspicious command executed via Windows Command Shell.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /Q /c start c:\\stage1.exe 1&gt; \\\\127.0.0.1\\ADMIN$\__[TIMESTAMP] 2&gt;&amp;1</code></td></tr><tr><td>T1059.003</td><td><em>Stage1 malware</em> is executed via Windows Command Shell.</td><td><em>Process Created</em>: <br>- <code>stage1.exe</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-direct-volume-access-to-install-a-malicious-mbr-bootkit-for-persistence"></a>Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence.<a class="hash-link" href="#threat-actor-used-direct-volume-access-to-install-a-malicious-mbr-bootkit-for-persistence" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-1"></a>Tactic<a class="hash-link" href="#tactic-1" title="Direct link to heading">#</a></h4><ul><li>Persistence</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-1"></a>Techniques<a class="hash-link" href="#techniques-1" title="Direct link to heading">#</a></h4><ul><li>T1006 - Direct Volume Access</li><li>T1542.003 - Pre-OS Boot: Bootkit</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-1"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-1" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1006</td><td><em>Stage1 malware</em> opens a write handle to the physical device using the CreateFile API.</td><td><em>API Invoked</em>: <br><em>API Invoked</em>: n/d</td></tr><tr><td>T1542.003</td><td><em>Stage1 malware</em> overwrote MBR (Master Boot Record) using WriteFile API.</td><td></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes"></a>Notes<a class="hash-link" href="#notes" title="Direct link to heading">#</a></h4><ul><li>WriteFile is executed with offset 0, to overwrite the 1st sector of the drive (the MBR).</li><li>This will divert the execution during startup from the normal boot loader to adversary code.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-mbr-bootkit-to-destroy-disk-data-and-display-ransom-note-for-impact"></a>Threat Actor used <em>MBR bootkit</em> to destroy disk data and display ransom note for Impact.<a class="hash-link" href="#threat-actor-used-mbr-bootkit-to-destroy-disk-data-and-display-ransom-note-for-impact" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-2"></a>Tactic<a class="hash-link" href="#tactic-2" title="Direct link to heading">#</a></h4><ul><li>Impact</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-2"></a>Techniques<a class="hash-link" href="#techniques-2" title="Direct link to heading">#</a></h4><ul><li>T1491.001 - Defacement: Internal Defacement</li><li>T1561 - Disk Wipe</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-2"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-2" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1491.001<br>T1561</td><td>MBR bootkit destroyed disk data and displayed ransom note.</td><td><em>File Created</em>: <br>- <code>n/d</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-1"></a>Notes<a class="hash-link" href="#notes-1" title="Direct link to heading">#</a></h4><ul><li>The MBR bootkit (OS Pre-boot), written in assembler, will traverse all drives corrupting disks data and will show ransom note.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-malware-exe-file-to-download-additional-artifacts-from-discord-cdn-for-command-and-control"></a>Threat Actor used malware <em>.EXE</em> file to download additional artifacts from <em>Discord CDN</em> for Command And Control.<a class="hash-link" href="#threat-actor-used-malware-exe-file-to-download-additional-artifacts-from-discord-cdn-for-command-and-control" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-3"></a>Tactic<a class="hash-link" href="#tactic-3" title="Direct link to heading">#</a></h4><ul><li>Command And Control</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-3"></a>Techniques<a class="hash-link" href="#techniques-3" title="Direct link to heading">#</a></h4><ul><li>T1553.002 - Subvert Trust Controls: Code Signing</li><li>T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion</li><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li><li>T1105 - Ingress Tool Transfer</li><li>T1102 - Web Service</li><li>T1036 - Masquerading</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-3"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-3" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1553.002</td><td><em>Stage2 malware</em> binary is signed with fake signature.</td><td><em>Process Created</em>: <br>- <code>n/d</code></td></tr><tr><td>T1497.003<br>T1059.001</td><td><em>Stage2 malware</em> delayed execution for 20 seconds via <em>PowerShell</em> Sleep commands.</td><td><em>Process Created</em>: <br>- <code>powershell -enc UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA==</code></td></tr><tr><td>T1105<br>T1102</td><td><em>Stage2 malware</em> reached out Discord CDN to fetch Stage3 malware.</td><td><em>DNS Queried</em>: <code>cdn.discordapp[.]com</code></td></tr><tr><td>T1036</td><td><em>Stage2 malware</em> dropped <em>Stage3 malware</em> disquised as a .JPG file</td><td><em>File Created</em>: <br>- <code>*\\Tbopbh.jpg</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-obfuscated-exe-files-for-defense-evasion"></a>Threat Actor used obfuscated <em>.EXE</em> files for Defense Evasion.<a class="hash-link" href="#threat-actor-used-obfuscated-exe-files-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-4"></a>Tactic<a class="hash-link" href="#tactic-4" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-4"></a>Techniques<a class="hash-link" href="#techniques-4" title="Direct link to heading">#</a></h4><ul><li>T1105 - Ingress Tool Transfer</li><li>T1027 - Obfuscated Files or Information</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-4"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-4" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1105<br>T1027</td><td>Additional files extracted out of Stage3.</td><td><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Waqybg</code><br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Temp\\Nmddfrqqrbyjeygggda.vbs</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="stage3-malware-used-advancedrunexe-via-vbscript-and-powershell-do-disable-windows-defender-for-defense-evasion"></a>Stage3 malware used <em>AdvancedRun.exe</em> via VBScript and PowerShell do disable Windows Defender for Defense Evasion.<a class="hash-link" href="#stage3-malware-used-advancedrunexe-via-vbscript-and-powershell-do-disable-windows-defender-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-5"></a>Tactic<a class="hash-link" href="#tactic-5" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-5"></a>Techniques<a class="hash-link" href="#techniques-5" title="Direct link to heading">#</a></h4><ul><li>T1059.005 - Command and Scripting Interpreter: Visual Basic</li><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li><li>T1562.001 - Impair Defenses: Disable or Modify Tools</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-5"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-5" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.005</td><td>Stage3 executed a Visual Basic script file</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\System32\\WScript.exe\&quot; \&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\Nmddfrqqrbyjeygggda.vbs\&quot;</code></td></tr><tr><td>T1059.001</td><td>WScript.exe spawned PowerShell</td><td><em>Process Created</em>: <br>- <code>powershell.exe Set-MpPreference -ExclusionPath \&#x27;C:\\\&#x27;</code></td></tr><tr><td>T1562.001</td><td><em>PowerShell</em> command to exclude folder from Windows Defender</td><td><em>Process Created</em>: <br>- <code>powershell.exe Set-MpPreference -ExclusionPath \&#x27;C:\\\&#x27;</code></td></tr><tr><td>T1562.001</td><td>Stage3 executed <em>AdvancedRun.exe</em> to stop Windows Defender.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe\&quot; /EXEFilename \&quot;C:\\Windows\\System32\\sc.exe\&quot; /WindowState 0 /CommandLine \&quot;stop WinDefend\&quot; /StartDirectory \&quot;\&quot; /RunAs 8 /Run</code></td></tr><tr><td>T1562.001</td><td><em>AdvancedRun.exe</em> executed <em>sc.exe</em> to stop Windows Defender.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe\&quot; /EXEFilename \&quot;C:\\Windows\\System32\\sc.exe\&quot; /WindowState 0 /CommandLine \&quot;stop WinDefend\&quot; /StartDirectory \&quot;\&quot; /RunAs 8 /Run</code></td></tr><tr><td>T1562.001</td><td>Stage3 executed <em>AdvancedRun.exe</em> to remove Windows Defender directory.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe\&quot; /EXEFilename \&quot;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\&quot; /WindowState 0 /CommandLine \&quot;rmdir \&quot;C:\\ProgramData\\Microsoft\\Windows Defender\&quot; -Recurse\&quot; /StartDirectory \&quot;\&quot; /RunAs 8 /Run</code></td></tr><tr><td>T1562.001</td><td><em>AdvancedRun.exe</em> executed <em>PowerShell</em> to remove Windows Defender directory.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Users\\#{user}\\AppData\\Local\\Temp\\AdvancedRun.exe\&quot; /EXEFilename \&quot;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\&quot; /WindowState 0 /CommandLine \&quot;rmdir \&quot;C:\\ProgramData\\Microsoft\\Windows Defender\&quot; -Recurse\&quot; /StartDirectory \&quot;\&quot; /RunAs 8 /Run</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-process-injection-on-_installutil-to-launch-the-destructive-routines-for-impact"></a>Threat Actor used <em>process injection on _InstallUtil</em> to launch the destructive routines for Impact.<a class="hash-link" href="#threat-actor-used-process-injection-on-_installutil-to-launch-the-destructive-routines-for-impact" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-6"></a>Tactic<a class="hash-link" href="#tactic-6" title="Direct link to heading">#</a></h4><ul><li>Impact</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-6"></a>Techniques<a class="hash-link" href="#techniques-6" title="Direct link to heading">#</a></h4><ul><li>T1055 - Process Injection</li><li>T1561 - Disk Wipe</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-6"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-6" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1055<br>T1561</td><td>File corruptor executed via Process Injection on <em>InstallUtil.exe</em>.</td><td><em>Process Created</em>: <br>- <code>InstallUtil.exe</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-2"></a>Notes<a class="hash-link" href="#notes-2" title="Direct link to heading">#</a></h4><ul><li>At this time, only Elastic reports on this TTP and no further details are available.</li><li>InstallUtil.exe is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="malware-used-cmd-del-command-to-delete-itself-for-defense-evasion"></a>Malware used <em>CMD del</em> command to delete itself for Defense Evasion.<a class="hash-link" href="#malware-used-cmd-del-command-to-delete-itself-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-7"></a>Tactic<a class="hash-link" href="#tactic-7" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-7"></a>Techniques<a class="hash-link" href="#techniques-7" title="Direct link to heading">#</a></h4><ul><li>T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion</li><li>T1070.004 - Indicator Removal on Host: File Deletion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-7"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-7" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1497.003</td><td>Malware launched a CMD command to delay execution of further commands.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 &gt; Nul &amp; Del /f /q #{process}</code></td></tr><tr><td>T1070.004</td><td>Malware deleted itself via CMD.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 &gt; Nul &amp; Del /f /q #{process}</code></td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/HermeticWiper"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« HermeticWiper</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/Hafnium"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Hafnium Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a><ul><li><a href="#references" class="table-of-contents__link">References:</a></li><li><a href="#threat-actor-activity" class="table-of-contents__link">Threat Actor Activity</a></li><li><a href="#count-of-documented-ttps-by-tactic" class="table-of-contents__link">Count of documented TTPs by Tactic</a></li><li><a href="#attack-flow" class="table-of-contents__link">Attack Flow</a></li></ul></li><li><a href="#tactics-techniques-and-procedures" class="table-of-contents__link">Tactics, Techniques and Procedures</a></li><li><a href="#tactics-techniques-procedures-observables-and-notes" class="table-of-contents__link">Tactics, Techniques, Procedures, Observables and Notes</a></li><li><a href="#ttp-profiles-with-observables" class="table-of-contents__link">TTP Profiles with Observables</a><ul><li><a href="#threat-actor-used-impacket-to-execute-stage1-exe-file-via-wmi-and-cmd-for-execution" class="table-of-contents__link">Threat Actor used <em>Impacket</em> to execute <em>Stage1</em> <em>.EXE</em> file via WMI and CMD for Execution.</a></li><li><a href="#threat-actor-used-direct-volume-access-to-install-a-malicious-mbr-bootkit-for-persistence" class="table-of-contents__link">Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence.</a></li><li><a href="#threat-actor-used-mbr-bootkit-to-destroy-disk-data-and-display-ransom-note-for-impact" class="table-of-contents__link">Threat Actor used <em>MBR bootkit</em> to destroy disk data and display ransom note for Impact.</a></li><li><a href="#threat-actor-used-malware-exe-file-to-download-additional-artifacts-from-discord-cdn-for-command-and-control" class="table-of-contents__link">Threat Actor used malware <em>.EXE</em> file to download additional artifacts from <em>Discord CDN</em> for Command And Control.</a></li><li><a href="#threat-actor-used-obfuscated-exe-files-for-defense-evasion" class="table-of-contents__link">Threat Actor used obfuscated <em>.EXE</em> files for Defense Evasion.</a></li><li><a href="#stage3-malware-used-advancedrunexe-via-vbscript-and-powershell-do-disable-windows-defender-for-defense-evasion" class="table-of-contents__link">Stage3 malware used <em>AdvancedRun.exe</em> via VBScript and PowerShell do disable Windows Defender for Defense Evasion.</a></li><li><a href="#threat-actor-used-process-injection-on-_installutil-to-launch-the-destructive-routines-for-impact" class="table-of-contents__link">Threat Actor used <em>process injection on _InstallUtil</em> to launch the destructive routines for Impact.</a></li><li><a href="#malware-used-cmd-del-command-to-delete-itself-for-defense-evasion" class="table-of-contents__link">Malware used <em>CMD del</em> command to delete itself for Defense Evasion.</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/ac3-threat-sightings/assets/js/runtime~main.c07ad03c.js"></script>
<script src="/ac3-threat-sightings/assets/js/main.a21a4089.js"></script>
</body>
</html>