<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Raccoon_InfoStealer | AC3 - Threat Sightings</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Raccoon_InfoStealer | AC3 - Threat Sightings"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/ac3-threat-sightings/img/ma-favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer" hreflang="x-default"><link rel="stylesheet" href="/ac3-threat-sightings/assets/css/styles.9f78bae8.css">
<link rel="preload" href="/ac3-threat-sightings/assets/js/runtime~main.5b7811bf.js" as="script">
<link rel="preload" href="/ac3-threat-sightings/assets/js/main.6c42f5d6.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ac3-threat-sightings/"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">AC3 Threat Sightings</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ac3-threat-sightings/docs/Welcome">Home</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Welcome">AC3 Threat Sightings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Sightings</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Darkside_Ransomware">Darkside_Ransomware</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer">Jupyter_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer">Raccoon_InfoStealer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Guildma_RAT">Guildma_RAT</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/TA551-Phishing">TA551-Phishing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Hafnium">Hafnium</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021">Emotet_Dec2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Older Schema Version</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Weapons</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Techniques</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Stats">Stats</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Raccoon_InfoStealer</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>This Threat Sighting documents a case of <em>Raccoon Stealer</em> bundled together with a cracked version of a commercial software tool. In this case, the user accessed a Youtube video that shows how to install and crack a tool called Stellar Data Recovery; download link is included in the description of the video. Likely Search Engine Optimization (SEO) poisoning was used for accelerating distribution. Upon infection, Raccoon accessed Web Browsers credentials stores and exfiltrated data to cloud storage.</p><p>This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: <a href="https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Raccoon_InfoStealer.yml" target="_blank" rel="noopener noreferrer">https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Raccoon_InfoStealer.yml</a></p><p>Author: Alejandro Houspanossian (@lekz86)</p><p>Acknowledgements: Alejandro Houspanossian (@lekz86)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="references"></a>References:<a class="hash-link" href="#references" title="Direct link to heading">#</a></h3><ul><li><a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.raccoon" target="_blank" rel="noopener noreferrer">https://malpedia.caad.fkie.fraunhofer.de/details/win.raccoon</a></li><li><a href="https://www.sentinelone.com/labs/info-stealers-how-malware-hacks-private-user-data/" target="_blank" rel="noopener noreferrer">https://www.sentinelone.com/labs/info-stealers-how-malware-hacks-private-user-data/</a></li><li><a href="https://apr4h.github.io/2019-12-20-Harvesting-Browser-Credentials/" target="_blank" rel="noopener noreferrer">https://apr4h.github.io/2019-12-20-Harvesting-Browser-Credentials/</a></li><li><a href="https://renenyffenegger.ch/notes/development/web/browser/Firefox/profile-folder/index" target="_blank" rel="noopener noreferrer">https://renenyffenegger.ch/notes/development/web/browser/Firefox/profile-folder/index</a></li><li><a href="https://blogs.blackberry.com/en/2021/09/threat-thursday-raccoon-infostealer" target="_blank" rel="noopener noreferrer">https://blogs.blackberry.com/en/2021/09/threat-thursday-raccoon-infostealer</a></li><li><a href="https://news.sophos.com/en-us/2021/08/03/trash-panda-as-a-service-raccoon-stealer-steals-cookies-cryptocoins-and-more/" target="_blank" rel="noopener noreferrer">https://news.sophos.com/en-us/2021/08/03/trash-panda-as-a-service-raccoon-stealer-steals-cookies-cryptocoins-and-more/</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-activity"></a>Threat Actor Activity<a class="hash-link" href="#threat-actor-activity" title="Direct link to heading">#</a></h3><ul><li>Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access.</li><li>Threat actor used compromised installers to lure users for Execution.</li><li>Threat actor used <em>Visual Basic scripts</em> to launch a <em>doscmd/batch</em> file via <em>CMD</em> for Execution.</li><li>Threat actor used <em>doscmd/batch</em> files to disable Windows Defender via multiple <em>reg.exe</em> and <em>SCHTASKS.exe</em> for Defense Evasion.</li><li>Threat actor used <em>AntiAV</em> (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion.</li><li>Threat actor used <em>CMD</em> to launch Raccoon InfoStealer for Execution.</li><li>Malware used HTTP to download additional tools for Command And Control.</li><li>Malware used <em>Native APIs</em> to access Chrome credentials store for Credential Access.</li><li>Malware used <em>SQlite3</em> DLL to read Firefox credentials store for Credential Access.</li><li>Malware used <em>unconfirmed method</em> to create a <em>.zip</em> file for Collection.</li><li>Malware used <em>cloud storage</em> for Exfiltration.</li><li>Malware used <em>CMD delayed command execution</em> to delelete itself for Defense Evasion.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="count-of-documented-ttps-by-tactic"></a>Count of documented TTPs by Tactic<a class="hash-link" href="#count-of-documented-ttps-by-tactic" title="Direct link to heading">#</a></h3><table><thead><tr><th>Tactic</th><th># Documented TTPs</th></tr></thead><tbody><tr><td>Initial Access</td><td>+ (1)</td></tr><tr><td>Command And Control</td><td>+ (1)</td></tr><tr><td>Collection</td><td>+ (1)</td></tr><tr><td>Exfiltration</td><td>+ (1)</td></tr><tr><td>Credential Access</td><td>++ (2)</td></tr><tr><td>Execution</td><td>+++ (3)</td></tr><tr><td>Defense Evasion</td><td>+++ (3)</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="attack-flow"></a>Attack Flow<a class="hash-link" href="#attack-flow" title="Direct link to heading">#</a></h3><p>The chart below shows a graphical representation of the attack flow.</p><div class="mermaid">
graph LR
IA[Initial Access] --&gt; | Search Engine Optimization -SEO- poisoning to lure users| IA[Initial Access]
IA[Initial Access] --&gt; | compromised installers to lure users| EXE[Execution]
EXE[Execution] --&gt; | _Visual Basic scripts_ to launch a _doscmd/batch_ file via _CMD_| EXE[Execution]
EXE[Execution] --&gt; | _doscmd/batch_ files to disable Windows Defender via multiple _reg.exe_ and _SCHTASKS.exe_| DE[Defense Evasion]
DE[Defense Evasion] --&gt; | _AntiAV_ -an open source tool obfuscation tool- to obfuscate malware binary file| DE[Defense Evasion]
DE[Defense Evasion] --&gt; | _CMD_ to launch Raccoon InfoStealer| EXE[Execution]
EXE[Execution] --&gt; | HTTP to download additional tools| C2[Command And Control]
EXE[Execution] --&gt; | _Native APIs_ to access Chrome credentials store| CA[Credential Access]
CA[Credential Access] --&gt; | _SQlite3_ DLL to read Firefox credentials store| CA[Credential Access]
CA[Credential Access] --&gt; | _unconfirmed method_ to create a _.zip_ file| COL[Collection]
COL[Collection] --&gt; | _cloud storage_| EXFIL[Exfiltration]
EXE[Execution] --&gt; | _CMD delayed command execution_ to delelete itself| DE[Defense Evasion]
</div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-and-procedures"></a>Tactics, Techniques and Procedures<a class="hash-link" href="#tactics-techniques-and-procedures" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th></tr></thead><tbody><tr><td>Initial Access</td><td>T1189 - Drive-by Compromise<br>T1105 - Ingress Tool Transfer</td><td>Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access.</td></tr><tr><td>Execution</td><td>T1204.002 - User Execution: Malicious File</td><td>Threat actor used compromised installers to lure users for Execution.</td></tr><tr><td>Execution</td><td>T1059.005 - Command and Scripting Interpreter: Visual Basic<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat actor used <em>Visual Basic scripts</em> to launch a <em>doscmd/batch</em> file via <em>CMD</em> for Execution.</td></tr><tr><td>Defense Evasion</td><td>T1562.001 - Impair Defenses: Disable or Modify Tools<br>T1112 - Modify Registry</td><td>Threat actor used <em>doscmd/batch</em> files to disable Windows Defender via multiple <em>reg.exe</em> and <em>SCHTASKS.exe</em> for Defense Evasion.</td></tr><tr><td>Defense Evasion</td><td>T1140 - Deobfuscate/Decode Files or Information<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat actor used <em>AntiAV</em> (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion.</td></tr><tr><td>Execution</td><td>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Threat actor used <em>CMD</em> to launch Raccoon InfoStealer for Execution.</td></tr><tr><td>Command And Control</td><td>T1071.001 - Application Layer Protocol: Web Protocols<br>T1105 - Ingress Tool Transfer</td><td>Malware used HTTP to download additional tools for Command And Control.</td></tr><tr><td>Credential Access</td><td>T1555.003 - Credentials from Password Stores: Credentials from Web Browsers<br>T1106 - Native API</td><td>Malware used <em>Native APIs</em> to access Chrome credentials store for Credential Access.</td></tr><tr><td>Credential Access</td><td>T1555.003 - Credentials from Password Stores: Credentials from Web Browsers</td><td>Malware used <em>SQlite3</em> DLL to read Firefox credentials store for Credential Access.</td></tr><tr><td>Collection</td><td>T1560 - Archive Collected Data</td><td>Malware used <em>unconfirmed method</em> to create a <em>.zip</em> file for Collection.</td></tr><tr><td>Exfiltration</td><td>T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage</td><td>Malware used <em>cloud storage</em> for Exfiltration.</td></tr><tr><td>Defense Evasion</td><td>T1070.004 - Indicator Removal on Host: File Deletion<br>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</td><td>Malware used <em>CMD delayed command execution</em> to delelete itself for Defense Evasion.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="tactics-techniques-procedures-observables-and-notes"></a>Tactics, Techniques, Procedures, Observables and Notes<a class="hash-link" href="#tactics-techniques-procedures-observables-and-notes" title="Direct link to heading">#</a></h2><table><thead><tr><th>Tactic</th><th>Techniques</th><th>Procedure</th><th>Observables</th><th>Notes</th></tr></thead><tbody><tr><td>Initial Access</td><td>T1189<br>T1105</td><td>Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access.</td><td><em>DNS Queried</em>: <code>softwarebestever[.]fun</code><br><em>DNS Queried</em>: <code>youtub[.]space</code><br><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\Downloads\\StellarDataRecoveryProfessional.rar</code></td><td>- Search Engine Optimization (SEO) poisoning allows threat actors to rank their malicious resources higher in web searches.<br>- In this case, apparently, the user is searching for a cracked version of a tool called Stellar Data Recovery.<br>- softwarebestever[.]fun resolves to an IP address that corresponds to the Russian Federation<br>- There is osint that shows that softwarebestever[.]fun has served the file <em>StellarDataRecoveryProfessional.rar</em> at some point in time (https://urlscan[.]io/search/#page.domain%3Asoftwarebestever.fun)<br>- Youtube video (<a href="https://www.youtube.com/watch?v=GJW-PN_O4z8" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=GJW-PN_O4z8</a>) shows how to download and crack Stellar Data Recovery Professional.<br>- youtub[.]space is part of the url provided in the description of the video (<a href="https://www.youtube%5B.%5Dcom/redirect?event=video_description&amp;redir_token=QUFFLUhqbEFBNzdjUXNuQklzWkdBSHFSYm1VN2Y0RkxDZ3xBQ3Jtc0tsN1NnVE5RODhvRlJ1cTlHamhBeG0tdFZhVFNFSG1SR2ZrS1ktWk9FMGlKQlZ5U0hJM2RKN05WWWN6TDFzWEliZ3cxU1JiYUZIVlVGb05NN0p0U2tGUC1ISVJvRlpVZlBzVU53aGxsZDRFbW9pQi1fdw&amp;q=https%3A%2F%2Fyoutub%5B%5D.%5Dspace%2FStellarDataRecoveryProfessional" target="_blank" rel="noopener noreferrer">https://www.youtube[.]com/redirect?event=video_description&amp;redir_token=QUFFLUhqbEFBNzdjUXNuQklzWkdBSHFSYm1VN2Y0RkxDZ3xBQ3Jtc0tsN1NnVE5RODhvRlJ1cTlHamhBeG0tdFZhVFNFSG1SR2ZrS1ktWk9FMGlKQlZ5U0hJM2RKN05WWWN6TDFzWEliZ3cxU1JiYUZIVlVGb05NN0p0U2tGUC1ISVJvRlpVZlBzVU53aGxsZDRFbW9pQi1fdw&amp;q=https%3A%2F%2Fyoutub[].]space%2FStellarDataRecoveryProfessional</a>)<br>- Unknown if user was maliciously redirected to perform this download<br>- StellarDataRecoveryProfessional.rar seems to be a cracked copy of Stellar Data Recovery Professional.<br>- StellarDataRecoveryProfessional.rar file has no reputation at VT (Oct 2nd 2021)</td></tr><tr><td>Execution</td><td>T1204.002</td><td>Threat actor used compromised installers to lure users for Execution.</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Program Files (x86)\\IZArc\\IZArc.exe\&quot; -ef C:\\Users\\#{user}\\Downloads C:\\Users\\#{user}\\Downloads\\StellarDataRecoveryProfessional.rar</code><br><em>Process Created</em>: <br>- <code>C:\\Users\\#{user}\\Downloads\\StellarDataRecoveryProfessional\\StellarDataRecoveryProfessional\\StellarDataRecovery-Professional.exe</code><br><em>File Created</em>: <br>- <code>C:\\ProgramData\\IgHMwb34dcD\\7z.exe</code><br>- <code>C:\\ProgramData\\IgHMwb34dcD\\main.bat</code><br>- <code>C:\\ProgramData\\IgHMwb34dcD\\STRTbbbn7przuvwav4hbpbps.vbs</code><br>- <code>C:\\ProgramData\\IgHMwb34dcD\\DELbbbn7l3bnchd166d2hhhv.bat</code><br>- <code>C:\\ProgramData\\IgHMwb34dcD\\AVDbbbn7i3b4ho55ck6raahj.bat</code></td><td>- As parent process is Explorer, likely the user executed  the process.<br>- IZArc.exe seems to be legit archiving functionality<br>- StellarDataRecovery-Professional.exe seems to be a fake or compromissed installer.<br>- <a href="https://www.virustotal.com/gui/file/56783c2e395603404c92bc44ca0c39d4bbcc312edbf6d2349e367c232c5b8e57" target="_blank" rel="noopener noreferrer">https://www.virustotal.com/gui/file/56783c2e395603404c92bc44ca0c39d4bbcc312edbf6d2349e367c232c5b8e57</a><br>- 13/69 detections at VT (Oct 2nd 2021)<br>- main.bat is related to <a href="https://github.com/hXR16F/AntiAV/blob/master/AntiAV.bat" target="_blank" rel="noopener noreferrer">https://github.com/hXR16F/AntiAV/blob/master/AntiAV.bat</a>, and Anti AntiVirus project.<br>- AntiAV obfuscates files using compression via 7zip</td></tr><tr><td>Execution</td><td>T1059.005<br>T1059.003</td><td>Threat actor used <em>Visual Basic scripts</em> to launch a <em>doscmd/batch</em> file via <em>CMD</em> for Execution.</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\WScript.exe\&quot; \&quot;C:\\ProgramData\\IgHMwb34dcD\\STRTbbbn7przuvwav4hbpbps.vbs\&quot;</code><br><em>Process Created</em>: <br>- <code>C:\\Windows\\system32\\cmd.exe /c \&quot;\&quot;C:\\ProgramData\\IgHMwb34dcD\\AVDbbbn7i3b4ho55ck6raahj.bat\&quot; \&quot;</code></td><td>- Script available at VT <a href="https://www.virustotal.com/gui/file/91ce5c5b2e5b19258d79f4da4dc087058a67c657f586c6c17cb5bef93070479e/content" target="_blank" rel="noopener noreferrer">https://www.virustotal.com/gui/file/91ce5c5b2e5b19258d79f4da4dc087058a67c657f586c6c17cb5bef93070479e/content</a><br>- detection rate 2/58 (Oct 2nd 2021)<br>- Script available at VT <a href="https://www.virustotal.com/gui/file/684985d417bc480cc3da17a8bd2a081ccb67a2c3315ce18abcb7c7b8ea5f8d58" target="_blank" rel="noopener noreferrer">https://www.virustotal.com/gui/file/684985d417bc480cc3da17a8bd2a081ccb67a2c3315ce18abcb7c7b8ea5f8d58</a><br>- detection rate 6/57 (Oct 2nd 2021)</td></tr><tr><td>Defense Evasion</td><td>T1562.001<br>T1112</td><td>Threat actor used <em>doscmd/batch</em> files to disable Windows Defender via multiple <em>reg.exe</em> and <em>SCHTASKS.exe</em> for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>reg  add \&quot;HKLM\\Software\\Microsoft\\Windows Defender\\Features\&quot; /v \&quot;TamperProtection\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code><br>- <code>reg  delete \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /v \&quot;DisableAntiSpyware\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /v \&quot;DisableAntiVirus\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\&quot; /v \&quot;MpEnablePus\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableBehaviorMonitoring\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableIOAVProtection\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableOnAccessProtection\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableRealtimeMonitoring\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableScanOnRealtimeEnable\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\&quot; /v \&quot;DisableEnhancedNotifications\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v \&quot;DisableBlockAtFirstSeen\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v \&quot;SpynetReporting\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v \&quot;SubmitSamplesConsent\&quot; /t REG_DWORD /d \&quot;2\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderApiLogger\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderAuditLogger\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code><br><em>Process Created</em>: <br>- <code>schtasks  /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Cache Maintenance\&quot; /Disable</code><br>- <code>schtasks  /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Scheduled Scan\&quot; /Disable</code><br>- <code>schtasks  /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Verification\&quot; /Disable</code><br>- <code>schtasks  /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Cleanup\&quot; /Disable</code><br><em>Process Created</em>: <br>- <code>reg delete \&quot;HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run\&quot; /v \&quot;SecurityHealth\&quot; /f</code><br>- <code>reg delete \&quot;HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\&quot; /v \&quot;SecurityHealth\&quot; /f</code><br>- <code>reg delete \&quot;HKCR\\*\\shellex\\ContextMenuHandlers\\EPP\&quot; /f</code><br>- <code>reg delete \&quot;HKCR\\Directory\\shellex\\ContextMenuHandlers\\EPP\&quot; /f</code><br>- <code>reg delete \&quot;HKCR\\Drive\\shellex\\ContextMenuHandlers\\EPP\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WdBoot\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WdFilter\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WdNisSvc\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WinDefend\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code></td><td>- setting Start to 4 means disabling the service.</td></tr><tr><td>Defense Evasion</td><td>T1140<br>T1059.003</td><td>Threat actor used <em>AntiAV</em> (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>C:\\Windows\\system32\\cmd.exe /c \&quot;\&quot;C:\\ProgramData\\IgHMwb34dcD\\main.bat\&quot;</code><br><em>File Created</em>: <br>- <code>C:\\ProgramData\\IgHMwb34dcD\\door.exe</code></td><td>- Script available at VT <a href="https://www.virustotal.com/gui/file/a3d45f57d6b62b2d09c4dcca451bf06a0ef330664b796813841d7ea0934fcf06/content" target="_blank" rel="noopener noreferrer">https://www.virustotal.com/gui/file/a3d45f57d6b62b2d09c4dcca451bf06a0ef330664b796813841d7ea0934fcf06/content</a><br>- detection rate 0/58 (Oct 2nd 2021)<br>- main.bat is an obfuscator <a href="https://github.com/hXR16F/AntiAV/" target="_blank" rel="noopener noreferrer">https://github.com/hXR16F/AntiAV/</a>.<br>- door.exe is available at VT <a href="https://www.virustotal.com/gui/file/a1ff11c6e6e4aa54b60a2d44b6d2f05a48e6c617f0d89801a90ec56c29223b21" target="_blank" rel="noopener noreferrer">https://www.virustotal.com/gui/file/a1ff11c6e6e4aa54b60a2d44b6d2f05a48e6c617f0d89801a90ec56c29223b21</a><br>- first submited around the time of this sighting.<br>- current detection is 45/69 (oct 2nd 2021)</td></tr><tr><td>Execution</td><td>T1059.003</td><td>Threat actor used <em>CMD</em> to launch Raccoon InfoStealer for Execution.</td><td><em>Process Created</em>: <br>- <code>&quot;door.exe&quot;</code></td><td>- door.exe is the info stealer.</td></tr><tr><td>Command And Control</td><td>T1071.001<br>T1105</td><td>Malware used HTTP to download additional tools for Command And Control.</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\ProgramData\\IgHMwb34dcD\\door.exe&quot;</code><br><em>Network Accessed</em>: <code>195.201.225[.]248</code><br><em>Network Accessed</em>: <code>telete[.]in</code><br><em>Network Accessed</em>: <code>185.53.46[.]105</code><br><em>File Created</em>: <br>- <code>C\\Users\\#{user}\\AppData\\LocalLow\\sqlite3.dll</code></td><td>- Process image file is not signed.<br>- IP addresses correspond to the Russian Federation<br>- IP addresses correspond to Czech Republic and Republic of Moldova<br>- SQLite is a software library that implements a self-contained, serverless, zero-configuration, transactional SQL database engine.<br>- Threat Actors leverage SQLite to access the credential databases</td></tr><tr><td>Credential Access</td><td>T1555.003<br>T1106</td><td>Malware used <em>Native APIs</em> to access Chrome credentials store for Credential Access.</td><td><em>File Read</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code></td><td>- &quot;\User Data\Default\Login Data&quot; is a SQlite3 database that stores the credentials of the Default profile<br>- Values are encrypted using Microsoftï¿½s Data Protection API (DPAPI)<br>- DPAPI consists of 2 functions -&gt; CryptProtectData() and CryptUnprotectData() which symetrically encrypt/decrypt data.<br>- CryptUnprotectData function decrypts data using implicit crypto keys tied to a specific user or system.</td></tr><tr><td>Credential Access</td><td>T1555.003</td><td>Malware used <em>SQlite3</em> DLL to read Firefox credentials store for Credential Access.</td><td><em>File Modified</em>: <br>- <code>C:\Users\#{user}\AppData\Roaming\Mozilla\Firefox\Profiles\#{random}.default-release\cert9.db</code><br>- <code>C:\Users\#{user}\AppData\Roaming\Mozilla\Firefox\Profiles\#{random}.default-release\key4.db</code></td><td>- cert9.db is a SQLite database that stores security certificate settings and SSL certificates imported into Firefox.<br>- key4.db is a SQLite database that stores passwords.<br>- logins.json stores (encrypted) passwords<br>- as a previous step, SQlite3 dll was downloaded.</td></tr><tr><td>Collection</td><td>T1560</td><td>Malware used <em>unconfirmed method</em> to create a <em>.zip</em> file for Collection.</td><td><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\LocalLow\\bjZYHn4lcwr.zip</code></td><td>- it is not known to us, the method used to create the <em>zip</em> file.</td></tr><tr><td>Exfiltration</td><td>T1567.002</td><td>Malware used <em>cloud storage</em> for Exfiltration.</td><td><em>DNS Queried</em>: <code>cdn.discordapp[.]com</code></td><td>- Discord is a VoIP, instant messaging and digital distribution platform.<br>- DNS Query events are precursory indicators of network ativity.</td></tr><tr><td>Defense Evasion</td><td>T1070.004<br>T1059.003</td><td>Malware used <em>CMD delayed command execution</em> to delelete itself for Defense Evasion.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /C timeout /T 10 /NOBREAK &gt; Nul &amp; Del /f /q &quot;C:\\ProgramData\\IgHMwb34dcD\\door.exe&quot;</code><br>- <code>ping 1.1.1.1 -n 1 -w 3000 &gt; Nul &amp; Del /f /q &quot;C:\\ProgramData\\IgHMwb34dcD\\door.exe&quot;</code></td><td>- Via Timeout command a delay of 10 seconds is introduced.<br>- Via ping command a delay of 3000 miliseconds is introduced.<br>- Del is native cmd function for deleting files.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="ttp-profiles-with-observables"></a>TTP Profiles with Observables<a class="hash-link" href="#ttp-profiles-with-observables" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-search-engine-optimization-seo-poisoning-to-lure-users-for-initial-access"></a>Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access.<a class="hash-link" href="#threat-actor-used-search-engine-optimization-seo-poisoning-to-lure-users-for-initial-access" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic"></a>Tactic<a class="hash-link" href="#tactic" title="Direct link to heading">#</a></h4><ul><li>Initial Access</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques"></a>Techniques<a class="hash-link" href="#techniques" title="Direct link to heading">#</a></h4><ul><li>T1189 - Drive-by Compromise</li><li>T1105 - Ingress Tool Transfer</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1189</td><td>Chrome performs DNS Queries for suspicious domains (softwarebestever[.]fun, youtub[.]space).</td><td><em>DNS Queried</em>: <code>softwarebestever[.]fun</code><br><em>DNS Queried</em>: <code>youtub[.]space</code></td></tr><tr><td>T1105</td><td>Chrome drops <em>.rar</em> file.</td><td><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\Downloads\\StellarDataRecoveryProfessional.rar</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes"></a>Notes<a class="hash-link" href="#notes" title="Direct link to heading">#</a></h4><ul><li>Unknown if user was maliciously redirected to perform this download</li><li>StellarDataRecoveryProfessional.rar seems to be a cracked copy of Stellar Data Recovery Professional.</li><li>StellarDataRecoveryProfessional.rar file has no reputation at VT (Oct 2nd 2021)</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-compromised-installers-to-lure-users-for-execution"></a>Threat actor used compromised installers to lure users for Execution.<a class="hash-link" href="#threat-actor-used-compromised-installers-to-lure-users-for-execution" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-1"></a>Tactic<a class="hash-link" href="#tactic-1" title="Direct link to heading">#</a></h4><ul><li>Execution</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-1"></a>Techniques<a class="hash-link" href="#techniques-1" title="Direct link to heading">#</a></h4><ul><li>T1204.002 - User Execution: Malicious File</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-1"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-1" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1204.002</td><td>User opened malicious .rar file.</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Program Files (x86)\\IZArc\\IZArc.exe\&quot; -ef C:\\Users\\#{user}\\Downloads C:\\Users\\#{user}\\Downloads\\StellarDataRecoveryProfessional.rar</code></td></tr><tr><td>T1204.002</td><td>User executed compromissed installer.</td><td><em>Process Created</em>: <br>- <code>C:\\Users\\#{user}\\Downloads\\StellarDataRecoveryProfessional\\StellarDataRecoveryProfessional\\StellarDataRecovery-Professional.exe</code></td></tr><tr><td></td><td>Multiple files created at %ProgramData% (including 7zip binary, batch files and Visual Basic scripts)</td><td><em>File Created</em>: <br>- <code>C:\\ProgramData\\IgHMwb34dcD\\7z.exe</code><br>- <code>C:\\ProgramData\\IgHMwb34dcD\\main.bat</code><br>- <code>C:\\ProgramData\\IgHMwb34dcD\\STRTbbbn7przuvwav4hbpbps.vbs</code><br>- <code>C:\\ProgramData\\IgHMwb34dcD\\DELbbbn7l3bnchd166d2hhhv.bat</code><br>- <code>C:\\ProgramData\\IgHMwb34dcD\\AVDbbbn7i3b4ho55ck6raahj.bat</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-1"></a>Notes<a class="hash-link" href="#notes-1" title="Direct link to heading">#</a></h4><ul><li>main.bat is related to <a href="https://github.com/hXR16F/AntiAV/blob/master/AntiAV.bat" target="_blank" rel="noopener noreferrer">https://github.com/hXR16F/AntiAV/blob/master/AntiAV.bat</a>, and Anti AntiVirus project.</li><li>AntiAV obfuscates files using compression via 7zip</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-visual-basic-scripts-to-launch-a-doscmdbatch-file-via-cmd-for-execution"></a>Threat actor used <em>Visual Basic scripts</em> to launch a <em>doscmd/batch</em> file via <em>CMD</em> for Execution.<a class="hash-link" href="#threat-actor-used-visual-basic-scripts-to-launch-a-doscmdbatch-file-via-cmd-for-execution" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-2"></a>Tactic<a class="hash-link" href="#tactic-2" title="Direct link to heading">#</a></h4><ul><li>Execution</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-2"></a>Techniques<a class="hash-link" href="#techniques-2" title="Direct link to heading">#</a></h4><ul><li>T1059.005 - Command and Scripting Interpreter: Visual Basic</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-2"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-2" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.005</td><td>Malware ran a Visual Basic script to launch execution of a batch file via CMD.</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\Windows\\System32\\WScript.exe\&quot; \&quot;C:\\ProgramData\\IgHMwb34dcD\\STRTbbbn7przuvwav4hbpbps.vbs\&quot;</code></td></tr><tr><td>T1059.003</td><td>Malware executed a batch file via CMD.</td><td><em>Process Created</em>: <br>- <code>C:\\Windows\\system32\\cmd.exe /c \&quot;\&quot;C:\\ProgramData\\IgHMwb34dcD\\AVDbbbn7i3b4ho55ck6raahj.bat\&quot; \&quot;</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-2"></a>Notes<a class="hash-link" href="#notes-2" title="Direct link to heading">#</a></h4><ul><li>Script available at VT <a href="https://www.virustotal.com/gui/file/684985d417bc480cc3da17a8bd2a081ccb67a2c3315ce18abcb7c7b8ea5f8d58" target="_blank" rel="noopener noreferrer">https://www.virustotal.com/gui/file/684985d417bc480cc3da17a8bd2a081ccb67a2c3315ce18abcb7c7b8ea5f8d58</a></li><li>detection rate 6/57 (Oct 2nd 2021)</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-doscmdbatch-files-to-disable-windows-defender-via-multiple-regexe-and-schtasksexe-for-defense-evasion"></a>Threat actor used <em>doscmd/batch</em> files to disable Windows Defender via multiple <em>reg.exe</em> and <em>SCHTASKS.exe</em> for Defense Evasion.<a class="hash-link" href="#threat-actor-used-doscmdbatch-files-to-disable-windows-defender-via-multiple-regexe-and-schtasksexe-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-3"></a>Tactic<a class="hash-link" href="#tactic-3" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-3"></a>Techniques<a class="hash-link" href="#techniques-3" title="Direct link to heading">#</a></h4><ul><li>T1562.001 - Impair Defenses: Disable or Modify Tools</li><li>T1112 - Modify Registry</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-3"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-3" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1562.001<br>T1112</td><td>Malware launched <em>REG.exe</em> (attempted to modify Windows Defender <em>policy configurations</em>).</td><td><em>Process Created</em>: <br>- <code>reg  add \&quot;HKLM\\Software\\Microsoft\\Windows Defender\\Features\&quot; /v \&quot;TamperProtection\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code><br>- <code>reg  delete \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /v \&quot;DisableAntiSpyware\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\&quot; /v \&quot;DisableAntiVirus\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\&quot; /v \&quot;MpEnablePus\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableBehaviorMonitoring\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableIOAVProtection\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableOnAccessProtection\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableRealtimeMonitoring\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\&quot; /v \&quot;DisableScanOnRealtimeEnable\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\&quot; /v \&quot;DisableEnhancedNotifications\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v \&quot;DisableBlockAtFirstSeen\&quot; /t REG_DWORD /d \&quot;1\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v \&quot;SpynetReporting\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\&quot; /v \&quot;SubmitSamplesConsent\&quot; /t REG_DWORD /d \&quot;2\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderApiLogger\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code><br>- <code>reg  add \&quot;HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderAuditLogger\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;0\&quot; /f</code></td></tr><tr><td>T1562.001</td><td>Malware launched <em>SCHTASKS</em> (attempted to modify Windows Defender <em>scheduled tasks</em>)</td><td><em>Process Created</em>: <br>- <code>schtasks  /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Cache Maintenance\&quot; /Disable</code><br>- <code>schtasks  /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Scheduled Scan\&quot; /Disable</code><br>- <code>schtasks  /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Verification\&quot; /Disable</code><br>- <code>schtasks  /Change /TN \&quot;Microsoft\\Windows\\Windows Defender\\Windows Defender Cleanup\&quot; /Disable</code></td></tr><tr><td>T1562.001<br>T1112</td><td>Malware launched <em>REG.exe</em> (attempted to modify Windows Defender <em>services configuration</em>).</td><td><em>Process Created</em>: <br>- <code>reg delete \&quot;HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run\&quot; /v \&quot;SecurityHealth\&quot; /f</code><br>- <code>reg delete \&quot;HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\&quot; /v \&quot;SecurityHealth\&quot; /f</code><br>- <code>reg delete \&quot;HKCR\\*\\shellex\\ContextMenuHandlers\\EPP\&quot; /f</code><br>- <code>reg delete \&quot;HKCR\\Directory\\shellex\\ContextMenuHandlers\\EPP\&quot; /f</code><br>- <code>reg delete \&quot;HKCR\\Drive\\shellex\\ContextMenuHandlers\\EPP\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WdBoot\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WdFilter\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WdNisSvc\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code><br>- <code>reg add \&quot;HKLM\\System\\CurrentControlSet\\Services\\WinDefend\&quot; /v \&quot;Start\&quot; /t REG_DWORD /d \&quot;4\&quot; /f</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-3"></a>Notes<a class="hash-link" href="#notes-3" title="Direct link to heading">#</a></h4><ul><li>setting Start to 4 means disabling the service.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-antiav-an-open-source-tool-obfuscation-tool-to-obfuscate-malware-binary-file-for-defense-evasion"></a>Threat actor used <em>AntiAV</em> (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion.<a class="hash-link" href="#threat-actor-used-antiav-an-open-source-tool-obfuscation-tool-to-obfuscate-malware-binary-file-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-4"></a>Tactic<a class="hash-link" href="#tactic-4" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-4"></a>Techniques<a class="hash-link" href="#techniques-4" title="Direct link to heading">#</a></h4><ul><li>T1140 - Deobfuscate/Decode Files or Information</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-4"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-4" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1140<br>T1059.003</td><td>Malware executed open source deobfuscator tool (<a href="https://github.com/hXR16F/AntiAV/" target="_blank" rel="noopener noreferrer">https://github.com/hXR16F/AntiAV/</a>) via CMD.exe.</td><td><em>Process Created</em>: <br>- <code>C:\\Windows\\system32\\cmd.exe /c \&quot;\&quot;C:\\ProgramData\\IgHMwb34dcD\\main.bat\&quot;</code></td></tr><tr><td>T1140</td><td>Malware created Raccoon InfoStealer binary file at %ProgramData% folder.</td><td><em>File Created</em>: <br>- <code>C:\\ProgramData\\IgHMwb34dcD\\door.exe</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-4"></a>Notes<a class="hash-link" href="#notes-4" title="Direct link to heading">#</a></h4><ul><li>door.exe is available at VT <a href="https://www.virustotal.com/gui/file/a1ff11c6e6e4aa54b60a2d44b6d2f05a48e6c617f0d89801a90ec56c29223b21" target="_blank" rel="noopener noreferrer">https://www.virustotal.com/gui/file/a1ff11c6e6e4aa54b60a2d44b6d2f05a48e6c617f0d89801a90ec56c29223b21</a></li><li>first submited around the time of this sighting.</li><li>current detection is 45/69 (oct 2nd 2021)</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="threat-actor-used-cmd-to-launch-raccoon-infostealer-for-execution"></a>Threat actor used <em>CMD</em> to launch Raccoon InfoStealer for Execution.<a class="hash-link" href="#threat-actor-used-cmd-to-launch-raccoon-infostealer-for-execution" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-5"></a>Tactic<a class="hash-link" href="#tactic-5" title="Direct link to heading">#</a></h4><ul><li>Execution</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-5"></a>Techniques<a class="hash-link" href="#techniques-5" title="Direct link to heading">#</a></h4><ul><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-5"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-5" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1059.003</td><td>Raccoon InfoStealer was launched via <em>CMD</em>.</td><td><em>Process Created</em>: <br>- <code>&quot;door.exe&quot;</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-5"></a>Notes<a class="hash-link" href="#notes-5" title="Direct link to heading">#</a></h4><ul><li>door.exe is the info stealer.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="malware-used-http-to-download-additional-tools-for-command-and-control"></a>Malware used HTTP to download additional tools for Command And Control.<a class="hash-link" href="#malware-used-http-to-download-additional-tools-for-command-and-control" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-6"></a>Tactic<a class="hash-link" href="#tactic-6" title="Direct link to heading">#</a></h4><ul><li>Command And Control</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-6"></a>Techniques<a class="hash-link" href="#techniques-6" title="Direct link to heading">#</a></h4><ul><li>T1071.001 - Application Layer Protocol: Web Protocols</li><li>T1105 - Ingress Tool Transfer</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-6"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-6" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td></td><td>Raccoon malware executed by itself</td><td><em>Process Created</em>: <br>- <code>&quot;C:\\ProgramData\\IgHMwb34dcD\\door.exe&quot;</code></td></tr><tr><td>T1071.001</td><td>Raccoon InfoStealer connected to C2 server (telete[.]in:443).</td><td><em>Network Accessed</em>: <code>195.201.225[.]248</code><br><em>Network Accessed</em>: <code>telete[.]in</code></td></tr><tr><td>T1071.001</td><td>Raccoon InfoStealer connected to C2 server (port IP:80).</td><td><em>Network Accessed</em>: <code>185.53.46[.]105</code></td></tr><tr><td>T1105</td><td>Raccoon InfoStealer downloaded a copy of sqlite3.dll from C2 server</td><td><em>File Created</em>: <br>- <code>C\\Users\\#{user}\\AppData\\LocalLow\\sqlite3.dll</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-6"></a>Notes<a class="hash-link" href="#notes-6" title="Direct link to heading">#</a></h4><ul><li>SQLite is a software library that implements a self-contained, serverless, zero-configuration, transactional SQL database engine.</li><li>Threat Actors leverage SQLite to access the credential databases</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="malware-used-native-apis-to-access-chrome-credentials-store-for-credential-access"></a>Malware used <em>Native APIs</em> to access Chrome credentials store for Credential Access.<a class="hash-link" href="#malware-used-native-apis-to-access-chrome-credentials-store-for-credential-access" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-7"></a>Tactic<a class="hash-link" href="#tactic-7" title="Direct link to heading">#</a></h4><ul><li>Credential Access</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-7"></a>Techniques<a class="hash-link" href="#techniques-7" title="Direct link to heading">#</a></h4><ul><li>T1555.003 - Credentials from Password Stores: Credentials from Web Browsers</li><li>T1106 - Native API</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-7"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-7" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1555.003</td><td>Raccoon InfoStealer reads Chrome credentials store</td><td><em>File Read</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code></td></tr><tr><td>T1555.003<br>T1106</td><td>Raccoon InfoStealer calls CryptUnprotectData API.</td><td></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-7"></a>Notes<a class="hash-link" href="#notes-7" title="Direct link to heading">#</a></h4><ul><li>CryptUnprotectData function decrypts data using implicit crypto keys tied to a specific user or system.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="malware-used-sqlite3-dll-to-read-firefox-credentials-store-for-credential-access"></a>Malware used <em>SQlite3</em> DLL to read Firefox credentials store for Credential Access.<a class="hash-link" href="#malware-used-sqlite3-dll-to-read-firefox-credentials-store-for-credential-access" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-8"></a>Tactic<a class="hash-link" href="#tactic-8" title="Direct link to heading">#</a></h4><ul><li>Credential Access</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-8"></a>Techniques<a class="hash-link" href="#techniques-8" title="Direct link to heading">#</a></h4><ul><li>T1555.003 - Credentials from Password Stores: Credentials from Web Browsers</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-8"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-8" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1555.003</td><td>Raccoon InfoStealer accessed Firefox credential store.</td><td><em>File Modified</em>: <br>- <code>C:\Users\#{user}\AppData\Roaming\Mozilla\Firefox\Profiles\#{random}.default-release\cert9.db</code><br>- <code>C:\Users\#{user}\AppData\Roaming\Mozilla\Firefox\Profiles\#{random}.default-release\key4.db</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-8"></a>Notes<a class="hash-link" href="#notes-8" title="Direct link to heading">#</a></h4><ul><li>cert9.db is a SQLite database that stores security certificate settings and SSL certificates imported into Firefox.</li><li>key4.db is a SQLite database that stores passwords.</li><li>logins.json stores (encrypted) passwords</li><li>as a previous step, SQlite3 dll was downloaded.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="malware-used-unconfirmed-method-to-create-a-zip-file-for-collection"></a>Malware used <em>unconfirmed method</em> to create a <em>.zip</em> file for Collection.<a class="hash-link" href="#malware-used-unconfirmed-method-to-create-a-zip-file-for-collection" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-9"></a>Tactic<a class="hash-link" href="#tactic-9" title="Direct link to heading">#</a></h4><ul><li>Collection</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-9"></a>Techniques<a class="hash-link" href="#techniques-9" title="Direct link to heading">#</a></h4><ul><li>T1560 - Archive Collected Data</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-9"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-9" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1560</td><td>Raccoon InfoStealer created a zip file</td><td><em>File Created</em>: <br>- <code>C:\\Users\\#{user}\\AppData\\LocalLow\\bjZYHn4lcwr.zip</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-9"></a>Notes<a class="hash-link" href="#notes-9" title="Direct link to heading">#</a></h4><ul><li>it is not known to us, the method used to create the <em>zip</em> file.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="malware-used-cloud-storage-for-exfiltration"></a>Malware used <em>cloud storage</em> for Exfiltration.<a class="hash-link" href="#malware-used-cloud-storage-for-exfiltration" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-10"></a>Tactic<a class="hash-link" href="#tactic-10" title="Direct link to heading">#</a></h4><ul><li>Exfiltration</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-10"></a>Techniques<a class="hash-link" href="#techniques-10" title="Direct link to heading">#</a></h4><ul><li>T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-10"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-10" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1567.002</td><td>Raccoon performed DNS Queries to cdn.discordapp[.]com.</td><td><em>DNS Queried</em>: <code>cdn.discordapp[.]com</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-10"></a>Notes<a class="hash-link" href="#notes-10" title="Direct link to heading">#</a></h4><ul><li>Discord is a VoIP, instant messaging and digital distribution platform.</li><li>DNS Query events are precursory indicators of network ativity.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="malware-used-cmd-delayed-command-execution-to-delelete-itself-for-defense-evasion"></a>Malware used <em>CMD delayed command execution</em> to delelete itself for Defense Evasion.<a class="hash-link" href="#malware-used-cmd-delayed-command-execution-to-delelete-itself-for-defense-evasion" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="tactic-11"></a>Tactic<a class="hash-link" href="#tactic-11" title="Direct link to heading">#</a></h4><ul><li>Defense Evasion</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="techniques-11"></a>Techniques<a class="hash-link" href="#techniques-11" title="Direct link to heading">#</a></h4><ul><li>T1070.004 - Indicator Removal on Host: File Deletion</li><li>T1059.003 - Command and Scripting Interpreter: Windows Command Shell</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="behaviors-and-observables-11"></a>Behaviors and Observables<a class="hash-link" href="#behaviors-and-observables-11" title="Direct link to heading">#</a></h4><table><thead><tr><th>Tech IDs</th><th>Behaviors</th><th>Observables</th></tr></thead><tbody><tr><td>T1070.004<br>T1059.003</td><td>Raccoon InfoStealer introduced a delayed command execution via CMD to delete itself.</td><td><em>Process Created</em>: <br>- <code>cmd.exe /C timeout /T 10 /NOBREAK &gt; Nul &amp; Del /f /q &quot;C:\\ProgramData\\IgHMwb34dcD\\door.exe&quot;</code><br>- <code>ping 1.1.1.1 -n 1 -w 3000 &gt; Nul &amp; Del /f /q &quot;C:\\ProgramData\\IgHMwb34dcD\\door.exe&quot;</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="notes-11"></a>Notes<a class="hash-link" href="#notes-11" title="Direct link to heading">#</a></h4><ul><li>Via Timeout command a delay of 10 seconds is introduced.</li><li>Via ping command a delay of 3000 miliseconds is introduced.</li><li>Del is native cmd function for deleting files.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Jupyter_InfoStealer</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/Guildma_RAT"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Guildma_RAT Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a><ul><li><a href="#references" class="table-of-contents__link">References:</a></li><li><a href="#threat-actor-activity" class="table-of-contents__link">Threat Actor Activity</a></li><li><a href="#count-of-documented-ttps-by-tactic" class="table-of-contents__link">Count of documented TTPs by Tactic</a></li><li><a href="#attack-flow" class="table-of-contents__link">Attack Flow</a></li></ul></li><li><a href="#tactics-techniques-and-procedures" class="table-of-contents__link">Tactics, Techniques and Procedures</a></li><li><a href="#tactics-techniques-procedures-observables-and-notes" class="table-of-contents__link">Tactics, Techniques, Procedures, Observables and Notes</a></li><li><a href="#ttp-profiles-with-observables" class="table-of-contents__link">TTP Profiles with Observables</a><ul><li><a href="#threat-actor-used-search-engine-optimization-seo-poisoning-to-lure-users-for-initial-access" class="table-of-contents__link">Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access.</a></li><li><a href="#threat-actor-used-compromised-installers-to-lure-users-for-execution" class="table-of-contents__link">Threat actor used compromised installers to lure users for Execution.</a></li><li><a href="#threat-actor-used-visual-basic-scripts-to-launch-a-doscmdbatch-file-via-cmd-for-execution" class="table-of-contents__link">Threat actor used <em>Visual Basic scripts</em> to launch a <em>doscmd/batch</em> file via <em>CMD</em> for Execution.</a></li><li><a href="#threat-actor-used-doscmdbatch-files-to-disable-windows-defender-via-multiple-regexe-and-schtasksexe-for-defense-evasion" class="table-of-contents__link">Threat actor used <em>doscmd/batch</em> files to disable Windows Defender via multiple <em>reg.exe</em> and <em>SCHTASKS.exe</em> for Defense Evasion.</a></li><li><a href="#threat-actor-used-antiav-an-open-source-tool-obfuscation-tool-to-obfuscate-malware-binary-file-for-defense-evasion" class="table-of-contents__link">Threat actor used <em>AntiAV</em> (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion.</a></li><li><a href="#threat-actor-used-cmd-to-launch-raccoon-infostealer-for-execution" class="table-of-contents__link">Threat actor used <em>CMD</em> to launch Raccoon InfoStealer for Execution.</a></li><li><a href="#malware-used-http-to-download-additional-tools-for-command-and-control" class="table-of-contents__link">Malware used HTTP to download additional tools for Command And Control.</a></li><li><a href="#malware-used-native-apis-to-access-chrome-credentials-store-for-credential-access" class="table-of-contents__link">Malware used <em>Native APIs</em> to access Chrome credentials store for Credential Access.</a></li><li><a href="#malware-used-sqlite3-dll-to-read-firefox-credentials-store-for-credential-access" class="table-of-contents__link">Malware used <em>SQlite3</em> DLL to read Firefox credentials store for Credential Access.</a></li><li><a href="#malware-used-unconfirmed-method-to-create-a-zip-file-for-collection" class="table-of-contents__link">Malware used <em>unconfirmed method</em> to create a <em>.zip</em> file for Collection.</a></li><li><a href="#malware-used-cloud-storage-for-exfiltration" class="table-of-contents__link">Malware used <em>cloud storage</em> for Exfiltration.</a></li><li><a href="#malware-used-cmd-delayed-command-execution-to-delelete-itself-for-defense-evasion" class="table-of-contents__link">Malware used <em>CMD delayed command execution</em> to delelete itself for Defense Evasion.</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/ac3-threat-sightings/assets/js/runtime~main.5b7811bf.js"></script>
<script src="/ac3-threat-sightings/assets/js/main.6c42f5d6.js"></script>
</body>
</html>