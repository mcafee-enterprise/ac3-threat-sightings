<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Validating your schema | AC3 - Threat Sightings</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Getting Started/Validating your schema"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Validating your schema | AC3 - Threat Sightings"><meta data-react-helmet="true" name="description" content="Once you have developed your first threat sighting, it is important validate the format to ensure that you did not a mistake. For that purpose, we have developed a `pythonÂ´ script to validate the information."><meta data-react-helmet="true" property="og:description" content="Once you have developed your first threat sighting, it is important validate the format to ensure that you did not a mistake. For that purpose, we have developed a `pythonÂ´ script to validate the information."><link data-react-helmet="true" rel="shortcut icon" href="/ac3-threat-sightings/img/ma-favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Getting Started/Validating your schema"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Getting Started/Validating your schema" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mcafee-enterprise.github.io/ac3-threat-sightings/docs/Getting Started/Validating your schema" hreflang="x-default"><link rel="stylesheet" href="/ac3-threat-sightings/assets/css/styles.9f78bae8.css">
<link rel="preload" href="/ac3-threat-sightings/assets/js/runtime~main.da40af01.js" as="script">
<link rel="preload" href="/ac3-threat-sightings/assets/js/main.563c3602.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ac3-threat-sightings/"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/ac3-threat-sightings/img/ac3.gif" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">AC3 Threat Sightings</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ac3-threat-sightings/docs/Welcome">Home</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Welcome">AC3 Threat Sightings</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Getting Started/Contributing">How to contribute</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Getting Started/Schema">Schema Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ac3-threat-sightings/docs/Getting Started/Creating your first Sighting">Creating your first sighting</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ac3-threat-sightings/docs/Getting Started/Validating your schema">Validating your schema</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Sightings</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Weapons</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Techniques</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ac3-threat-sightings/docs/Stats">Stats</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Validating your schema</h1></header><p>Once you have developed your first threat sighting, it is important validate the format to ensure that you did not a mistake. For that purpose, we have developed a `pythonÂ´ script to validate the information.</p><p>You can find the script in our public github: <a href="https://github.com/mcafee-enterprise/ac3-threat-sightings/tree/main/tools/sighting%20validator" target="_blank" rel="noopener noreferrer">https://github.com/mcafee-enterprise/ac3-threat-sightings/tree/main/tools/sighting%20validator</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="threat-sighting-validator"></a>Threat Sighting validator<a class="hash-link" href="#threat-sighting-validator" title="Direct link to heading">#</a></h2><p>This script allows you to validate the schema of your threat sighting. when you are working on creating a threat sighting, there may be errors during the creation. Therefore, this script allows the user to validate if all the mandatory fields are defined and which ones that are not supported were entered.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="installation"></a>Installation<a class="hash-link" href="#installation" title="Direct link to heading">#</a></h2><p>Python3 is needed to run this script.</p><p>To install the dependencies run the following command.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip install -r requirements.txt</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>Note</strong>: We recommend the use of virtualenv to install the dependencies. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="usage"></a>Usage<a class="hash-link" href="#usage" title="Direct link to heading">#</a></h2><p>After installing all the dependencies, the use of the script is simple.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; python sightingValidator.py -h</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">usage: sightingValidator.py [-h] [-f INPUT_FILE]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Threat Sightings Validator - This script allows you to validate if your threat sighting has a correct structure or not.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">options:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -h, --help            show this help message and exit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -f INPUT_FILE, --file INPUT_FILE</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        YAML File that you want verify the schema</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="validating-a-threat-sighting"></a>Validating a threat sighting<a class="hash-link" href="#validating-a-threat-sighting" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="without-errors"></a>Without errors<a class="hash-link" href="#without-errors" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; python sightingValidator.py -f sighting_Guildma.yml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+-------+-----+----------+</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| GUID | Error | Key | Sighting |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+-------+-----+----------+</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+-------+-----+----------+</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="unexpected-element"></a>Unexpected element<a class="hash-link" href="#unexpected-element" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; python sightingValidator.py -f sighting_Guildma.yml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+---------------------+----------------------------------------+------------------------------+</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| GUID |        Error        |                  Key                   |           Sighting           |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+---------------------+----------------------------------------+------------------------------+</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">|  -   |  Unexpected element | threatSightings.0.behaviors.1.proceses | .\sighting_Guildma.yml       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+---------------------+----------------------------------------+------------------------------+</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>An error occurred in the first <code>sighting</code> key (position 0), and the second <code>behavior</code> key (position 1) with a field called <code>proceses</code> which doesn&#x27;t exists in the schema. In this case, the correct form is <code>processes</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="duplicate-uuid"></a>Duplicate uuid<a class="hash-link" href="#duplicate-uuid" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; python sightingValidator.py -f sighting_Guildma.yml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+----------------+--------------------------------------+------------------------------+</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| GUID |     Error      |                 Key                  |           Sighting           |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+----------------+--------------------------------------+------------------------------+</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">|  -   | Duplicate uuid | 97f41fab-22c2-4b0c-8e47-d1aeee9f1e0e | .\sighting_Guildma.yml       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+----------------+--------------------------------------+------------------------------+</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Duplicate uuid found in threat sighting</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="incorrect-behaviorid-in-hunting-section"></a>Incorrect behaviorId in hunting section<a class="hash-link" href="#incorrect-behaviorid-in-hunting-section" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; python sightingValidator.py -f sighting_Guildma.yml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+--------------------------------------------------------------------+--------------------------------------+------------------------------+</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| GUID |                               Error                                |                 Key                  |           Sighting           |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+--------------------------------------------------------------------+--------------------------------------+------------------------------+</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">|  -   | BehaviorId in huntingQuery that does not exist in behavior section | 97f4sfab-22c2-4b0c-8e47-d1aeee9f1e0e | .\sighting_Guildma.yml       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+------+--------------------------------------------------------------------+--------------------------------------+------------------------------+</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A behaviorId in <code>threatHunting</code> section was found and wasn&#x27;t declared in the threat sighting file on behaviors section.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Getting Started/Creating your first Sighting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Creating your first sighting</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ac3-threat-sightings/docs/Sightings/Darkside_Ransomware"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Darkside_Ransomware Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#threat-sighting-validator" class="table-of-contents__link">Threat Sighting validator</a></li><li><a href="#installation" class="table-of-contents__link">Installation</a></li><li><a href="#usage" class="table-of-contents__link">Usage</a><ul><li><a href="#validating-a-threat-sighting" class="table-of-contents__link">Validating a threat sighting</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/ac3-threat-sightings/assets/js/runtime~main.da40af01.js"></script>
<script src="/ac3-threat-sightings/assets/js/main.563c3602.js"></script>
</body>
</html>