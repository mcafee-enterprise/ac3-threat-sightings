"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[6037],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},8444:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return o},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return u},default:function(){return p}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=a(3248),d=["components"],o={},s=void 0,m={unversionedId:"Sightings/WhisperGate",id:"Sightings/WhisperGate",isDocsHomePage:!1,title:"WhisperGate",description:"Overview",source:"@site/docs/03-Sightings/13-WhisperGate.md",sourceDirName:"03-Sightings",slug:"/Sightings/WhisperGate",permalink:"/ac3-threat-sightings/docs/Sightings/WhisperGate",tags:[],version:"current",sidebarPosition:13,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"HermeticWiper",permalink:"/ac3-threat-sightings/docs/Sightings/HermeticWiper"},next:{title:"Hafnium",permalink:"/ac3-threat-sightings/docs/Sightings/Hafnium"}},u=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat Actor used <em>Impacket</em> to execute <em>Stage1</em> <em>.EXE</em> file via WMI and CMD for Execution.",id:"threat-actor-used-impacket-to-execute-stage1-exe-file-via-wmi-and-cmd-for-execution",children:[]},{value:"Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence.",id:"threat-actor-used-direct-volume-access-to-install-a-malicious-mbr-bootkit-for-persistence",children:[]},{value:"Threat Actor used <em>MBR bootkit</em> to destroy disk data and display ransom note for Impact.",id:"threat-actor-used-mbr-bootkit-to-destroy-disk-data-and-display-ransom-note-for-impact",children:[]},{value:"Threat Actor used malware <em>.EXE</em> file to download additional artifacts from <em>Discord CDN</em> for Command And Control.",id:"threat-actor-used-malware-exe-file-to-download-additional-artifacts-from-discord-cdn-for-command-and-control",children:[]},{value:"Threat Actor used obfuscated <em>.EXE</em> files for Defense Evasion.",id:"threat-actor-used-obfuscated-exe-files-for-defense-evasion",children:[]},{value:"Stage3 malware used <em>AdvancedRun.exe</em> via VBScript and PowerShell do disable Windows Defender for Defense Evasion.",id:"stage3-malware-used-advancedrunexe-via-vbscript-and-powershell-do-disable-windows-defender-for-defense-evasion",children:[]},{value:"Threat Actor used <em>process injection on _InstallUtil</em> to launch the destructive routines for Impact.",id:"threat-actor-used-process-injection-on-_installutil-to-launch-the-destructive-routines-for-impact",children:[]},{value:"Malware used <em>CMD del</em> command to delete itself for Defense Evasion.",id:"malware-used-cmd-del-command-to-delete-itself-for-defense-evasion",children:[]}]}],c={toc:u};function p(e){var t=e.components,a=(0,r.Z)(e,d);return(0,l.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"This Threat Sighting documents observed TTPs for a data destructive malware tracked as WhisperGate. This Threat Sighting is based on information made public by different research teams. At this point, there are no deteails about the TTPs for Initial Access. Other pieces of the attack chain are unclear or partially documented."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_WhisperGate.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_WhisperGate.yml")),(0,l.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("p",null,"Acknowledgements: @MSFTSecurity, @S2W_Official, @elastic, @TrellixLabs"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/"},"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3"},"https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://securityboulevard.com/2022/01/ttps-used-by-dev-0586-apt-group-in-whispergate-attack-targeting-ukraine/"},"https://securityboulevard.com/2022/01/ttps-used-by-dev-0586-apt-group-in-whispergate-attack-targeting-ukraine/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://elastic.github.io/security-research/malware/2022/01/01.operation-bleeding-bear/article/"},"https://elastic.github.io/security-research/malware/2022/01/01.operation-bleeding-bear/article/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://limbenjamin.com/articles/overwriting-mbr.html"},"https://limbenjamin.com/articles/overwriting-mbr.html")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.zscaler.com/blogs/security-research/discord-cdn-popular-choice-hosting-malicious-payloads"},"https://www.zscaler.com/blogs/security-research/discord-cdn-popular-choice-hosting-malicious-payloads")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.trellix.com/en-us/about/newsroom/stories/threat-labs/return-of-pseudo-ransomware.html"},"https://www.trellix.com/en-us/about/newsroom/stories/threat-labs/return-of-pseudo-ransomware.html")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://attack.mitre.org/techniques/T1542/003/"},"https://attack.mitre.org/techniques/T1542/003/"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Impacket")," to execute ",(0,l.kt)("em",{parentName:"li"},"Stage1")," ",(0,l.kt)("em",{parentName:"li"},".EXE")," file via WMI and CMD for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"MBR bootkit")," to destroy disk data and display ransom note for Impact."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used malware ",(0,l.kt)("em",{parentName:"li"},".EXE")," file to download additional artifacts from ",(0,l.kt)("em",{parentName:"li"},"Discord CDN")," for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used obfuscated ",(0,l.kt)("em",{parentName:"li"},".EXE")," files for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Stage3 malware used ",(0,l.kt)("em",{parentName:"li"},"AdvancedRun.exe")," via VBScript and PowerShell do disable Windows Defender for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"process injection on _InstallUtil")," to launch the destructive routines for Impact."),(0,l.kt)("li",{parentName:"ul"},"Malware used ",(0,l.kt)("em",{parentName:"li"},"CMD del")," command to delete itself for Defense Evasion.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(i.Z,{chart:"\ngraph LR\nEXE[Execution] --\x3e | _Impacket_ to execute _Stage1_ _.EXE_ file via WMI and CMD| EXE[Execution]\nEXE[Execution] --\x3e | direct volume access to install a malicious MBR bootkit| PER[Persistence]\nPER[Persistence] --\x3e | _MBR bootkit_ to destroy disk data and display ransom note| IMP[Impact]\nEXE[Execution] --\x3e | malware _.EXE_ file to download additional artifacts from _Discord CDN_| C2[Command And Control]\nEXE[Execution] --\x3e | obfuscated _.EXE_ files| DE[Defense Evasion]\nEXE[Execution] --\x3e | _AdvancedRun.exe_ via VBScript and PowerShell do disable Windows Defender| DE[Defense Evasion]\nEXE[Execution] --\x3e | _process injection on _InstallUtil_ to launch the destructive routines| IMP[Impact]\nEXE[Execution] --\x3e | _CMD del_ command to delete itself| DE[Defense Evasion]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047 - Windows Management Instrumentation",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Impacket")," to execute ",(0,l.kt)("em",{parentName:"td"},"Stage1")," ",(0,l.kt)("em",{parentName:"td"},".EXE")," file via WMI and CMD for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1006 - Direct Volume Access",(0,l.kt)("br",null),"T1542.003 - Pre-OS Boot: Bootkit"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1491.001 - Defacement: Internal Defacement",(0,l.kt)("br",null),"T1561 - Disk Wipe"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MBR bootkit")," to destroy disk data and display ransom note for Impact.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1553.002 - Subvert Trust Controls: Code Signing",(0,l.kt)("br",null),"T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion",(0,l.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer",(0,l.kt)("br",null),"T1102 - Web Service",(0,l.kt)("br",null),"T1036 - Masquerading"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malware ",(0,l.kt)("em",{parentName:"td"},".EXE")," file to download additional artifacts from ",(0,l.kt)("em",{parentName:"td"},"Discord CDN")," for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105 - Ingress Tool Transfer",(0,l.kt)("br",null),"T1027 - Obfuscated Files or Information"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used obfuscated ",(0,l.kt)("em",{parentName:"td"},".EXE")," files for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.005 - Command and Scripting Interpreter: Visual Basic",(0,l.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,l.kt)("br",null),"T1562.001 - Impair Defenses: Disable or Modify Tools"),(0,l.kt)("td",{parentName:"tr",align:null},"Stage3 malware used ",(0,l.kt)("em",{parentName:"td"},"AdvancedRun.exe")," via VBScript and PowerShell do disable Windows Defender for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1055 - Process Injection",(0,l.kt)("br",null),"T1561 - Disk Wipe"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"process injection on _InstallUtil")," to launch the destructive routines for Impact.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion",(0,l.kt)("br",null),"T1070.004 - Indicator Removal on Host: File Deletion"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"CMD del")," command to delete itself for Defense Evasion.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Impacket")," to execute ",(0,l.kt)("em",{parentName:"td"},"Stage1")," ",(0,l.kt)("em",{parentName:"td"},".EXE")," file via WMI and CMD for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c start c:\\\\stage1.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c start c:\\\\stage1.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"stage1.exe")),(0,l.kt)("td",{parentName:"tr",align:null},"- Wmiprvse.exe is the executable file for the Windows Management Instrumentation Provider Service.",(0,l.kt)("br",null),"- This might indicate remote code execution",(0,l.kt)("br",null),"- Patterns in the command-line arguments and process geno resemble to Impacket .",(0,l.kt)("br",null),"- Impacket is an open source collection of modules written in Python for programmatically constructing and manipulating network protocols.",(0,l.kt)("br",null),"- Impacket contains several tools for remote service execution, Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1006",(0,l.kt)("br",null),"T1542.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"API Invoked"),": ",(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"API Invoked"),": n/d"),(0,l.kt)("td",{parentName:"tr",align:null},'- CreateFileW(L"',"\\","\\",".","\\",'PhysicalDrive0"...',(0,l.kt)("br",null),"- WriteFile is executed with offset 0, to overwrite the 1st sector of the drive (the MBR).",(0,l.kt)("br",null),"- This will divert the execution during startup from the normal boot loader to adversary code.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1491.001",(0,l.kt)("br",null),"T1561"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MBR bootkit")," to destroy disk data and display ransom note for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d")),(0,l.kt)("td",{parentName:"tr",align:null},"- The MBR bootkit (OS Pre-boot), written in assembler, will traverse all drives corrupting disks data and will show ransom note.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1553.002",(0,l.kt)("br",null),"T1497.003",(0,l.kt)("br",null),"T1059.001",(0,l.kt)("br",null),"T1105",(0,l.kt)("br",null),"T1102",(0,l.kt)("br",null),"T1036"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malware ",(0,l.kt)("em",{parentName:"td"},".EXE")," file to download additional artifacts from ",(0,l.kt)("em",{parentName:"td"},"Discord CDN")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell -enc UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA=="),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"cdn.discordapp[.]com"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\Tbopbh.jpg")),(0,l.kt)("td",{parentName:"tr",align:null},"- details about mechanism used to execute this process is unknown for us at this time.",(0,l.kt)("br",null),"- the fake signature refers to a Microsoft Windows component.",(0,l.kt)("br",null),"- base64 encoded command decodes to 'Start-Sleep -s 10'",(0,l.kt)("br",null),"- command is executed twice",(0,l.kt)("br",null),"- Multiple threat actors are using Discord CDN to host malware")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105",(0,l.kt)("br",null),"T1027"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used obfuscated ",(0,l.kt)("em",{parentName:"td"},".EXE")," files for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Waqybg"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Nmddfrqqrbyjeygggda.vbs")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.005",(0,l.kt)("br",null),"T1059.001",(0,l.kt)("br",null),"T1562.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Stage3 malware used ",(0,l.kt)("em",{parentName:"td"},"AdvancedRun.exe")," via VBScript and PowerShell do disable Windows Defender for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\System32\\\\WScript.exe\\" \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Nmddfrqqrbyjeygggda.vbs\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell.exe Set-MpPreference -ExclusionPath \\'C:\\\\\\'"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell.exe Set-MpPreference -ExclusionPath \\'C:\\\\\\'"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe\\" /EXEFilename \\"C:\\\\Windows\\\\System32\\\\sc.exe\\" /WindowState 0 /CommandLine \\"stop WinDefend\\" /StartDirectory \\"\\" /RunAs 8 /Run'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe\\" /EXEFilename \\"C:\\\\Windows\\\\System32\\\\sc.exe\\" /WindowState 0 /CommandLine \\"stop WinDefend\\" /StartDirectory \\"\\" /RunAs 8 /Run'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe\\" /EXEFilename \\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\" /WindowState 0 /CommandLine \\"rmdir \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\" -Recurse\\" /StartDirectory \\"\\" /RunAs 8 /Run'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe\\" /EXEFilename \\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\" /WindowState 0 /CommandLine \\"rmdir \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\" -Recurse\\" /StartDirectory \\"\\" /RunAs 8 /Run')),(0,l.kt)("td",{parentName:"tr",align:null},"- Nirsofts ",(0,l.kt)("em",{parentName:"td"},"AdvancedRun.exe")," allows to run a Windows program with different settings.",(0,l.kt)("br",null),"- Nirsofts ",(0,l.kt)("em",{parentName:"td"},"AdvancedRun.exe")," allows to run a Windows program with different settings.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1055",(0,l.kt)("br",null),"T1561"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"process injection on _InstallUtil")," to launch the destructive routines for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"InstallUtil.exe")),(0,l.kt)("td",{parentName:"tr",align:null},"- At this time, only Elastic reports on this TTP and no further details are available.",(0,l.kt)("br",null),"- InstallUtil.exe is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1497.003",(0,l.kt)("br",null),"T1070.004"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"CMD del")," command to delete itself for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 > Nul & Del /f /q #{process}"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 > Nul & Del /f /q #{process}")),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"threat-actor-used-impacket-to-execute-stage1-exe-file-via-wmi-and-cmd-for-execution"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Impacket")," to execute ",(0,l.kt)("em",{parentName:"h3"},"Stage1")," ",(0,l.kt)("em",{parentName:"h3"},".EXE")," file via WMI and CMD for Execution."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},"Windows Command Shell spawned by Windows Management Instrumentation Provider Service (WMIPRVSE)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c start c:\\\\stage1.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Suspicious command executed via Windows Command Shell."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c start c:\\\\stage1.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Stage1 malware")," is executed via Windows Command Shell."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"stage1.exe"))))),(0,l.kt)("h3",{id:"threat-actor-used-direct-volume-access-to-install-a-malicious-mbr-bootkit-for-persistence"},"Threat Actor used direct volume access to install a malicious MBR bootkit for Persistence."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1006 - Direct Volume Access"),(0,l.kt)("li",{parentName:"ul"},"T1542.003 - Pre-OS Boot: Bootkit")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1006"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Stage1 malware")," opens a write handle to the physical device using the CreateFile API."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"API Invoked"),": ",(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"API Invoked"),": n/d")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1542.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Stage1 malware")," overwrote MBR (Master Boot Record) using WriteFile API."),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"WriteFile is executed with offset 0, to overwrite the 1st sector of the drive (the MBR)."),(0,l.kt)("li",{parentName:"ul"},"This will divert the execution during startup from the normal boot loader to adversary code.")),(0,l.kt)("h3",{id:"threat-actor-used-mbr-bootkit-to-destroy-disk-data-and-display-ransom-note-for-impact"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"MBR bootkit")," to destroy disk data and display ransom note for Impact."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1491.001 - Defacement: Internal Defacement"),(0,l.kt)("li",{parentName:"ul"},"T1561 - Disk Wipe")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1491.001",(0,l.kt)("br",null),"T1561"),(0,l.kt)("td",{parentName:"tr",align:null},"MBR bootkit destroyed disk data and displayed ransom note."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"))))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The MBR bootkit (OS Pre-boot), written in assembler, will traverse all drives corrupting disks data and will show ransom note.")),(0,l.kt)("h3",{id:"threat-actor-used-malware-exe-file-to-download-additional-artifacts-from-discord-cdn-for-command-and-control"},"Threat Actor used malware ",(0,l.kt)("em",{parentName:"h3"},".EXE")," file to download additional artifacts from ",(0,l.kt)("em",{parentName:"h3"},"Discord CDN")," for Command And Control."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1553.002 - Subvert Trust Controls: Code Signing"),(0,l.kt)("li",{parentName:"ul"},"T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion"),(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer"),(0,l.kt)("li",{parentName:"ul"},"T1102 - Web Service"),(0,l.kt)("li",{parentName:"ul"},"T1036 - Masquerading")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1553.002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Stage2 malware")," binary is signed with fake signature."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1497.003",(0,l.kt)("br",null),"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Stage2 malware")," delayed execution for 20 seconds via ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," Sleep commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell -enc UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA=="))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105",(0,l.kt)("br",null),"T1102"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Stage2 malware")," reached out Discord CDN to fetch Stage3 malware."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"cdn.discordapp[.]com"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1036"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Stage2 malware")," dropped ",(0,l.kt)("em",{parentName:"td"},"Stage3 malware")," disquised as a .JPG file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\Tbopbh.jpg"))))),(0,l.kt)("h3",{id:"threat-actor-used-obfuscated-exe-files-for-defense-evasion"},"Threat Actor used obfuscated ",(0,l.kt)("em",{parentName:"h3"},".EXE")," files for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer"),(0,l.kt)("li",{parentName:"ul"},"T1027 - Obfuscated Files or Information")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105",(0,l.kt)("br",null),"T1027"),(0,l.kt)("td",{parentName:"tr",align:null},"Additional files extracted out of Stage3."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Waqybg"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Nmddfrqqrbyjeygggda.vbs"))))),(0,l.kt)("h3",{id:"stage3-malware-used-advancedrunexe-via-vbscript-and-powershell-do-disable-windows-defender-for-defense-evasion"},"Stage3 malware used ",(0,l.kt)("em",{parentName:"h3"},"AdvancedRun.exe")," via VBScript and PowerShell do disable Windows Defender for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.005 - Command and Scripting Interpreter: Visual Basic"),(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("li",{parentName:"ul"},"T1562.001 - Impair Defenses: Disable or Modify Tools")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.005"),(0,l.kt)("td",{parentName:"tr",align:null},"Stage3 executed a Visual Basic script file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\System32\\\\WScript.exe\\" \\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Nmddfrqqrbyjeygggda.vbs\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"WScript.exe spawned PowerShell"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell.exe Set-MpPreference -ExclusionPath \\'C:\\\\\\'"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," command to exclude folder from Windows Defender"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell.exe Set-MpPreference -ExclusionPath \\'C:\\\\\\'"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Stage3 executed ",(0,l.kt)("em",{parentName:"td"},"AdvancedRun.exe")," to stop Windows Defender."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe\\" /EXEFilename \\"C:\\\\Windows\\\\System32\\\\sc.exe\\" /WindowState 0 /CommandLine \\"stop WinDefend\\" /StartDirectory \\"\\" /RunAs 8 /Run'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"AdvancedRun.exe")," executed ",(0,l.kt)("em",{parentName:"td"},"sc.exe")," to stop Windows Defender."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe\\" /EXEFilename \\"C:\\\\Windows\\\\System32\\\\sc.exe\\" /WindowState 0 /CommandLine \\"stop WinDefend\\" /StartDirectory \\"\\" /RunAs 8 /Run'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Stage3 executed ",(0,l.kt)("em",{parentName:"td"},"AdvancedRun.exe")," to remove Windows Defender directory."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe\\" /EXEFilename \\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\" /WindowState 0 /CommandLine \\"rmdir \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\" -Recurse\\" /StartDirectory \\"\\" /RunAs 8 /Run'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"AdvancedRun.exe")," executed ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to remove Windows Defender directory."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\AdvancedRun.exe\\" /EXEFilename \\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\" /WindowState 0 /CommandLine \\"rmdir \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\" -Recurse\\" /StartDirectory \\"\\" /RunAs 8 /Run'))))),(0,l.kt)("h3",{id:"threat-actor-used-process-injection-on-_installutil-to-launch-the-destructive-routines-for-impact"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"process injection on _InstallUtil")," to launch the destructive routines for Impact."),(0,l.kt)("h4",{id:"tactic-6"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-6"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1055 - Process Injection"),(0,l.kt)("li",{parentName:"ul"},"T1561 - Disk Wipe")),(0,l.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1055",(0,l.kt)("br",null),"T1561"),(0,l.kt)("td",{parentName:"tr",align:null},"File corruptor executed via Process Injection on ",(0,l.kt)("em",{parentName:"td"},"InstallUtil.exe"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"InstallUtil.exe"))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"At this time, only Elastic reports on this TTP and no further details are available."),(0,l.kt)("li",{parentName:"ul"},"InstallUtil.exe is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries.")),(0,l.kt)("h3",{id:"malware-used-cmd-del-command-to-delete-itself-for-defense-evasion"},"Malware used ",(0,l.kt)("em",{parentName:"h3"},"CMD del")," command to delete itself for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-7"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-7"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1497.003 - Virtualization/Sandbox Evasion: Time Based Evasion"),(0,l.kt)("li",{parentName:"ul"},"T1070.004 - Indicator Removal on Host: File Deletion")),(0,l.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1497.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware launched a CMD command to delay execution of further commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 > Nul & Del /f /q #{process}"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1070.004"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware deleted itself via CMD."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 > Nul & Del /f /q #{process}"))))))}p.isMDXComponent=!0}}]);