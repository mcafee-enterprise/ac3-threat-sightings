"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[3602],{3248:function(e,n,t){var i=t(7294),a=t(7273);a.Z.initialize({startOnLoad:!0});n.Z=function(e){var n=e.chart;return(0,i.useEffect)((function(){a.Z.contentLoaded()}),[]),i.createElement("div",{className:"mermaid"},n)}},3098:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return d},toc:function(){return u},default:function(){return m}});var i=t(7462),a=t(3366),o=(t(7294),t(4137)),r=t(3248),s=["components"],l={},c=void 0,d={unversionedId:"Sightings/Older Schema Version/CVE-2021-40444",id:"Sightings/Older Schema Version/CVE-2021-40444",isDocsHomePage:!1,title:"CVE-2021-40444",description:"Summary",source:"@site/docs/03-Sightings/Older Schema Version/01-CVE-2021-40444.md",sourceDirName:"03-Sightings/Older Schema Version",slug:"/Sightings/Older Schema Version/CVE-2021-40444",permalink:"/ac3-threat-sightings/docs/Sightings/Older Schema Version/CVE-2021-40444",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Emotet_Dec2021",permalink:"/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021"},next:{title:"CobaltStrike",permalink:"/ac3-threat-sightings/docs/Sightings/Older Schema Version/CobaltStrike"}},u=[{value:"Summary",id:"summary",children:[{value:"Description",id:"description",children:[]}]},{value:"TTPs",id:"ttps",children:[{value:"Execution - User Execution. Weaponized office document.",id:"execution---user-execution-weaponized-office-document",children:[]}]},{value:"Threat Sighting YAML File",id:"threat-sighting-yaml-file",children:[]}],p={toc:u};function m(e){var n=e.components,t=(0,a.Z)(e,s);return(0,o.kt)("wrapper",(0,i.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"summary"},"Summary"),(0,o.kt)("h3",{id:"description"},"Description"),(0,o.kt)("p",null," Threat Sighting for CVE-2021-40444 (Microsoft MSHTML Remote Code Execution Vulnerability). Microsoft is investigating reports of a remote code execution vulnerability in MSHTML that affects Microsoft Windows. Microsoft is aware of targeted attacks that attempt to exploit this vulnerability by using specially-crafted Microsoft Office documents."),(0,o.kt)("h2",{id:"ttps"},"TTPs"),(0,o.kt)("h3",{id:"execution---user-execution-weaponized-office-document"},"Execution - User Execution. Weaponized office document."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,o.kt)("th",{parentName:"tr",align:null},"Technique"),(0,o.kt)("th",{parentName:"tr",align:null},"Behavior"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Execution"),(0,o.kt)("td",{parentName:"tr",align:null},"T1204.002 - User Execution: Malicious File"),(0,o.kt)("td",{parentName:"tr",align:null},"Winword drops DLL file masqueraded as INF file")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Execution"),(0,o.kt)("td",{parentName:"tr",align:null},"T1203 - Exploitation for Client Execution"),(0,o.kt)("td",{parentName:"tr",align:null},"Winword drops DLL file masqueraded as INF file")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Command and Control"),(0,o.kt)("td",{parentName:"tr",align:null},"T1105 - Ingress tool transfer"),(0,o.kt)("td",{parentName:"tr",align:null},"Winword drops DLL file masqueraded as INF file")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,o.kt)("td",{parentName:"tr",align:null},"T1036 - Masquerading"),(0,o.kt)("td",{parentName:"tr",align:null},"Winword drops DLL file masqueraded as INF file")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Execution"),(0,o.kt)("td",{parentName:"tr",align:null},"T1218.002 - Signed Binary Proxy Execution: Control Panel"),(0,o.kt)("td",{parentName:"tr",align:null},"Winword spawns control.exe to execute masqueraded DLL")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Execution"),(0,o.kt)("td",{parentName:"tr",align:null},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,o.kt)("td",{parentName:"tr",align:null},"control.exe spawns RUNDLL32 to execute masqueraded DLL via Shell32.dll")))),(0,o.kt)(r.Z,{chart:'\ngraph LR;\nsigh_781196695deb41e1bae37d6623a4fabc["Execution - User Execution. Weaponized office document."];\ntyp_0["File Created"];\nsigh_781196695deb41e1bae37d6623a4fabc --\x3e typ_0;\ntech_0["T1204.002 - User Execution: Malicious File"];\ntyp_0 --\x3e tech_0;\ntech_1["T1203 - Exploitation for Client Execution"];\ntyp_0 --\x3e tech_1;\ntech_2["T1105 - Ingress tool transfer"];\ntyp_0 --\x3e tech_2;\ntech_3["T1036 - Masquerading"];\ntyp_0 --\x3e tech_3;\ntyp_1["Process Created"];\nsigh_781196695deb41e1bae37d6623a4fabc --\x3e typ_1;\ntech_4["T1218.002 - Signed Binary Proxy Execution: Control Panel"];\ntyp_1 --\x3e tech_4;\ntyp_2["Process Created"];\nsigh_781196695deb41e1bae37d6623a4fabc --\x3e typ_2;\ntech_5["T1218.011 - Signed Binary Proxy Execution: Rundll32"];\ntyp_2 --\x3e tech_5;\n',mdxType:"Mermaid"}),(0,o.kt)("h2",{id:"threat-sighting-yaml-file"},"Threat Sighting YAML File"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"header:\n sightingReportId: 5b0254ce-bf9f-4b00-b272-0bd96d114de2\n status: wip\n description: Threat Sighting for CVE-2021-40444 (Microsoft MSHTML Remote Code Execution Vulnerability). Microsoft is investigating reports of a remote code execution vulnerability in MSHTML that affects Microsoft Windows. Microsoft is aware of targeted attacks that attempt to exploit this vulnerability by using specially-crafted Microsoft Office documents.\n author: Alejandro Houspanossian (@lekz86)\n acknowledgement: Kevin Beaumont (@GossiTheDog)\n tlp: white\n threatInformation:\n   adversary:\n   - n/d\n   malware:\n   - n/d\n   tools:\n   - n/d\n   lolbas:\n   - Winword.exe\n   - excel.exe\n   - powerpnt.exe\n   - rundll32.exe\n   - control.exe\n   - Shell32.dll\n   country:\n   - n/d\n   industry:\n   - n/d\n   region:\n   - n/d\nthreatSightings:\n- sighting: Execution - User Execution. Weaponized office document.\n id: 78119669-5deb-41e1-bae3-7d6623a4fabc\n observables:\n - behavior: Winword drops DLL file masqueraded as INF file\n   id: 81676822-b170-4ea8-b010-7aaa35587d90\n   type: File Created\n   parentProcess: C:\\\\Program Files (x86)\\\\Microsoft Office\\\\Office16\\\\WINWORD.EXE\n   files:\n   - name: championship.inf\n     path: C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\Temp\\\\championship.inf\n     sha256: 6EEDF45CB91F6762DE4E35E36BCB03E5AD60CE9AC5A08CAEB7EDA035CD74762B\n     fileType: PE\n   notes:\n   - Legit .INF files (aka Setup Information files) are a plain-text file used by Microsoft Windows for the installation of software and drivers.\n   att&ck:\n     execution:\n     - 'T1204.002 - User Execution: Malicious File'\n     - T1203 - Exploitation for Client Execution\n     commandAndControl:\n     - T1105 - Ingress tool transfer\n     defenseEvasion:\n     - T1036 - Masquerading\n - behavior: Winword spawns control.exe to execute masqueraded DLL\n   id: dc761f3a-fce2-409d-8976-6928056c792f\n   type: Process Created\n   parentProcess: C:\\\\Program Files (x86)\\\\Microsoft Office\\\\Office16\\\\WINWORD.EXE\n   process: C:\\\\Windows\\\\System32\\\\control.exe\n   cmdLine:\n   - '''C:\\Windows\\System32\\control.exe'' ''.cpl:../../../AppData/Local/Temp/championship.inf'''\n   notes:\n   - control.exe  is a part of the Microsoft Windows Operating System and offers access to the Microsoft Windows Control Panel.\n   - control.exe executes Control Panel items provided in the command-line\n   - Control Panel items are DLLs or executable (.exe) files that let users configure the environment of Windows.\n   - Control Panel items are typically accessed by clicking an icon in the Control Panel.\n   - Control Panel items file extensions is typically .cpl.\n   att&ck:\n     execution:\n     - 'T1218.002 - Signed Binary Proxy Execution: Control Panel'\n - behavior: control.exe spawns RUNDLL32 to execute masqueraded DLL via Shell32.dll\n   id: b76bbd49-83d3-4a90-93e2-3e4847c70a53\n   type: Process Created\n   parentProcess: C:\\\\Windows\\\\System32\\\\control.exe\n   process: C:\\\\Windows\\\\System32\\\\rundll32.exe\n   cmdLine:\n   - '''C:\\Windows\\system32\\rundll32.exe'' Shell32.dll,Control_RunDLL ''.cpl:../../../AppData/Local/Temp/championship.inf'''\n   notes:\n   - Shell32.dll is a LOLBAS that can be abused to launch DLL payloads.\n   att&ck:\n     execution:\n     - 'T1218.011 - Signed Binary Proxy Execution: Rundll32'\nthreatHunting:\n- query: Hunt for suspicious execution of control.exe (Winword-> control.exe -> inf file)\n queryId: 0887e0e1-e67a-4e72-8d6e-2b567b3f8ed4\n type: sigma\n behaviorIds:\n - dc761f3a-fce2-409d-8976-6928056c792f\n logsource:\n   category: process_creation\n   product: windows\n detection:\n   selection:\n     ParentImage|endswith:\n     - \\Winword.exe\n     - \\excel.exe\n     - \\powerpnt.exe\n   selection2:\n     Image|endswith:\n     - \\control.exe\n     CommandLine|contains:\n     - AppData/Local/Temp/\n     - '.inf'\n     - .dll\n   condition: all of them\n- query: Hunt for suspicious execution of control.exe spawning RUNDLL32 + Shell32.dll\n queryId: add0e36a-fdf3-4606-a75d-9f696897ca96\n type: sigma\n behaviorIds:\n - b76bbd49-83d3-4a90-93e2-3e4847c70a53\n logsource:\n   category: process_creation\n   product: windows\n detection:\n   selection:\n     ParentImage|endswith:\n     - \\control.exe\n   selection2:\n     Image|endswith:\n     - \\rundll32.exe\n     CommandLine|contains|all:\n     - Shell32.dll,Control_RunDLL\n   condition: all of them\n- query: Hunt for Winword dropping INF file.\n queryId: 2afafde1-d374-4aea-85fe-f92a6aa26060\n type: sigma\n behaviorIds:\n - 81676822-b170-4ea8-b010-7aaa35587d90\n logsource:\n   category: file_event\n   product: windows\n detection:\n   selection:\n     ParentImage|endswith:\n     - \\Winword.exe\n   selection2:\n     FileName|endswith:\n     - '.inf'\n   condition: all of them\nfooter:\n changeTracking:\n   created: 2021-09-08\n   lastModified: 2021-11-03\n   sightingVersion: 1.4\n   schemaVersion: 1.6\n references:\n - https://www.joesandbox.com/analysis/476188/1/html\n - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444\n - https://docs.microsoft.com/en-us/windows/win32/shell/executing-control-panel-items\n - https://lolbas-project.github.io/lolbas/Libraries/Shell32/\n")))}m.isMDXComponent=!0}}]);