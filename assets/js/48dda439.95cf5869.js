"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[6630],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},4370:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return m},contentTitle:function(){return o},metadata:function(){return d},toc:function(){return k},default:function(){return c}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=a(3248),s=["components"],m={},o=void 0,d={unversionedId:"Sightings/BlackCat_Ransomware",id:"Sightings/BlackCat_Ransomware",isDocsHomePage:!1,title:"BlackCat_Ransomware",description:"Overview",source:"@site/docs/03-Sightings/04-BlackCat_Ransomware.md",sourceDirName:"03-Sightings",slug:"/Sightings/BlackCat_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/BlackCat_Ransomware",tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Conti_Ransomware",permalink:"/ac3-threat-sightings/docs/Sightings/Conti_Ransomware"},next:{title:"Jupyter_InfoStealer",permalink:"/ac3-threat-sightings/docs/Sightings/Jupyter_InfoStealer"}},k=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"BlackCat malware has used <em>CMSTPLUA</em> COM interface UAC Bypass for Privilege Escalation.",id:"blackcat-malware-has-used-cmstplua-com-interface-uac-bypass-for-privilege-escalation",children:[]},{value:"BlackCat malware has used <em>vssadmin.exe</em> to delete Volume Shadow Copies for Impact.",id:"blackcat-malware-has-used-vssadminexe-to-delete-volume-shadow-copies-for-impact",children:[]},{value:"BlackCat malware has used <em>WMIC.exe</em> to obtain system UUID for Discovery.",id:"blackcat-malware-has-used-wmicexe-to-obtain-system-uuid-for-discovery",children:[]},{value:"BlackCat malware has used <em>fsutil.exe</em> to modifify symbolic link evaluation settings for Lateral Movement.",id:"blackcat-malware-has-used-fsutilexe-to-modifify-symbolic-link-evaluation-settings-for-lateral-movement",children:[]},{value:"BlackCat malware has used <em>reg.exe</em> to modify SMB protocol implementation settings for Lateral Movement.",id:"blackcat-malware-has-used-regexe-to-modify-smb-protocol-implementation-settings-for-lateral-movement",children:[]},{value:"BlackCat malware has used <em>net.exe</em> to mount remote drives for Lateral Movement.",id:"blackcat-malware-has-used-netexe-to-mount-remote-drives-for-lateral-movement",children:[]},{value:"BlackCat malware has used <em>Native API calls</em> to enumerated network shares for Defense Evasion.",id:"blackcat-malware-has-used-native-api-calls-to-enumerated-network-shares-for-defense-evasion",children:[]},{value:"BlackCat malware has used <em>.sykffle file extension</em> for <em>encrypted files</em> for Impact.",id:"blackcat-malware-has-used-sykffle-file-extension-for-encrypted-files-for-impact",children:[]}]}],u={toc:k};function c(e){var t=e.components,a=(0,r.Z)(e,s);return(0,l.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"Threat Sighting for BlackCat Ransomware TTPs based on internal research and external reports. BlackCat is written in Rust and promoted on Russian-speaking hacking forums. The ransomware-as-a-service (RaaS) pays affiliates depending on the size of the ransom payment. The malware is highly configurable, with the ability to use different encryption routines, spread between computers, kill virtual machines and ESXi VMs, and automatically wipe ESXi snapshots to prevent recovery. BlackCat uses a triple-extortion tactic where they steal data before encrypting devices and threat to publish the data if a ransom is not paid. As an additional extortion method, the threat actors threaten to DDoS victims until they pay a ransom. Source- Bleeping Computer."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_BlackCat_Ransomware.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_BlackCat_Ransomware.yml")),(0,l.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("p",null,"Acknowledgements: Jason Hill @varonis, Symantec @threatintel"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.bleepingcomputer.com/news/security/alphv-blackcat-this-years-most-sophisticated-ransomware/"},"https://www.bleepingcomputer.com/news/security/alphv-blackcat-this-years-most-sophisticated-ransomware/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/noberus-blackcat-alphv-rust-ransomware"},"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/noberus-blackcat-alphv-rust-ransomware")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.varonis.com/blog/alphv-blackcat-ransomware"},"https://www.varonis.com/blog/alphv-blackcat-ransomware")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://cqureacademy.com/cqure-labs/cqlabs-how-uac-bypass-methods-really-work-by-adrian-denkiewicz"},"https://cqureacademy.com/cqure-labs/cqlabs-how-uac-bypass-methods-really-work-by-adrian-denkiewicz"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"li"},"CMSTPLUA")," COM interface UAC Bypass for Privilege Escalation."),(0,l.kt)("li",{parentName:"ul"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"li"},"vssadmin.exe")," to delete Volume Shadow Copies for Impact."),(0,l.kt)("li",{parentName:"ul"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"li"},"WMIC.exe")," to obtain system UUID for Discovery."),(0,l.kt)("li",{parentName:"ul"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"li"},"fsutil.exe")," to modifify symbolic link evaluation settings for Lateral Movement."),(0,l.kt)("li",{parentName:"ul"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"li"},"reg.exe")," to modify SMB protocol implementation settings for Lateral Movement."),(0,l.kt)("li",{parentName:"ul"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"li"},"net.exe")," to mount remote drives for Lateral Movement."),(0,l.kt)("li",{parentName:"ul"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"li"},"Native API calls")," to enumerated network shares for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"li"},".sykffle file extension")," for ",(0,l.kt)("em",{parentName:"li"},"encrypted files")," for Impact.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"+++ (3)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(i.Z,{chart:"\ngraph LR\nEXE[Execution] --\x3e | _CMSTPLUA_ COM interface UAC Bypass| PE[Privilege Escalation]\nPE[Privilege Escalation] --\x3e | _vssadmin.exe_ to delete Volume Shadow Copies| IMP[Impact]\nPE[Privilege Escalation] --\x3e | _WMIC.exe_ to obtain system UUID| D[Discovery]\nPE[Privilege Escalation] --\x3e | _fsutil.exe_ to modifify symbolic link evaluation settings| LatM[Lateral Movement]\nPE[Privilege Escalation] --\x3e | _reg.exe_ to modify SMB protocol implementation settings| LatM[Lateral Movement]\nPE[Privilege Escalation] --\x3e | _net.exe_ to mount remote drives| LatM[Lateral Movement]\nPE[Privilege Escalation] --\x3e | _Native API calls_ to enumerated network shares| DE[Defense Evasion]\nPE[Privilege Escalation] --\x3e | _.sykffle file extension_ for _encrypted files_| IMP[Impact]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.003 - Signed Binary Proxy Execution: CMSTP",(0,l.kt)("br",null),"T1548.002 - Abuse Elevation Control Mechanism: Bypass User Account Control"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"CMSTPLUA")," COM interface UAC Bypass for Privilege Escalation.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1490 - Inhibit System Recovery"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"vssadmin.exe")," to delete Volume Shadow Copies for Impact.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1082 - System Information Discovery",(0,l.kt)("br",null),"T1047 - Windows Management Instrumentation"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"WMIC.exe")," to obtain system UUID for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1xxx - Modify Symbolic Links Evaluation configurations"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"fsutil.exe")," to modifify symbolic link evaluation settings for Lateral Movement.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1021.001 - Remote Services: SMB/Windows Admin Shares",(0,l.kt)("br",null),"T1112 - Modify Registry"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"reg.exe")," to modify SMB protocol implementation settings for Lateral Movement.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1021.002 - Remote Services: SMB/Windows Admin Shares",(0,l.kt)("br",null),"T1078 - Valid Accounts"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"net.exe")," to mount remote drives for Lateral Movement.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1106 - Native API"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"Native API calls")," to enumerated network shares for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1486 - Data Encrypted for Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},".sykffle file extension")," for ",(0,l.kt)("em",{parentName:"td"},"encrypted files")," for Impact.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,l.kt)("td",{parentName:"tr",align:null},"T1218.003",(0,l.kt)("br",null),"T1548.002"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"CMSTPLUA")," COM interface UAC Bypass for Privilege Escalation."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\SysWOW64\\\\DllHost.exe /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\Downloads\\\\customBlackCat.exe\\" \\"--access-token\\" \\"123456\\" \\"-p\\" \\"c:\\\\Victim\\"')),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"DllHost.exe")," (aka ",(0,l.kt)("em",{parentName:"td"},"COM Surrogate")," aka ",(0,l.kt)("em",{parentName:"td"},"DLLHOST"),") is part of Microsoft Windows.",(0,l.kt)("br",null),"- With the ",(0,l.kt)("em",{parentName:"td"},"/Processid")," flag, ",(0,l.kt)("em",{parentName:"td"},"DLLHOST")," will execute the COM object referenced by 3E5FC7F9-9A51-4367-9063-A120244FBEC7.",(0,l.kt)("br",null),"- 3E5FC7F9-9A51-4367-9063-A120244FBEC7 corresponds to the ",(0,l.kt)("em",{parentName:"td"},"CMSTPLUA COM interface"),".",(0,l.kt)("br",null),"- ",(0,l.kt)("em",{parentName:"td"},"CMSTPLUA")," stands for Connection Manager Admin API Helper for Setup, and is part of the Microsoft Connection Manager Profile Installer (",(0,l.kt)("em",{parentName:"td"},"CMSTP"),").",(0,l.kt)("br",null),"- The ",(0,l.kt)("em",{parentName:"td"},"CMSTPLUA")," COM interface has a method called ",(0,l.kt)("em",{parentName:"td"},"ShellExec")," that can be abused to launch arbitrary commands as high integrity processes.",(0,l.kt)("br",null),"- The ",(0,l.kt)("em",{parentName:"td"},"CMSTPLUA UAC Bypass")," will produce suspicious process execution started by ",(0,l.kt)("em",{parentName:"td"},"DLLHOST")," without prompting the user for confirmation.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1490"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"vssadmin.exe")," to delete Volume Shadow Copies for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"vssadmin.exe delete shadows /all /quiet\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"vssadmin.exe delete shadows /all /quiet")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"vssadmin.exe delete shadows /all /quiet")," is a common command executed by ransomware.",(0,l.kt)("br",null),"- ",(0,l.kt)("em",{parentName:"td"},"vssadmin.exe")," is Windows Volume Shadow Copy Service administrative tool.",(0,l.kt)("br",null),"- Windows Volume Shadow Copy is a technology to create backups of computer files.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1082",(0,l.kt)("br",null),"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"WMIC.exe")," to obtain system UUID for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"wmic csproduct get UUID\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic csproduct get UUID")),(0,l.kt)("td",{parentName:"tr",align:null},"- The command ",(0,l.kt)("em",{parentName:"td"},"wmic csproduct get UUID")," retrieves the universally unique identifier (UUID) of the target system.",(0,l.kt)("br",null),"- ",(0,l.kt)("em",{parentName:"td"},"WMIC.exe"),"  is a command-line interface for Windows Management Instrumentation (WMI) technology",(0,l.kt)("br",null),"- ",(0,l.kt)("em",{parentName:"td"},"WMI")," is a techonlogy for enterprise-scale manageability.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1xxx"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"fsutil.exe")," to modifify symbolic link evaluation settings for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"fsutil behavior set SymlinkEvaluation R2L:1\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"fsutil behavior set SymlinkEvaluation R2L:1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"fsutil behavior set SymlinkEvaluation R2R:1")),(0,l.kt)("td",{parentName:"tr",align:null},"- The First L o R -before the 2- refers location of the links",(0,l.kt)("br",null),"- The Second L o R -after the 2- refers location of the target of the link",(0,l.kt)("br",null),"- R2L means that you can access links located on a remote machine that point to targets on the same remote machine.",(0,l.kt)("br",null),"- R2R means that you can access links located on a remote machine that point to remote targets of the remote machine.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1021.001",(0,l.kt)("br",null),"T1112"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"reg.exe")," to modify SMB protocol implementation settings for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"reg add HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanServer\\\\Parameters /v MaxMpxCt /d 65535 /t REG_DWORD /f\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"reg add HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanServer\\\\Parameters /v MaxMpxCt /d 65535 /t REG_DWORD /f")),(0,l.kt)("td",{parentName:"tr",align:null},"- LanmanServer is a Windows service that implements the server side of the Server Message Block (SMB) protocol.",(0,l.kt)("br",null),"- MaxMpxCt specifies the maximum outstanding network requests for the server per client. 65535 is highest possible value.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1021.002",(0,l.kt)("br",null),"T1078"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"net.exe")," to mount remote drives for Lateral Movement."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"net use \\\\\\\\REMOTEDIR /user:Administrator password /persistent:no\\"'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net use \\\\\\\\REMOTEDIR /user:Administrator password /persistent:no")),(0,l.kt)("td",{parentName:"tr",align:null},"- ",(0,l.kt)("em",{parentName:"td"},"net use")," command typically takes a drive as first parameter for further reference of the mounted drive.",(0,l.kt)("br",null),"- if no drive letter is provided, the commands succeeds but the connected drive remains unmmaped.",(0,l.kt)("br",null),"- not using a drive letter might be an unvoluntary ommision or a defense evasion technique.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1106"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},"Native API calls")," to enumerated network shares for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1486"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"td"},".sykffle file extension")," for ",(0,l.kt)("em",{parentName:"td"},"encrypted files")," for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Modified"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\RECOVER-sykffle-FILES.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\RECOVER-sykffle-FILES.txt.png")),(0,l.kt)("td",{parentName:"tr",align:null},"- RECOVER-sykffle-FILES.txt",(0,l.kt)("br",null),"- RECOVER-sykffle-FILES.txt.png")))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"blackcat-malware-has-used-cmstplua-com-interface-uac-bypass-for-privilege-escalation"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"h3"},"CMSTPLUA")," COM interface UAC Bypass for Privilege Escalation."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Privilege Escalation")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1218.003 - Signed Binary Proxy Execution: CMSTP"),(0,l.kt)("li",{parentName:"ul"},"T1548.002 - Abuse Elevation Control Mechanism: Bypass User Account Control")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1218.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"DLLHOST")," executed the ",(0,l.kt)("em",{parentName:"td"},"CMSTPLUA")," COM object."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\SysWOW64\\\\DllHost.exe /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1548.002"),(0,l.kt)("td",{parentName:"tr",align:null},"DLLHOST (",(0,l.kt)("em",{parentName:"td"},"CMSTPLUA"),") spawned BlackCat malware with high integrity."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"C:\\\\Users\\\\#{user}\\\\Downloads\\\\customBlackCat.exe\\" \\"--access-token\\" \\"123456\\" \\"-p\\" \\"c:\\\\Victim\\"'))))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The ",(0,l.kt)("em",{parentName:"li"},"CMSTPLUA")," COM interface has a method called ",(0,l.kt)("em",{parentName:"li"},"ShellExec")," that can be abused to launch arbitrary commands as high integrity processes."),(0,l.kt)("li",{parentName:"ul"},"The ",(0,l.kt)("em",{parentName:"li"},"CMSTPLUA UAC Bypass")," will produce suspicious process execution started by ",(0,l.kt)("em",{parentName:"li"},"DLLHOST")," without prompting the user for confirmation.")),(0,l.kt)("h3",{id:"blackcat-malware-has-used-vssadminexe-to-delete-volume-shadow-copies-for-impact"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"h3"},"vssadmin.exe")," to delete Volume Shadow Copies for Impact."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1490 - Inhibit System Recovery")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"vssadmin.exe delete shadows /all /quiet\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1490"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat executed ",(0,l.kt)("em",{parentName:"td"},"vssadmin.exe")," to delete all Windows Volume Shadow Copies on a system."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"vssadmin.exe delete shadows /all /quiet"))))),(0,l.kt)("h4",{id:"notes-1"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"vssadmin.exe")," is Windows Volume Shadow Copy Service administrative tool."),(0,l.kt)("li",{parentName:"ul"},"Windows Volume Shadow Copy is a technology to create backups of computer files.")),(0,l.kt)("h3",{id:"blackcat-malware-has-used-wmicexe-to-obtain-system-uuid-for-discovery"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"h3"},"WMIC.exe")," to obtain system UUID for Discovery."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1082 - System Information Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"wmic csproduct get UUID\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1082",(0,l.kt)("br",null),"T1047"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"WMIC command")," executed to retrieve system UUID."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic csproduct get UUID"))))),(0,l.kt)("h4",{id:"notes-2"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The command ",(0,l.kt)("em",{parentName:"li"},"wmic csproduct get UUID")," retrieves the universally unique identifier (UUID) of the target system."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"WMIC.exe"),"  is a command-line interface for Windows Management Instrumentation (WMI) technology"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"WMI")," is a techonlogy for enterprise-scale manageability.")),(0,l.kt)("h3",{id:"blackcat-malware-has-used-fsutilexe-to-modifify-symbolic-link-evaluation-settings-for-lateral-movement"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"h3"},"fsutil.exe")," to modifify symbolic link evaluation settings for Lateral Movement."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Lateral Movement")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1xxx - Modify Symbolic Links Evaluation configurations")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"fsutil behavior set SymlinkEvaluation R2L:1\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1xxx"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"fsutil")," command executed to modify symbolic link evaluation settings."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"fsutil behavior set SymlinkEvaluation R2L:1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"fsutil behavior set SymlinkEvaluation R2R:1"))))),(0,l.kt)("h4",{id:"notes-3"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The First L o R -before the 2- refers location of the links"),(0,l.kt)("li",{parentName:"ul"},"The Second L o R -after the 2- refers location of the target of the link"),(0,l.kt)("li",{parentName:"ul"},"R2L means that you can access links located on a remote machine that point to targets on the same remote machine."),(0,l.kt)("li",{parentName:"ul"},"R2R means that you can access links located on a remote machine that point to remote targets of the remote machine.")),(0,l.kt)("h3",{id:"blackcat-malware-has-used-regexe-to-modify-smb-protocol-implementation-settings-for-lateral-movement"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"h3"},"reg.exe")," to modify SMB protocol implementation settings for Lateral Movement."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Lateral Movement")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1021.001 - Remote Services: SMB/Windows Admin Shares"),(0,l.kt)("li",{parentName:"ul"},"T1112 - Modify Registry")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"reg add HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanServer\\\\Parameters /v MaxMpxCt /d 65535 /t REG_DWORD /f\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1021.001",(0,l.kt)("br",null),"T1112"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"reg.exe add")," command executed to modify SMB protocol settings."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"reg add HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanServer\\\\Parameters /v MaxMpxCt /d 65535 /t REG_DWORD /f"))))),(0,l.kt)("h4",{id:"notes-4"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"LanmanServer is a Windows service that implements the server side of the Server Message Block (SMB) protocol."),(0,l.kt)("li",{parentName:"ul"},"MaxMpxCt specifies the maximum outstanding network requests for the server per client. 65535 is highest possible value.")),(0,l.kt)("h3",{id:"blackcat-malware-has-used-netexe-to-mount-remote-drives-for-lateral-movement"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"h3"},"net.exe")," to mount remote drives for Lateral Movement."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Lateral Movement")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1021.002 - Remote Services: SMB/Windows Admin Shares"),(0,l.kt)("li",{parentName:"ul"},"T1078 - Valid Accounts")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat launched ",(0,l.kt)("em",{parentName:"td"},"CMD")," for command execution."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'\\"cmd\\" /c \\"net use \\\\\\\\REMOTEDIR /user:Administrator password /persistent:no\\"'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1021.002",(0,l.kt)("br",null),"T1078"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"net use")," command executed to mount (unmmaped) remote drive."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"net use \\\\\\\\REMOTEDIR /user:Administrator password /persistent:no"))))),(0,l.kt)("h4",{id:"notes-5"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"net use")," command typically takes a drive as first parameter for further reference of the mounted drive."),(0,l.kt)("li",{parentName:"ul"},"if no drive letter is provided, the commands succeeds but the connected drive remains unmmaped."),(0,l.kt)("li",{parentName:"ul"},"not using a drive letter might be an unvoluntary ommision or a defense evasion technique.")),(0,l.kt)("h3",{id:"blackcat-malware-has-used-native-api-calls-to-enumerated-network-shares-for-defense-evasion"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"h3"},"Native API calls")," to enumerated network shares for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-6"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-6"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1106 - Native API")),(0,l.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1106"),(0,l.kt)("td",{parentName:"tr",align:null},"Enumerated network share via ",(0,l.kt)("em",{parentName:"td"},"NetShareEnum API"),"."),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h3",{id:"blackcat-malware-has-used-sykffle-file-extension-for-encrypted-files-for-impact"},"BlackCat malware has used ",(0,l.kt)("em",{parentName:"h3"},".sykffle file extension")," for ",(0,l.kt)("em",{parentName:"h3"},"encrypted files")," for Impact."),(0,l.kt)("h4",{id:"tactic-7"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-7"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1486 - Data Encrypted for Impact")),(0,l.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1486"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackCat malware encrypts files (based on excusion lists)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Modified"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\RECOVER-sykffle-FILES.txt"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"*\\\\RECOVER-sykffle-FILES.txt.png"))))),(0,l.kt)("h4",{id:"notes-6"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"RECOVER-sykffle-FILES.txt"),(0,l.kt)("li",{parentName:"ul"},"RECOVER-sykffle-FILES.txt.png")))}c.isMDXComponent=!0}}]);